<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>使用 pip 离线复制 python 运行环境</title>
    <url>/2021/04/15/coding/environment/pip-env-install-off-line/pip-env-install-off-line/</url>
    <content><![CDATA[<blockquote>
<p>python 运行时会有不同环境需求，在其他机器部署时需要重新配置python环境，当需要离线部署时可以使用pip的离线复制环境的功能。</p>
</blockquote>
<a id="more"></a>

<h3 id="工作思路"><a href="#工作思路" class="headerlink" title="工作思路"></a>工作思路</h3><ol>
<li>获取环境所需的库和对应版本</li>
<li>确定运行平台（Linux，Windows）</li>
<li>在指定平台下载库的离线包</li>
<li>将库列表与离线包迁移到新机器</li>
<li>在新机器上安装python</li>
<li>安装离线包</li>
<li>程序调试</li>
</ol>
<h3 id="具体操作流程"><a href="#具体操作流程" class="headerlink" title="具体操作流程"></a>具体操作流程</h3><h4 id="获取环境所需的库和对应版本"><a href="#获取环境所需的库和对应版本" class="headerlink" title="获取环境所需的库和对应版本"></a>获取环境所需的库和对应版本</h4><ul>
<li>在源机器安装<code>pipreqs</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install pipreqs</span><br></pre></td></tr></table></figure>

<blockquote>
<p>pipreqs可以帮你找到当前项目的所有组件及其版本。</p>
</blockquote>
<ul>
<li>获取库与版本</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pipreqs ./  # 报错就执行下面这条</span><br><span class="line">pipreqs ./ --encoding=utf-8</span><br></pre></td></tr></table></figure>

<blockquote>
<p>成功后会在当前目录生成 <code>requirements.txt</code>文件</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">numba&#x3D;&#x3D;0.53.1</span><br><span class="line">matplotlib&#x3D;&#x3D;3.3.2</span><br><span class="line">opencv_python_headless&#x3D;&#x3D;4.5.1.48</span><br><span class="line">pynvml&#x3D;&#x3D;8.0.4</span><br><span class="line">tqdm&#x3D;&#x3D;4.49.0</span><br><span class="line">numpy&#x3D;&#x3D;1.19.2</span><br><span class="line">pathlib2&#x3D;&#x3D;2.3.5</span><br><span class="line">line_profiler&#x3D;&#x3D;3.1.0</span><br><span class="line">Pillow&#x3D;&#x3D;8.2.0</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="下载库的离线包"><a href="#下载库的离线包" class="headerlink" title="下载库的离线包"></a>下载库的离线包</h4><ul>
<li>获取<code>requirements.txt</code>后下载对应包，使用<code>pip download</code>命令将包存入<code>packages</code>文件夹</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir packages</span><br><span class="line">pip download -r requirements.txt -d e:/packages/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>目标路径不是绝对路径有可能出问题</p>
<p>也可以不用手动创建文件夹，pip会自动创建对应文件夹</p>
</blockquote>
<ul>
<li>也可以下载指定的包</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip download numpy -d e:/packages/</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意：</strong>这个命令如果中途遇到问题报错没有执行完则不会将所有之前下载的包放到目标文件夹，需要逐个解决问题后才会移动到指定位置</p>
<p><strong>Tips</strong>：建议将pip源换成阿里云，成功率高很多</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210415171821.png" alt="上述包文件下载后的结果"></p>
<h4 id="安装离线包"><a href="#安装离线包" class="headerlink" title="安装离线包"></a>安装离线包</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install --no-index --find-links=e:/packages/ -r requirements.txt</span><br></pre></td></tr></table></figure>


<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>–no-index</td>
<td>忽略包索引（只查看–find-links）</td>
</tr>
<tr>
<td>–find-links</td>
<td>指向 URL,html 文件 tar.gz,whl 或者目录，不支持指向VCS项目URL的链接</td>
</tr>
<tr>
<td>–ignore-installed</td>
<td>忽略已安装的软件包，覆盖它们</td>
</tr>
</tbody></table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.cnblogs.com/believepd/p/10423094.html" target="_blank" rel="noopener">https://www.cnblogs.com/believepd/p/10423094.html</a></li>
<li><a href="https://blog.csdn.net/u010383467/article/details/112274008" target="_blank" rel="noopener">https://blog.csdn.net/u010383467/article/details/112274008</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>pip</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>pip</tag>
      </tags>
  </entry>
  <entry>
    <title>降维算法 - SNE</title>
    <url>/2021/04/15/machine_learning/sne-alg/sne-alg/</url>
    <content><![CDATA[<blockquote>
<p>SNE是一种数据降维算法，最早出现在2002年，它改变了MDS和ISOMAP中基于距离不变的思想，将高维映射到低维的同时，尽量保证相互之间的分布概率不变，SNE将高维和低维中的样本分布都看作高斯分布，而Tsne将低维中的坐标当做T分布，这样做的好处是为了让距离大的簇之间距离拉大，从而解决了拥挤问题。。</p>
</blockquote>
<a id="more"></a>

<h3 id="SNE"><a href="#SNE" class="headerlink" title="SNE"></a>SNE</h3><ul>
<li>高维数据用X表示，Xi表示第i个样本，低维数据用Y表示，则高维中的分布概率矩阵P定义如下：</li>
</ul>
<p>$$<br>p _ { j |i } = \frac { exp ( - ||  x _ { i } - x _ { j }|| ^ { 2 } ( 2 \sigma _ { i } ^ { 2 } ) } { \sum _ {<br>k \neq 1 }  ( - || x _ { i } - x _ { k }  ^ { 2 } || ^ { 2 } ( 2 \sigma _ { i } ^ { 2 } )}<br>$$</p>
<ul>
<li><p>$P(i,j)$表示第$i$个样本分布在样本$j$周围的概率。$\sigma$是依据最大熵原理来决定，以每个样本点作为中心的$\sigma$都需要使得最后分布的熵较小，通常以$log(k)$为上限，$k$为你所决定的邻域点的个数</p>
</li>
<li><p>低维中的分布概率矩阵计算如下：<br>$$<br>q_{j \mid i}=\frac{\exp \left(-\left|y_{i}-y_{j}\right|^{2}\right)}{\sum_{k \neq i} \exp \left(-\left|y_{i}-y_{k}\right|^{2}\right)}<br>$$</p>
</li>
<li><p>这里我们把低维中的分布看作是均衡的，每个delta都是0.5，由此可以基本判断最后降维之后生成的分布也是一个相对均匀的分布。</p>
</li>
<li><p>随机给定一个初始化的Y，进行优化，使得Y的分布矩阵逼近X的分布矩阵。我们给定目的函数，用KL散度来定义两个不同分布之间的差距：</p>
</li>
</ul>
<p>$$<br>C=\sum_{i} K L\left(P_{i} | Q_{i}\right)=\sum_{i} \sum_{j} p_{j \mid i} \log \frac{p_{j \mid i}}{q_{j \mid i}}<br>$$</p>
<ul>
<li>则可以计算梯度为：</li>
</ul>
<p>$$<br>\frac{\delta C}{\delta y_{i}}=2 \sum_{j}\left(p_{j \mid i}-q_{j \mid i}+p_{i \mid j}-q_{i \mid j}\right)\left(y_{i}-y_{j}\right)<br>$$</p>
<ul>
<li>每次梯度下降的步长可设定固定或者自适应、随机等，也可以加上一个动量的梯度，初始值一般设为1e-4的随机正态分布。</li>
</ul>
<p>$$ \mathcal{Y}^{(t)}=\mathcal{Y}^{(t-1)}+\eta \frac{\delta C}{\delta \mathcal{Y}}+\alpha(t)\left(\gamma^{(t-1)}-\mathcal{Y}^{(t-2)}\right) $$</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/zhangweiguo_717/article/details/70188517" target="_blank" rel="noopener">https://blog.csdn.net/zhangweiguo_717/article/details/70188517</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>dimension reduction</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>dimension reduction</tag>
      </tags>
  </entry>
  <entry>
    <title>Python CUDA 编程 - 1 - 基础概念</title>
    <url>/2021/04/15/deep_learning/speed_up/numba/numba/</url>
    <content><![CDATA[<blockquote>
<p>基于CPU和GPU的异构计算已经逐步发展成为高性能计算的主流模式。CUDA作为GPU高性能计算的主要开发工具之一，已经在各个领域取得广泛应用。</p>
</blockquote>
<a id="more"></a>

<h3 id="什么是GPU"><a href="#什么是GPU" class="headerlink" title="什么是GPU"></a>什么是GPU</h3><blockquote>
<p>GPU全名为Graphics Processing Unit，又称视觉处理器、图形显示卡。GPU负责渲染出2D、3D、VR效果，主要专注于计算机图形图像领域。后来人们发现，GPU非常适合并行计算，可以加速现代科学计算，GPU也因此不再局限于游戏和视频领域。</p>
</blockquote>
<h3 id="加速原理"><a href="#加速原理" class="headerlink" title="加速原理"></a>加速原理</h3><blockquote>
<p>为了同时并行地处理更多任务，芯片公司开发出了多核架构，只要相互之间没有依赖，每个核心做自己的事情，多核之间互不干扰，就可以达到<strong>并行计算</strong>的效果，极大缩短计算时间。</p>
</blockquote>
<h3 id="CPU与GPU"><a href="#CPU与GPU" class="headerlink" title="CPU与GPU"></a>CPU与GPU</h3><p><img src="https://photos.zywvvd.com/image_canglan/20210415014639.png"></p>
<blockquote>
<p>CPU主要从主存（Main Memory）中读写数据，并通过总线（Bus）与GPU交互。GPU除了有超多计算核心外，也有自己独立的存储，被称之为显存。一台服务器上可以安装多块GPU卡，但GPU卡的发热量极大，普通的空调系统难以给大量GPU卡降温，所以大型数据中心通常使用水冷散热，并且选址在温度较低的地方。</p>
</blockquote>
<h3 id="主机与设备"><a href="#主机与设备" class="headerlink" title="主机与设备"></a>主机与设备</h3><blockquote>
<p>由于CPU和GPU是分开的，在英伟达的设计理念里，CPU和主存被称为<strong>主机（Host）</strong>，GPU被称为<strong>设备（Device）</strong>。Host和Device概念会贯穿整个英伟达GPU编程，甚至包括OpenCL等其他平台。</p>
<p>以上结构也被称为<strong>异构计算</strong>：使用CPU+GPU组合来加速计算。绝大多数的高性能计算中心会使用上图所示的结构，比如一台服务器上有2至4块Intel Xeon CPU和1至8块英伟达GPU显卡，多台机器之间通过InfiniBand高速网络互联。</p>
</blockquote>
<h3 id="英伟达GPU硬件架构"><a href="#英伟达GPU硬件架构" class="headerlink" title="英伟达GPU硬件架构"></a>英伟达GPU硬件架构</h3><blockquote>
<p>在英伟达的设计里，多个核心组成一个Streaming Multiprocessor（<strong>SM</strong>），一张GPU卡有多个SM。从“Multiprocessor”这个名字上也可以看出SM包含了多个处理器。实际上，英伟达主要以SM为运算和调度的基本单元。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20210415015000.png"></p>
<p>英伟达不同时代产品的芯片设计不同，每代产品背后有一个微架构代号，微架构均以著名的物理学家为名，以向先贤致敬。当前比较火热的架构有：</p>
<ul>
<li>Ampere 安培<ul>
<li>2020年5月发布</li>
<li>专业显卡：Telsa A100</li>
</ul>
</li>
<li>Turing 图灵<ul>
<li>2018年发布</li>
<li>消费显卡：GeForce RTX 2080 Ti、Titan RTX</li>
</ul>
</li>
<li>Volta 伏特<ul>
<li>2017年末发布</li>
<li>专业显卡：Telsa V100 (16或32GB显存 5120个CUDA核心)</li>
</ul>
</li>
<li>Pascal 帕斯卡<ul>
<li>2016年发布</li>
<li>专业显卡：Telsa P100(12或16GB显存 3584个CUDA核心)</li>
</ul>
</li>
</ul>
<h3 id="软件生态"><a href="#软件生态" class="headerlink" title="软件生态"></a>软件生态</h3><blockquote>
<p>英伟达能够在人工智能时代成功，除了他们在长期深耕显卡芯片领域，更重要的是他们率先提供了可编程的软件架构，确切地说，软硬件一体方案帮他们赢得了市场。2007年，英伟达发布了CUDA（Compute Unified Device Architecture）编程模型，软件开发人员从此可以使用CUDA在英伟达的GPU上进行并行编程。在此之前，GPU编程并不友好。CUDA简单到什么程度？有经验的程序员经过半天的培训，掌握一些基础概念后，能在半小时内将一份CPU程序修改成为GPU并行程序。</p>
</blockquote>
<blockquote>
<p>继CUDA之后，英伟达不断丰富其软件技术栈，提供了科学计算所必需的cuBLAS线性代数库，cuFFT快速傅里叶变换库等，当深度学习大潮到来时，英伟达提供了cuDNN深度神经网络加速库，目前常用的TensorFlow、PyTorch深度学习框架的底层大多基于cuDNN库。</p>
</blockquote>
<p>关于英伟达的软件栈，可以总结为：</p>
<ul>
<li>最底层是GPU硬件，包括各类GPU显卡，DGX工作站等。</li>
<li>操作系统是基于硬件的第一层软件，在操作系统上我们需要安装GPU驱动。</li>
<li>CUDA在GPU驱动之上，有了CUDA，我们可以进行一些GPU编程。</li>
<li>英伟达对相似计算进一步抽象，进而有了cuBLAS、cuFFT、cuDNN等库，这些库基于CUDA提供常见的计算。</li>
<li>最顶层是应用，包括TensorFlow和PyTorch的模型训练和推理过程。</li>
</ul>
<h3 id="CUDA"><a href="#CUDA" class="headerlink" title="CUDA"></a>CUDA</h3><blockquote>
<p>英伟达能在人工智能时代击败Intel、AMD等强大对手，很大一部分是因为它丰富的软件体系。这些软件工具库使研发人员专注于自己的研发领域，不用再去花大量时间学习GPU底层知识。CUDA对于GPU就像个人电脑上的Windows、手机上的安卓系统，一旦建立好生态，吸引了开发者，用户非常依赖这套软件生态体系。</p>
</blockquote>
<ul>
<li>GPU编程可以直接使用CUDA的C/C++版本进行编程，也可以使用其他语言包装好的库，比如Python可使用Numba库调用CUDA。CUDA的编程思想在不同语言上都很相似。</li>
</ul>
<p>CUDA及其软件栈的优势是方便易用，缺点也显而易见：</p>
<ol>
<li>软件环境复杂，库以及版本很多，顶层应用又严重依赖底层工具库，入门者很难快速配置好一整套环境；多环境配置困难。</li>
<li>用户只能使用英伟达的显卡，成本高，个人用户几乎负担不起。</li>
</ol>
<h3 id="英伟达之外的选项"><a href="#英伟达之外的选项" class="headerlink" title="英伟达之外的选项"></a>英伟达之外的选项</h3><ul>
<li><p>前文对GPU的描述主要基于英伟达旗下产品。在GPU领域，AMD也提供了独立显卡产品，价格较低。历史上，AMD的显卡产品线是收购ATI而获得的。相对来说，AMD的显卡在人工智能和超级计算领域并没有英伟达强势。为了与CUDA对抗，AMD提供的软件开发平台名为ROCm（Radeon Open Compute platforM ）。</p>
</li>
<li><p>与相对封闭的CUDA不同，OpenCL（Open Computing Language)也是当前重要的计算加速平台，可以兼容英伟达和AMD的GPU，以及一些FPGA等硬件。一些上层软件为了兼容性，在计算加速部分并没有使用CUDA，而是使用了OpenCL。比如，决策树算法框架LightGBM主要基于OpenCL进行GPU加速。</p>
</li>
</ul>
<blockquote>
<p>无论是ROCm还是OpenCL，其编程思想与CUDA都非常相似，如果掌握了CUDA，那上手OpenCL也会很容易。</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://lulaoshi.info/gpu/gpu-basic/gpu.html" target="_blank" rel="noopener">https://lulaoshi.info/gpu/gpu-basic/gpu.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Deep Learning</category>
        <category>CUDA</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>CUDA</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 10 - 常见概率分布</title>
    <url>/2021/04/14/math/probability/distributions/distributions/</url>
    <content><![CDATA[<blockquote>
<p>本文记录常见的概率分布。</p>
</blockquote>
<a id="more"></a>

<h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><h4 id="probability-mass-function-PMF"><a href="#probability-mass-function-PMF" class="headerlink" title="probability mass function:PMF"></a>probability mass function:PMF</h4><ul>
<li>概率质量函数（离散随机变量密度函数）</li>
<li>和为1</li>
</ul>
<h4 id="probability-density-function：PDF"><a href="#probability-density-function：PDF" class="headerlink" title="probability density function：PDF"></a>probability density function：PDF</h4><ul>
<li>概率密度函数（连续随机变量）</li>
<li>积分为1</li>
</ul>
<h3 id="常见分布"><a href="#常见分布" class="headerlink" title="常见分布"></a>常见分布</h3><h4 id="均匀分布"><a href="#均匀分布" class="headerlink" title="均匀分布"></a>均匀分布</h4><h5 id="离散随机变量的均匀分布"><a href="#离散随机变量的均匀分布" class="headerlink" title="离散随机变量的均匀分布"></a>离散随机变量的均匀分布</h5><ul>
<li>假设 $ X $ 有 $ k $ 个取值: $ x_{1}, x_{2}, \cdots, x_{k} $, 则均匀分布的概率密度函数( probability mass function:PMF )为:</li>
</ul>
<p>$$<br>p\left(X=x_{i}\right)=\frac{1}{k}, \quad i=1,2, \cdots, k<br>$$</p>
<h5 id="连续随机变量的均匀分布"><a href="#连续随机变量的均匀分布" class="headerlink" title="连续随机变量的均匀分布"></a>连续随机变量的均匀分布</h5><ul>
<li>假设 $ X $ 在 $ [\mathrm{a}, \mathrm{b}] $ 上均匀分布，则其概率密度函数( probability density function: PDF )为:</li>
</ul>

$$
p(X=x)=\left\{\begin{array}{ll}
0, & x \notin[a, b] \\
\frac{1}{b-a}, & x \in[a, b]
\end{array}\right.
$$



<ul>
<li>期望：</li>
</ul>

$$
\begin{array}{l}
\mu  &= \int_a^b {\frac{1}{{b - a}}xdx} \\
 &= \frac{{{b^2} - {a^2}}}{{2(b - a)}}\\
 &= \frac{{b - a}}{2}
\end{array}
$$



<ul>
<li>方差：</li>
</ul>

$$
\begin{array}{l}

{\sigma ^2} &= \int_a^b {\frac{1}{{b - a}}{{(x - \mu )}^2}dx} \\
 &= \frac{1}{{3(b - a)}}\int_a^b {d{{(x - \mu )}^3}} \\
 &= \frac{1}{{3(b - a)}}[{(\frac{{b - a}}{2})^3} - {(\frac{{a - b}}{2})^3}]\\
 &= \frac{{{{(b - a)}^2}}}{{12}}
\end{array}
$$



<h4 id="伯努利分布"><a href="#伯努利分布" class="headerlink" title="伯努利分布"></a>伯努利分布</h4><ol>
<li>伯努利分布：参数为 $ \phi \in[0,1]_{\circ} $ 随机变量 $ X \in{0,1} $ 。</li>
</ol>
<ul>
<li>概率分布函数： $ p(X=x)=\phi^{x}(1-\phi)^{1-x}, x \in{0,1} $ </li>
<li>期望: $ \mathbb{E}[X]=\phi $ </li>
<li>方差: $ \operatorname{Var}[X]=\phi(1-\phi) $ </li>
</ul>
<ol start="2">
<li>categorical 分布：它是二项分布的推广, 也称作 multinoulli 分布。假设随机变量 $ X \in{1,2, \cdots, K} $, 其概率分布函数为:</li>
</ol>

$$
\begin{array}{c}
p(X=1)=\theta_{1} \\
p(X=2)=\theta_{2} \\
\vdots \\
p(X=K-1)=\theta_{K-1} \\
p(X=K)=1-\sum_{i=1}^{K-1} \theta_{i}
\end{array}
$$
​		

<p>​        其中 $ \theta_{i} $ 为参数, 它满足 $ \theta_{i} \in[0,1] $, 且 $ \sum_{i=1}^{K-1} \theta_{i} \in[0,1] $ 。</p>
<h4 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h4><ol>
<li>假设试验只有两种结果：成功的概率为 $ \phi $, 失败的概率为 $ 1-\phi_{\circ} $ 则二项分布描述了：独立重复地进行 $ n $ 次 试验中，成功 $ x $ 次的概率。</li>
</ol>
<ul>
<li>概率质量函数:<br>$$<br>p(X=x)=\frac{n !}{x !(n-x) !} \phi^{x}(1-\phi)^{n-x}, x \in{0,1, \cdots, n}<br>$$<ul>
<li>期望: $ \mathbb{E}[X]=n \phi_{\circ} $</li>
<li>方差: $ \operatorname{Var}[X]=n \phi(1-\phi) $ </li>
</ul>
</li>
</ul>
<h3 id="高斯分布"><a href="#高斯分布" class="headerlink" title="高斯分布"></a>高斯分布</h3><blockquote>
<p>正态分布是很多应用中的合理选择。如果某个随机变量取值范围是实数，且对它的概率分布一无所知，通常会假设它服从正态分布。有两个原因支持这一选择：</p>
<ul>
<li>建模的任务的真实分布通常都确实接近正态分布。</li>
<li>中心极限定理表明，多个独立随机变量的和近似正态分布。</li>
<li>在具有相同方差的所有可能的概率分布中，正态分布的熵最大（即不确定性最大）。</li>
</ul>
</blockquote>
<h4 id="一维正态分布"><a href="#一维正态分布" class="headerlink" title="一维正态分布"></a>一维正态分布</h4><ul>
<li>正态分布的概率密度函数为:</li>
</ul>
<p>$$<br>p(x)=\frac{1}{\sqrt{2 \pi} \sigma} e^{-(x-\mu)^{2} /\left(2 \sigma^{2}\right)},-\infty&lt;x&lt;\infty<br>$$</p>
<ul>
<li><p>其中 $ \mu, \sigma(\sigma&gt;0) $ 为常数。<br>若随机变量 $ X $ 的概率密度函数如上所述, 则称 $ X $ 服从参数为 $ \mu, \sigma $ 的正态分布或者高斯分布，记作 $ X \sim N\left(\mu, \sigma^{2}\right) $<br>特别的, 当 $ \mu=0, \sigma=1 $ 时，称为标准正态分布，其概率密度函数记作 $ \varphi(x) $, 分布函数记作 $ \Phi(x) $ </p>
</li>
<li><p> 为了计算方便, 有时也记作: </p>
</li>
</ul>
<p>$$<br>\mathcal{N}\left(x ; \mu, \beta^{-1}\right)=\sqrt{\frac{\beta}{2 \pi}} \exp \left(-\frac{1}{2} \beta(x-\mu)^{2}\right)<br>$$</p>
<ul>
<li>,其中 $ \beta \in(0, \infty)$</li>
<li>期望： $ \mathbb{E}[X]=\mu$</li>
<li>方差: $ \operatorname{Var}[X]=\sigma^{2} $ </li>
</ul>
<h5 id="正态分布的概率密度函数性贡"><a href="#正态分布的概率密度函数性贡" class="headerlink" title="正态分布的概率密度函数性贡"></a>正态分布的概率密度函数性贡</h5><ul>
<li>曲线关于 $ x=\mu $ 对称</li>
<li>Q 曲线在 $ x=\mu $ 时取最大值</li>
<li> 曲线在 $ x=\mu \pm \sigma $ 处有抛点</li>
<li>参数 $ \mu $ 决定曲线的位置</li>
<li>$ \sigma $ 决定图形的胖瘦</li>
</ul>
<h4 id="二维正态分布"><a href="#二维正态分布" class="headerlink" title="二维正态分布"></a>二维正态分布</h4><ul>
<li>二维正态随机变量 $ (X, Y) $ 的概率密度为:</li>
</ul>

$$
\begin{aligned}
p(x, y) &=\frac{1}{2 \pi \sigma_{1} \sigma_{2} \sqrt{1-\rho^{2}}} \exp \left\{\frac { - 1 } { 2 ( 1 - \rho ^ { 2 } ) } \left[\frac{\left(x-\mu_{1}\right)^{2}}{\sigma_{1}^{2}}\right.\right.
\left.\left.-2 \rho \frac{\left(x-\mu_{1}\right)\left(y-\mu_{2}\right)}{\sigma_{1} \sigma_{2}}+\frac{\left(y-\mu_{2}\right)^{2}}{\sigma_{2}^{2}}\right]\right\}
\end{aligned}
$$



<ul>
<li>根据定义，可以计算出:</li>
</ul>
<p>$$ p_{X}(x)=\frac{1}{\sqrt{2 \pi} \sigma_{1}} e^{-\left(x-\mu_{1}\right)^{2} /\left(2 \sigma_{1}^{2}\right)},-\infty&lt;x&lt;\infty $$<br>$$ p_{Y}(y)=\frac{1}{\sqrt{2 \pi} \sigma_{2}} e^{-\left(y-\mu_{2}\right)^{2} /\left(2 \sigma_{3}^{2}\right)},-\infty&lt;y&lt;\infty $$<br>$$ \mathbb{E}[X]=\mu_{1} $$<br>$$ \mathbb{E}[Y]=\mu_{2} $$<br>$$ \operatorname{Var}[X]=\sigma_{1}^{2} $$<br>$$ \operatorname{Var}[Y]=\sigma_{2}^{2} $$<br>$$ \operatorname{Cov}[X, Y]=\int_{-\infty}^{\infty} \int_{-\infty}^{\infty}\left(x-\mu_{1}\right)\left(y-\mu_{2}\right) p(x, y) d x d y=\rho \sigma_{1} \sigma_{2} $$<br>$$ \rho_{X Y}=\rho $$</p>
<ul>
<li><p>引入矩阵:</p>

  $$
  \overrightarrow{\mathbf{x}}=\left[\begin{array}{l}
  x \\
  y
  \end{array}\right] \quad \vec{\mu}=\left[\begin{array}{c}
  \mu_{1} \\
  \mu_{2}
  \end{array}\right] \quad \mathbf{\Sigma}=\left[\begin{array}{ll}
  c_{11} & c_{12} \\
  c_{21} & c_{22}
  \end{array}\right]=\left[\begin{array}{cc}
  \sigma_{1}^{2} & \rho \sigma_{1} \sigma_{2} \\
  \rho \sigma_{1} \sigma_{2} & \sigma_{2}^{2}
  \end{array}\right]
  $$
  
<p>$ \mathbf{\Sigma} $ 为 $ (X, Y) $ 的协方差矩阵。其行列式为 $ \operatorname{det} \mathbf{\Sigma}=\sigma_{1}^{2} \sigma_{2}^{2}\left(1-\rho^{2}\right) $, 其逆矩阵为:<br>$$<br>\mathbf{\Sigma}^{-1}=\frac{1}{\operatorname{det} \mathbf{\Sigma}}\left[\begin{array}{cc}<br>\sigma_{2}^{2} &amp; -\rho \sigma_{1} \sigma_{2} \<br>-\rho \sigma_{1} \sigma_{2} &amp; \sigma_{1}^{2}<br>\end{array}\right]<br>$$<br>于是 $ (X, Y) $ 的概率密度函数可以写作：</p>
</li>
</ul>

$$
  p(x, y)=\frac{1}{(2 \pi)(\operatorname{det} \mathbf{\Sigma})^{1 / 2}} \exp \left\{-\frac{1}{2}(\overrightarrow{\mathbf{x}}-\vec{\mu})^{T} \mathbf{\Sigma}^{-1}(\overrightarrow{\mathbf{x}}-\vec{\mu})\right\}
$$
  

<ul>
<li><p>其中：</p>
<ul>
<li>均值 $ \mu_{1}, \mu_{2} $ 决定了曲面的位置 </li>
<li>标准差 $ \sigma_{1}, \sigma_{2} $ 决定了曲面的陡肖程度</li>
<li>$ \rho $ 决定了协方差矩阵的形状，从而决定了曲面的形状：</li>
<li>$ \rho=0 $ 时, 协方差矩阵对角线非零，其他位置均为零。此时表示随机变量之间不相关，曲面在 $ z=0 $ 平面的截面是个圆形</li>
<li>$ \rho=0.5 $ 时，协方差矩阵对角线非零，其他位置非零。此时表示随机变量之间相关。曲面在 $ z=0 $ 平面的截面是个格圆，相当于圆形沿着直线 $ y=x $ 方向压缩</li>
<li>$ \rho=1 $ 时, 协方差矩阵对角线非零, 其他位置非零。此时表示随机变量之间完全相关。此时的联合分布概率函数形状为：曲面在 $ z=0 $ 平面的截面是直线 $ y=x $, 相当于圆形沿着直线 $ y=x $ 方向压缩成一条直线</li>
</ul>
</li>
</ul>
<h4 id="多维正态分布"><a href="#多维正态分布" class="headerlink" title="多维正态分布"></a>多维正态分布</h4><ul>
<li>多维正态随机变量 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $, 引入列矩阵：</li>
</ul>

$$
\overrightarrow{\mathbf{x}}=\left[\begin{array}{c}
x_{1} \\
x_{2} \\
\vdots \\
x_{n}
\end{array}\right] \quad \vec{\mu}=\left[\begin{array}{c}
\mu_{1} \\
\mu_{2} \\
\vdots \\
\mu_{n}
\end{array}\right]=\left[\begin{array}{c}
\mathbb{E}\left[X_{1}\right] \\
\mathbb{E}\left[X_{2}\right] \\
\vdots \\
\mathbb{E}\left[X_{n}\right]
\end{array}\right]
$$


<ul>
<li>$ \mathbf{\Sigma} $ 为 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $ 的协方差矩阵。则:</li>
</ul>

$$
\begin{array}{r}
p\left(x_{1}, x_{2}, x_{3}, \cdots, x_{n}\right)=\frac{1}{(2 \pi)^{n / 2}(\operatorname{det} \mathbf{\Sigma})^{1 / 2}} \exp \left\{-\frac{1}{2}(\overrightarrow{\mathbf{x}}-\vec{\mu})^{T} \mathbf{\Sigma}^{-1}(\overrightarrow{\mathbf{x}}-\vec{\mu})\right\} \\

\end{array}
$$



<ul>
<li>记做：<br>$$<br>\mathcal{N}(\overrightarrow{\mathbf{x}} ; \vec{\mu}, \mathbf{\Sigma})=\sqrt{\frac{1}{(2 \pi)^{n} \operatorname{det}(\mathbf{\Sigma})}} \exp \left(-\frac{1}{2}(\overrightarrow{\mathbf{x}}-\vec{\mu})^{T} \mathbf{\Sigma}^{-1}(\overrightarrow{\mathbf{x}}-\vec{\mu})\right)<br>$$</li>
</ul>
<h5 id="四条性质"><a href="#四条性质" class="headerlink" title="四条性质"></a>四条性质</h5><ul>
<li>$ n $ 维正态变量的每一个分量都是正态变量; 反之, 若 $ X_{1}, X_{2}, \cdots, X_{n} $ 都是正态变量, 且相互独立, 则 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $ 是 $ n $ 维正态变量。</li>
<li>$  n $ 维随机变量 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $ 服从 $ n $ 维正态分布的充要条件是: <ul>
<li>$ X_{1}, X_{2}, \cdots, X_{n_{n}} $ 的任意线性组合$ l_{1} X_{1}+l_{2} X_{2}+\cdots+l_{n} X_{n} $ 服从一维正态分布, 其中 $ l_{1}, l_{2}, \cdots, l_{n} $ 不全为 $ 0_{\circ} $</li>
</ul>
</li>
<li>若 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $ 服从 $ n $ 维正态分布, 设 $ Y_{1}, Y_{2}, \cdots, Y_{k} $ 是 $ X_{j}, j=1,2, \cdots, n $ 的线性函数, 则 $ \left(Y_{1}, Y_{2}, \cdots, Y_{k}\right) $ 也服从多维正态分布。这一性质称为正态变量的线性变换不变性。</li>
<li>设 $ \left(X_{1}, X_{2}, \cdots, X_{n}\right) $ 服从 $ n $ 维正态分布, 则 $ X_{1}, X_{2}, \cdots, X_{n} $ 相互独立 $ \Longleftrightarrow X_{1}, X_{2}, \cdots, X_{n} $ 两两不相关。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>表面模糊原理与 python 实现</title>
    <url>/2021/04/13/image_processing/surface-blur/surface-blur/</url>
    <content><![CDATA[<blockquote>
<p>常规的模糊算法如高斯模糊等会模糊图像边缘，很多场景中我们需要保留图像纹理并模糊一些细节，这就可以使用PS中的表面模糊。</p>
</blockquote>
<a id="more"></a>

<h3 id="表面模糊"><a href="#表面模糊" class="headerlink" title="表面模糊"></a>表面模糊</h3><ul>
<li>表面模糊有两个参数，半径Radius和阈值Threshold。 如果我们知道了以某点为中心，半径为Radius范围内的直方图数据Hist，以及该点的像素值，那根据原始的算法，其计算公式为：</li>
</ul>
<p>$$<br>x = \frac { \sum _ { i = 1 } ^ { ( 2 r + 1 ) ^ { 2 } } [ ( 1 - \frac { | x _ { i } - x _ { 1 } | } { 2.5 Y } ) x _ { i } ] } { \sum _ { i = 1 } ^ { ( 2 r + 1 ) ^ { 2 } } ( 1 - \frac { | x _ { i } - x _ { 1 } | } { 2.5 Y } ) }<br>$$</p>
<blockquote>
<p>其中：$r $为半径，$Y$为阈值， $x_1$为当前像素阶值，$x_i$为模板中某个像素值，$x$为当前像素结果阶值</p>
</blockquote>
<ul>
<li>主要思想还是计算当前像素X的邻域范围内不同像素的加权求和，边缘地方的像素，加权比较大，平滑的地方加权比较小，以此来保留边缘信息，平滑平坦区域；</li>
<li>python 代码：</li>
</ul>
<blockquote>
<p>参考了网络流行的Python版本，做了一点点优化和修正</p>
<p>使用了numba cpu加速，可以提速10倍，但还是没有c++快</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@nb.jit(nopython=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Surface_blur</span><span class="params">(I_in, thre, radius)</span>:</span></span><br><span class="line"></span><br><span class="line">    I_out = I_in.copy()</span><br><span class="line">    row, col = I_in.shape</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(radius, row<span class="number">-1</span>-radius):</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(radius, col - <span class="number">1</span> - radius):</span><br><span class="line">            p0 = I_in[ii, jj]</span><br><span class="line">            aa = I_in[ii-radius: ii+radius+<span class="number">1</span>, jj-radius: jj + radius + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            mask_2 = <span class="number">1</span>-np.abs(aa-p0)/(<span class="number">2.5</span>*thre)</span><br><span class="line">            mask_3 = mask_2 * (mask_2 &gt; <span class="number">0</span>)</span><br><span class="line">            t1 = aa * mask_3</span><br><span class="line">            I_out[ii, jj] = t1.sum()/mask_3.sum()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> I_out</span><br></pre></td></tr></table></figure>

<ul>
<li>numba CUDA 加速代码：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> numba <span class="keyword">import</span> cuda</span><br><span class="line"></span><br><span class="line"><span class="meta">@cuda.jit</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_process_cuda</span><span class="params">(img_cuda, result_img_cuda, y_size, x_size)</span>:</span></span><br><span class="line">    y = cuda.threadIdx.y + cuda.blockDim.y * cuda.blockIdx.y</span><br><span class="line">    x = cuda.threadIdx.x + cuda.blockDim.x * cuda.blockIdx.x</span><br><span class="line"></span><br><span class="line">    radius = <span class="number">8</span></span><br><span class="line">    thre = <span class="number">20</span></span><br><span class="line">    <span class="keyword">if</span> radius &lt; y &lt; y_size-radius <span class="keyword">and</span> radius &lt; x &lt; x_size-radius:</span><br><span class="line">        a = <span class="number">0.0</span></span><br><span class="line">        b = <span class="number">0.0</span></span><br><span class="line">        x_1 = float(img_cuda[y, x, <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> x_index <span class="keyword">in</span> range(x-radius, x+radius+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> y_index <span class="keyword">in</span> range(y-radius, y+radius+<span class="number">1</span>):</span><br><span class="line">                x_i = float(img_cuda[y_index, x_index, <span class="number">0</span>])</span><br><span class="line">                </span><br><span class="line">                temp_b = (<span class="number">1</span> - abs(x_i - x_1) / <span class="number">2.5</span> / thre)</span><br><span class="line">                <span class="keyword">if</span> temp_b &lt;= <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                b += temp_b</span><br><span class="line">                a += temp_b * x_i</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">            result_img_cuda[y, x, i] = int(round(a / b))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>调用：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">img = ...</span><br><span class="line">ori_image_cuda = cuda.to_device(img)</span><br><span class="line">copy_image_cuda = cuda.to_device(copy_image)</span><br><span class="line">image_process_cuda[blocks_per_grid, threads_per_block](ori_image_cuda, copy_image_cuda, y_size, x_size)</span><br><span class="line">result_img = copy_image_cuda.copy_to_host()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>相比于 cpu 加速运算可以有百倍以上的速度提升</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/matrix_space/article/details/52818857" target="_blank" rel="noopener">https://blog.csdn.net/matrix_space/article/details/52818857</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>image_processing</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>image_processing</tag>
      </tags>
  </entry>
  <entry>
    <title>错误 Stale NFS file handle 解决方法</title>
    <url>/2021/04/08/linux/mount/Stale-NFS-file-handle/Stale-NFS-file-handle/</url>
    <content><![CDATA[<blockquote>
<p>本文记录错误 <code> Stale NFS file handle</code> 的解决方法 。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">@ mount -o nfsvers=3 10.0.1.84:/home/share /mnt</span><br><span class="line">mount.nfs: Stale NFS file handle</span><br></pre></td></tr></table></figure>

<blockquote>
<p>错误原因是客户端之前挂载的mnt目录在没有卸载的情况下，服务器侧把这个目录移除了，才会出现这样的错误提示。</p>
</blockquote>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><blockquote>
<p>解决的办法就是在客户端 <code>umount</code> 一下，重新挂载就好。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">umount &#x2F;mnt</span><br><span class="line">mount -t nfs &#x2F;share &#x2F;mnt</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.51cto.com/naonao/1412212" target="_blank" rel="noopener">https://blog.51cto.com/naonao/1412212</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>调用 Mathpix AIP 实现每月1000次免费识别</title>
    <url>/2021/04/07/tools/math-pix-api-usage/math-pix-api-usage/</url>
    <content><![CDATA[<blockquote>
<p>Mathpix 是优秀的img2latax工具，对于普通用户来说每月有50-100次免费机会，对于需求量大的用户无法满足需求。有一种方法是调用Mathpix官方的API，每月1000次免费机会。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p><a href="https://mathpix.com/" target="_blank" rel="noopener">Mathpix</a>是一款跨平台（Windows、macOS、Linux）的 OCR 工具，它能够识别复杂的数学公式，并将其转换为 LaTeX 语法。</p>
<p>LaTeX 是一个十分强大切流行的排版系统，除了能编写数学公式，还能非常完整的撰写学术论文，并且被国际各大机构接受，但一直以入门难著称。</p>
<p>Mathpix 能够直接截取数学公式的图片，将截图转换为 LaTeX 语法，非常简单方便，并且支持三大主流系统。</p>
</blockquote>
<ul>
<li>当前Mathpix收费，无限次识别的Pro账户每个月需要4.99$</li>
<li>但是如果调用Mathpix的API的话，每个账户每个月的前 1000 次请求免费；随后的第 1-100 千次，每次 0.004 美元；第 100- 300 千次，每次 0.002 美元。这种收费模式显然比较合理，至少每个月有1000次的免费调用机会。</li>
<li>官网链接：<a href="https://mathpix.com/" target="_blank" rel="noopener">https://mathpix.com/</a></li>
</ul>
<h3 id="注册账号"><a href="#注册账号" class="headerlink" title="注册账号"></a>注册账号</h3><ul>
<li><a href="https://accounts.mathpix.com/login" target="_blank" rel="noopener">https://accounts.mathpix.com/login</a></li>
<li>注册 MathPix 账号</li>
<li>登录账号</li>
</ul>
<h3 id="创建API"><a href="#创建API" class="headerlink" title="创建API"></a>创建API</h3><ul>
<li>选择 OCR API</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210407002527.png"></p>
<ul>
<li>接受一个激活协议</li>
<li>使用信用卡激活</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210407002800.png"></p>
<ul>
<li><p>此处只能使用信用卡</p>
<ul>
<li>卡号填卡号</li>
<li>日期填卡上的日期</li>
<li>CVC是卡背面数字的后三位</li>
</ul>
</li>
<li><p><strong>此处会有1$的消费</strong></p>
</li>
<li><p>成功后会获得 <code>App ID</code>和 <code>App Key</code></p>
<p><img src="https://photos.zywvvd.com/image_canglan/20210407003041.png"></p>
</li>
</ul>
<h3 id="调用官方API"><a href="#调用官方API" class="headerlink" title="调用官方API"></a>调用官方API</h3><ul>
<li>官方文档 <a href="https://docs.mathpix.com/" target="_blank" rel="noopener">https://docs.mathpix.com</a></li>
<li>API的示例<a href="https://github.com/Mathpix/api-examples" target="_blank" rel="noopener">https://github.com/Mathpix/api-examples</a></li>
<li>核心调用代码（python）：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">env = os.environ</span><br><span class="line"></span><br><span class="line">default_headers = &#123;</span><br><span class="line">    <span class="string">'app_id'</span>: env.get(<span class="string">'APP_ID'</span>, <span class="string">'你的APP_ID'</span>),</span><br><span class="line">    <span class="string">'app_key'</span>: env.get(<span class="string">'APP_KEY'</span>, <span class="string">'你的APP_KEY'</span>),</span><br><span class="line">    <span class="string">'Content-type'</span>: <span class="string">'application/json'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">service = <span class="string">'https://api.mathpix.com/v3/latex'</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">r = requests.post(service, data=json.dumps(args), headers=headers, timeout=timeout)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> json.loads(r.text)</span><br></pre></td></tr></table></figure>

<h3 id="python-桌面应用"><a href="#python-桌面应用" class="headerlink" title="python 桌面应用"></a>python 桌面应用</h3><ul>
<li>我们使用一位大佬的python应用为例</li>
<li><a href="https://github.com/Joshua-li-yi/img2latex" target="_blank" rel="noopener">https://github.com/Joshua-li-yi/img2latex</a><ul>
<li>代码中 <code>def grapclipboard(self):</code> 应为  <code>def grabclipboard(self): </code></li>
</ul>
</li>
<li>代码如下：</li>
</ul>
<details>
  <summary>python 代码</summary>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> PyQt5.QtGui</span><br><span class="line"><span class="keyword">import</span> PyQt5.QtCore</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> QApplication, QLabel, QPushButton, QWidget, QGridLayout, QLineEdit</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtCore <span class="keyword">import</span> Qt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"><span class="keyword">import</span> pyperclip</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">env = os.environ</span><br><span class="line"></span><br><span class="line">default_headers = &#123;</span><br><span class="line">    <span class="string">'app_id'</span>: env.get(<span class="string">'APP_ID'</span>, <span class="string">'你的APP_ID'</span>),</span><br><span class="line">    <span class="string">'app_key'</span>: env.get(<span class="string">'APP_KEY'</span>, <span class="string">'你的APP_KEY'</span>),</span><br><span class="line">    <span class="string">'Content-type'</span>: <span class="string">'application/json'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">service = <span class="string">'https://api.mathpix.com/v3/latex'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Img2Latex</span><span class="params">(QWidget)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.initUI()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initUI</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.setGeometry(<span class="number">300</span>, <span class="number">300</span>, <span class="number">800</span>, <span class="number">700</span>)</span><br><span class="line">        self.setWindowTitle(<span class="string">'Img2Latex'</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># copy latex</span></span><br><span class="line">        self.Latex1copyBtn = QPushButton()</span><br><span class="line">        self.Latex2copyBtn = QPushButton()</span><br><span class="line">        self.Latex3copyBtn = QPushButton()</span><br><span class="line">        <span class="comment"># set copy btn icon</span></span><br><span class="line">        self.Latex1copyBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\copy.png"</span>))</span><br><span class="line">        self.Latex2copyBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\copy.png"</span>))</span><br><span class="line">        self.Latex3copyBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\copy.png"</span>))</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># edit latex</span></span><br><span class="line">        self.Latex1EditBtn = QPushButton()</span><br><span class="line">        self.Latex2EditBtn = QPushButton()</span><br><span class="line">        self.Latex3EditBtn = QPushButton()</span><br><span class="line">        <span class="comment"># set edit btn icon</span></span><br><span class="line">        self.Latex1EditBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\edit.png"</span>))</span><br><span class="line">        self.Latex2EditBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\edit.png"</span>))</span><br><span class="line">        self.Latex3EditBtn.setIcon(PyQt5.QtGui.QIcon(<span class="string">r".\img\edit.png"</span>))</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># img to latex convert btn</span></span><br><span class="line">        self.img2latexBtn = QPushButton(<span class="string">'convert'</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># show the picture on clipboard</span></span><br><span class="line">        self.imgLable = QLabel()</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># show the formula in latex</span></span><br><span class="line">        self.Latex1Edit = QLineEdit()</span><br><span class="line">        self.Latex2Edit = QLineEdit()</span><br><span class="line">        self.Latex3Edit = QLineEdit()</span><br><span class="line">        self.Latex1Edit.setEnabled(<span class="literal">False</span>)</span><br><span class="line">        self.Latex2Edit.setEnabled(<span class="literal">False</span>)</span><br><span class="line">        self.Latex3Edit.setEnabled(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># # show the convert latex result</span></span><br><span class="line">        <span class="comment"># self.reviewImgLable = QLabel()</span></span><br><span class="line">        <span class="comment"># self.reviewImgLable.setStyleSheet("border: 2px solid red")</span></span><br><span class="line">    </span><br><span class="line">        grid = QGridLayout()</span><br><span class="line">        grid.setSpacing(<span class="number">20</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 排版</span></span><br><span class="line">        grid.addWidget(self.imgLable, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">        grid.addWidget(self.img2latexBtn,<span class="number">6</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">        grid.addWidget(self.Latex1Edit, <span class="number">7</span>, <span class="number">0</span>)</span><br><span class="line">        grid.addWidget(self.Latex1copyBtn, <span class="number">7</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># grid.addWidget(self.Latex1EditBtn, 7, 2)</span></span><br><span class="line">    </span><br><span class="line">        grid.addWidget(self.Latex2copyBtn, <span class="number">8</span>, <span class="number">1</span>)</span><br><span class="line">        grid.addWidget(self.Latex2Edit, <span class="number">8</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment"># grid.addWidget(self.Latex2EditBtn, 8, 2)</span></span><br><span class="line">    </span><br><span class="line">        grid.addWidget(self.Latex3copyBtn, <span class="number">9</span>, <span class="number">1</span>)</span><br><span class="line">        grid.addWidget(self.Latex3Edit, <span class="number">9</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="comment"># grid.addWidget(self.Latex3EditBtn, 9, 2)</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># grid.addWidget(self.reviewImgLable, 10, 0, 4, 3)</span></span><br><span class="line">    </span><br><span class="line">        self.setLayout(grid)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># sign and slot</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># img to latex convert</span></span><br><span class="line">        self.img2latexBtn.clicked.connect(self.convert)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># copy latex</span></span><br><span class="line">        self.Latex1copyBtn.clicked.connect(self.copyLatex1)</span><br><span class="line">        self.Latex2copyBtn.clicked.connect(self.copyLatex2)</span><br><span class="line">        self.Latex3copyBtn.clicked.connect(self.copyLatex3)</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># edit latex</span></span><br><span class="line">        <span class="comment"># self.Latex1EditBtn.clicked.connect(self.Latex1EditImg)</span></span><br><span class="line">        <span class="comment"># self.Latex1Edit.textChanged.connect(self.Latex1EditImg)</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># self.Latex2EditBtn.clicked.connect(self.Latex2EditImg)</span></span><br><span class="line">        <span class="comment"># self.Latex2Edit.textChanged.connect(self.Latex2EditImg)</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># self.Latex3EditBtn.clicked.connect(self.Latex3EditImg)</span></span><br><span class="line">        <span class="comment"># self.Latex3Edit.textChanged.connect(self.Latex3EditImg)</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># beautify the window</span></span><br><span class="line">        self.Beautify()</span><br><span class="line">        self.show()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Beautify</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.setWindowOpacity(<span class="number">0.9</span>)  <span class="comment"># 设置窗口透明度</span></span><br><span class="line">        <span class="comment"># self.setAttribute(qtpy.QtCore.Qt.WA_TranslucentBackground) # 设置窗口背景透明</span></span><br><span class="line">        <span class="comment"># self.setWindowFlag(qtpy.QtCore.Qt.FramelessWindowHint) # 隐藏边框</span></span><br><span class="line">        pe = PyQt5.QtGui.QPalette()</span><br><span class="line">        self.setAutoFillBackground(<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># pe.setColor(PyQt5.QtGui.QPalette.Window, Qt.Black)  #设置背景色</span></span><br><span class="line">        pe.setColor(PyQt5.QtGui.QPalette.Background, Qt.black)</span><br><span class="line">        self.setPalette(pe)</span><br><span class="line">        self.imgLable.setStyleSheet(</span><br><span class="line">            <span class="string">''' QLabel&#123;</span></span><br><span class="line"><span class="string">                border: 2px solid red;</span></span><br><span class="line"><span class="string">                border-radius:15px;</span></span><br><span class="line"><span class="string">                padding:2px 4px;</span></span><br><span class="line"><span class="string">                background-color:#aaa;</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">        </span><br><span class="line">        self.Latex1Edit.setStyleSheet(</span><br><span class="line">            <span class="string">'''QLineEdit&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:10px;</span></span><br><span class="line"><span class="string">                padding:2px 4px;</span></span><br><span class="line"><span class="string">                background-color:#ddd;</span></span><br><span class="line"><span class="string">                height:35px;</span></span><br><span class="line"><span class="string">                font-color:black;</span></span><br><span class="line"><span class="string">                font-weight:1000;</span></span><br><span class="line"><span class="string">                font-size:24px</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">        self.Latex2Edit.setStyleSheet(</span><br><span class="line">            <span class="string">'''QLineEdit&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:10px;</span></span><br><span class="line"><span class="string">                padding:2px 4px;</span></span><br><span class="line"><span class="string">                background-color:#ddd;</span></span><br><span class="line"><span class="string">                height:35px;</span></span><br><span class="line"><span class="string">                font-color:black;</span></span><br><span class="line"><span class="string">                font-weight:1000;</span></span><br><span class="line"><span class="string">                font-size:24px</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">        self.Latex3Edit.setStyleSheet(</span><br><span class="line">            <span class="string">'''QLineEdit&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:10px;</span></span><br><span class="line"><span class="string">                padding:2px 4px;</span></span><br><span class="line"><span class="string">                background-color:#ddd;</span></span><br><span class="line"><span class="string">                height:35px;</span></span><br><span class="line"><span class="string">                font-color:black;</span></span><br><span class="line"><span class="string">                font-weight:1000;</span></span><br><span class="line"><span class="string">                font-size:24px</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">    </span><br><span class="line">        self.Latex1copyBtn.setStyleSheet(</span><br><span class="line">            <span class="string">'''QPushButton&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:4px;</span></span><br><span class="line"><span class="string">                padding:5px 5px;</span></span><br><span class="line"><span class="string">                height:35px</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">        self.Latex2copyBtn.setStyleSheet(</span><br><span class="line">            <span class="string">'''QPushButton&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:4px;</span></span><br><span class="line"><span class="string">                padding:5px 5px;</span></span><br><span class="line"><span class="string">                height:35px</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">        self.Latex3copyBtn.setStyleSheet(</span><br><span class="line">            <span class="string">'''QPushButton&#123;</span></span><br><span class="line"><span class="string">                border:1px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:4px;</span></span><br><span class="line"><span class="string">                padding:5px 5px;</span></span><br><span class="line"><span class="string">                height:35px</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">    </span><br><span class="line">        self.img2latexBtn.setStyleSheet(</span><br><span class="line">            <span class="string">'''QPushButton&#123;</span></span><br><span class="line"><span class="string">                border:2px solid gray;</span></span><br><span class="line"><span class="string">                border-radius:10px;</span></span><br><span class="line"><span class="string">                padding:5px 5px;</span></span><br><span class="line"><span class="string">                background-color:#555;</span></span><br><span class="line"><span class="string">                font-size:24px;</span></span><br><span class="line"><span class="string">                font-color:#fff;</span></span><br><span class="line"><span class="string">                font-weight:700;</span></span><br><span class="line"><span class="string">                font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="string">            &#125;'''</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Return the base64 encoding of an image with the given filename.</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">image_uri</span><span class="params">(self,filename)</span>:</span></span><br><span class="line">        image_data = open(filename, <span class="string">"rb"</span>).read()</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"data:image/jpg;base64,"</span> + base64.b64encode(image_data).decode()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Call the Mathpix service with the given arguments, headers, and timeout.</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">latex</span><span class="params">(self,args, headers=default_headers, timeout=<span class="number">30</span>)</span>:</span></span><br><span class="line">        r = requests.post(service,</span><br><span class="line">                          data=json.dumps(args), headers=headers, timeout=timeout)</span><br><span class="line">        <span class="keyword">return</span> json.loads(r.text)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">convert</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.grapclipboard()</span><br><span class="line">        r = self.latex(&#123;</span><br><span class="line">            <span class="string">'src'</span>:self.image_uri(<span class="string">r".\img\equa.png"</span>),</span><br><span class="line">            <span class="string">'formats'</span>: [<span class="string">'latex_simplified'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment"># print(r['latex_simplified'])</span></span><br><span class="line">        latex1 = r[<span class="string">'latex_simplified'</span>]</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># test</span></span><br><span class="line">        <span class="comment"># latex1='111'</span></span><br><span class="line">        latex2 = <span class="string">'$'</span> + latex1 + <span class="string">'$'</span></span><br><span class="line">        latex3 = <span class="string">'$$'</span> + latex1 + <span class="string">'$$'</span></span><br><span class="line">        self.Latex1Edit.setText(latex1)</span><br><span class="line">        self.Latex2Edit.setText(latex2)</span><br><span class="line">        self.Latex3Edit.setText(latex3)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyLatex1</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># get the latex formula</span></span><br><span class="line">        text = self.Latex1Edit.text()</span><br><span class="line">        <span class="comment"># copy it to clipboard</span></span><br><span class="line">        pyperclip.copy(text)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyLatex2</span><span class="params">(self)</span>:</span></span><br><span class="line">        text = self.Latex2Edit.text()</span><br><span class="line">        pyperclip.copy(text)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyLatex3</span><span class="params">(self)</span>:</span></span><br><span class="line">        text = self.Latex3Edit.text()</span><br><span class="line">        pyperclip.copy(text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 识别剪贴板公式</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">grabclipboard</span><span class="params">(self)</span>:</span></span><br><span class="line">        im = ImageGrab.grabclipboard()</span><br><span class="line">        im.save(<span class="string">r'.\img\equa.png'</span>, <span class="string">'PNG'</span>)</span><br><span class="line">        self.imgLable.setPixmap(PyQt5.QtGui.QPixmap(<span class="string">r'.\img\equa.png'</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 为程序添加快捷键</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 可以自己定义</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">keyPressEvent</span><span class="params">(self, event)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (event.key() == Qt.Key_T)<span class="keyword">and</span>(event.modifiers() == Qt.AltModifier):</span><br><span class="line">            self.convert()</span><br><span class="line">        <span class="keyword">if</span> (event.key() == Qt.Key_C)<span class="keyword">and</span>(event.modifiers() == Qt.AltModifier):</span><br><span class="line">            self.copyLatex3()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app = QApplication(sys.argv)</span><br><span class="line">    ex = Img2Latex()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>需要将自己的 ID 和 Key 填入代码中</li>
</ul>
<h3 id="示例效果"><a href="#示例效果" class="headerlink" title="示例效果"></a>示例效果</h3><p><img src="https://photos.zywvvd.com/image_canglan/20210407004541.png"></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/weixin_44984664/article/details/105242426" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44984664/article/details/105242426</a></li>
<li><a href="https://geomatlab.com/mathpix-api/" target="_blank" rel="noopener">https://geomatlab.com/mathpix-api/</a></li>
</ul>
<p>```</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>tools</category>
        <category>mathpix</category>
      </categories>
      <tags>
        <tag>tools</tag>
        <tag>mathpix</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 9 - 中心极限定理</title>
    <url>/2021/04/03/math/probability/central-limit-theorem/central-limit-theorem/</url>
    <content><![CDATA[<blockquote>
<p>中心极限定理（<strong>Central Limit Theorem</strong>，CTL），是指概率论中讨论随机变量序列部分和分布渐近于正态分布的一类定理。。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>定理是数理统计学和误差分析的理论基础，指出了大量随机变量近似服从正态分布的条件。它是概率论中最重要的一类定理，有广泛的实际应用背景。在自然界与生产中，一些现象受到许多相互独立的随机因素的影响，如果每个因素所产生的影响都很微小时，总的影响可以看作是服从正态分布的。中心极限定理就是从数学上证明了这一现象。    ——<a href="https://baike.baidu.com/item/%E4%B8%AD%E5%BF%83%E6%9E%81%E9%99%90%E5%AE%9A%E7%90%86/829451?fr=aladdin" target="_blank" rel="noopener">百度百科</a></p>
</blockquote>
<ul>
<li>中心极限定理（CLT）指出，如果样本量足够大，则变量均值的采样分布将近似于正态分布，而与该变量在总体中的分布无关。</li>
</ul>
<h3 id="独立同分布"><a href="#独立同分布" class="headerlink" title="独立同分布"></a>独立同分布</h3><ul>
<li>设随机变量$X_1, X_2,\dots,X_n$独立同分布，且具有数学期望$\mu$和方差$\sigma^2$，前$n$个变量之和为$\overline S  = \sum\limits_{i = 1}^n {{X_i}} \\$</li>
<li>那么$\overline S_n$的期望和方差为$n\mu$和$n\sigma^2$，$\overline S_n$的标准化变量为：</li>
</ul>
<p>$$<br>Y_n=\frac{\overline S_n - n\mu}{\sqrt n\sigma}<br>$$</p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ul>
<li>中心极限定理的内容为：$Y_n$的概率分布函数$F_n(x)$对于任意$x$满足：</li>
</ul>

$$
\begin{array}{c}
\lim _{n \rightarrow \infty} F_{n}(x)=\lim \limits_{n \rightarrow \infty} P\left\{Y_{n} \leq x\right\}=\lim \limits_{n \rightarrow \infty} P\left\{\frac{\sum_{k=1}^{n} X_{k}-n \mu}{\sqrt{n} \sigma} \leq x\right\} \\
=\int_{-\infty}^{x} \frac{1}{\sqrt{2 \pi}} e^{-t^{2} / 2} d t=\Phi(x)
\end{array}
$$


<h4 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h4><blockquote>
<p>通过观察某个分布的采样均值可以发现近似服从正态分布，我们的目标就是证明这个变量与正态分布的特征函数相同</p>
</blockquote>
<ul>
<li>引入一些特征函数的<a href="https://www.zywvvd.com/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/">结论</a></li>
<li>正态分布的特征函数：</li>
</ul>

$$
{\varphi (t)}{ = {e^{ - \frac{{{t^2}}}{2}}}}
$$



<p><a href="https://www.zywvvd.com/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/#%E6%A0%87%E5%87%86%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E7%89%B9%E5%BE%81%E5%87%BD%E6%95%B0">标准正态分布的特征函数</a></p>
<ul>
<li>随机变量$X_i$的特征函数用${\varphi_x (t)}$表示</li>
<li>$\overline S_n$的特征函数为：</li>
</ul>

$$
{\varphi_{S_n} (t)}=[{\varphi_x (t)}]^n
$$



<blockquote>
<p><a href="https://www.zywvvd.com/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/#%E7%8B%AC%E7%AB%8B%E5%8F%98%E9%87%8F%E5%92%8C%E7%9A%84%E7%89%B9%E5%BE%81%E5%87%BD%E6%95%B0">独立变量和的特征函数</a></p>
</blockquote>
<ul>
<li>$X_i$均值$\overline X=\frac{1}{n}\overline {S_n}$的特征函数：</li>
</ul>

$$
{\varphi_{\overline X} (t)}={\varphi_{S_n} (\frac{t}{n})}=[{\varphi_x (\frac{t}{n})}]^n
$$



<blockquote>
<p><a href="https://www.zywvvd.com/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/#%E5%B8%B8%E6%95%B0%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2%E7%9A%84%E7%89%B9%E5%BE%81%E5%87%BD%E6%95%B0">常数线性变换的特征函数</a></p>
</blockquote>
<ul>
<li>$Y_n=\frac{\overline S_n - n\mu}{\sqrt n\sigma}=\frac{\overline X - \mu}{\frac{\sigma}{\sqrt n}}=\frac{\sqrt n}{\sigma}\overline X - \frac{\sqrt n}{\sigma} \mu$ 的特征函数：

</li>
</ul>

$$
\varphi_{y}(t)=e^{i\left(-\frac{\sqrt{n}}{\sigma} \mu\right) t} \cdot \varphi_{\bar{x}}\left(\frac{\sqrt{n}}{\sigma} t\right)=e^{i\left(-\frac{\sqrt{n}}{\sigma} \mu\right) t} \cdot\left[\varphi_{x}\left(\frac{t}{\sigma \sqrt{n}}\right)\right]^{n}
$$



<h5 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h5><ul>
<li>取对数：</li>
</ul>

$$
\begin{aligned}
\ln \varphi_{y}(t)&=\ln \left\{e^{i\left(-\frac{\sqrt{n}}{\sigma} \mu\right) t} \cdot\left[\varphi_{x}\left(\frac{t}{\sigma \sqrt{n}}\right)\right]^{n}\right\}\\
&=-i \frac{\sqrt{n}}{\sigma} \mu t+n \ln \left[\varphi_{x}\left(\frac{t}{\sigma \sqrt{n}}\right)\right]\\
&=\frac{-i \mu \frac{t}{\sigma \sqrt{n}}+\ln \left[\varphi_{x}\left(\frac{t}{\sigma \sqrt{n}}\right)\right]}{\frac{1}{n}}\\

\end{aligned}
$$



<ul>
<li>令$p=\frac{t}{\sigma \sqrt{n}}$, 当 $ n \rightarrow \infty $ 时, $ p \rightarrow 0$ 又 ：</li>
</ul>

$$
\begin{aligned}

&\varphi_{x}(0)=\int_{-\infty}^{\infty} f(x) d x=1\\
&\varphi_{x}^{\prime}(0)=\int_{-\infty}^{\infty} i x f(x) d x=i \mu\\
&\varphi_{x}^{\prime \prime}(0)=\int_{-\infty}^{\infty}-x^{2} f(x) d x=-E\left(X^{2}\right)=-\mu^{2}-\sigma^{2}\\
\end{aligned}
$$



<ul>
<li>有 ：</li>
</ul>

$$
\begin{aligned}

\lim _{n \rightarrow \infty} \ln \varphi_{y}(t)&=\lim _{n \rightarrow \infty} \frac{-i \mu \frac{t}{\sigma \sqrt{n}}+\ln \left[\varphi_{x}\left(\frac{t}{\sigma \sqrt{n}}\right)\right]}{\frac{1}{n}}\\
&=\frac{t^{2}}{\sigma^{2}} \lim _{p \rightarrow 0} \frac{-i \mu p+\ln \left[\varphi_{x}(p)\right]}{p^{2}} \quad(\text { 洛必达) }\\
&=\frac{t^{2}}{\sigma^{2}} \lim _{p \rightarrow 0} \frac{-i \mu+\frac{1}{\varphi_{x}(p)} \cdot \varphi_{x}^{\prime}(p)}{2 p} \quad(\text { 洛必达 })\\
&=\frac{t^{2}}{\sigma^{2}} \lim _{p \rightarrow 0} \frac{\varphi_{x}^{\prime \prime}(p) \cdot \varphi_{x}(p)-\varphi_{x}^{\prime}(p) \cdot \varphi_{x}^{\prime}(p)}{2\left[\varphi_{x}(p)\right]^{2}}\\
&=\frac{t^{2}}{\sigma^{2}} \cdot \frac{\varphi_{x}^{\prime \prime}(0) \cdot \varphi_{x}(0)-\varphi_{x}^{\prime}(0) \cdot \varphi_{x}^{\prime}(0)}{2\left[\varphi_{x}(0)\right]^{2}}\\
&=\frac{t^{2}}{\sigma^{2}} \cdot \frac{\left(-\mu^{2}-\sigma^{2}\right) \cdot 1-i \mu \cdot i \mu}{2 \cdot 1}\\
&=-\frac{t^{2}}{2}
\end{aligned}
$$



<h5 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h5>
$$
\begin{array}{l}
Y_{n}=\frac{n \bar{X}-\mu}{\sigma \sqrt{n}}=\frac{\sum_{i=1}^{n} \eta_{i}}{\sigma \sqrt{n}}
\\\quad \eta_{i}=X_{i}-\mu \\
\varphi(t)=E\left(e^{i t Y_{n}}\right)=E\left(e^{i t \frac{\eta_{1}}{\sigma \sqrt{n}}} \cdot e^{i t \frac{\eta_{2}}{\sigma \sqrt{n}}} \cdot \ldots \cdot e^{i t \frac{\eta_{n}}{\sigma \sqrt{n}}}\right)=\left[\phi\left(\frac{t}{\sigma \sqrt{n}}\right)\right]^{n}
\end{array}
$$


<ul>
<li>$\phi(t)$ 为 $\eta_{i}$ 的特征函数</li>
<li>$\phi\left(\frac{t}{\sigma \sqrt{n}}\right)$ 在0点处的泰勒展开形式为:</li>
</ul>

$$
\begin{aligned}
\phi\left(\frac{t}{\sigma \sqrt{n}}\right)=\phi(0) &+\phi^{\prime}(0) \frac{t}{\sigma \sqrt{n}}+\frac{\phi^{\prime \prime}(0)}{2 !}\left(\frac{t}{\sigma \sqrt{n}}\right)^{2}+o\left(\left(\frac{t}{\sigma \sqrt{n}}\right)^{2}\right) \\
&=1+0-\frac{t^{2}}{2 n}+o\left(\left(\frac{t}{\sigma \sqrt{n}}\right)^{2}\right)
\end{aligned}
$$


<ul>
<li>所以, $\varphi(t)$ 为:</li>
</ul>

$$
\varphi(t)=\left(1-\frac{t^{2}}{2 n}+o\left(\left(\frac{t}{\sigma \sqrt{n}}\right)^{2}\right)\right)^{\left(-\frac{2 n}{t^{2}}\right) \times\left(-\frac{t^{2}}{2}\right)}=e^{-\frac{t^{2}}{2}}, n \rightarrow+\infty
$$


<h5 id="都得出结论"><a href="#都得出结论" class="headerlink" title="都得出结论"></a>都得出结论</h5><ul>
<li>即有：</li>
</ul>

$$
\lim _{n \rightarrow \infty} \varphi_{y}(t)={e^{ - \frac{{{t^2}}}{2}}}
$$



<ul>
<li>$Y_n$特征函数与正态分布相同，故有当$ n \rightarrow \infty$时，$Y_n$服从正态分布的结论</li>
</ul>
<h4 id="应用思路"><a href="#应用思路" class="headerlink" title="应用思路"></a>应用思路</h4><ul>
<li>均值方差为$\mu$和$\sigma^2$，的独立同分布的随机变量$X_i$前$n$项之和$\overline S_n$的标准变化量$Y_n$，当$n$充分大时，其分布近似于标准正态分布</li>
<li>即在$n$充分大时，$\overline S_n$分布近似于$N(n\mu,n\sigma^2)$</li>
<li>一般情况下，很难求出$n$个随机变量之和的分布函数。因此当$n$充分大时，可以通过正态分布来做理论上的分析或者计算</li>
</ul>
<h3 id="独立不同分布"><a href="#独立不同分布" class="headerlink" title="独立不同分布"></a>独立不同分布</h3><ul>
<li><p><code>Liapunov </code>定理：设随机变量 $X_{1}, X_{2}, \cdots, X_{n}, \cdots$ 相互独立, 具有数学期望和方差:<br>$$<br>\mathbb{E}\left[X_{k}\right]=\mu_{k}, \operatorname{Var}\left[X_{k}\right]=\sigma_{k}^{2}<br>$$</p>
</li>
<li><p>记: $B_{n}^{2}=\sum_{k=1}^{n} \sigma_{k}^{2}$ 若存在正数 $\delta,$ 使得当 $n \rightarrow \infty$ 时，有：</p>

  $$
\frac{1}{B_{n}^{2+\delta}} \sum_{k=1}^{n} \mathbb{E}\left[\left|X_{k}-\mu_{k}\right|^{2+\delta}\right] \rightarrow 0
  $$


</li>
<li><p>则随机变量之和 $\overline{S X_{n}}=\sum_{k=1}^{n} X_{k}$ 的标准变化量:</p>
</li>
</ul>

$$
Z_{n}=\frac{\overline{S X_{n}}-\mathbb{E}\left[\overline{S X_{n}}\right]}{\sqrt{\operatorname{Var}\left[\overline{S X_{n}}\right]}}=\frac{\overline{S X_{n}}-\sum_{k=1}^{n} \mu_{k}}{B_{n}}
$$


<ul>
<li>概率分布函数 $F_{n}(x)$ 对于任意 $x$ 满足:</li>
</ul>

$$
\begin{array}{c}
\lim _{n \rightarrow \infty} F_{n}(x)=\lim _{n \rightarrow \infty} P\left\{Z_{n} \leq x\right\}=\lim _{n \rightarrow \infty} P\left\{\frac{\sum_{k=1}^{n} X_{k}-\sum_{k=1}^{n} \mu_{k}}{B_{n}} \leq x\right\} \\
=\int_{-\infty}^{x} \frac{1}{\sqrt{2 \pi}} e^{-t^{2} / 2} d t=\Phi(x)
\end{array}
$$


<ul>
<li><p>其物理意义为：</p>
<p>相互独立的随机变量 $X_{1}, X_{2}, \cdots, X_{n}, \cdots$ 之和 $\overline{S X_{n}}=\sum_{k=1}^{n} X_{k}$ 的衍生随机变量序列 $Z_{n}=\frac{\overline{S X_{n}}-\sum_{k=1}^{n} \mu_{k}}{B_{n}},$ 当 $n$ 充分大时, 其分布近似与标准正态分布。</p>
</li>
<li><p>这里并不要求 $X_{1}, X_{2}, \cdots, X_{n}, \cdots$ 同分布。</p>
</li>
</ul>
<h3 id="棣莫佛－拉普拉斯定理"><a href="#棣莫佛－拉普拉斯定理" class="headerlink" title="棣莫佛－拉普拉斯定理"></a>棣莫佛－拉普拉斯定理</h3><ul>
<li><code>Demoiver-Laplace</code> 定理：设随机变量序列 $\eta_{n}, n=1,2, \ldots$ 服从参数为 $(n, p)$ 的二项分布，其中 $0&lt;p&lt;1$ 则对于任意 $x$, 有:</li>
</ul>

$$
\lim _{n \rightarrow \infty} P\left\{\frac{\eta_{n}-n p}{\sqrt{n p(1-p)}} \leq x\right\}=\int_{-\infty}^{x} \frac{1}{\sqrt{2 \pi}} e^{-t^{2} \mid 2} d t=\Phi(x)
$$


<ul>
<li>该定理表明, 正态分布是二项分布的极限分布。当 $n$ 充分大时，可以利用正态分布来计算二项分布的概率。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://baike.baidu.com/item/%E4%B8%AD%E5%BF%83%E6%9E%81%E9%99%90%E5%AE%9A%E7%90%86/829451?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E4%B8%AD%E5%BF%83%E6%9E%81%E9%99%90%E5%AE%9A%E7%90%86/829451?fr=aladdin</a></p>
</li>
<li><p><a href="https://baijiahao.baidu.com/s?id=1665261046335447411&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1665261046335447411&amp;wfr=spider&amp;for=pc</a></p>
</li>
<li><p><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/25956080/answer/1375064657" target="_blank" rel="noopener">https://www.zhihu.com/question/25956080/answer/1375064657</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/93738110" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/93738110</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>VSCode 配置 C++ 运行环境</title>
    <url>/2021/04/02/coding/environment/cpp-vscode/cpp-vscode/</url>
    <content><![CDATA[<blockquote>
<p>本文记录使用 vscode 配置c++编程环境的流程。</p>
</blockquote>
<a id="more"></a>

<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><table>
<thead>
<tr>
<th>项目</th>
<th>内容</th>
</tr>
</thead>
<tbody><tr>
<td>操作系统</td>
<td>Windows 10</td>
</tr>
<tr>
<td>软件安装</td>
<td><a href="https://vscode.en.softonic.com/" target="_blank" rel="noopener">VS code</a></td>
</tr>
</tbody></table>
<ul>
<li>官网：<a href="https://code.visualstudio.com/" target="_blank" rel="noopener">https://code.visualstudio.com/</a></li>
</ul>
<h3 id="安装gcc编译器"><a href="#安装gcc编译器" class="headerlink" title="安装gcc编译器"></a>安装gcc编译器</h3><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><ul>
<li>链接：<a href="https://link.zhihu.com/?target=https://sourceforge.net/projects/mingw-w64/files/">MinGW-w64 - for 32 and 64 bit Windows</a> </li>
</ul>
<blockquote>
<p>选最新版本中的<code>x86_64-posix-seh</code></p>
</blockquote>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul>
<li>解压压缩包</li>
<li>将目录中的<code>bin</code>添加到环境变量</li>
</ul>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><ul>
<li>在cmd中输入命令</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; gcc -v</span><br><span class="line"></span><br><span class="line">Using built-in specs.</span><br><span class="line">COLLECT_GCC&#x3D;gcc</span><br><span class="line">COLLECT_LTO_WRAPPER&#x3D;E:&#x2F;Program\ Files&#x2F;mingw64&#x2F;bin&#x2F;..&#x2F;libexec&#x2F;gcc&#x2F;x86_64-w64-mingw32&#x2F;8.1.0&#x2F;lto-wrapper.exe</span><br><span class="line">Target: x86_64-w64-mingw32</span><br><span class="line">Configured with: ..&#x2F;..&#x2F;..&#x2F;src&#x2F;gcc-8.1.0&#x2F;configure --host&#x3D;x86_64-w64-mingw32 --build&#x3D;x86_64-w64-mingw32 --target&#x3D;x86_64-w64-mingw32 --prefix&#x3D;&#x2F;mingw64 --with-sysroot&#x3D;&#x2F;c&#x2F;mingw810&#x2F;x86_64-810-posix-seh-rt_v6-rev0&#x2F;mingw64 --enable-shared --enable-static --disable-multilib --enable-languages&#x3D;c,c++,fortran,lto --enable-libstdcxx-time&#x3D;yes --enable-threads&#x3D;posix --enable-libgomp --enable-libatomic --enable-lto --enable-graphite --enable-checking&#x3D;release --enable-fully-dynamic-string --enable-version-specific-runtime-libs --disable-libstdcxx-pch --disable-libstdcxx-debug --enable-bootstrap --disable-rpath --disable-win32-registry --disable-nls --disable-werror --disable-symvers --with-gnu-as --with-gnu-ld --with-arch&#x3D;nocona --with-tune&#x3D;core2 --with-libiconv --with-system-zlib --with-gmp&#x3D;&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static --with-mpfr&#x3D;&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static --with-mpc&#x3D;&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static --with-isl&#x3D;&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static --with-pkgversion&#x3D;&#39;x86_64-posix-seh-rev0, Built by MinGW-W64 project&#39; --with-bugurl&#x3D;https:&#x2F;&#x2F;sourceforge.net&#x2F;projects&#x2F;mingw-w64 CFLAGS&#x3D;&#39;-O2 -pipe -fno-ident -I&#x2F;c&#x2F;mingw810&#x2F;x86_64-810-posix-seh-rt_v6-rev0&#x2F;mingw64&#x2F;opt&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-zlib-static&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static&#x2F;include&#39; CXXFLAGS&#x3D;&#39;-O2 -pipe -fno-ident -I&#x2F;c&#x2F;mingw810&#x2F;x86_64-810-posix-seh-rt_v6-rev0&#x2F;mingw64&#x2F;opt&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-zlib-static&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static&#x2F;include&#39; CPPFLAGS&#x3D;&#39; -I&#x2F;c&#x2F;mingw810&#x2F;x86_64-810-posix-seh-rt_v6-rev0&#x2F;mingw64&#x2F;opt&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-zlib-static&#x2F;include -I&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static&#x2F;include&#39; LDFLAGS&#x3D;&#39;-pipe -fno-ident -L&#x2F;c&#x2F;mingw810&#x2F;x86_64-810-posix-seh-rt_v6-rev0&#x2F;mingw64&#x2F;opt&#x2F;lib -L&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-zlib-static&#x2F;lib -L&#x2F;c&#x2F;mingw810&#x2F;prerequisites&#x2F;x86_64-w64-mingw32-static&#x2F;lib &#39;</span><br><span class="line">Thread model: posix</span><br><span class="line">gcc version 8.1.0 (x86_64-posix-seh-rev0, Built by MinGW-W64 project)</span><br></pre></td></tr></table></figure>

<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul>
<li>C/C++：又名 cpptools，提供Debug和Format功能</li>
<li>Code Runner：右键即可编译运行单文件，很方便；但无法Debug</li>
</ul>
<blockquote>
<p>Bracket Pair Colorizer 2：彩虹花括号</p>
</blockquote>
<h3 id="建立配置文件"><a href="#建立配置文件" class="headerlink" title="建立配置文件"></a>建立配置文件</h3><h4 id="tasks-json"><a href="#tasks-json" class="headerlink" title="tasks.json"></a>tasks.json</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; https:&#x2F;&#x2F;code.visualstudio.com&#x2F;docs&#x2F;editor&#x2F;tasks</span><br><span class="line">&#123;</span><br><span class="line">    &quot;version&quot;: &quot;2.0.0&quot;,</span><br><span class="line">    &quot;tasks&quot;: [&#123;</span><br><span class="line">        &quot;label&quot;: &quot;Compile&quot;, &#x2F;&#x2F; 任务名称，与launch.json的preLaunchTask相对应</span><br><span class="line">        &quot;command&quot;: &quot;g++&quot;,   &#x2F;&#x2F; 要使用的编译器，C++用g++</span><br><span class="line">        &quot;args&quot;: [</span><br><span class="line">            &quot;$&#123;file&#125;&quot;,</span><br><span class="line">            &quot;-o&quot;,    &#x2F;&#x2F; 指定输出文件名，不加该参数则默认输出a.exe，Linux下默认a.out</span><br><span class="line">            &quot;$&#123;fileDirname&#125;&#x2F;$&#123;fileBasenameNoExtension&#125;.exe&quot;,</span><br><span class="line">            &quot;-g&quot;,    &#x2F;&#x2F; 生成和调试有关的信息</span><br><span class="line">            &quot;-m64&quot;,  &#x2F;&#x2F; 不知为何有时会生成16位程序而无法运行，此条可强制生成64位的</span><br><span class="line">            &quot;-Wall&quot;, &#x2F;&#x2F; 开启额外警告</span><br><span class="line">            &quot;-static-libgcc&quot;,     &#x2F;&#x2F; 静态链接libgcc，一般都会加上</span><br><span class="line">            &quot;-fexec-charset&#x3D;GBK&quot;, &#x2F;&#x2F; 生成的程序使用GBK编码，不加这条会导致Win下输出中文乱码；繁体系统改成BIG5</span><br><span class="line">            &quot;-D__USE_MINGW_ANSI_STDIO&quot;, &#x2F;&#x2F; 用MinGW写C时留着，否则不需要，用于支持printf的%zd和%Lf等</span><br><span class="line">        ], &#x2F;&#x2F; 编译的命令，其实相当于VSC帮你在终端中输了这些东西</span><br><span class="line">        &quot;type&quot;: &quot;process&quot;, &#x2F;&#x2F; process是把预定义变量和转义解析后直接全部传给command；shell相当于先打开shell再输入命令，所以args还会经过shell再解析一遍</span><br><span class="line">        &quot;group&quot;: &#123;</span><br><span class="line">            &quot;kind&quot;: &quot;build&quot;,</span><br><span class="line">            &quot;isDefault&quot;: true &#x2F;&#x2F; 不为true时ctrl shift B就要手动选择了</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;presentation&quot;: &#123;</span><br><span class="line">            &quot;echo&quot;: true,</span><br><span class="line">            &quot;reveal&quot;: &quot;always&quot;, &#x2F;&#x2F; 执行任务时是否跳转到终端面板，可以为always，silent，never。具体参见VSC的文档，即使设为never，手动点进去还是可以看到</span><br><span class="line">            &quot;focus&quot;: false,     &#x2F;&#x2F; 设为true后可以使执行task时焦点聚集在终端，但对编译C&#x2F;C++来说，设为true没有意义</span><br><span class="line">            &quot;panel&quot;: &quot;shared&quot;   &#x2F;&#x2F; 不同的文件的编译信息共享一个终端面板</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;problemMatcher&quot;:&quot;$gcc&quot; &#x2F;&#x2F; 捕捉编译时终端里的报错信息到问题面板中，修改代码后需要重新编译才会再次触发</span><br><span class="line">        &#x2F;&#x2F; 本来有Lint，再开problemMatcher就有双重报错，但MinGW的Lint效果实在太差了；用Clangd可以注释掉</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; https:&#x2F;&#x2F;code.visualstudio.com&#x2F;docs&#x2F;cpp&#x2F;launch-json-reference</span><br><span class="line">&#123;</span><br><span class="line">    &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">    &quot;configurations&quot;: [&#123;</span><br><span class="line">        &quot;name&quot;: &quot;(gdb) Launch&quot;, &#x2F;&#x2F; 配置名称，将会在启动配置的下拉菜单中显示</span><br><span class="line">        &quot;type&quot;: &quot;cppdbg&quot;, &#x2F;&#x2F; 配置类型，对于C&#x2F;C++可认为此处只能是cppdbg，由cpptools提供；不同编程语言不同</span><br><span class="line">        &quot;request&quot;: &quot;launch&quot;, &#x2F;&#x2F; 可以为launch（启动）或attach（附加）</span><br><span class="line">        &quot;program&quot;: &quot;$&#123;fileDirname&#125;&#x2F;$&#123;fileBasenameNoExtension&#125;.exe&quot;, &#x2F;&#x2F; 将要进行调试的程序的路径</span><br><span class="line">        &quot;args&quot;: [], &#x2F;&#x2F; 程序调试时传递给程序的命令行参数，一般设为空</span><br><span class="line">        &quot;stopAtEntry&quot;: false, &#x2F;&#x2F; 设为true时程序将暂停在程序入口处，相当于在main上打断点</span><br><span class="line">        &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;, &#x2F;&#x2F; 调试程序时的工作目录，此为工作区文件夹；改成$&#123;fileDirname&#125;可变为文件所在目录</span><br><span class="line">        &quot;environment&quot;: [], &#x2F;&#x2F; 环境变量</span><br><span class="line">        &quot;externalConsole&quot;: true, &#x2F;&#x2F; 使用单独的cmd窗口，与其它IDE一致；为false时使用内置终端</span><br><span class="line">        &quot;internalConsoleOptions&quot;: &quot;neverOpen&quot;, &#x2F;&#x2F; 如果不设为neverOpen，调试时会跳到“调试控制台”选项卡，你应该不需要对gdb手动输命令吧？</span><br><span class="line">        &quot;MIMode&quot;: &quot;gdb&quot;, &#x2F;&#x2F; 指定连接的调试器，可以为gdb或lldb。但我没试过lldb</span><br><span class="line">        &quot;miDebuggerPath&quot;: &quot;gdb.exe&quot;, &#x2F;&#x2F; 调试器路径，Windows下后缀不能省略，Linux下则不要</span><br><span class="line">        &quot;setupCommands&quot;: [</span><br><span class="line">            &#123; &#x2F;&#x2F; 模板自带，好像可以更好地显示STL容器的内容，具体作用自行Google</span><br><span class="line">                &quot;description&quot;: &quot;Enable pretty-printing for gdb&quot;,</span><br><span class="line">                &quot;text&quot;: &quot;-enable-pretty-printing&quot;,</span><br><span class="line">                &quot;ignoreFailures&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;preLaunchTask&quot;: &quot;Compile&quot; &#x2F;&#x2F; 调试前执行的任务，一般为编译程序。与tasks.json的label相对应</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="settings-json"><a href="#settings-json" class="headerlink" title="settings.json"></a>settings.json</h3><blockquote>
<p>把这个文件里的东西放到“用户设置”里可以覆盖全局设置，否则只在当前工作区才有效。这两点各有自己的优势。</p>
<p>Code Runner的命令行和某些选项可以根据自己的需要在此处修改，想自定义或者想知道是什么意思还是参见此扩展的文档和百度gcc使用教程。如果终端用的是cmd（<strong>Win7</strong>默认）需要改用注释掉的，或者把<code>terminal.integrated.shell.windows</code>改为PowerShell；Win10默认就是PS就不用改。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;files.defaultLanguage&quot;: &quot;c&quot;, &#x2F;&#x2F; ctrl+N新建文件后默认的语言</span><br><span class="line">    &quot;editor.formatOnType&quot;: true,  &#x2F;&#x2F; 输入分号(C&#x2F;C++的语句结束标识)后自动格式化当前这一行的代码</span><br><span class="line">    &quot;editor.suggest.snippetsPreventQuickSuggestions&quot;: false, &#x2F;&#x2F; clangd的snippets有很多的跳转点，不用这个就必须手动触发Intellisense了</span><br><span class="line">    &quot;editor.acceptSuggestionOnEnter&quot;: &quot;off&quot;, &#x2F;&#x2F; 我个人的习惯，按回车时一定是真正的换行，只有tab才会接受Intellisense</span><br><span class="line">    &#x2F;&#x2F; &quot;editor.snippetSuggestions&quot;: &quot;top&quot;, &#x2F;&#x2F; （可选）snippets显示在补全列表顶端，默认是inline</span><br><span class="line"></span><br><span class="line">    &quot;code-runner.runInTerminal&quot;: true, &#x2F;&#x2F; 设置成false会在“输出”中输出，无法输入</span><br><span class="line">    &quot;code-runner.executorMap&quot;: &#123;</span><br><span class="line">        &quot;c&quot;: &quot;gcc &#39;$fileName&#39; -o &#39;$fileNameWithoutExt.exe&#39; -Wall -O2 -m64 -lm -static-libgcc -fexec-charset&#x3D;GBK -D__USE_MINGW_ANSI_STDIO &amp;&amp; &amp;&#39;.&#x2F;$fileNameWithoutExt.exe&#39;&quot;,</span><br><span class="line">        &quot;cpp&quot;: &quot;g++ &#39;$fileName&#39; -o &#39;$fileNameWithoutExt.exe&#39; -Wall -O2 -m64 -static-libgcc -fexec-charset&#x3D;GBK &amp;&amp; &amp;&#39;.&#x2F;$fileNameWithoutExt.exe&#39;&quot;</span><br><span class="line">        &#x2F;&#x2F; &quot;c&quot;: &quot;gcc $fileName -o $fileNameWithoutExt.exe -Wall -O2 -m64 -lm -static-libgcc -fexec-charset&#x3D;GBK -D__USE_MINGW_ANSI_STDIO &amp;&amp; $dir$fileNameWithoutExt.exe&quot;,</span><br><span class="line">        &#x2F;&#x2F; &quot;cpp&quot;: &quot;g++ $fileName -o $fileNameWithoutExt.exe -Wall -O2 -m64 -static-libgcc -fexec-charset&#x3D;GBK &amp;&amp; $dir$fileNameWithoutExt.exe&quot;</span><br><span class="line">    &#125;, &#x2F;&#x2F; 右键run code时运行的命令；未注释的仅适用于PowerShell（Win10默认）和pwsh，文件名中有空格也可以编译运行；注释掉的适用于cmd（win7默认）、PS和bash，但文件名中有空格时无法运行</span><br><span class="line">    &quot;code-runner.saveFileBeforeRun&quot;: true, &#x2F;&#x2F; run code前保存</span><br><span class="line">    &quot;code-runner.preserveFocus&quot;: true,     &#x2F;&#x2F; 若为false，run code后光标会聚焦到终端上。如果需要频繁输入数据可设为false</span><br><span class="line">    &quot;code-runner.clearPreviousOutput&quot;: false, &#x2F;&#x2F; 每次run code前清空属于code runner的终端消息，默认false</span><br><span class="line">    &quot;code-runner.ignoreSelection&quot;: true,   &#x2F;&#x2F; 默认为false，效果是鼠标选中一块代码后可以单独执行，但C是编译型语言，不适合这样用</span><br><span class="line">    &quot;code-runner.fileDirectoryAsCwd&quot;: true, &#x2F;&#x2F; 将code runner终端的工作目录切换到文件目录再运行，对依赖cwd的程序产生影响；如果为false，executorMap要加cd $dir</span><br><span class="line"></span><br><span class="line">    &quot;C_Cpp.clang_format_sortIncludes&quot;: true, &#x2F;&#x2F; 格式化时调整include的顺序（按字母排序）</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.zhihu.com/question/30315894" target="_blank" rel="noopener">https://www.zhihu.com/question/30315894</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>c++</category>
        <category>ide</category>
      </categories>
      <tags>
        <tag>c++</tag>
        <tag>ide</tag>
      </tags>
  </entry>
  <entry>
    <title>docker - Error Got permission denied &amp; response from daemon Unknown runtime specified nvidia 解决方案</title>
    <url>/2021/03/30/docker/docker_error_fix/</url>
    <content><![CDATA[<blockquote>
<p>Docker 在使用过程中<code>docker: Error response from daemon: Unknown runtime specified nvidia.</code>问题的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="docker-Got-permission-denied-while-trying-to-connect-to-the-Docker-daemon-socket"><a href="#docker-Got-permission-denied-while-trying-to-connect-to-the-Docker-daemon-socket" class="headerlink" title="docker: Got permission denied while trying to connect to the Docker daemon socket"></a>docker: Got permission denied while trying to connect to the Docker daemon socket</h3><blockquote>
<p>这是因为用户没有加入到docker组中，因此将自己的用户加入到docker的用户组</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo usermod -a -G docker $USER</span><br></pre></td></tr></table></figure>



<h3 id="docker-Error-response-from-daemon-Unknown-runtime-specified-nvidia"><a href="#docker-Error-response-from-daemon-Unknown-runtime-specified-nvidia" class="headerlink" title="docker: Error response from daemon: Unknown runtime specified nvidia."></a>docker: Error response from daemon: Unknown runtime specified nvidia.</h3><blockquote>
<p>这个时候是我们需要安装nvidia-docker2</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get install -y nvidia-docker2</span><br></pre></td></tr></table></figure>

<ul>
<li>运行：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo docker run --runtime&#x3D;nvidia --rm nvidia&#x2F;cuda nvidia-smi</span><br></pre></td></tr></table></figure>

<ul>
<li>还是报错：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker: Error response from daemon: Unknown runtime specified nvidia.</span><br></pre></td></tr></table></figure>

<ul>
<li>而运行显示镜像的命令是正常的，说明nvidia-docker2是安装成功了的</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nvidia-docker image ls</span><br></pre></td></tr></table></figure>

<ul>
<li>需要将docker重启</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>




<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://zhuanlan.zhihu.com/p/68044009" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/68044009</a></p>
</li>
<li><p><a href="https://github.com/NVIDIA/nvidia-docker/issues/838" target="_blank" rel="noopener">https://github.com/NVIDIA/nvidia-docker/issues/838</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Nvidia 显卡 Failed to initialize NVML Driver/library version mismatch 错误解决方案</title>
    <url>/2021/03/30/linux/driver/driver-library-version-mismatch/driver-library-version-mismatch/</url>
    <content><![CDATA[<blockquote>
<p>本文记录错误 <code>Failed to initialize NVML: Driver/library version mismatch</code> 错误解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nvidia-smi </span></span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">Failed to initialize NVML: Driver/library version mismatch</span><br></pre></td></tr></table></figure>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>NVIDIA 内核驱动版本与系统驱动不一致</li>
</ul>
<h4 id="查看显卡驱动所使用的内核版本"><a href="#查看显卡驱动所使用的内核版本" class="headerlink" title="查看显卡驱动所使用的内核版本"></a>查看显卡驱动所使用的内核版本</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /proc/driver/nvidia/version</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">NVRM version: NVIDIA UNIX x86_64 Kernel Module  430.34  Wed Jun 26 12:19:48 CDT 2019</span><br><span class="line">GCC version:  gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12)</span><br></pre></td></tr></table></figure>

<ul>
<li>内核版本 Kernel Module 为 430.34， 系统内核 16.04.12</li>
</ul>
<h4 id="查看系统驱动日志"><a href="#查看系统驱动日志" class="headerlink" title="查看系统驱动日志"></a>查看系统驱动日志</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /var/log/dpkg.log | grep nvidia</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">2021-03-30 14:04:55 install libnvidia-compute-460-server:amd64 &lt;none&gt; 460.32.03-0ubuntu0.18.04.2</span><br><span class="line">2021-03-30 14:04:55 status half-installed libnvidia-compute-460-server:amd64 460.32.03-0ubuntu0.18.04.2</span><br><span class="line">2021-03-30 14:04:57 status unpacked libnvidia-compute-460-server:amd64 460.32.03-0ubuntu0.18.04.2</span><br><span class="line">2021-03-30 14:04:57 status unpacked libnvidia-compute-460-server:amd64 460.32.03-0ubuntu0.18.04.2</span><br><span class="line">2021-03-30 14:05:15 install nvidia-cuda-dev:amd64 &lt;none&gt; 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:15 status half-installed nvidia-cuda-dev:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:34 status unpacked nvidia-cuda-dev:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:34 status unpacked nvidia-cuda-dev:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:34 install nvidia-cuda-doc:all &lt;none&gt; 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:34 status half-installed nvidia-cuda-doc:all 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:38 status unpacked nvidia-cuda-doc:all 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:38 status unpacked nvidia-cuda-doc:all 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:38 install nvidia-cuda-gdb:amd64 &lt;none&gt; 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:38 status half-installed nvidia-cuda-gdb:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:39 status unpacked nvidia-cuda-gdb:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:39 status unpacked nvidia-cuda-gdb:amd64 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:39 install nvidia-profiler:amd64 &lt;none&gt; 9.1.85-3ubuntu1</span><br><span class="line">2021-03-30 14:05:39 status half-installed nvidia-profiler:amd64 9.1.85-3ubuntu1</span><br></pre></td></tr></table></figure>

<ul>
<li>可以看到曾经安装过系统内核 18.04 的 460.32 的驱动</li>
</ul>
<h4 id="查看驱动程序"><a href="#查看驱动程序" class="headerlink" title="查看驱动程序"></a>查看驱动程序</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dpkg --list | grep nvidia-*</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">ii  libnvidia-compute-460-server:amd64   460.32.03-0ubuntu0.18.04.2                 amd64        NVIDIA libcompute package</span><br><span class="line">ii  libnvidia-container-tools            1.0.5-1                                    amd64        NVIDIA container runtime library (command-line tools)</span><br><span class="line">ii  libnvidia-container1:amd64           1.0.5-1                                    amd64        NVIDIA container runtime library</span><br><span class="line">ii  nvidia-container-runtime             3.1.4-1                                    amd64        NVIDIA container runtime</span><br><span class="line">ii  nvidia-container-toolkit             1.0.5-1                                    amd64        NVIDIA container runtime hook</span><br><span class="line">ii  nvidia-cuda-dev                      9.1.85-3ubuntu1                            amd64        NVIDIA CUDA development files</span><br><span class="line">ii  nvidia-cuda-doc                      9.1.85-3ubuntu1                            all          NVIDIA CUDA and OpenCL documentation</span><br></pre></td></tr></table></figure>

<ul>
<li>可以看到系统安装了ubuntu 内核18.04 下的 nvidia 460 驱动</li>
<li>实际系统内核版本与驱动需求的版本不一致是问题产生的根源</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>卸载现有驱动，重新安装</li>
</ul>
<h4 id="卸载驱动"><a href="#卸载驱动" class="headerlink" title="卸载驱动"></a>卸载驱动</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo /usr/bin/nvidia-uninstall</span><br><span class="line">sudo apt-get --purge remove nvidia-*</span><br><span class="line">sudo apt-get purge nvidia*</span><br><span class="line">sudo apt-get purge libnvidia*</span><br></pre></td></tr></table></figure>

<ul>
<li>直到命令不输出任何内容</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dpkg --list | grep nvidia-*</span><br></pre></td></tr></table></figure>

<ul>
<li>重新安装</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chmod a+x NVIDIA-Linux-x86_64-450.80.02.run</span><br><span class="line">sudo ./NVIDIA-Linux-x86_64-450.80.02.run -no-x-check -no-nouveau-check -no-opengl-files</span><br></pre></td></tr></table></figure>

<blockquote>
<p>–no-opengl-files 只安装驱动文件,不安装OpenGL文件</p>
<p>–no-x-check 安装驱动时不检查X服务</p>
<p>–no-nouveau-check 安装驱动时不检查nouveau</p>
</blockquote>
<h3 id="查看驱动更新结果"><a href="#查看驱动更新结果" class="headerlink" title="查看驱动更新结果"></a>查看驱动更新结果</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nvidia-smi</span></span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20201203202133.png"></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://blog.csdn.net/qq_40200387/article/details/90341107" target="_blank" rel="noopener">https://blog.csdn.net/qq_40200387/article/details/90341107</a></p>
</li>
<li><p><a href="https://www.zywvvd.com/2020/12/03/linux/driver/nvidia-driver-install-linux/">https://www.zywvvd.com/2020/12/03/linux/driver/nvidia-driver-install-linux/</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>docker - 占满根目录空间的解决方案</title>
    <url>/2021/03/30/docker/docker_no_space_left/</url>
    <content><![CDATA[<blockquote>
<p>Docker 默认会占用根目录的空间，时间久了就会吧根目录占满，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><blockquote>
<p>不知不觉根目录已经没有空间，<code>ls</code> 的补全都会报错。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cannot create temp file for here-document: No space left on devic</span><br></pre></td></tr></table></figure>

<ul>
<li>可以看到 <code>/</code>已经没有空间了</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> df -h</span></span><br><span class="line">Filesystem                           Size  Used Avail Use% Mounted on</span><br><span class="line">udev                                  32G     0   32G   0% /dev</span><br><span class="line">tmpfs                                6.3G  138M  6.2G   3% /run</span><br><span class="line">/dev/mapper/MT3--vg-root             219G  208G     0 100% /</span><br><span class="line">tmpfs                                 32G   32K   32G   1% /dev/shm</span><br><span class="line">tmpfs                                5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs                                 32G     0   32G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sdb1                            3.6T  1.1T  2.4T  32% /gluster/data</span><br></pre></td></tr></table></figure>

<h3 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h3><h4 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo　apt-get autoclean   # 删除你已经卸载掉的软件包的命令为 </span><br><span class="line"></span><br><span class="line">sudo apt-get clean       # 若你想清理出更多的空间，可以把电脑上存储的安装包全部卸载</span><br><span class="line"></span><br><span class="line">sudo apt-get autoremove  # 删除已经被卸载的软件所依赖的（其他软件不依赖的）孤立的软件包</span><br></pre></td></tr></table></figure>

<h4 id="方案2"><a href="#方案2" class="headerlink" title="方案2"></a>方案2</h4><blockquote>
<p>空间仍不足：通过建立软链接将/var目录下占用空间较大的目录移动到富足的空间区块（如/home）下，使得/var下不再占用空间。 （具体实现）</p>
</blockquote>
<ul>
<li>查看文件夹下文件占用磁盘空间</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo du -ah -x --max-depth&#x3D;1</span><br></pre></td></tr></table></figure>

<ul>
<li>通过排查发现<code>/var/lib/docker</code>中文件巨大，将其移到其他磁盘中</li>
<li>为了避免风险并提升速度（小文件很多），将其压缩到其他盘中再解压</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zcvf [压缩后的文件.tar.gz] var&#x2F;lib&#x2F;docker</span><br></pre></td></tr></table></figure>

<ul>
<li>解压：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxvf [压缩后的文件.tar.gz]</span><br></pre></td></tr></table></figure>

<ul>
<li>将<code>/var/lib/docker</code>重命名为<code>/var/lib/docker-old</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mv /var/lib/docker /var/lib/docker-old</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这时查看 <code>docker images</code> 是空的</p>
</blockquote>
<ul>
<li>建立软连接重现<code>docker</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ln -s &#x2F;var&#x2F;lib&#x2F;docker [解压后的docker文件夹]</span><br></pre></td></tr></table></figure>

<ul>
<li>这时查看 <code>docker images</code> 一切正常的化已经可以看到之前的所有docker 数据了</li>
</ul>
<blockquote>
<p>但是如果这时新建容器或启动容器会报错：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">OCI runtime create failed: &#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;c6eb60dada971e57fd5d125fb61d294870be347a2efb287862f8dfe52d99c57b&#x2F;merged is not an absolute path or is a symlink: unknown</span><br></pre></td></tr></table></figure>

<ul>
<li>需要重启 docker</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service docker stop</span><br><span class="line">service docker start</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure>




<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/weixin_30710457/article/details/95471146" target="_blank" rel="noopener">https://blog.csdn.net/weixin_30710457/article/details/95471146</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 8 - 大数定理</title>
    <url>/2021/03/30/math/probability/law-of-large-numbers/law-of-large-numbers/</url>
    <content><![CDATA[<blockquote>
<p>概率论历史上第一个极限定理属于伯努利，后人称之为“大数定律”。概率论中讨论随机变量序列的算术平均值向随机变量各数学期望的算术平均值收敛的定律。</p>
</blockquote>
<a id="more"></a>

<h3 id="依概率收敛"><a href="#依概率收敛" class="headerlink" title="依概率收敛"></a>依概率收敛</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ul>
<li><p>设$Y_1,Y_2, \dots ,Y_n, \dots$ 是一个随机变量序列，$a$是一个常数。</p>
<p>若对于任意正数$\varepsilon $有 ：</p>


$$
\lim _{n \rightarrow \infty} P\left\{\left|Y_{n}-a\right| \leq \varepsilon\right\}=1
$$

​		
</li>
<li><p>则称序列依概率收敛于$a$，记作：</p>
</li>
</ul>
<p>$$<br>Y_{n} \stackrel{P}{\rightarrow} a<br>$$</p>
<h4 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h4><ul>
<li>收敛：表明这是一个随机变量序列，而不是某个随机变量；且序列是无限长，而不是有限长。</li>
<li>依概率：表明序列无穷远处的随机变量$Y_{\infty}$的分布规律为：绝大部分分布于点 $a$，极少数位于$a$  之外。且分布于$a$  之外的事件发生的概率之和为0。</li>
</ul>
<h3 id="大数定理"><a href="#大数定理" class="headerlink" title="大数定理"></a>大数定理</h3><ul>
<li>设随机变量$X_1,X_2, \dots ,X_n, \dots$ 相互独立，且具有相同的数学期望和方差：</li>
</ul>
<p>$$<br>\mathbb{E}\left[X_{k}\right]=\mu, \operatorname{Var}\left[X_{k}\right]=\sigma^{2}<br>$$</p>
<ul>
<li>则序列$X_i$依概率收敛于$\mu$：</li>
</ul>

$$
\lim _{n \rightarrow \infty} P\left\{\left|\frac{1}{n} \sum_{i=1}^{n} X_{i}-E\left(X_{i}\right)\right|<\varepsilon\right\}=1
$$


<ul>
<li>这里并没有要求随机变量$X_1,X_2, \dots ,X_n, \dots$ 同分布。</li>
</ul>
<blockquote>
<p>证明见 <a href="https://www.zywvvd.com/2021/03/30/math/probability/chebyshev-inequality/chebyshev-inequality/">切比雪夫不等式</a></p>
</blockquote>
<h3 id="辛钦定理"><a href="#辛钦定理" class="headerlink" title="辛钦定理"></a>辛钦定理</h3><ul>
<li>设随机变量$X_1,X_2, \dots ,X_n, \dots$ 相互独立，服从同一分布，且具有相同的数学期望$\mu$，则对于任意正数$\varepsilon$有：</li>
</ul>

$$
\lim _{n \rightarrow \infty} P\left\{\left|\frac{1}{n} \sum_{k=1}^{n} X_{k}-\mu\right|<\varepsilon\right\}=1
$$


<ul>
<li>注意：这里并没有要求随机变量$X_i$的方差存在</li>
</ul>
<h4 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h4><ul>
<li>由于$X_i$同分布，他们有相同的分布，也就具有相同的<a href="https://www.zywvvd.com/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/">特征函数</a>：</li>
</ul>
<p>$$<br>\varphi_{X}(t)=E\left[e^{i t X}\right]<br>$$</p>
<ul>
<li>其中$e^{i t X}$为：</li>
</ul>
<p>$$<br>e^{i t X}=1+\frac{i t X}{1}-\frac{t^{2} X^{2}}{2 !}+\cdots+\frac{(i t)^{n} X^{n}}{n !}<br>$$</p>
<ul>
<li>因此$X$的期望$E(X)$可以用特征函数在$t=0$处的一阶导数表示：</li>
</ul>

$$
\begin{array}{l}
\varphi_{X}'(0)=iE(X)\\
E(X)=\frac{\varphi_{X}'(0)}{i}
\end{array}
$$



<ul>
<li>将特征函数在$t=0$处泰勒展开，有：</li>
</ul>
<p>$$<br>\varphi_{X}(t)=\varphi_{X}(0)+\varphi_{X}’(0)t+o(t)=1+i\mu t+o(t)<br>$$</p>
<ul>
<li>其中$\mu$=$E(X)$</li>
<li>由于$X_i$相互独立，变量$\frac{1}{n} \sum_{k=1}^{n} X_{k}$的特征函数为：</li>
</ul>

$$
\begin{array}{l}

{g_n}(t) &= E[{e^{it\frac{1}{n}\sum\limits_{k = 1}^n {{X_k}} }}]\\
 &= E[{e^{i\frac{{\rm{t}}}{n}{X_1}}} \cdot {e^{i\frac{{\rm{t}}}{n}{X_2}}} \cdot  \cdots  \cdot {e^{i\frac{{\rm{t}}}{n}{X_n}}}]\\
 &= {\{ E[{e^{i\frac{{\rm{t}}}{n}X}}]\} ^n}\\
 &= {[{\varphi _X}(\frac{t}{n})]^n}\\
 &= {[1 + i\mu \frac{t}{n} + o(t)]^n}
\end{array}
$$



<ul>
<li>根据（可由<a href="https://www.zywvvd.com/2021/03/30/math/LHolpitals-Rule/LHolpitals-Rule/">洛必达法则</a>推出）：</li>
</ul>

$$
\mathop {\lim }\limits_{n \to \infty } {\rm{(1 + }}\frac{{\rm{a}}}{n}{)^n} = {e^a}
$$



<ul>
<li>得：</li>
</ul>
<p>$$<br>{g_n}(t)=e^{i\mu t}=1+\frac{i t E(X)}{1}-\frac{t^{2} E(X^{2})}{2 !}+\cdots+\frac{(i t)^{n} E(X^{n})}{n !}<br>$$</p>
<ul>
<li>而$e^{i\mu t}$为：</li>
</ul>
<p>$$<br>e^{i\mu t}=1+\frac{i t \mu}{1}-\frac{t^{2} \mu^{2}}{2 !}+\cdots+\frac{(i t)^{n} \mu^{n}}{n !}<br>$$</p>
<ul>
<li>即$X$的$n$阶矩与期望的关系为：</li>
</ul>
<p>$$<br>E(X^n)=\mu^n<br>$$</p>
<ul>
<li>变量$\frac{1}{n} \sum_{k=1}^{n} X_{k}$与退化函数：</li>
</ul>

$$
F(X) = \left\{ {\begin{array}{*{20}{c}}
{\mu,X = a}\\
{0,X \ne a}
\end{array}} \right.
$$



<ul>
<li>二者具有相同的特征函数，因此具有相同的分布，有：</li>
</ul>

$$
\lim _{n \rightarrow \infty} P\left\{\left|\frac{1}{n} \sum_{k=1}^{n} X_{k}-\mu\right|<\varepsilon\right\}=1
$$



<h3 id="伯努利大数定理"><a href="#伯努利大数定理" class="headerlink" title="伯努利大数定理"></a>伯努利大数定理</h3><ul>
<li>设$n_A$为$n$次独立重复实验中事件$A$发生的次数， $p$是事件$A$在每次试验中发生的概率。则对于任意正数$\varepsilon$有：</li>
</ul>

$$
\begin{aligned}
& \lim _{n \rightarrow \infty} P\left\{\left|\frac{n_{A}}{n}-p\right|<\varepsilon\right\}=1 \\
\text { or : } & \lim _{n \rightarrow \infty} P\left\{\left|\frac{n_{A}}{n}-p\right| \geq \varepsilon\right\}=0
\end{aligned}
$$


<ul>
<li><p>当独立重复实验执行非常大的次数时，事件$A$发生的频率逼近于它的概率</p>
</li>
<li><p>伯努利大数定理是亲钦定理的特殊情况</p>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 7 - 特征函数</title>
    <url>/2021/03/30/math/probability/Characteristic-Function/Characteristic-Function/</url>
    <content><![CDATA[<blockquote>
<p>特征函数是随机变量的分布的不同表示形式。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>一般而言，对于随机变量$X$的分布，大家习惯用概率密度函数来描述，虽然概率密度函数理解起来很直观，但是确实随机变量的分布还有另外的描述方式，比如特征函数。</p>
</blockquote>
<ul>
<li><p>特征函数的本质是概率密度函数的泰勒展开</p>
</li>
<li><p>每一个级数表示原始概率密度函数的一个特征</p>
</li>
<li><p>如果两个分布的所有特征都相同，那我们就认为这是两个相同的分布</p>
</li>
<li><p><code>矩</code>是描述概率分布的重要特征，期望、方差等概念都是矩的特殊形态</p>
</li>
<li><p>直觉上可以简单理解为：</p>
<ul>
<li>各阶矩相等 → 各个特征相等 → 分布相同</li>
</ul>
</li>
</ul>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li>随机变量$X$ 的特征函数定义为：</li>
</ul>
<p>$$<br>\varphi_{X}(t)=E\left[e^{i t X}\right]<br>$$</p>
<ul>
<li>针对概率密度函数为$f(x)$的连续随机变量$x$，特征函数写作：</li>
</ul>

$$
\varphi_x(t)=\int_{-\infty}^{\infty} e^{i t x} f(x) \cdot d x
$$


<ul>
<li>为什么这么定义呢? 首先, $e^{i t X}$ 的泰勒级数为:</li>
</ul>
<p>$$<br>e^{i t X}=1+\frac{i t X}{1}-\frac{t^{2} X^{2}}{2 !}+\cdots+\frac{(i t)^{n} X^{n}}{n !}<br>$$</p>
<ul>
<li>代入可以推出：</li>
</ul>

$$
\begin{aligned}
\varphi_{X}(t) &=E\left[e^{i t X}\right] \\
&=E\left(1+\frac{i t X}{1}-\frac{t^{2} X^{2}}{2 !}+\cdots+\frac{(i t)^{n} X^{n}}{n !}\right) \\
&=E(1)+E\left(\frac{i t X}{1}\right)-E\left(\frac{t^{2} X^{2}}{2 !}\right)+\cdots+E\left(\frac{(i t)^{n} X^{n}}{n !}\right) \\
&=1+\frac{i t \overbrace{E[X]}^{\text {一阶矩 }}}{1}-\frac{t^{2} \overbrace{E\left[X^{2}\right]}^{\text {二阶矩 }}}{2 !}+\cdots+\frac{(i t)^{n} \overbrace{E\left[X^{n}\right]}^{\text {n阶矩 }}}{n !}

\end{aligned}
$$



<ul>
<li>也就是说特征函数包含了分布函数的所有<code>矩</code>，可以理解为包含了分布的所有特征</li>
<li>之前的结论可以进一步理解为：<ul>
<li>$\varphi_{X}(t) $相等 → 各阶矩相等 → 各个特征相等 → 分布相同</li>
</ul>
</li>
<li>所以，特征函数其实是随机变量$X$的分布的另外一种描述方式</li>
</ul>
<h3 id="一些推论"><a href="#一些推论" class="headerlink" title="一些推论"></a>一些推论</h3><ul>
<li>设随机变量$X$的概率密度函数为$f(x)$ ，其特征函数为：</li>
</ul>

$$
\varphi_x(t)=\int_{-\infty}^{\infty} e^{i t x} f(x) \cdot d x
$$


<h4 id="独立变量和的特征函数"><a href="#独立变量和的特征函数" class="headerlink" title="独立变量和的特征函数"></a>独立变量和的特征函数</h4><ul>
<li>$Y=X_1+X_2 $，其中$X_1,X_2$相互独立，特征函数：</li>
</ul>

$$
\begin{array}{l}
\varphi_{y}(t)&=\varphi_{x_{1}+x_{2}}(t) \\
&=\iint_{-\infty}^{\infty} e^{i t\left(x_{1}+x_{2}\right)} \cdot f\left(x_{1}\right) \cdot g\left(x_{2}\right) \cdot d x_{1} d x_{2} \\
&=\int_{-\infty}^{\infty} e^{i t x_{1}} f\left(x_{1}\right) d x_{1} \cdot \int_{-\infty}^{\infty} e^{i t x_{2}} g\left(x_{2}\right) d x_{2} \\
&=\varphi_{x_{1}}(t) \cdot \varphi_{x_{2}}(t)
\end{array}
$$


<h4 id="常数线性变换的特征函数"><a href="#常数线性变换的特征函数" class="headerlink" title="常数线性变换的特征函数"></a>常数线性变换的特征函数</h4><ul>
<li>$Y=aX+b$ 的特征函数：</li>
</ul>

$$
\begin{array}{l}
\varphi_{y}(t)&=\varphi_{a x+b}(t)=\int_{-\infty}^{\infty} e^{i t(a x+b)} f(x) d x \\
&=e^{i t b} \int_{-\infty}^{\infty} e^{i(a t) x} f(x) d x \\
&=e^{i t b} \cdot \varphi_{x}(a t)
\end{array}
$$


<h4 id="标准正态分布的特征函数"><a href="#标准正态分布的特征函数" class="headerlink" title="标准正态分布的特征函数"></a>标准正态分布的特征函数</h4><ul>
<li>设 $X \sim N(0,1)$则其概率密度函数为：</li>
</ul>

$$
f(x)=\frac{1}{\sqrt{2 \pi}} e^{-\frac{x^{2}}{2}}
$$


<ul>
<li>特征函数为：</li>
</ul>

$$
\begin{array}{l}
\varphi(t)&=\int_{-\infty}^{\infty} e^{i t x} \cdot \frac{1}{\sqrt{2 \pi}} e^{-\frac{x^{2}}{2}} \cdot d x \\
&=e^{-\frac{t^{2}}{2}} \int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi}} e^{-\frac{(x-i t)^{2}}{2}} d(x-i t) \\
&=e^{-\frac{t^{2}}{2}}
\end{array}
$$


<h3 id="特征函数是共轭傅立叶变换"><a href="#特征函数是共轭傅立叶变换" class="headerlink" title="特征函数是共轭傅立叶变换"></a>特征函数是共轭傅立叶变换</h3><ul>
<li>假设某连续随机变量$X$的概率密度函数为$f(x)$，那么可知：</li>
</ul>
<p>$$<br>{\rm{E(X) = }}\int\limits_{ - \infty }^{ + \infty } {xf(x)dx}<br>$$</p>
<ul>
<li>特征函数为：</li>
</ul>

$$
\begin{array}{l}
{\varphi _X}(t) &= E[{e^{itX}}]\\
 &= \int\limits_{ - \infty }^{ + \infty } {{e^{itX}}f(x)dx} 
\end{array}
$$



<ul>
<li>而$f(x)$的傅立叶变换为：</li>
</ul>
<p>$$<br>{\rm{F(X) = }}\int\limits_{ - \infty }^{ + \infty } {f(x)e^{-itx}dx}<br>$$</p>
<ul>
<li>二者是共轭关系：</li>
</ul>
<p>$$<br>{\varphi _X}(t) = \overline {F(t)}<br>$$</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://www.zhihu.com/question/23686709/answer/376439033" target="_blank" rel="noopener">https://www.zhihu.com/question/23686709/answer/376439033</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/25956080/answer/1375064657" target="_blank" rel="noopener">https://www.zhihu.com/question/25956080/answer/1375064657</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>洛必达法则</title>
    <url>/2021/03/30/math/LHolpitals-Rule/LHolpitals-Rule/</url>
    <content><![CDATA[<blockquote>
<p>洛必达法则是在一定条件下通过分子分母分别求导再求极限来确定未定式值的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>众所周知，两个无穷小之比或两个无穷大之比的极限可能存在，也可能不存在。因此，求这类极限时往往需要适当的变形，转化成可利用极限运算法则或重要极限的形式进行计算。</p>
</blockquote>
<h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><h4 id="零比零型"><a href="#零比零型" class="headerlink" title="零比零型"></a>零比零型</h4><ul>
<li>若函数$f(x)$和$g(x)$满足如下条件：</li>
</ul>
<ol>
<li>在$a$点收敛于0</li>
</ol>
<p>$$<br>\lim _{x \rightarrow a} f(x)=0, \lim _{x \rightarrow a} g(x)=0<br>$$</p>
<ol start="2">
<li>在点 $a$ 的某去心邻域内两者都可导，且 $g^{\prime}(x) \neq 0$</li>
<li>$\lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}=A\left(A\right.$ 可为实数，也可为 $\left.\pm {\infty}\right),$ 则<br>$$<br>\lim _{x \rightarrow a} \frac{f(x)}{g(x)}=\lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}=A<br>$$</li>
</ol>
<h4 id="无穷比无穷型"><a href="#无穷比无穷型" class="headerlink" title="无穷比无穷型"></a>无穷比无穷型</h4><ul>
<li>若函数$f(x)$和$g(x)$满足如下条件：</li>
</ul>
<ol>
<li>在$a$点收敛于无穷</li>
</ol>
<p>$$<br>\lim _{x \rightarrow a} f(x)=\infty , \lim _{x \rightarrow a} g(x)=\infty<br>$$</p>
<ol start="2">
<li>在点 $a$ 的某去心邻域内两者都可导，且 $g^{\prime}(x) \neq 0$</li>
<li>$\lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}=A\left(A\right.$ 可为实数，也可为$\left.\pm {\infty}\right),$ 则：</li>
</ol>
<p>$$<br>\lim _{x \rightarrow a} \frac{f(x)}{g(x)}=\lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}=A<br>$$</p>
<h3 id="其他不定式"><a href="#其他不定式" class="headerlink" title="其他不定式"></a>其他不定式</h3><ul>
<li>不定式极限还包括<ul>
<li>$0  \cdot \infty $</li>
<li>$1^\infty$</li>
<li>$0^0$</li>
<li>$\infty^0$</li>
<li>$\infty - \infty$</li>
</ul>
</li>
<li>经过简单变化，一般可以转化为零比零和无穷比无穷型的极限</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>注意:不能在数列形式下直接用洛必达法则,因为对于离散变量$n∈N $是无法求导数的</li>
<li>在运用洛必达法则之前，首先要完成两项任务：<ul>
<li>一是分子分母的极限是否都等于零(或者无穷大)；</li>
<li>二是分子分母在限定的区域内是否分别可导。</li>
</ul>
</li>
<li>如果这两个条件都满足，接着求导并判断求导之后的极限是否存在：<ul>
<li>如果存在，直接得到答案；</li>
<li>如果不存在，则说明此种未定式不可用洛必达法则来解决；</li>
<li>如果不确定，即结果仍然为未定式，再在验证的基础上继续使用洛必达法则。</li>
</ul>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.gaosan.com/gaokao/317487.html" target="_blank" rel="noopener">http://www.gaosan.com/gaokao/317487.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
      </categories>
      <tags>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 6 - 切比雪夫不等式</title>
    <url>/2021/03/30/math/probability/chebyshev-inequality/chebyshev-inequality/</url>
    <content><![CDATA[<blockquote>
<p>切比雪夫不等式可以使人们在随机变量X的分布未知的情况下，对事件$|X-\mu|&lt;\varepsilon $ 概率作出估计。</p>
</blockquote>
<a id="more"></a>

<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li>假设随机变量$X$具有期望$E(X)=\mu$， 方差 $Var(X)=\sigma^2$，则对于任意正数$\varepsilon$ ，有不等式成立：</li>
</ul>
<p>$$<br>\mathbb P{|X-\mu| \geq \varepsilon} \leq \frac{\sigma^{2}}{\varepsilon^{2}}<br>$$</p>
<h3 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h3><ul>
<li><p>其意义是：对于距离$E(X)$足够远的地方（距离大于等于$\varepsilon$），事件出现的概率是小于等于$\frac{\sigma^{2}}{\varepsilon^{2}}$ 。即事件出现在区间$[\mu-\varepsilon, \mu+\varepsilon]$ 的概率大于$1-\frac{\sigma^2}{\varepsilon^2}$ </p>
</li>
<li><p>该不等式给出了随机变量$X$在分布未知的情况下， 事件$|X-\mu| \leq \varepsilon$ 的下限估计</p>
<blockquote>
<p>例如：</p>
</blockquote>
<p>$$<br>\mathbb P{|X-\mu|\ &lt; 3 \sigma } \ge 1-\frac{1}{9}=\frac{8}{9}<br>$$</p>
</li>
<li><p>切比雪夫不等式刻画了变量偏离均值的程度与发生概率大小之间的关系</p>
</li>
<li><p>在随机变量分布未知的情况下，我们只知道均值和方差，切比雪夫不等式给出了$X$落入以均值为中心的$ε$邻域概率的概率下界</p>
</li>
</ul>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><h4 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h4><blockquote>
<p>利用取值范围建立不等式</p>
</blockquote>

$$
\begin{aligned}
\mathbb P\{|X-\mu| \geq \varepsilon\} &=\int_{|x-\mu| \geq \varepsilon} p(x) d x \\
&\leq \int_{|x-\mu| \geq \varepsilon} \frac{|x-\mu|^{2}}{\varepsilon^{2}} p(x) d x \\
& \leq \frac{1}{\varepsilon^{2}} \int_{-\infty}^{\infty}(x-\mu)^{2} p(x) d x\\
&=\frac{\sigma^{2}}{\varepsilon^{2}}
\end{aligned}
$$



<h4 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h4><blockquote>
<p>利用<a href="https://www.zywvvd.com/2021/03/30/math/probability/markov-inequality/markov-inequality/">马尔可夫不等式</a></p>
</blockquote>
<p>$$<br>\mathbb{P}(X \geq a) \leq \frac{\mathbb{E}(X)}{a}<br>$$</p>
<ul>
<li>将$|X-\mu|$作为随机变量带入不等式，有：</li>
</ul>
<p>$$<br>\mathbb P(|X-\mu| \ge \varepsilon) \leq \frac{E(|X-\mu|)}{\varepsilon}<br>$$</p>
<ul>
<li>其中$\varepsilon &gt; 0$，而：</li>
</ul>
<p>$$<br>\mathbb P(|X-\mu| \ge \varepsilon) = \mathbb P(|X-\mu|^2 \ge \varepsilon^2)<br>$$</p>
<ul>
<li>再次套用马尔可夫不等式：</li>
</ul>
<p>$$<br>\mathbb P(|X-\mu| \ge \varepsilon) =\mathbb P(|X-\mu|^2 \ge \varepsilon^2) \le \frac{E(|X-\mu|^2)}{\varepsilon^2}=\frac{\sigma^2}{\varepsilon^2}<br>$$</p>
<h3 id="推论——切比雪夫定理"><a href="#推论——切比雪夫定理" class="headerlink" title="推论——切比雪夫定理"></a>推论——切比雪夫定理</h3><ul>
<li>对于相互独立具有相同期望和方差的随机变量$X_i$，$\frac{1}{n}\sum\limits_{i = 1}^n  $的方差为：</li>
</ul>

$$
\frac{{Var(X)}}{n}=\frac{{{\sigma ^2}}}{n}
$$



<ul>
<li>那么当 $n \to \infty $时，$\frac{1}{n}\sum\limits_{i = 1}^n  $的方差$\to 0 $，对于任意给定的$\varepsilon &gt; 0$，根据切比雪夫不等式有：</li>
</ul>

$$
\lim _{n \rightarrow \infty} P\left\{\left|\frac{1}{n} \sum_{i=1}^{n} X_{i}-E\left(X_{i}\right)\right|<\varepsilon\right\}=1
$$



<ul>
<li>即当样本个数趋于无穷时，样本的算数平均值会收敛于理论均值</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://baike.baidu.com/item/%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/3647561?fromtitle=%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E4%B8%8D%E7%AD%89%E5%BC%8F&amp;fromid=8709330&amp;fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/3647561?fromtitle=%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E4%B8%8D%E7%AD%89%E5%BC%8F&amp;fromid=8709330&amp;fr=aladdin</a></li>
<li><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></li>
<li><a href="https://blog.csdn.net/ukakasu/article/details/82688413" target="_blank" rel="noopener">https://blog.csdn.net/ukakasu/article/details/82688413</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 5 - 马尔可夫不等式</title>
    <url>/2021/03/30/math/probability/markov-inequality/markov-inequality/</url>
    <content><![CDATA[<blockquote>
<p>马尔可夫不等式把概率关联到数学期望，给出了随机变量的累积分布函数一个宽泛但仍有用的界。</p>
</blockquote>
<a id="more"></a>

<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote>
<p>马尔可夫不等式用于估计尾事件的概率上界。</p>
</blockquote>
<ul>
<li>若随机变量$X$只取非负值，则$\forall a&gt;0$有：</li>
</ul>
<p>$$<br>\mathbb{P}(X \geq a) \leq \frac{\mathbb{E}(X)}{a}<br>$$</p>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><h4 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h4><blockquote>
<p>放大概率，得到部分函数期望</p>
<p>截断函数期望，二者相比较</p>
</blockquote>
<ul>
<li>考虑 $X\ge a$的情况 → $\frac {X}{a} \ge 1$</li>
<li>对于不等式左边有：</li>
</ul>
<p>$$<br>\mathbb P(X \geq a)=\int_{a}^{+\infty} f(x) d x \leq \int_{a}^{+\infty} \frac{X}{a} f(x) d x<br>$$</p>
<ul>
<li>对于不等式右边有：</li>
</ul>
<p>$$<br>E\left(\frac{X}{a}\right)=\int_{-\infty}^{a} \frac{X}{a} f(x) d x+\int_{a}^{+\infty} \frac{X}{a} f(x) d x<br>$$</p>
<ul>
<li>由于：</li>
</ul>
<p>$$<br>\int_{-\infty}^{a} \frac{X}{a} f(x) d x \geq 0<br>$$</p>
<ul>
<li>因此：</li>
</ul>
<p>$$<br>\mathbb P(X \geq a) \leq \int_{a}^{+\infty} \frac{X}{a} f(x) d x \leq E\left(\frac{X}{a}\right)<br>$$</p>
<ul>
<li>即：</li>
</ul>
<p>$$<br>\mathbb P(X \geq a) \leq E\left(\frac{X}{a}\right)=\frac{E(X)}{a}<br>$$</p>
<h4 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h4><blockquote>
<p>原始期望大于截断部分非负值的期望</p>
<p>求取期望时缩小$X$得到$a$</p>
</blockquote>
<p>$$<br>\begin{aligned}<br>\mathbb{E}(X) &amp;=\int_{-\infty}^{\infty} x f(x) d x \<br>&amp; \geq \int_{a}^{\infty} x f(x) d x \quad(a \geq 0) \<br>&amp; \geq \int_{a}^{\infty} a f(x) d x \<br>&amp;=a \int_{a}^{\infty} f(x) d x \<br>&amp;=a \mathbb{P}(X \geq a)<br>\end{aligned}<br>$$</p>
<h3 id="图示"><a href="#图示" class="headerlink" title="图示"></a>图示</h3><blockquote>
<p>$a$越大于均值，$X&gt;a$的概率越小</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210330100709.gif" alt="转自知乎-马同学"></p>
<h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><ul>
<li>将概率与期望联系起来建立了不等式关系</li>
<li>约束较松，可以用来粗略估计尾部事件</li>
</ul>
<blockquote>
<p>例如：</p>
<p>如果$X$是工资，那么$E(X)$就是平均工资，假设$a=n  E(X)$，即平均工资的$n$倍。那么根据马尔可夫不等式，不超过$1/n$的人会有超过平均工资的$n$倍的工资。</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://baike.baidu.com/item/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E4%B8%8D%E7%AD%89%E5%BC%8F/7565874?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E4%B8%8D%E7%AD%89%E5%BC%8F/7565874?fr=aladdin</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/27821324" target="_blank" rel="noopener">https://www.zhihu.com/question/27821324</a></p>
</li>
<li><p><a href="https://blog.csdn.net/ukakasu/article/details/82688413" target="_blank" rel="noopener">https://blog.csdn.net/ukakasu/article/details/82688413</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 4 - 协方差、相关系数、协方差矩阵</title>
    <url>/2021/03/27/math/probability/covariance/covariance/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍协方差。</p>
</blockquote>
<a id="more"></a>

<h3 id="协方差"><a href="#协方差" class="headerlink" title="协方差"></a>协方差</h3><blockquote>
<p>协方差表示的是两个变量的总体的<a href="https://baike.baidu.com/item/%E8%AF%AF%E5%B7%AE/738024" target="_blank" rel="noopener">误差</a>，这与只表示一个变量误差的<a href="https://baike.baidu.com/item/%E6%96%B9%E5%B7%AE/3108412" target="_blank" rel="noopener">方差</a>不同。 如果两个<a href="https://baike.baidu.com/item/%E5%8F%98%E9%87%8F/5271" target="_blank" rel="noopener">变量</a>的变化趋势一致，也就是说如果其中一个大于自身的期望值，另外一个也大于自身的期望值，那么两个变量之间的协方差就是正值。 如果两个变量的变化趋势相反，即其中一个大于自身的期望值，另外一个却小于自身的期望值，那么两个变量之间的协方差就是负值。 —— 百度百科</p>
</blockquote>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ul>
<li>在概率论和统计学中，协方差用于衡量两个变量的总体误差。而<a href="https://www.zywvvd.com/2021/03/27/math/probability/expectation-and-variance/variance/">方差</a>是协方差的一种特殊情况，即当两个变量是相同的情况。</li>
<li>期望值分别为$E[X]$与$E[Y]$的两个实随机变量$X$与$Y$之间的**协方差$Cov(X,Y)$定义为：</li>
</ul>

$$
\begin{aligned}
\operatorname{Cov}(X, Y) &=E[(X-E[X])(Y-E[Y])] \\
&=E[X Y]-2 E[Y] E[X]+E[X] E[Y] \\
&=E[X Y]-E[X] E[Y]
\end{aligned}
$$



<h4 id="相关系数"><a href="#相关系数" class="headerlink" title="相关系数"></a>相关系数</h4><ul>
<li>定义随机变量$X$与$Y$的相关系数：</li>
</ul>
<p>$$<br>\rho_{X Y}=\frac{\operatorname{Cov}[X, Y]}{\sqrt{\operatorname{Var}[X]} \sqrt{\operatorname{Var}[Y]}}<br>$$</p>
<ul>
<li>相关系数是协方差的归一化</li>
</ul>
<h4 id="与方差的关系"><a href="#与方差的关系" class="headerlink" title="与方差的关系"></a>与方差的关系</h4><ul>
<li>由定义可知：</li>
</ul>

$$
\begin{array}{c}
\operatorname{Cov}[X, Y]=\operatorname{Cov}[Y, X] \\
\operatorname{Cov}[X, X]=\operatorname{Var}[X] \\
\operatorname{Var}[X+Y]=\operatorname{Var}[X]+\operatorname{Var}[Y]+2 \operatorname{Cov}[X, Y]
\end{array}
$$



<h4 id="协方差的性质"><a href="#协方差的性质" class="headerlink" title="协方差的性质"></a>协方差的性质</h4><ul>
<li><p>$a, b$ 为常数，有：<br>$$<br>\operatorname{Cov}[a X, b Y]=a b \operatorname{Cov}[X, Y]<br>$$</p>
</li>
<li><p>变量和的协方差：</p>
</li>
</ul>
<p>$$<br>\operatorname{Cov}\left[X_{1}+X_{2}, Y\right]=\operatorname{Cov}\left[X_{1}, Y\right]+\operatorname{Cov}\left[X_{2}, Y\right]<br>$$</p>
<ul>
<li>连续变量的协方差：</li>
</ul>
<p>$$<br>\operatorname{Cov}[f(X), g(Y)]=\mathbb{E}[(f(X)-\mathbb{E}[f(X)])(g(Y)-\mathbb{E}[g(Y)])]<br>$$</p>
<ul>
<li>连续变量的协方差系数：</li>
</ul>
<p>$$<br>\rho[f(X), g(Y)]=\frac{\operatorname{Cov}[f(X), g(Y)]}{\sqrt{\operatorname{Var}[f(X)]} \sqrt{\operatorname{Var}[g(Y)]}}<br>$$</p>
<h4 id="协方差的物理意义"><a href="#协方差的物理意义" class="headerlink" title="协方差的物理意义"></a>协方差的物理意义</h4><ul>
<li><p>协方差的绝对值越大，说明两个随机变量都远离它们的均值</p>
</li>
<li><p>协方差为正，则说明两个随机变量同时趋向于取较大的值或者同时趋向于取较小的值</p>
</li>
<li><p>协方差为负，则说明一个随变量趋向于取较大的值，另一个随机变量趋向于取较小的值</p>
</li>
<li><p>两个随机变量的独立性可以导出协方差为零，但是两个随机变量的协方差为零无法导出独立性——<a href="https://www.zywvvd.com/2021/03/12/math/probability/orthogonal-independent-uncorrelation/orthogonal-independent-uncorrelation/">正交-不相关-独立</a></p>
<blockquote>
<p>因为独立性也包括：没有非线性关系</p>
<p>有可能两个随机变量是非独立的，但是协方差为零</p>
<p>如：假设随机变量 $X \sim U[-1,1]$。定义随机变量 的概率分布函数为：<br>$$<br>P(S=1)=\frac{1}{2} P(S=-1)=\frac{1}{2}<br>$$<br>定义随机变量 $Y=SX$，则随机变量$X,Y$是非独立的，但是有：<br>$$<br>Cov[X,Y]=0<br>$$</p>
</blockquote>
</li>
</ul>
<h4 id="相关系数的物理意义"><a href="#相关系数的物理意义" class="headerlink" title="相关系数的物理意义"></a>相关系数的物理意义</h4><blockquote>
<p>考虑以随机变量$X$的线性函数$a+bX$ 来近似表示$Y$。</p>
</blockquote>
<ul>
<li>均方误差，$e$为：</li>
</ul>
<p>$$<br>e=\mathbb{E}\left[(Y-(a+b X))^{2}\right]=\mathbb{E}\left[Y^{2}\right]+b^{2} \mathbb{E}\left[X^{2}\right]+a^{2}-2 b \mathbb{E}[X Y]+2 a b \mathbb{E}[X]-2 a \mathbb{E}[Y]<br>$$</p>
<ul>
<li>e取极小值，该优化问题为凸优化，直接求导为0即可：</li>
</ul>

$$
\left\{ \begin{array}{l}
\frac{{\partial e}}{{\partial a}} = 2a + 2b\mathbb{E}[X] - 2\mathbb{E}[Y] = 0\\
\frac{{\partial e}}{{\partial b}} = 2b\mathbb{E}[{X^2}] - 2\mathbb{E}[XY] + 2a\mathbb{E}[X] = 0
\end{array} \right.
$$


<ul>
<li>解得：</li>
</ul>

$$
\left\{ {\begin{array}{*{20}{c}}
{a = \mathbb{E}[Y] - \frac{{Cov[X,Y]}}{{Var[X]}}\mathbb{E}[X]}\\
{b = \frac{{Cov[X,Y]}}{{Var[X]}}}
\end{array}} \right.
$$


<ul>
<li>带入$e$得：</li>
</ul>
<p>$$<br>\min (e)=\mathbb{E}\left[\left(Y-\left(a_{0}+b_{0} X\right)\right)^{2}\right]=\left(1-\rho_{X Y}^{2}\right) \operatorname{Var}[Y]<br>$$</p>
<ul>
<li><p>因此有以下定理：</p>
<ul>
<li>$\left|\rho_{X Y}\right| \leq 1$</li>
<li>$|\rho_{X Y}| = 1$的充要条件为：存在常数$a,b$使得$Y=a+bX$ </li>
</ul>
</li>
<li><p>当$\left|\rho_{X Y}\right|$较大时， $e$较小，意味着随机变量$X$和$Y$联系较紧密。于是$\rho_{X Y}$ 是一个表征 $X$、$Y$之间线性关系紧密程度的量</p>
</li>
<li><p>当$\rho_{X Y}=0$时，称$X$和$Y$ 不相关。</p>
<ul>
<li>不相关是就线性关系来讲的，而相互独立是一般关系而言的。</li>
<li>相互独立一定不相关；不相关则未必独立。</li>
</ul>
</li>
</ul>
<h3 id="矩"><a href="#矩" class="headerlink" title="矩"></a>矩</h3><ul>
<li>设$X$和$Y$是随机变量：<ul>
<li>若$\mathbb{E}\left[X^{k}\right], k=1,2, \cdots$存在，则称它为$X$的$k$阶原点矩，简称$k$阶矩。</li>
<li>若$\mathbb{E}\left[(X-\mathbb{E}[X])^{k}\right], k=2,3, \cdots$存在，则称它为$X$的$k$阶中心矩。</li>
<li>若$\mathbb{E}\left[X^{k} Y^{l}\right], k, l=1,2, \cdots$存在，则称它为$X$的$Y$的$k+l$阶混合矩。</li>
<li>若$\mathbb{E}\left[(X-\mathbb{E}[X])^{k}(Y-\mathbb{E}[Y])^{l}\right], k, l=1,2, \cdots$存在，则称它为$X$的$Y$的$k+l$阶混合中心矩。</li>
</ul>
</li>
<li>期望是一阶原点矩</li>
<li>方差是二阶中心矩</li>
<li>协方差是二阶混合中心矩</li>
</ul>
<h3 id="协方差矩阵"><a href="#协方差矩阵" class="headerlink" title="协方差矩阵"></a>协方差矩阵</h3><ul>
<li>设$n$维随机变量$(X_1,X_2, \dots,X_n)$的二阶混合中心矩</li>
</ul>
<p>$$<br>c_{i j}=\operatorname{Cov}\left[X_{i}, X_{j}\right]=\mathbb{E}\left[\left(X_{i}-\mathbb{E}\left[X_{i}\right]\right)\left(X_{j}-\mathbb{E}\left[X_{j}\right]\right)\right]<br>$$</p>
<ul>
<li>都存在，则称矩阵：</li>
</ul>

$$
\mathbf{C}=\left[\begin{array}{cccc}
c_{11} & c_{12} & \cdots & c_{1 n} \\
c_{21} & c_{22} & \cdots & c_{2 n} \\
\vdots & \vdots & \ddots & \vdots \\
c_{n 1} & c_{n 2} & \cdots & c_{n n}
\end{array}\right]
$$


<ul>
<li>为$n$维随机变量$(X_1,X_2, \dots,X_n)$的协方差矩阵</li>
<li>由于$c_{ij} = c_{ji}$ 因此协方差矩阵是对称阵</li>
<li>由于对角线为各个变量的方差，因此对角线非负</li>
<li>通常$n$ 维随机变量的分布是不知道的，或者太复杂以致数学上不容易处理，因此实际中协方差矩阵非常重要。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></p>
</li>
<li><p><a href="https://baike.baidu.com/item/%E5%8D%8F%E6%96%B9%E5%B7%AE/2185936?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E5%8D%8F%E6%96%B9%E5%B7%AE/2185936?fr=aladdin</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 3 - 方差</title>
    <url>/2021/03/27/math/probability/expectation-and-variance/variance/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍方差。</p>
</blockquote>
<a id="more"></a>

<h3 id="方差"><a href="#方差" class="headerlink" title="方差"></a>方差</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>数学期望(mean)（或<a href="https://baike.baidu.com/item/%E5%9D%87%E5%80%BC/5922988" target="_blank" rel="noopener">均值</a>，亦简称期望）是试验中每次可能结果的<a href="https://baike.baidu.com/item/%E6%A6%82%E7%8E%87/828845" target="_blank" rel="noopener">概率</a>乘以其结果的总和，是最基本的<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%A6/107037" target="_blank" rel="noopener">数学</a>特征之一。它反映随机变量平均取值的大小。    ——百度百科</p>
</blockquote>
<ul>
<li>对随机变量$X$，若$\mathbb{E}\left[(X-\mathbb{E}[X])^{2}\right]$存在，则称它为$X$的方差，记作 $Var[X]$。</li>
<li>$X$的标准差为方差的开平方：$\sigma=\sqrt{\operatorname{Var}[X]}$<ul>
<li>方差度量了随机变量$X$与期望值偏离的程度，衡量了$X$取值分散程度的一个尺度。</li>
</ul>
</li>
<li>对于一个期望为$\mu$ ， 方差为$\sigma^2$的随机变量$X$ ，随机变量$X^{<em>}=\frac{X-\mu}{\sigma}$的数学期望为0，方差为1。 称$X^</em>$为$X$的标准化变量</li>
</ul>
<h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><ul>
<li>常数的方差恒为 0 </li>
<li>对常数$C$，有：</li>
</ul>
<p>$$<br>\operatorname{Var}[C X]=C^{2} \operatorname{Var}[X]<br>$$</p>
<ul>
<li>对两个随机变量$X,Y$，有： </li>
</ul>
<p>$$<br>\operatorname{Var}[X+Y]=\operatorname{Var}[X]+\operatorname{Var}[Y]+2 \mathbb{E}[(X-\mathbb{E}[X])(Y-\mathbb{E}[Y])]<br>$$</p>
<ul>
<li>当$X,Y$相互独立时，有：</li>
</ul>
<p>$$<br>\operatorname{Var}[X+Y]=\operatorname{Var}[X]+\operatorname{Var}[Y]<br>$$</p>
<ul>
<li>可以推广至任意有限多个相互独立的随机变量之和的情况。</li>
</ul>
<h4 id="样本方差的均值估计"><a href="#样本方差的均值估计" class="headerlink" title="样本方差的均值估计"></a>样本方差的均值估计</h4><blockquote>
<p>假设$X$为独立同分布的一组随机变量，总体为$M$，随机抽取$N$个随机变量构成一个样本，$\mathrm{E}\left(\mathrm{X}_{\mathrm{i}}\right)=\mu$和$\mathrm{D}\left(\mathrm{X}_{\mathrm{i}}\right)=\sigma^{2}$是总体的均值和方差, 是常数。    </p>
<p>$\overline{\mathrm{X}}, \mathrm{S}^{2}$是样本的均值和方差，由于样本是随机抽取的，$\overline{\mathrm{X}}, \mathrm{S}^{2}$也是随机的。</p>
<p>实际工作中，总体均数难以得到时，应用样本统计量代替总体参数。</p>
<p>我们接下来讨论用样本统计量代替总体样本参数会得到什么样的均值和方差结果。</p>
</blockquote>
<h5 id="样本均值-overline-mathrm-X"><a href="#样本均值-overline-mathrm-X" class="headerlink" title="样本均值$\overline{\mathrm{X}}$"></a>样本均值$\overline{\mathrm{X}}$</h5><ul>
<li>考虑$\overline{\mathrm{X}}$的均值：</li>
</ul>

$$
\mathrm{E}(\overline{\mathrm{X}})=\mathrm{E}\left(\frac{1}{\mathrm{n}} \sum_{\mathrm{i}=1}^{\mathrm{n}} \mathrm{X}_{\mathrm{i}}\right)=\frac{1}{\mathrm{n}} \sum_{\mathrm{i}=1}^{\mathrm{n}} \mathrm{E}\left(\mathrm{X}_{\mathrm{i}}\right)=\frac{1}{\mathrm{n}} \times \mathrm{nE}\left(\mathrm{X}_{\mathrm{i}}\right)=\mu
$$



<ul>
<li>考虑$\overline{\mathrm{X}}$的方差：</li>
</ul>

$$
\mathrm{D}(\overline{\mathrm{X}})=\mathrm{D}\left(\frac{1}{\mathrm{n}} \sum_{\mathrm{i}=1}^{\mathrm{n}} \mathrm{X}_{\mathrm{i}}\right)=\frac{1}{\mathrm{n}^{2}} \sum_{\mathrm{i}=1}^{\mathrm{n}} \mathrm{D}\left(\mathrm{X}_{\mathrm{i}}\right)=\frac{\sigma^{2}}{\mathrm{n}}
$$



<h5 id="样本方差-S-2"><a href="#样本方差-S-2" class="headerlink" title="样本方差$S^2$"></a>样本方差$S^2$</h5><ul>
<li>考虑$S^2$的均值：</li>
</ul>

$$
\begin{array}{l}
\mathrm{E}\left(\mathrm{S}^{2}\right)&=\mathrm{E}\left[\frac{1}{\mathrm{n}} \sum_{\mathrm{i}=1}^{\mathrm{n}}\left(\mathrm{X}_{\mathrm{i}}-\overline{\mathrm{X}}\right)^{2}\right]\\
&=\frac{1}{\mathrm{n}} \mathrm{E}\left[\sum_{\mathrm{i}=1}^{\mathrm{n}}\left(\mathrm{X}_{\mathrm{i}}^{2}-2 \mathrm{X}_{\mathrm{i}} \overline{\mathrm{X}}+\overline{\mathrm{X}}^{2}\right)\right] \\
&=\frac{1}{\mathrm{n}} \mathrm{E}\left[\sum_{\mathrm{i}=1}^{\mathrm{n}}\left(\mathrm{X}_{\mathrm{i}}^{2}\right)\right]-\frac{1}{\mathrm{n}} \mathrm{E}\left(2 \overline{\mathrm{X}} \times \mathrm{n} \overline{\mathrm{X}}-\mathrm{n} \overline{\mathrm{X}}^{2}\right)\\
&=\frac{1}{\mathrm{n}} \sum_{\mathrm{i}=1}^{\mathrm{n}} \mathrm{E}\left(\mathrm{X}_{i}^{2}\right)-\mathrm{E}\left(\overline{\mathrm{X}}^{2}\right) \\
\end{array}
$$



<ul>
<li>根据样本方差计算公式：</li>
</ul>
<p>$$<br>D({X_i}) = {E^2}({X_i}) - E(X_i^2) = {\sigma ^2}<br>$$</p>
<ul>
<li>得：</li>
</ul>
<p>$$<br>E(X_i^2) = {E^2}({X_i}) + {\sigma ^2} = {\mu ^2} + {\sigma ^2}<br>$$</p>
<ul>
<li>根据$\overline{\mathrm{X}}$的方差推导结果：</li>
</ul>

$$
\begin{array}{l}
{\rm{D}}(\overline {\rm{X}} ) = E({\overline {\rm{X}} ^2}) - {E^2}(\overline {\rm{X}} ) = \frac{{{\sigma ^2}}}{{\rm{n}}}\\
E({\overline {\rm{X}} ^2}) = {E^2}(\overline {\rm{X}} ) + \frac{{{\sigma ^2}}}{{\rm{n}}}=\mu^2+\frac{{{\sigma^2}}}{{\rm{n}}}
\end{array}
$$



<ul>
<li>将上述结果带入$E(S^2)$计算过程：</li>
</ul>

$$
\begin{array}{l}
{\rm{E}}\left( {{{\rm{S}}^2}} \right) &= \frac{1}{{\rm{n}}}\sum\limits_{{\rm{i}} = 1}^{\rm{n}} {\rm{E}} \left( {{\rm{X}}_i^2} \right) - {\rm{E}}\left( {{{\overline {\rm{X}} }^2}} \right)\\
 &= \frac{1}{n} \cdot n({\mu ^2} + {\sigma ^2}) - ({\mu ^2} + \frac{{{\sigma ^2}}}{{\rm{n}}})\\
 &= {\mu ^2} + {\sigma ^2} - {\mu ^2} - \frac{{{\sigma ^2}}}{{\rm{n}}}\\
 &= \frac{{n - 1}}{n}{\sigma ^2}
\end{array}
$$





<ul>
<li>也就是说样本方差的期望并不等于总体样本的方差，这个估计$E(S^2)$被称为样本方差的有偏估计</li>
<li>如果想求样本方差的无偏估计，需要乘上一个系数：</li>
</ul>
<p>$$<br>\frac{\mathrm{n}}{\mathrm{n}-1} \mathrm{~S}^{2}=\frac{1}{\mathrm{n}-1} \sum_{\mathrm{i}=1}^{\mathrm{n}}\left(\mathrm{X}_{\mathrm{i}}-\overline{\mathrm{X}}\right)^{2}=\sigma^2<br>$$</p>
<ul>
<li>其中：$n-1$为自由度，就是说，在一个容量为$n$的样本里，当确定了$n-1$个变量以后，第$n$个变量就确定了，因为样本均值是无偏的。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></p>
</li>
<li><p><a href="http://blog.sina.com.cn/s/blog_c96053d60101n24f.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_c96053d60101n24f.html</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 2 - 期望</title>
    <url>/2021/03/27/math/probability/expectation-and-variance/expectation/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍期望。</p>
</blockquote>
<a id="more"></a>

<h3 id="期望"><a href="#期望" class="headerlink" title="期望"></a>期望</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>数学期望(mean)（或<a href="https://baike.baidu.com/item/%E5%9D%87%E5%80%BC/5922988" target="_blank" rel="noopener">均值</a>，亦简称期望）是试验中每次可能结果的<a href="https://baike.baidu.com/item/%E6%A6%82%E7%8E%87/828845" target="_blank" rel="noopener">概率</a>乘以其结果的总和，是最基本的<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%A6/107037" target="_blank" rel="noopener">数学</a>特征之一。它反映随机变量平均取值的大小。    ——百度百科</p>
</blockquote>
<ul>
<li>期望描述了随机变量的平均情况，衡量了随机变量 的均值。它是概率分布的泛函（函数的函数）。</li>
</ul>
<h4 id="计算方法"><a href="#计算方法" class="headerlink" title="计算方法"></a>计算方法</h4><h5 id="离散型"><a href="#离散型" class="headerlink" title="离散型"></a>离散型</h5><ul>
<li>离散随机变量$X$的期望：</li>
</ul>
<p>$$<br>\mathbb{E}[X]=\sum_{i=1}^{\infty} x_{i} p_{i}<br>$$</p>
<ul>
<li>若右侧级数不收敛，则期望不存在。</li>
</ul>
<h5 id="连续型"><a href="#连续型" class="headerlink" title="连续型"></a>连续型</h5><ul>
<li>连续随机变量$X$的期望：</li>
</ul>
<p>$$<br>\mathbb{E}[X]=\int_{-\infty}^{\infty} x p(x) d x<br>$$</p>
<ul>
<li>若右侧级数不收敛，则期望不存在。</li>
</ul>
<h4 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h4><ul>
<li>定理：对于随机变量$ X$, 设 $ Y=g(X) $ 也为随机变量,$ g(\cdot) $ 是连续函数。</li>
</ul>
<h5 id="离散型-1"><a href="#离散型-1" class="headerlink" title="离散型"></a>离散型</h5><ul>
<li>若$ X$为离散随机变量，若$ Y$的期望存在，则：</li>
</ul>
<p>$$<br>\mathbb{E}[Y]=\mathbb{E}[g(X)]=\sum_{i=1}^{\infty} g\left(x_{i}\right) p_{i}<br>$$</p>
<ul>
<li>也记作：</li>
</ul>

$$
\mathbb{E}_{X \sim P(X)}[g(X)]=\sum_{x} g(x) p(x)
$$



<h5 id="连续型-1"><a href="#连续型-1" class="headerlink" title="连续型"></a>连续型</h5><ul>
<li>若$ X$为连续随机变量，若$ Y$的期望存在，则：</li>
</ul>
<p>$$<br>\mathbb{E}[Y]=\mathbb{E}[g(X)]=\int_{-\infty}^{\infty} g(x) p(x) d x<br>$$</p>
<ul>
<li>也记作：</li>
</ul>
<p>$$<br>\mathbb{E}_{X \sim P(X)}[g(X)]=\int g(x) p(x) d x<br>$$</p>
<h5 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h5><ul>
<li>该定理的意义在于：当求$\mathbb{E}[Y]$ 时，不必计算出$Y$的分布，只需要利用$X$的分布即可。</li>
<li>该定理可以推广至两个或两个以上随机变量的情况。</li>
</ul>
<h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><ul>
<li><p>常数的期望就是常数本身</p>
</li>
<li><p>对常数$C$有 ：<br>$$<br>\mathbb{E}[C X]=C \mathbb{E}[X]<br>$$</p>
</li>
<li><p>对两个随机变量 $X,Y$，有：</p>
</li>
</ul>
<p>$$<br>\mathbb{E}[X+Y]=\mathbb{E}[X]+\mathbb{E}[Y]<br>$$</p>
<blockquote>
<p>该结论可以推广到任意有限个随机变量之和的情况</p>
</blockquote>
<ul>
<li>对两个相互独立的随机变量，有：</li>
</ul>
<p>$$<br>\mathbb{E}[X Y]=\mathbb{E}[X] \mathbb{E}[Y]<br>$$</p>
<blockquote>
<p>该结论可以推广到任意有限个相互独立的随机变量之积的情况</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 软件推荐 - 小黄条 全平台同步桌面便签</title>
    <url>/2021/03/25/software/recommend/Windows/xiaohuangtiao-win-software/xiaohuangtiao-win-software/</url>
    <content><![CDATA[<blockquote>
<p>这是一款嵌入电脑桌面的Todolist工具，大小2.1M，也是免安装直接使用的，<strong>类似于电脑上的“便利贴”</strong>。</p>
</blockquote>
<a id="more"></a>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>每天的工作任务有很多，这个时候该如何有序的安排呢？「小黄条」将手机和电脑同步，自定义一个桌面便利贴，记录和标注待办事项，字体颜色和风格都可以自行设置。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20210325011146.png"></p>
<ul>
<li>全平台同步简直是直击灵魂深处的需求</li>
<li>如果邀请了6个小伙伴点你的链接，可以以年费12元享受一年数据同步服务，不然得96</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210325011333.png"></p>
<h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><ul>
<li>官网下载：<a href="https://www.yynote.cn/" target="_blank" rel="noopener">https://www.yynote.cn/</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>软件推荐</category>
        <category>Windows 软件推荐</category>
      </categories>
      <tags>
        <tag>软件</tag>
        <tag>软件推荐</tag>
        <tag>Windows 软件推荐</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 软件推荐 - listary —— Windows 上的高效启动器</title>
    <url>/2021/03/25/software/recommend/Windows/listary-win-software/listary-win-software/</url>
    <content><![CDATA[<blockquote>
<p>如果你的日常工作需要经常处理邮件，你一定会为保存附件时，从我的电脑到X盘再一级一级的目录打开，直到找到你所想要的目录。这种频繁的文件夹点击将会极大的制约你的效率。本文介绍Windows快速启动神器 listary 。</p>
</blockquote>
<a id="more"></a>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>Windows虽以可视化所见即所得著称，系统不停的升级，但是核心的文档操作方式和方法并没有显著的改善，所以频繁双击、查找、另存都是系统的一个硬伤。</p>
</blockquote>
<ul>
<li>Listary首先是一款超高效的全局搜索软件。最常用的是搜索已安装的应用和寻找任何的文件、文件夹。</li>
<li>比如你要快速打开一个cmd，只需要用快捷键 <code>ctrl ctrl</code>调用Listary，输入“cmd”立马出现，类似地启动程序再也不用挨个翻找快接方式了</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210325011751.png"></p>
<ul>
<li>文件也可以快速定位</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210325012026.png"></p>
<h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><ul>
<li>官网：<a href="https://www.listary.com/" target="_blank" rel="noopener">https://www.listary.com/</a></li>
<li>下载地址：<a href="https://www.listary.com/download" target="_blank" rel="noopener">https://www.listary.com/download</a></li>
<li>下载链接：<a href="https://www.listary.com/download/Listary.exe?version=5.00.2843" target="_blank" rel="noopener">https://www.listary.com/download/Listary.exe?version=5.00.2843</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>软件推荐</category>
        <category>Windows 软件推荐</category>
      </categories>
      <tags>
        <tag>软件</tag>
        <tag>软件推荐</tag>
        <tag>Windows 软件推荐</tag>
      </tags>
  </entry>
  <entry>
    <title>SVM 的推导</title>
    <url>/2021/03/24/machine_learning/about-svm/about-svm/</url>
    <content><![CDATA[<blockquote>
<p>SVM（Support Vector Machine，支持向量机）是一个线性分类器，是最经典的分类算法，其核心目标就是找到最大间隔超平面。本文记录SVM的推导过程。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>SVM就是一个分类器，只是相对于传统的线性分类器，它添加了一个支持向量的概念。</p>
</blockquote>
<ul>
<li>考虑一个分类任务</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210324120914.gif"></p>
<blockquote>
<p>从图片上解释，对于一组数据，SVM在使用直线的同时要求数据点距离这条直线的最小距离最大，也就是说分类器和数据之间要有足够大的“间隔”。这样做的好处是很明显的，越大的“间隔”代表了更大的转圜空间，在得到新的数据之后更容易将其正确分类。</p>
<p>而SVM的工作就是求解这个最大间隔，也就是最优化问题。对于线性可分的数据，可以直接套用线性规划的知识进行推导，但如果数据线性不可分，就需要核函数进行数据升维，进行超平面分类。</p>
</blockquote>
<h3 id="目标函数"><a href="#目标函数" class="headerlink" title="目标函数"></a>目标函数</h3><blockquote>
<p>SVM是一个线性分类器，SVM的目标就是找到最大间隔超平面。</p>
</blockquote>
<ul>
<li>定义任意的超平面函数为：</li>
</ul>
<p>$$<br>\bf{w}^{T} \bf{x}+b=0<br>$$</p>
<ul>
<li>二维空间点$(x,y)$到直线$Ax+By+C=0$的距离为：</li>
</ul>
<p>$$<br>\frac{|A x+B y+C|}{\sqrt{A^{2}+B^{2}}}<br>$$</p>
<ul>
<li>扩展到$k$维空间后，点$X=(x_1,x_2,\dots,x_k)$到超平面$w^{T} x+b=0$距离为：</li>
</ul>
<p>$$<br>\frac{\left|\bf{w}^{T} \bf{x}+b\right|}{|\bf{w}|}<br>$$</p>
<ul>
<li>其中：</li>
</ul>
<p>$$<br>|\bf{w}|=\sqrt{w_{1}^{2}+\ldots w_{n}^{2}}<br>$$</p>
<ul>
<li>我们希望这个超平面可以区分不同两类数据特征，这个分类决策函数就是：</li>
</ul>
<p>$$<br>f(x)=\operatorname{sign}\left(\bf{w}^T\bf{x}+b\right)<br>$$</p>
<ul>
<li>我们的数据为$({{\bf{x}}_i},{y_i}),i \in \{ 1,2, \ldots ,n\},y_i \in \{1,-1\} $，定义点$({{\bf{x}}_i},{y_i}) $到超平面的函数距离$\hat{\gamma}_{i}$：</li>
</ul>

$$
\hat{\gamma}_{i}=y_{i}\left(\bf{w} \cdot \bf{x}_{i}+b\right)
$$


<ul>
<li>而我们的目标是找到可以最大化数据到点几何距离的超平面，将几何距离用${\gamma}_{i}$表示，为：</li>
</ul>

$$
\gamma_{i}=|\frac{\bf{w}}{\|\bf{w}\|} \cdot \bf{x}_{i}+\frac{b}{\|\bf{w}\|}|=\frac{|\bf{w}^T\bf{x}_i+b|}{\|\bf{w}\|}=\frac{y_{i}\left(\bf{w} \cdot \bf{x}_{i}+b\right)}{\|\bf{w}\|}=\frac{\hat{\gamma}_{i}}{\|\bf{w}\|}
$$


<ul>
<li>因此优化函数为：</li>
</ul>

$$
\begin{array}{*{20}{l}}
{\mathop {\max }\limits_{{\bf{w}},b} }&\gamma \\
{{\rm{ s}}{\rm{.t}}{\rm{. }}}&{{y_i}\left( {\frac{{\bf{w}}}{{{||\bf{w}||}}} \cdot {x_i} + \frac{b}{{{||\bf{w}||}}}} \right) \ge \gamma ,\quad i = 1,2, \cdots ,n}
\end{array}
$$


<ul>
<li>根据已有结论可以将优化函数转化为：</li>
</ul>

$$
\begin{array}{*{20}{l}}
{\mathop {\max }\limits_{{\bf{w}},b} }&{\frac{{{{\hat \gamma }_i}}}{{{||\bf{w}||}}}}\\
{{\rm{s}}.{\rm{t}}.}&{{y_i}\left( {{\bf{w}} \cdot {x_i} + b} \right) \ge {{\hat \gamma }_i},\quad i = 1,2, \cdots ,n}
\end{array}
$$


<ul>
<li>事实上函数间隔${\hat \gamma }$并不影响最优化问题的解，假设将$\bf{w}$和$b$成倍的改变为$a\bf{w}，ab$，那么函数间隔也会相应变成$a{\hat \gamma }$，因此为简便，我们取 ${\hat \gamma }=1$，因此优化函数为最大化$1/||\bf{w}||$，这等价于最小化$||\bf{w}||$，考虑到求导方便，我们最小化$1/2||\bf{w}||^2$</li>
<li>优化函数最终为：</li>
</ul>

$$
\begin{array}{*{20}{l}}
{\mathop {\min }\limits_{{\bf{w}},b} }&{\frac{1}{2}||{\bf{w}}|{|^2}}\\
{{\rm{s}}.{\rm{t}}.}&{{y_i}\left( {{\bf{w}} \cdot {{\bf{x}}_i} + b} \right) - 1 \ge 0,\quad i = 1,2, \cdots ,n}
\end{array}
$$


<h3 id="拉格朗日对偶求极值"><a href="#拉格朗日对偶求极值" class="headerlink" title="拉格朗日对偶求极值"></a>拉格朗日对偶求极值</h3><ul>
<li>写成拉格朗日优化的格式：</li>
</ul>

$$
\begin{array}{*{20}{l}}
{\mathop {\min }\limits_{{\bf{w}},b} }&{\frac{1}{2}||{\bf{w}}|{|^2}}\\
{{\rm{s}}.{\rm{t}}.}&1-{{y_i}\left( {{\bf{w}} \cdot {{\bf{x}}_i} + b} \right) \le 0,\quad i = 1,2, \cdots ,n}
\end{array}
$$


<ul>
<li>拉格朗日方程：</li>
</ul>

$$
L({\bf{w}},b,{\bf{\alpha }}) = \frac{1}{2}||{\bf{w}}|{|^2} + \sum\limits_{i = 1}^n {{\alpha _i}(1 - {y_i}\left( {{\bf{w}} \cdot {{\bf{x}}_i} + b} \right)} )
$$


<ul>
<li>原始问题为凸优化问题，我们按照KKT条件求解该问题的对偶问题，即可根据强对偶条件获得原始问题的解</li>
<li>对偶问题为：</li>
</ul>

$$
\mathop {max}\limits_{\bf{\alpha }} D({\bf{\alpha }}) = \mathop {max}\limits_{\bf{\alpha }} \mathop {\min }\limits_{{\bf{w}},b} L({\bf{w}},b,{\bf{\alpha }})
$$




<ul>
<li>先求最小化极值问题 $\mathop {\min }\limits_{{\bf{w}},b} L({\bf{w}},b,{\bf{\alpha }})$：</li>
</ul>

$$
\left\{ {\begin{array}{*{20}{c}}
{\frac{{\partial {\rm{L}}}}{{\partial {\bf{w}}}} = 0}\\
{\frac{{\partial {\rm{L}}}}{{\partial b}} = 0}
\end{array}} \right.
$$


<ul>
<li>解得：</li>
</ul>

$$
\left\{ {\begin{array}{*{20}{c}}
{{\bf{w}} = \sum\limits_{i = 1}^n {{\alpha _i}{y_i}{{\bf{x}}_i}} }\\
{\sum\limits_{i = 1}^n {{\alpha _i}{y_i} = 0} }
\end{array}} \right.
$$


<ul>
<li>带入$L({\bf{w}},b,{\bf{\alpha }})$得：</li>
</ul>

$$
\begin{aligned}
L(\bf{w}, b, \bf{\alpha}) &=\frac{1}{2}\|\bf{w}\|^{2}+\sum_{i=1}^{n} \alpha_{i}\left[1-y_{i}\left(\bf{w}^{T} x_{i}+b\right)\right] \\
&=\frac{1}{2} \bf{w}^{T} \bf{w}-\bf{w}^{T} \sum_{i=1}^{n} \alpha_{i} y_{i} x_{i}-b \sum_{i=1}^{n} \alpha_{i} y_{i}+\sum_{i=1}^{n} \alpha_{i} \\
&=\frac{1}{2} \bf{w}^{T} \sum_{i=1}^{n} \alpha_{i} y_{i} x_{i}-\bf{w}^{T^{\prime}} \sum_{i=1}^{n} \alpha_{i} x_{i} y_{i}-b * 0+\sum_{i=1}^{n} \alpha_{i} \\
&=\sum_{i=1}^{n} \alpha_{i}-\frac{1}{2}\left(\sum_{i=1}^{n} \alpha_{i} y_{i} x_{i}\right)^{T} \sum_{i=1}^{n} \alpha_{i} y_{i} x_{i} \\
&=\sum_{i=1}^{n} \alpha_{i}-\frac{1}{2} \sum_{i, j=1}^{n} \alpha_{i} \alpha_{j} y_{i} y_{j} x_{i}^{T} x_{j}
\end{aligned}
$$


<ul>
<li>此时我们需要解决的优化问题是：</li>
</ul>

$$
\begin{array}{*{20}{c}}
{\mathop {\max }\limits_{\bf{\alpha }} \sum\limits_{i = 1}^n {{\alpha _i}}  - \frac{1}{2}\sum\limits_{i,j = 1}^n {{\alpha _i}} {\alpha _j}{y_i}{y_j}{\bf{x}}_i^T{{\bf{x}}_j}}\\
{\qquad \begin{array}{*{20}{c}}
{{\rm{ s}}{\rm{.t}}{\rm{. }}{\alpha _i} \ge 0,\quad i = 1,2, \ldots ,n}\\
{\sum\limits_{i = 1}^n {{\alpha _i}} {y_i} = 0}
\end{array}}
\end{array}
$$


<ul>
<li><p>可以看到通过拉格朗日对偶，我们将原始拉格朗日方程$k+1+n$个未知数、$n$个复杂不等式约束条件的优化问题转换为了$n$个未知数，1个等式约束的问题，当然满足KKT条件是前提</p>
</li>
<li><p>对于这个问题，我们有更高效的优化算法，即序列最小优化（SMO）算法。我们通过这个优化算法能得到$\bf{α}$，再根据$\bf{α}$，我们就可以求解出$\bf{w}$和$b$，进而求得我们最初的目的：找到超平面，即”决策平面”。</p>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://www.jianshu.com/p/0f8f9d52abcf" target="_blank" rel="noopener">https://www.jianshu.com/p/0f8f9d52abcf</a></p>
</li>
<li><p><a href="https://www.pianshen.com/article/15821257925/" target="_blank" rel="noopener">https://www.pianshen.com/article/15821257925/</a></p>
</li>
<li><p><a href="https://blog.csdn.net/qq_40778406/article/details/79879434" target="_blank" rel="noopener">https://blog.csdn.net/qq_40778406/article/details/79879434</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>从服务器映射 jupyter 到本机应用</title>
    <url>/2021/03/22/python/jupyter-map/jupyter-map/</url>
    <content><![CDATA[<blockquote>
<p>Jupyter Notebook是基于网页的用于交互计算的应用程序，方便易用，本文记录将远程jupyter环境映射到本机的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>Jupyter Notebook是基于网页的用于交互计算的应用程序。其可被应用于全过程计算：开发、文档编写、运行代码和展示结果。——<a href="https://link.jianshu.com/?t=https://jupyter-notebook.readthedocs.io/en/stable/notebook.html" target="_blank" rel="noopener">Jupyter Notebook官方介绍</a></p>
</blockquote>
<p>简而言之，Jupyter Notebook是以网页的形式打开，可以在网页页面中<strong>直接</strong>编写代码和运行代码，代码的运行结果也会直接在代码块下显示。如在编程过程中需要编写说明文档，可在同一个页面中直接编写，便于作及时的说明和解释。</p>
<h3 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h3><ul>
<li>在服务器启动docker</li>
<li>在docker容器中启动jupyter服务</li>
<li>映射到本机浏览器实际使用</li>
</ul>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><blockquote>
<p>本质其实仅仅是端口映射</p>
</blockquote>
<ul>
<li>将docker端口映射到服务器指定端口</li>
<li>从本机访问服务器的指定端口并填入token即可</li>
</ul>
<h3 id="具体方法"><a href="#具体方法" class="headerlink" title="具体方法"></a>具体方法</h3><h4 id="创建docker时映射端口"><a href="#创建docker时映射端口" class="headerlink" title="创建docker时映射端口"></a>创建docker时映射端口</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nvidia-docker run -it --name vvd --shm-size=15g -p 4832:4832 -v /home:/workspace vvd_image bash</span><br></pre></td></tr></table></figure>

<h4 id="在docker启动jupyter服务"><a href="#在docker启动jupyter服务" class="headerlink" title="在docker启动jupyter服务"></a>在docker启动jupyter服务</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">jupyter notebook --allow-root --no-browser --ip 0.0.0.0 --port 4832 --notebook-dir /workspace/nfs/vvd_jupyter_lab/</span><br></pre></td></tr></table></figure>

<ul>
<li><p>返回访问地址：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:4832&#x2F;?token&#x3D;34d2fd23fxxxx3241cb6519ccab7d66cad355ee2xxxxxxx</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="在本机访问地址"><a href="#在本机访问地址" class="headerlink" title="在本机访问地址"></a>在本机访问地址</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&#123;remote ip&#125;:4832&#x2F;?token&#x3D;34d2fd23fxxxx3241cb6519ccab7d66cad355ee2xxxxxxx</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.jianshu.com/p/91365f343585" target="_blank" rel="noopener">https://www.jianshu.com/p/91365f343585</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>jupyter</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>jupyter</tag>
      </tags>
  </entry>
  <entry>
    <title>拉格朗日对偶问题</title>
    <url>/2021/03/19/machine_learning/lagrangian-duality/lagrangian-duality/</url>
    <content><![CDATA[<blockquote>
<p>在前文了解过拉格朗日乘数法后，进一步介绍拉格朗日对偶。</p>
</blockquote>
<a id="more"></a>

<h3 id="背景信息"><a href="#背景信息" class="headerlink" title="背景信息"></a>背景信息</h3><blockquote>
<p>在约束最优化问题中，常常利用拉格朗日对偶性（Lagrange duality）将原始问题转换为对偶问题，通过解对偶问题而得到原始问题的解。</p>
</blockquote>
<ul>
<li>拉格朗日对偶是在<a href="https://www.zywvvd.com/2021/03/13/machine_learning/lagrange-multiplier/lagrange-multiplier/">拉格朗日乘数法</a>基础之上，通过变换原始问题的求解形式得到的相对于原始优化问题的另一个优化问题</li>
</ul>
<h4 id="原始优化问题"><a href="#原始优化问题" class="headerlink" title="原始优化问题"></a>原始优化问题</h4><blockquote>
<p>假设$f(x)$, $c_i(x)$, $h_j(x)$ 是定义在$\mathbf{R}^{n}$上的连续可微函数，考虑约束最优化问题：</p>
</blockquote>

$$
\begin{array}{c}
\min _{x \in \mathbf{R}^{n}} f(x)  \\
\text { s.t. } \quad h_{i}(x) \leq 0, i=1,2, \ldots, k \\
g_{j}(x)=0, j=1,2, \ldots, l
\end{array}\tag{1} \label{eq1}
$$



<ul>
<li>定义此问题为原始优化问题</li>
</ul>
<h4 id="广义拉格朗日函数"><a href="#广义拉格朗日函数" class="headerlink" title="广义拉格朗日函数"></a>广义拉格朗日函数</h4><blockquote>
<p>来源见 ：<a href="https://www.zywvvd.com/2021/03/13/machine_learning/lagrange-multiplier/lagrange-multiplier/">拉格朗日乘数法</a></p>
</blockquote>
<p>$$<br>L(x, \alpha, \beta)=f(x)+\sum_{i=1}^{k} \alpha_{i} h_{i}(x)+\sum_{j=1}^{l} \beta_{j} g_{j}(x)\tag{2} \label{eq2}<br>$$</p>
<ul>
<li>其中 $x=\left(x_1, x_2, \ldots, x_n\right)^{T} \in \mathbf{R}^{n} , \alpha_{i}, \beta_{j}$是拉格朗日乘子，且$\alpha_{i} \geq 0$</li>
</ul>
<h3 id="拉格朗日对偶的来源"><a href="#拉格朗日对偶的来源" class="headerlink" title="拉格朗日对偶的来源"></a>拉格朗日对偶的来源</h3><blockquote>
<p>考虑原始优化问题$\eqref{eq1}$</p>
</blockquote>
<ul>
<li>想要求得$f(x)$的最小值，也就是要求$f(x)$的最大下界</li>
<li>对于方程组：</li>
</ul>
<p>$$<br>\begin{array}{l}<br>f(\mathbf{x})&lt;v \\<br>h_{i}(\mathbf{x}) \leq 0, i=1,2, \ldots, k<br>\end{array} \tag{3} \label{eq3}<br>$$</p>
<ul>
<li>若方程组$\eqref{eq3}$无解，则$v$是$f(x)$的一个下界，也就是说如果有渠道可以利用到方程组$\eqref{eq3}$无解，则可以利用其限制$f(x)$的下界</li>
<li>注意到若方程组$\eqref{eq3}$有解，可以推出对于任意$\lambda \ge 0$：</li>
</ul>
<p>$$<br>f(\mathbf{x})+\sum_{i=1}^{k} \lambda_{i} h_{i}(\mathbf{x})&lt;v   \tag{4}   \label{eq4}<br>$$</p>
<ul>
<li>方程$\eqref{eq4}$有解</li>
<li>即命题：**<em>if</em> 方程组$\eqref{eq3}$有解 <em>then</em> 方程$\eqref{eq4}$有解** 成立</li>
<li>则其逆否命题 **<em>if</em> 方程$\eqref{eq4}$无解 <em>then</em>  方程组$\eqref{eq3}$无解 ** 成立</li>
<li>而 <strong>方程$\eqref{eq4}$无解</strong> 的充要（等价）条件是：</li>
</ul>

$$
\min _{ \mathbf{x} } f ( \mathbf {x} ) + \sum _ { i=1 } ^ {k} \lambda_{i} g_{i} ( \mathbf {x}) \geq v \tag{5} \label{eq5}
$$



<ul>
<li>方程$\eqref{eq5}$的自变量为$\lambda_i$，我们的目标是要找到其上界$v_{max}$，因此有：</li>
</ul>

$$
v_{max}=\max _{\boldsymbol{\lambda} \geq \mathbf{0}} \min _{\mathbf{x}} f(\mathbf{x})+\sum_{i=1}^{k} \lambda_{i} g_{i}(\mathbf{x}) \tag{6} \label{eq6}
$$



<ul>
<li>方程$\eqref{eq6}$即为拉格朗日对偶问题的核心，延续原始问题的标记，记为：</li>
</ul>

$$
\mathop {\max }\limits_{\alpha  \cdot \beta ;{\alpha _i} \ge 0}D(\alpha ,\beta ) = \mathop {\max }\limits_{\alpha  \cdot \beta ;{\alpha _i} \ge 0} \mathop {\min }\limits_x L(x,\alpha ,\beta )\tag{7} \label{eq7}
$$



<blockquote>
<p>可以说对偶问题就是从另一个方向逼近$f(x)$最小值的问题</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210324150300.gif"></p>
<h3 id="对偶问题的性质"><a href="#对偶问题的性质" class="headerlink" title="对偶问题的性质"></a>对偶问题的性质</h3><blockquote>
<p>之所以引入另一个优化问题是因为对偶问题之间有着良好的性质</p>
</blockquote>
<ul>
<li>对偶问题的对偶是原问题；</li>
<li>无论原始问题是否是凸的，对偶问题都是凸优化问题；</li>
<li>对偶问题可以给出原始问题一个下界；</li>
<li>当满足一定条件时，原始问题与对偶问题的解是完全等价的；</li>
</ul>
<h3 id="拉格朗日对偶问题的凹函数性质证明"><a href="#拉格朗日对偶问题的凹函数性质证明" class="headerlink" title="拉格朗日对偶问题的凹函数性质证明"></a>拉格朗日对偶问题的凹函数性质证明</h3><h4 id="按照定义"><a href="#按照定义" class="headerlink" title="按照定义"></a>按照定义</h4><blockquote>
<p>对偶问题有一个很好的性质是对偶函数为凹函数，证明如下</p>
</blockquote>
<ul>
<li>命题 <strong>拉格朗日对偶函数一定是凹函数，且其凹性与最优化函数和约束函数无关。</strong></li>
<li>考虑对偶问题$\eqref{eq7}$，按照凹函数定义，往证：</li>
</ul>
<p>$$<br>D(\theta {\alpha _1} + (1 - \theta ){\alpha _2},\theta {\beta _1} + (1 - \theta ){\beta _2}) \ge \theta D({\alpha _1},{\beta _1}) + (1 - \theta )D({\alpha _2},{\beta _2}) \tag{8} \label{eq8}<br>$$</p>
<ul>
<li>有：</li>
</ul>

$$
\begin{array}{l}
&D(\theta {\alpha _1} + (1 - \theta ){\alpha _2},\theta {\beta _1} + (1 - \theta ){\beta _2}) \\
&= \mathop {\min }\limits_x L(x,\theta {\alpha _1} + (1 - \theta ){\alpha _2},\theta {\beta _1} + (1 - \theta ){\beta _2})\\
 &= \mathop {\min }\limits_x (f(x) + \sum\limits_{i = 1}^k {(\theta {\alpha _{1,i}} + (1 - \theta ){\alpha _{2,i}})} {h_i}(x) + \sum\limits_{j = 1}^l {(\theta {\beta _{1,j}} + (1 - \theta ){\beta _{2,j}})} {g_j}(x)\\
 &= \mathop {\min }\limits_x (\theta (f(x) + \sum\limits_{i = 1}^k {{\alpha _{1,i}}} {h_i}(x) + \sum\limits_{j = 1}^l {{\beta _{1,j}}} {g_j}(x)) + (1 - \theta )(f(x) + \sum\limits_{i = 1}^k {{\alpha _{2,i}}} {h_i}(x) + \sum\limits_{j = 1}^l {{\beta _{2,j}}} {g_j}(x)))\\
 &\ge \theta \mathop {\min }\limits_x (f(x) + \sum\limits_{i = 1}^k {{\alpha _{1,i}}} {h_i}(x) + \sum\limits_{j = 1}^l {{\beta _{1,j}}} {g_j}(x)) + (1 - \theta )\mathop {\min }\limits_x (f(x) + \sum\limits_{i = 1}^k {{\alpha _{2,i}}} {h_i}(x) + \sum\limits_{j = 1}^l {{\beta _{2,j}}} {g_j}(x))\\
 &= \theta D({\alpha _1},{\beta _1}) + (1 - \theta )D({\alpha _2},{\beta _2})
\end{array} \tag{9} \label{eq9}
$$



<ul>
<li><p>其中$\eqref{eq9}$的不等式来源于：</p>
<ul>
<li>对于实数集合$\bf{a},\bf{b}$：</li>
</ul>

  $$
  \begin{array}{l}
  a=\left\{a_{1}, a_{2}, \cdots, a_{n}\right\} \\
  b=\left\{b_{1}, b_{2}, \cdots, b_{n}\right\}
  \end{array} \tag{10}
  $$

  

<ul>
<li>对于任意$i$，有：</li>
</ul>

  $$
  \mathop {\min }\limits_i \left\{ {{a_i} + {b_i}} \right\} \ge \min \{ {\bf{a}}\}  + \min \{ {\bf{b}}\} ,\quad i \in {N^ + } \tag{11}
  $$
  
</li>
<li><p>原命题得证。</p>
</li>
</ul>
<h4 id="仿射函数"><a href="#仿射函数" class="headerlink" title="仿射函数"></a>仿射函数</h4><blockquote>
<p>另一种思路是讨论$\eqref{eq2}$的后两项内容</p>
</blockquote>
<ul>
<li>因为对偶问题中$x$视作常数，$\alpha,\beta$为自变量，可以视作：</li>
</ul>

$$
\begin{array}{l}
D(\alpha ,\beta {\rm{|x}}) &= f(x) + \sum\limits_{i = 1}^k {{\alpha _i}} {h_i}(x) + \sum\limits_{j = 1}^l {{\beta _j}} {g_j}(x)\\
 &= A + \sum\limits_{i = 1}^k {{\alpha _i}} {B_i} + \sum\limits_{j = 1}^l {{\beta _j}} {C_j}
 \end{array} \tag{12}
$$



<ul>
<li>因此$D(\alpha, \beta)$是调整常数$A,B,C$的仿射函数，仿射函数<strong>既凸且凹</strong>，因此拉格朗日对偶问题具有凹函数性质</li>
</ul>
<h3 id="拉格朗日对偶"><a href="#拉格朗日对偶" class="headerlink" title="拉格朗日对偶"></a>拉格朗日对偶</h3><h4 id="原始问题"><a href="#原始问题" class="headerlink" title="原始问题"></a>原始问题</h4><ul>
<li>考虑$x$的函数：</li>
</ul>

$$
P(x)=\max _{\alpha, \beta ; \alpha_{i} \geq 0} L(x, \alpha, \beta) \tag{13}
$$



<blockquote>
<p>这里，$P$表示原始问题。将上式看做$x$ 的函数。</p>
<p>等式右边可以看做固定$x$ 的情况下，求关于$\alpha, \beta$的函数 $L $的最大值的问题。</p>
</blockquote>
<ul>
<li>可以推出：</li>
</ul>

$$
P(x)=\left\{\begin{array}{l}
f(x), x \text { 满足原始问题约束 } \\
+\infty, \text { otherwise }
\end{array}\right. \tag{14}
$$



<ul>
<li>考虑极小化问题：</li>
</ul>
<p>$$<br>\min _{x} P(x)=\min _{x} \max _{\alpha, \beta ; \alpha \geq 0} L(x, \alpha, \beta) \tag{15} \label{eq15}<br>$$</p>
<ul>
<li>式$\eqref{eq15}$与$\eqref{eq7}$等价，因为固定$x$时剩余两项在约束范围内最大值为0，相当于在约束范围内求解$f(x)$的最小值。</li>
<li>定义原始问题的值为：</li>
</ul>
<p>$$<br>p^{*}=\min _{x} P(x) \tag{16}<br>$$</p>
<h4 id="对偶问题"><a href="#对偶问题" class="headerlink" title="对偶问题"></a>对偶问题</h4><ul>
<li>延续上文的对偶问题$\eqref{eq7}$</li>
<li>可以看到事实上对偶问题与原问题为极大极小的求解顺序问题</li>
<li>定义对偶问题的值：</li>
</ul>

$$
d^{*}=\max _{\alpha, \beta ; \alpha_{i} \geq 0} D(\alpha, \beta) \tag{17}
$$



<h4 id="原始问题与对偶问题的关系"><a href="#原始问题与对偶问题的关系" class="headerlink" title="原始问题与对偶问题的关系"></a>原始问题与对偶问题的关系</h4><ul>
<li>对偶问题的解不大于原始问题的解：</li>
<li>证明：</li>
</ul>
<p>$$<br>\begin{array}{c}\<br>D(a, \beta)=\min _{x} L(x, a, \beta) \leqslant L(x, a, \beta) \leqslant \max <em>{\sigma, \beta: a</em>{i} \geqslant 0} L(x, a, \beta)=P(x)\<br>D(\mathrm{a}, \beta) \leqslant P(x)\<br>\mathrm{d}^{<em>}=\max <em>{\mathrm{a}, \mathrm{B}: \mathrm{a}</em>{i} \geqslant 0} \min <em>{\mathrm{x}} L(x, \mathrm{a}, \beta) \leqslant \min _{\mathrm{x}} \max _{\mathrm{a}, \mathrm{\beta}: \mathrm{a}</em>{i} \geqslant 0} L(x, \mathrm{a}, \beta)=\mathrm{p}^{</em>}\<br>d ^ { * } \le p ^ { * }<br>\end{array}\tag{18}<br>$$</p>
<ul>
<li>该性质为弱对偶性（weak duality），该性质在任何情况下都成立</li>
<li>也因为弱对偶的存在，使得 <strong>对偶问题可以给出原始问题的下界</strong></li>
<li>与弱对偶性相对应的是强对偶性（strong duality），即：</li>
</ul>
<p>$$<br>d^{* } = p^{* } \tag{19}<br>$$</p>
<ul>
<li>若强对偶性成立，即原始问题与对偶问题的最优值相等，则可以通过求解对偶问题来得到原始问题的解</li>
</ul>
<h3 id="强对偶成立条件"><a href="#强对偶成立条件" class="headerlink" title="强对偶成立条件"></a>强对偶成立条件</h3><blockquote>
<p>强对偶的性质太过于美妙，如果我们的问题满足强对偶条件，直接求对偶问题就好了</p>
<p>这里列出两个常见的条件</p>
</blockquote>
<h4 id="Convex-Slater"><a href="#Convex-Slater" class="headerlink" title="Convex + Slater"></a>Convex + Slater</h4><ul>
<li>原问题是凸优化<ul>
<li>$f(x)$和$h(x)$是凸函数</li>
<li>$g(x)$是放射函数</li>
</ul>
</li>
<li>存在$x$使得不等式约束严格成立（严格成立不等号）</li>
</ul>
<h4 id="KKT-条件"><a href="#KKT-条件" class="headerlink" title="KKT 条件"></a>KKT 条件</h4><blockquote>
<p>原问题是否为凸函数的两种情况下，KKT的用法不同</p>
</blockquote>
<h5 id="原问题非凸"><a href="#原问题非凸" class="headerlink" title="原问题非凸"></a>原问题非凸</h5><blockquote>
<p>当原问题并非凸优化(或者不清楚、不关心是不是凸优化)时，KKT 条件是一种用来<strong>描述强对偶情况下最优解性质</strong>的条件<br>换而言之，若强对偶性质成立，那么满足最优解的<strong>点</strong>一定满足 KKT 条件；KKT 条件是强对偶一个<strong>必要条件</strong>，但无法作为充分条件来使用</p>
</blockquote>
<h5 id="原问题为凸函数"><a href="#原问题为凸函数" class="headerlink" title="原问题为凸函数"></a>原问题为凸函数</h5><blockquote>
<p>当原问题为凸优化时，KKT 条件在非凸的基础上有多了找到最优点的功能<br>在这种情况下，那么满足 KKT 条件的点一定是原问题和对偶问题的最优解；KKT 条件成了强对偶和最优解的充要条件</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/qq_32742009/article/details/81413068" target="_blank" rel="noopener">https://blog.csdn.net/qq_32742009/article/details/81413068</a></li>
<li><a href="https://blog.csdn.net/u014540876/article/details/79153913" target="_blank" rel="noopener">https://blog.csdn.net/u014540876/article/details/79153913</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/45431511" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/45431511</a></li>
<li><a href="https://www.zhihu.com/question/58584814" target="_blank" rel="noopener">https://www.zhihu.com/question/58584814</a></li>
<li><a href="https://blog.csdn.net/frostime/article/details/90291392" target="_blank" rel="noopener">https://blog.csdn.net/frostime/article/details/90291392</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>将训练好的 mmdetection 模型转为 tensorrt 模型</title>
    <url>/2021/03/17/deep_learning/tensorrt-model-gen-mmdection/tensorrt-model-gen/</url>
    <content><![CDATA[<blockquote>
<p>mmdetection 是商汤科技（2018 COCO 目标检测挑战赛冠军）和香港中文大学开源的基于Pytorch实现的深度学习目标检测工具箱，性能强大，运算效率高，配置化编程，比较容易训练、测试。但pytorch模型不易于部署，运算速度还有进一步提升的空间，当前比较有效的方法是将模型转换为行为相同的tensorrt模型，本文记录转换流程。</p>
</blockquote>
<a id="more"></a>

<h3 id="任务思路"><a href="#任务思路" class="headerlink" title="任务思路"></a>任务思路</h3><blockquote>
<p>转换mmdetection 的 pytorch模型到tensorrt模型有多种方法，本文使用 <a href="https://github.com/grimoire/mmdetection-to-tensorrt" target="_blank" rel="noopener">mmdetection-to-tensorrt</a> 库作为核心，完成直接的模型转换。</p>
<p>该库跳过了通常的 pth -&gt; onnx -&gt; tensorrt 的转换步骤，直接从pth转成tensorrt模型，并且已经成功支持了很多mmdetection 的模型转换。</p>
</blockquote>
<details>
    <summary>Support Model/Module </summary>

<ul>
<li><input checked="" disabled="" type="checkbox"> Faster R-CNN</li>
<li><input checked="" disabled="" type="checkbox"> Cascade R-CNN</li>
<li><input checked="" disabled="" type="checkbox"> Double-Head R-CNN</li>
<li><input checked="" disabled="" type="checkbox"> Group Normalization</li>
<li><input checked="" disabled="" type="checkbox"> Weight Standardization</li>
<li><input checked="" disabled="" type="checkbox"> DCN</li>
<li><input checked="" disabled="" type="checkbox"> SSD</li>
<li><input checked="" disabled="" type="checkbox"> RetinaNet</li>
<li><input checked="" disabled="" type="checkbox"> Libra R-CNN</li>
<li><input checked="" disabled="" type="checkbox"> FCOS</li>
<li><input checked="" disabled="" type="checkbox"> Fovea</li>
<li><input checked="" disabled="" type="checkbox"> CARAFE</li>
<li><input checked="" disabled="" type="checkbox"> FreeAnchor</li>
<li><input checked="" disabled="" type="checkbox"> RepPoints</li>
<li><input checked="" disabled="" type="checkbox"> NAS-FPN</li>
<li><input checked="" disabled="" type="checkbox"> ATSS</li>
<li><input checked="" disabled="" type="checkbox"> PAFPN</li>
<li><input checked="" disabled="" type="checkbox"> FSAF</li>
<li><input checked="" disabled="" type="checkbox"> GCNet</li>
<li><input checked="" disabled="" type="checkbox"> Guided Anchoring</li>
<li><input checked="" disabled="" type="checkbox"> Generalized Attention</li>
<li><input checked="" disabled="" type="checkbox"> Dynamic R-CNN</li>
<li><input checked="" disabled="" type="checkbox"> Hybrid Task Cascade</li>
<li><input checked="" disabled="" type="checkbox"> DetectoRS</li>
<li><input checked="" disabled="" type="checkbox"> Side-Aware Boundary Localization</li>
<li><input checked="" disabled="" type="checkbox"> YOLOv3</li>
<li><input checked="" disabled="" type="checkbox"> PAA</li>
<li><input disabled="" type="checkbox"> CornerNet(WIP)</li>
<li><input checked="" disabled="" type="checkbox"> Generalized Focal Loss</li>
<li><input checked="" disabled="" type="checkbox"> Grid RCNN</li>
<li><input checked="" disabled="" type="checkbox"> VFNet</li>
<li><input checked="" disabled="" type="checkbox"> GROIE</li>
<li><input checked="" disabled="" type="checkbox"> Mask R-CNN(experiment)</li>
<li><input checked="" disabled="" type="checkbox"> Cascade Mask R-CNN(experiment)</li>
<li><input checked="" disabled="" type="checkbox"> Cascade RPN</li>
</ul>
</details>

<h4 id="完成步骤"><a href="#完成步骤" class="headerlink" title="完成步骤"></a>完成步骤</h4><ul>
<li>配置环境</li>
<li>安装tensorrt 7.2.3.4</li>
<li>安装 mmdetection-to-tensorrt 库并安装依赖</li>
<li>使用 mmdetection-to-tensorrt 转换模型</li>
<li>结果测试</li>
</ul>
<h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><blockquote>
<p>本机 gpu Nvidia GTX 1080 服务器</p>
<p>时间 2021.03</p>
</blockquote>
<ul>
<li><p>操作系统 Ubuntu 16.04</p>
</li>
<li><p>Nvidia 显卡驱动 460.39</p>
</li>
<li><p>Cuda 版本 11.1</p>
</li>
<li><p>Cudnn 版本 8.1.1</p>
</li>
</ul>
<blockquote>
<p>具体配置方法教程很多，在此不再赘述，需要根据个人具体情况配置</p>
</blockquote>
<h3 id="安装-tensorrt并配置环境"><a href="#安装-tensorrt并配置环境" class="headerlink" title="安装 tensorrt并配置环境"></a>安装 tensorrt并配置环境</h3><blockquote>
<p>选择的版本是 tensorrt 7.2.3.4</p>
<p>建议Python环境安装 Anaconda</p>
</blockquote>
<h4 id="安装-PyCuda"><a href="#安装-PyCuda" class="headerlink" title="安装 PyCuda"></a>安装 PyCuda</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install pycuda</span><br></pre></td></tr></table></figure>

<h4 id="安装tensorrt"><a href="#安装tensorrt" class="headerlink" title="安装tensorrt"></a>安装tensorrt</h4><ul>
<li><p>下载tensorrt </p>
<ul>
<li><p>链接 <a href="https://developer.nvidia.com/zh-cn/tensorrt" target="_blank" rel="noopener">https://developer.nvidia.com/zh-cn/tensorrt</a></p>
</li>
<li><p>选择 TensorRT-7.2.3.4.Ubuntu-16.04.x86_64-gnu.cuda-11.1.cudnn8.1.tar.gz</p>
</li>
</ul>
</li>
<li><p>解压</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar zxfv TensorRT-7.2.3.4.Ubuntu-16.04.x86_64-gnu.cuda-11.1.cudnn8.1.tar.gz</span><br></pre></td></tr></table></figure>

<blockquote>
<p>解压后文件夹内文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">TensorRT-Release-Notes.pdf  bin  data  doc  graphsurgeon  include  lib  onnx_graphsurgeon  python  samples  targets  uff</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>安装tensorrt</li>
</ul>
<blockquote>
<p>根据自己的 Python 版本选择合适的包进行安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd TensorRT-7.2.3.4/python</span><br><span class="line">pip install tensorrt-7.2.3.4-cp37-none-linux_x86_64.whl</span><br></pre></td></tr></table></figure>

<ul>
<li>安装graphsurgeon wheel</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd TensorRT-7.2.3.4/graphsurgeon</span><br><span class="line">pip install graphsurgeon-0.4.5-py2.py3-none-any.whl</span><br></pre></td></tr></table></figure>

<ul>
<li>配置环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/cuda/bin</span><br><span class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/lib64</span><br><span class="line">export LIBRARY_PATH=$LIBRARY_PATH:/usr/local/cuda/lib64</span><br><span class="line"></span><br><span class="line">export PATH=$PATH:"your_path_to_TensorRT-7.2.3.4"</span><br><span class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:"your_path_to_TensorRT-7.2.3.4/lib"</span><br></pre></td></tr></table></figure>

<ul>
<li>测试</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python</span><br><span class="line">import tensorrt</span><br><span class="line">tensorrt.__version__</span><br><span class="line"></span><br><span class="line">--&gt; &#39;7.2.3.4&#39;</span><br></pre></td></tr></table></figure>

<h3 id="安装-mmdetection"><a href="#安装-mmdetection" class="headerlink" title="安装 mmdetection"></a>安装 mmdetection</h3><ul>
<li>链接 <a href="https://github.com/open-mmlab/mmdetection" target="_blank" rel="noopener">https://github.com/open-mmlab/mmdetection</a></li>
<li>安装文档 <a href="https://github.com/open-mmlab/mmdetection/blob/master/docs/get_started.md" target="_blank" rel="noopener">https://github.com/open-mmlab/mmdetection/blob/master/docs/get_started.md</a></li>
</ul>
<h4 id="安装-mmcv"><a href="#安装-mmcv" class="headerlink" title="安装 mmcv"></a>安装 mmcv</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/&#123;cu_version&#125;/&#123;torch_version&#125;/index.html</span><br></pre></td></tr></table></figure>

<h4 id="下载并安装-mmdetection"><a href="#下载并安装-mmdetection" class="headerlink" title="下载并安装 mmdetection"></a>下载并安装 mmdetection</h4><ul>
<li>下载</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone git@git.zhlh6.cn:open-mmlab/mmdetection.git</span><br></pre></td></tr></table></figure>

<ul>
<li>配置环境并安装</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd mmdetection</span><br><span class="line">pip install -r requirements/build.txt</span><br><span class="line">pip install -v -e .  # or "python setup.py develop"</span><br></pre></td></tr></table></figure>

<h3 id="安装-mmdetection-to-tensorrt"><a href="#安装-mmdetection-to-tensorrt" class="headerlink" title="安装 mmdetection-to-tensorrt"></a>安装 mmdetection-to-tensorrt</h3><ul>
<li>链接 <a href="https://github.com/grimoire/mmdetection-to-tensorrt" target="_blank" rel="noopener">https://github.com/grimoire/mmdetection-to-tensorrt</a></li>
</ul>
<h4 id="安装-torch2trt-dynamic"><a href="#安装-torch2trt-dynamic" class="headerlink" title="安装 torch2trt_dynamic"></a>安装 <a href="https://github.com/grimoire/torch2trt_dynamic" target="_blank" rel="noopener">torch2trt_dynamic</a></h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone git@git.zhlh6.cn:grimoire/torch2trt_dynamic.git</span><br><span class="line">cd torch2trt_dynamic</span><br><span class="line">python setup.py develop</span><br></pre></td></tr></table></figure>

<h4 id="安装-amirstan-plugin"><a href="#安装-amirstan-plugin" class="headerlink" title="安装 amirstan_plugin"></a>安装 <a href="https://github.com/grimoire/amirstan_plugin" target="_blank" rel="noopener">amirstan_plugin</a></h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone --depth&#x3D;1 git@git.zhlh6.cn:grimoire&#x2F;amirstan_plugin.git</span><br><span class="line">cd amirstan_plugin</span><br></pre></td></tr></table></figure>

<ul>
<li>更新子模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git submodule update --init --progress --depth&#x3D;1</span><br></pre></td></tr></table></figure>

<p>讲道理一句话就可以了，不过我在执行这句命令时报错，如果没报错继续下面的步骤</p>
<details>
    <summary> 子模块更新报错解决方案 </summary>


<blockquote>
<p>http协议不好用，需要改成git</p>
</blockquote>
<ul>
<li>修改 <code>amirstan_plugin/.gitmodules</code> 文件</li>
</ul>
<blockquote>
<p>将第三行地址改为 <code>git@github.com:NVIDIA/cub.git</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[submodule "third_party/cub"]</span><br><span class="line">	path = third_party/cub</span><br><span class="line">	url = git@github.com:NVIDIA/cub.git </span><br><span class="line">	branch = 1.8.0</span><br></pre></td></tr></table></figure>

<ul>
<li>修改 <code>amirstan_plugin/.git/modules/third_party/cub/config</code></li>
</ul>
<blockquote>
<p>将 <code>remote &quot;origin&quot;</code> 地址改为 <code>git@github.com:NVIDIA/cub.git</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[core]</span><br><span class="line">	repositoryformatversion = 0</span><br><span class="line">	filemode = true</span><br><span class="line">	bare = false</span><br><span class="line">	logallrefupdates = true</span><br><span class="line">	worktree = ../../../../third_party/cub</span><br><span class="line">[remote "origin"]</span><br><span class="line">	url = git@github.com:NVIDIA/cub.git </span><br><span class="line">	fetch = +refs/heads/main:refs/remotes/origin/main</span><br><span class="line">[branch "main"]</span><br><span class="line">	remote = origin</span><br><span class="line">	merge = refs/heads/main</span><br></pre></td></tr></table></figure>

<ul>
<li>再次执行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git submodule update --init --progress --depth&#x3D;1</span><br></pre></td></tr></table></figure>

</details>

<ul>
<li>新建build文件夹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br></pre></td></tr></table></figure>

<ul>
<li>生成 makefile</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmake -DTENSORRT_DIR&#x3D;$&#123;your_path_to_tensorrt&#125; ..</span><br></pre></td></tr></table></figure>

<blockquote>
<p>若输出：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- Found TensorRT headers at ..&#x2F;TensorRT-7.2.3.4&#x2F;include</span><br><span class="line">-- Find TensorRT libs at  ..&#x2F;TensorRT-7.2.3.4&#x2F;lib&#x2F;libnvinfer.so; ..&#x2F;TensorRT-7.2.3.4&#x2F;lib&#x2F;libnvparsers.so; ..&#x2F;TensorRT-7.2.3.4&#x2F;lib&#x2F;libnvinfer_plugin.so</span><br><span class="line">-- Found TENSORRT:  ..&#x2F;TensorRT-7.2.3.4&#x2F;include  </span><br><span class="line">-- WITH_DEEPSTREAM: false</span><br><span class="line">-- GPU_ARCHS is not defined. Generating CUDA code for default SMs: 35;53;61;70;75;80</span><br><span class="line">-- Configuring done</span><br><span class="line">-- Generating done</span><br><span class="line">-- Build files have been written to:  ..&#x2F;amirstan_plugin&#x2F;build</span><br></pre></td></tr></table></figure>

<blockquote>
<p>则说明 makefile 生成成功，保存在 <code>build</code> 文件夹下</p>
</blockquote>
<ul>
<li>编译</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">make -j10</span><br></pre></td></tr></table></figure>

<p>此时在<code>build/lib</code>文件夹下生成了很多文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">libadaptivePoolPlugin_static.a  libcarafeFeatureReassemblePlugin_static.a  libexViewPlugin_static.a             liblayerNormPlugin_static.a     libroiPoolPlugin_static.a         libtorchEmbeddingPlugin_static.a </span><br><span class="line">libamir_cuda_util.a             libdeformableConvPlugin_static.a           libgridAnchorDynamicPlugin_static.a  libmeshGridPlugin_static.a      libtorchBmmPlugin_static.a        libtorchFlipPlugin_static.a</span><br><span class="line">libamirstan_plugin.so           libdeformablePoolPlugin_static.a           libgridSamplePlugin_static.a         librepeatDimsPlugin_static.a    libtorchCumMaxMinPlugin_static.a  libtorchGatherPlugin_static.a</span><br><span class="line">libbatchedNMSPlugin_static.a    libdelta2bboxPlugin_static.a               libgroupNormPlugin_static.a          libroiExtractorPlugin_static.a  libtorchCumPlugin_static.a        libtorchNMSPlugin_static.a</span><br></pre></td></tr></table></figure>

<ul>
<li>配置环境变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export AMIRSTAN_LIBRARY_PATH=&lt;amirstan_plugin_root&gt;/build/lib</span><br></pre></td></tr></table></figure>

<h4 id="安装-mmdetection-to-tensorrt-1"><a href="#安装-mmdetection-to-tensorrt-1" class="headerlink" title="安装 mmdetection-to-tensorrt"></a>安装 mmdetection-to-tensorrt</h4><blockquote>
<p>进入 <code>mmdetection-to-tensorrt</code> 根目录</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python setup.py develop</span><br></pre></td></tr></table></figure>

<ul>
<li>测试是否成功</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> pip show mmdet2trt</span></span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">Name: mmdet2trt</span><br><span class="line">Version: 0.3.0</span><br><span class="line">Summary: mmdetection to tensorrt converter</span><br><span class="line">Home-page: UNKNOWN</span><br><span class="line">Author: UNKNOWN</span><br><span class="line">Author-email: UNKNOWN</span><br><span class="line">License: UNKNOWN</span><br><span class="line">Location: /workspace/nfs/tensorrt_test/mmdetection-to-tensorrt</span><br><span class="line">Requires: </span><br><span class="line">Required-by:</span><br></pre></td></tr></table></figure>



<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ul>
<li><p>在 <code>mmdetection-to-tensorrt</code> 项目中，运行 <code>demo</code> 文件夹下的 <code>inference.py</code> 文件</p>
</li>
<li><p>修改<code>inference.py</code> 文件中的 parser 参数 ：</p>
<ul>
<li>img：测试图像路径</li>
<li>config：mmdetection 的模型配置文件</li>
<li>checkpoint：模型 pth 文件路径</li>
<li>save_path：tensorrt 模型存放路径</li>
<li>score-thr：检测有效阈值</li>
</ul>
</li>
<li><p>配置好后运行该文件即可以生成模型在测试图像上的检测结果</p>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://github.com/grimoire/mmdetection-to-tensorrt" target="_blank" rel="noopener">https://github.com/grimoire/mmdetection-to-tensorrt</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/165359425" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/165359425</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>pytorch</category>
        <category>tensorrt</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>pytorch</tag>
        <tag>tensorrt</tag>
      </tags>
  </entry>
  <entry>
    <title>拉格朗日乘数法</title>
    <url>/2021/03/13/machine_learning/lagrange-multiplier/lagrange-multiplier/</url>
    <content><![CDATA[<blockquote>
<p>在数学最优<a href="https://baike.baidu.com/item/%E9%97%AE%E9%A2%98/1067365" target="_blank" rel="noopener">问题</a>中，拉格朗日乘数法（以数学家<a href="https://baike.baidu.com/item/%E7%BA%A6%E7%91%9F%E5%A4%AB%C2%B7%E8%B7%AF%E6%98%93%E6%96%AF%C2%B7%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5/7070424" target="_blank" rel="noopener">约瑟夫·路易斯·拉格朗日</a>命名）是一种寻找变量受一个或多个条件所限制的<a href="https://baike.baidu.com/item/%E5%A4%9A%E5%85%83%E5%87%BD%E6%95%B0/2498728" target="_blank" rel="noopener">多元函数</a>的<a href="https://baike.baidu.com/item/%E6%9E%81%E5%80%BC/5330918" target="_blank" rel="noopener">极值</a>的方法。这种方法将一个有n 个变量与k 个<a href="https://baike.baidu.com/item/%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6/1046571" target="_blank" rel="noopener">约束条件</a>的<a href="https://baike.baidu.com/item/%E6%9C%80%E4%BC%98%E5%8C%96%E9%97%AE%E9%A2%98/9632567" target="_blank" rel="noopener">最优化问题</a>转换为一个有n + k个变量的方程组的极值问题，其变量不受任何约束。本文介绍拉格朗日乘数法（Lagrange multiplier）。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li><p>我们擅长解决的是无约束极值求解问题，这类问题仅需对所有变量求偏导，使得所有偏导数为0，即可找到所有极值点和鞍点。我们解决带约束条件的问题时便会尝试将其转化为无约束优化问题</p>
</li>
<li><p>事实上如果我们可以通过g得到某个变量的表示，例如$x_1 = h(x_2, …, x_n)$，将该式带入$y$即可抓换为无约束优化（初高中就是这么做的，所谓消元法是也），但有的时候我们无法得到这样的表示，便需要借助拉格朗日乘数法来避免消元法的困境。</p>
</li>
</ul>
<blockquote>
<p>作为一种优化算法，拉格朗日乘数法主要用于解决约束优化问题，它的基本思想就是通过引入拉格朗日乘子来将含有$n$个变量和$k个$约束条件的约束优化问题转化为含有$（n+k）$个变量的无约束优化问题。拉格朗日乘子背后的数学意义是其为约束方程梯度线性组合中每个向量的系数。</p>
</blockquote>
<h3 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h3><ul>
<li>考虑二元函数$f(x,y)$，在约束$g(x,y)=c$下的极值</li>
<li>首先我们可以绘制出$f(x,y)$的一层层等高线，当等高线与$g(x,y)=c$相切时即可能是该问题的极值点</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210324141929.jpg" alt="拉格朗日乘数法示意图（转自知乎）"></p>
<h3 id="拉格朗日乘数法"><a href="#拉格朗日乘数法" class="headerlink" title="拉格朗日乘数法"></a>拉格朗日乘数法</h3><h4 id="单个等式约束"><a href="#单个等式约束" class="headerlink" title="单个等式约束"></a>单个等式约束</h4><blockquote>
<p>考虑$n$元函数$y=f(x_1, x_2,…,x_n)$，在等式约束$g(x_1, x_2,…,x_n)=0$ 下的极值点求解问题</p>
</blockquote>
<ul>
<li>在极值点，必有$y$和$g$法向量平行</li>
<li>$y$的法向量为：</li>
</ul>

$$
[\frac{{\partial y}}{{\partial {x_1}}},\frac{{\partial y}}{{\partial {x_2}}},...,\frac{{\partial y}}{{\partial {x_n}}}]
$$


<ul>
<li>$g$的法向量为：</li>
</ul>

$$
[\frac{{\partial g}}{{\partial {x_1}}},\frac{{\partial g}}{{\partial {x_2}}},...,\frac{{\partial g}}{{\partial {x_n}}}]
$$


<ul>
<li>二者平行，则存在常数$\lambda$使得：</li>
</ul>

$$
[\frac{{\partial y}}{{\partial {x_1}}},\frac{{\partial y}}{{\partial {x_2}}},...,\frac{{\partial y}}{{\partial {x_n}}}] + \lambda [\frac{{\partial g}}{{\partial {x_1}}},\frac{{\partial g}}{{\partial {x_2}}},...,\frac{{\partial g}}{{\partial {x_n}}}] = 0
$$


<ul>
<li>即：</li>
</ul>

$$
\frac{{\partial y}}{{\partial {x_i}}} + \lambda \frac{{\partial g}}{{\partial {x_i}}} = 0,1 \le i \le n
$$


<ul>
<li>这样我们就得到了$n$个等式方程，再加上$g(x_1, x_2,…,x_n)=0$一起构成$n+1$个方程的方程组，未知数为$[x_1,x_2,…,x_n,\lambda]$共$n+1$个，方程组的解即为所有极值点和鞍点的集合，每组解中的$\lambda$即为两个平行法向量的倍数，该值在等式约束轨迹穿过$y$的极值点时为0。</li>
</ul>
<h4 id="多个等式约束"><a href="#多个等式约束" class="headerlink" title="多个等式约束"></a>多个等式约束</h4><blockquote>
<p>原理与单个等式约束情况类似</p>
<p>考虑$n$元函数$y=f(x_1, x_2,…,x_n)$，在$m$个等式约束($g_i(x_1, x_2,…,x_n)=0, 1 \le i \le m$) 下的极值点求解问题</p>
</blockquote>
<ul>
<li>$n$维空间由$m$个条件约束，会确定一个$n-m$维的曲面，我们讨论$y$在这个曲面上的极值问题</li>
<li>这个曲面由$m$个$n-1$维曲面交织而成，存在$m$个法向量，这$m$个法向量构成了$n-m$维曲面的法空间</li>
<li>在问题的极值点，$y$的法向量必然落在$n-m$维曲面的法空间之内，也就是说$y$的法向量可以由$n-m$维曲面的$m$个法向量的线性组合表示：</li>
</ul>

$$
[\frac{{\partial y}}{{\partial {x_1}}},\frac{{\partial y}}{{\partial {x_2}}},...,\frac{{\partial y}}{{\partial {x_n}}}] + \sum\limits_{i = 1}^m {{\lambda _i}[\frac{{\partial {g_i}}}{{\partial {x_1}}},\frac{{\partial {g_i}}}{{\partial {x_2}}},...,\frac{{\partial {g_i}}}{{\partial {x_n}}}]}  = 0
$$


<ul>
<li>即：</li>
</ul>

$$
\frac{{\partial y}}{{\partial {x_j}}} + \sum\limits_{i = 1}^m {{\lambda _i}\frac{{\partial {g_i}}}{{\partial {x_j}}}}  = 0,1 \le j \le n
$$


<ul>
<li>此时我们得到了$n$个等式方程，再加上$m$个等式约束($g_i(x_1, x_2,…,x_n)=0, 1 \le i \le m$) 一起构成$n+m$个方程的方程组，未知数为$[x_1,x_2,…,x_n,\lambda_1,\lambda_2,…,\lambda_m]$共$n+m$个，方程组的解即为所有极值点和鞍点的集合，每组解中的$\lambda_i$的值即为$y$的法向量在$n-m$维曲面的法空间中的线性组合系数。</li>
</ul>
<h4 id="单个不等式约束"><a href="#单个不等式约束" class="headerlink" title="单个不等式约束"></a>单个不等式约束</h4><blockquote>
<p>不等式约束其实是等式约束的扩展，等式约束表示一组确定的等高线（面），不等式约束则表示等高线（面）的某一边区域</p>
<p>考虑$n$元函数$y=f(x_1, x_2,…,x_n)$，在不等式约束$g(x_1, x_2,…,x_n) \le 0$ 下的极值点求解问题</p>
</blockquote>
<ul>
<li>若该问题有解，那么有两种情况</li>
</ul>
<ol>
<li>解在 $g(x_1, x_2,…,x_n) = 0$ 曲面上</li>
<li>解在$g(x_1, x_2,…,x_n) &lt; 0$ 范围内</li>
</ol>
<ul>
<li>当解在 $g(x_1, x_2,…,x_n) = 0$ 曲面上时，说明该不等式对$y$取最小值的区域进行了限制，最终解落在了$y$和约束相切的位置，那么此时二者的法向量方向必然相反（否则$y$会在$g(x_1, x_2,…,x_n) &lt; 0$ 范围内找到更小的值），按照等式情况构建方程：</li>
</ul>

$$
\frac{{\partial y}}{{\partial {x_i}}} + \lambda \frac{{\partial g}}{{\partial {x_i}}} = 0,1 \le i \le n
$$


<ul>
<li><p>便有结论：$\lambda \ge 0$</p>
</li>
<li><p>当解在$g(x_1, x_2,…,x_n) &lt; 0$ 范围内时，事实上这个不等式没有对$y$的求解起到约束作用，此时相当于$\lambda = 0$</p>
</li>
<li><p>而且两种情况下分别有 $g(x_1, x_2,…,x_n) = 0$和$\lambda = 0$，也就是二者必有一方为0</p>
</li>
<li><p>因此对于单个不等式约束的拉格朗日乘数法，仅需增加限制条件： $\lambda \ge 0$和$\lambda g(x_1, x_2,…,x_n) = 0$</p>
</li>
</ul>
<h4 id="多个不等式约束"><a href="#多个不等式约束" class="headerlink" title="多个不等式约束"></a>多个不等式约束</h4><blockquote>
<p>考虑$n$元函数$y=f(x_1, x_2,…,x_n)$，在$m$个不等式约束($g_i(x_1, x_2,…,x_n)\le0, 1 \le i \le m$) 下的极值点求解问题</p>
</blockquote>
<ul>
<li>本质上与单个不等式约束相同，只是数量变多了</li>
<li>此情况下需要在等式拉格朗日乘数法基础上增加条件：</li>
</ul>

$$
\begin{aligned}
\lambda_i &\ge 0,1 \le i \le m\\
\lambda_ig_i &= 0,1 \le i \le m
\end{aligned}
$$


<h3 id="算法描述"><a href="#算法描述" class="headerlink" title="算法描述"></a>算法描述</h3><ul>
<li>基于上述原理，提出了拉格朗日乘数法：</li>
</ul>
<ol start="0">
<li><p>考虑$n$元函数$y=f(x_1, x_2,…,x_n)$，在$m_1$个等式约束($g_i(x_1, x_2,…,x_n)=0, 1 \le i \le m_1$) 、$m_2$个不等式约束($h_j(x_1, x_2,…,x_n)\le0, 1 \le j \le m_2$) 下的极值点求解问题</p>
</li>
<li><p>加入常数$\lambda,\mu$构造方程：</p>
</li>
</ol>

$$
z = f({x_1},{x_2},...,{x_n}) + \sum\limits_{i = 1}^{{m_1}} {{\lambda _i}{g_i}({x_1},{x_2},...,{x_n})}  + \sum\limits_{j = 1}^{{m_2}} {{\mu _j}{h_j}({x_1},{x_2},...,{x_n})}
$$


<ol start="2">
<li>对所有变量求偏导，并令导数为0：</li>
</ol>

$$
\begin{aligned}
\frac{{\partial z}}{{\partial {x_i}}} &= 0\\
\frac{{\partial y}}{{\partial {x_k}}} + \sum\limits_{i = 1}^{{m_1}} {{\lambda _i}\frac{{\partial g}}{{\partial {x_k}}}}  + \sum\limits_{j = 1}^{{m_1}} {{\mu _j}\frac{{\partial h}}{{\partial {x_k}}}} {\rm{ }} &= 0
\end{aligned}
$$


<blockquote>
<p>其中：$1 \le k \le n$</p>
</blockquote>
<ol start="3">
<li>将上述$n$个方程与$m_1$个等式约束方程$g_i(x_1, x_2,…,x_n)=0, 1 \le i \le m_1$ 联立</li>
<li>将上述$n+m_1$个方程与$\mu_j h_j=0, 1 \le j \le m_2$联立，得到$n+m_1+m_2$个方程</li>
<li>加上限制条件$\mu_j \ge 0$，$h_j \le 0$$, 1 \le j \le m_2$</li>
<li>在限制条件下解$n+m_1+m_2$元方程即可得到极值点与鞍点集合</li>
<li>从所有解中筛选出极值点</li>
</ol>
<h3 id="KKT条件"><a href="#KKT条件" class="headerlink" title="KKT条件"></a>KKT条件</h3><ul>
<li>上述$n+m_1+m_2$元方程与限制条件即为<code>KKT条件</code></li>
<li><code>KKT</code>条件是拉格朗日函数取极值时的必要条件</li>
</ul>

$$
\left\{\begin{array}{l}
\nabla f+\sum_{i}^{m_1} \lambda_{i} \nabla g_{i}+\sum_{j}^{m_2} \mu_{j} \nabla h_{j}=0 \\
g_{i}=0,  \\
h_{j} \leq 0,  \\

\mu_{j} \geq 0, \\
\mu_{j} h_{j}=0\\
\end{array}\right.
$$


<blockquote>
<p>其中 $i \in { 1,2, \cdots, m_1}$ ，$j \in { 1,2, \cdots, m_2}$</p>
</blockquote>
<ul>
<li>总结一下所有条件的含义：</li>
</ul>
<table>
<thead>
<tr>
<th>内容</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$\nabla f+\sum_{i}^{m_1} \lambda_{i} \nabla g_{i}+\sum_{j}^{m_2} \mu_{j} \nabla h_{j}=0$</td>
<td>求解极值需要在各个自变量方向上导数为0</td>
</tr>
<tr>
<td>$g_{i}=0$</td>
<td>等式约束</td>
</tr>
<tr>
<td>$h_{j} \le 0$</td>
<td>不等式约束</td>
</tr>
<tr>
<td>$\mu_{j} \geq 0$</td>
<td>不等式约束时的两种情况： <br />1. 不等式约束无效($\mu_{j} = 0$) <br />2. 不等式分界面法向量与原函数法向量方向相反($\mu_{j} &gt; 0$)</td>
</tr>
<tr>
<td>$\mu_{j} h_{j}=0$</td>
<td>不等式约束时的两种情况： <br />1. 不等式约束无效，极值点在$h_{j} &lt; 0$范围内 ($\mu_{j} = 0$) <br />2. 不等式约束有效，极值点在$h_{j} = 0$曲面上($h_{j} = 0$)</td>
</tr>
</tbody></table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://baike.baidu.com/item/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0%E6%B3%95/8550443?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0%E6%B3%95/8550443?fr=aladdin</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/38586401" target="_blank" rel="noopener">https://www.zhihu.com/question/38586401</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/359162625" target="_blank" rel="noopener">https://www.zhihu.com/question/359162625</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/23311674/answer/468804362" target="_blank" rel="noopener">https://www.zhihu.com/question/23311674/answer/468804362</a></p>
</li>
<li><p><a href="https://blog.csdn.net/johnnyconstantine/article/details/46335763" target="_blank" rel="noopener">https://blog.csdn.net/johnnyconstantine/article/details/46335763</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>正定，半正定矩阵</title>
    <url>/2021/03/13/math/linear_algebra/cov-pos-sem/cov-pos-sem/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍正定矩阵和半正定矩阵。</p>
</blockquote>
<a id="more"></a>

<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote>
<p>正定和半正定这两个词的英文分别是positive definite和positive semi-definite，其中，definite是一个形容词，表示“明确的、确定的”等意思。</p>
</blockquote>
<h4 id="正定"><a href="#正定" class="headerlink" title="正定"></a>正定</h4><ul>
<li>给定一个大小为$n \times n$ 的实方阵$A$ ，若对于任意长度为$n$的非零向量$x$ ，有$x^TAx&gt;0$ 恒成立，则矩阵$A$是一个正定矩阵。</li>
<li>此时，若$A$为对称方阵，则称$A$为对称正定矩阵。</li>
</ul>
<h4 id="半正定"><a href="#半正定" class="headerlink" title="半正定"></a>半正定</h4><ul>
<li>给定一个大小为$n \times n$ 的实方阵$A$ ，若对于任意长度为$n$的非零向量$x$ ，有$x^TAx  \ge  0$ 恒成立，则矩阵$A$是一个半正定矩阵。</li>
<li>此时，若$A$为对称方阵，则称$A$为对称半正定矩阵。</li>
</ul>
<blockquote>
<p>可以看到半正定矩阵包含了正定矩阵，仅多出了等于零的一种情况，类似于正数和非负数的关系。</p>
</blockquote>
<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><blockquote>
<p>以正定矩阵为例，半正定矩阵仅多了等于零的情况。</p>
</blockquote>
<ul>
<li><p>正定矩阵的行列式恒为正；</p>
</li>
<li><p><a href="https://baike.baidu.com/item/%E5%AE%9E%E5%AF%B9%E7%A7%B0%E7%9F%A9%E9%98%B5/4773879" target="_blank" rel="noopener">实对称矩阵</a>A正定当且仅当A与单位矩阵合同；</p>
</li>
<li><p>若A是正定矩阵，则A的逆矩阵也是正定矩阵；</p>
</li>
<li><p>两个正定矩阵的和是正定矩阵；</p>
</li>
<li><p>正实数与正定矩阵的乘积是正定矩阵。</p>
</li>
</ul>
<h3 id="等价命题"><a href="#等价命题" class="headerlink" title="等价命题"></a>等价命题</h3><blockquote>
<p>对于n阶实对称矩阵A，下列条件是等价的（以正定矩阵为例）：</p>
</blockquote>
<ul>
<li><p>A是正定矩阵；</p>
</li>
<li><p>A的一切<a href="https://baike.baidu.com/item/%E9%A1%BA%E5%BA%8F%E4%B8%BB%E5%AD%90%E5%BC%8F/3167642" target="_blank" rel="noopener">顺序主子式</a>均为正；</p>
</li>
<li><p>A的一切主子式均为正；</p>
</li>
<li><p>A的特征值均为正；</p>
</li>
<li><p>存在实可逆矩阵C，使A=C′C；</p>
</li>
<li><p>存在秩为n的m×n实矩阵B，使A=B′B；</p>
</li>
<li><p>存在主对角线元素全为正的实三角矩阵R，使A=R′R 。</p>
</li>
</ul>
<h3 id="协方差矩阵半正定"><a href="#协方差矩阵半正定" class="headerlink" title="协方差矩阵半正定"></a>协方差矩阵半正定</h3><ul>
<li>在概率统计中，多维变量的协方差矩阵是对称矩阵，事实上同时它也是半正定矩阵：</li>
</ul>
<h4 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h4><ul>
<li>考虑一个由$n$个$m$维向量刻画的分布，即共$n$条数据，每条数据由一个$m$维向量表示：</li>
</ul>

$$
X = \left[ {\begin{array}{*{20}{c}}
{{x_{11}}}&{{x_{12}}}& \cdots &{{x_{1n}}}\\
{{x_{21}}}&{{x_{22}}}&{}&{{x_{2n}}}\\
\vdots &{}& \ddots & \vdots \\
{{x_{m1}}}&{{x_{m2}}}& \cdots &{{x_{mn}}}
\end{array}} \right]
$$


<ul>
<li>$X$的均值为${\mu _X}$</li>
<li>$X$的协方差矩阵为:</li>
</ul>
<p>$$<br>\sum\nolimits_X  =  \frac{1}{n}(X - {\mu _X}){(X - {\mu _X})^T}<br>$$</p>
<ul>
<li>协方差矩阵 $\Sigma_{X}$，对其进行SVD分解：</li>
</ul>
<p>$$<br>{\Sigma_X} = U \Sigma {V ^ T }<br>$$</p>
<ul>
<li>由于 $\Sigma_{X}$ 是对称矩阵，可以得到：</li>
</ul>
<p>$$<br>U=V<br>$$</p>
<ul>
<li>而且$U$是正交矩阵，有：</li>
</ul>

$$
U^T{\Sigma _X}U = \Sigma
$$

$$
\Sigma  = {U^T}(X - {\mu _X}){(X - {\mu _X})^T}U
$$

$$
\Sigma  = ({U^T}X - {U^T}{\mu _X}){({U^T}X - {U^T}{\mu _X})^T}
$$



<ul>
<li>令$Y = {U^T}X - {U^T}{\mu _X}$：</li>
</ul>
<p>$$<br>\Sigma  = Y{Y^T}<br>$$</p>
<ul>
<li><p>由于$\Sigma$是特征值为对角线元素的对角阵，因此对角线外元素为0，表示$Y$中向量相互之间不相关。</p>
</li>
<li><p>对于任意一个$\Sigma$中的特征值$\lambda_i$，计算公式为：</p>
</li>
</ul>
<p>$$<br>{\lambda _ i } = { Y _ i } { Y _ i } ^ T = \sum \limits_ {j = 1} ^n { {Y_{ij} } ^ 2}  \ge 0<br>$$</p>
<ul>
<li>因此协方差矩阵的特征值非负，是半正定矩阵。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://zhuanlan.zhihu.com/p/44860862" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/44860862</a></p>
</li>
<li><p><a href="https://baike.baidu.com/item/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/11030459?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/11030459?fr=aladdin</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>linear_algebra</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>linear_algebra</tag>
      </tags>
  </entry>
  <entry>
    <title>正交-不相关-独立</title>
    <url>/2021/03/12/math/probability/orthogonal-independent-uncorrelation/orthogonal-independent-uncorrelation/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍随机变量中正交、不相关、独立的区别和联系。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>三者均是描述随机变量之间关系的概念，看似都可以表示两个随机变量的疏远关系，但定义和约束均有不同。</p>
</blockquote>
<ul>
<li>考察$m$维随机变量$X,Y$之间的关系。</li>
</ul>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><h4 id="正交"><a href="#正交" class="headerlink" title="正交"></a>正交</h4><blockquote>
<p>定义$R(X, Y) = E[XY]$为相关函数：若$R(X, Y)=0$，称$X,Y$正交</p>
</blockquote>
<h4 id="不相关"><a href="#不相关" class="headerlink" title="不相关"></a>不相关</h4><blockquote>
<p>定义 $E[XY] = E[X]E[Y]$，则$X,Y$不相关</p>
</blockquote>
<ul>
<li>$X,Y$的协方差：</li>
</ul>
<p>$$<br>Cov(X,Y)=E[XY]- E[X]E[Y]<br>$$</p>
<blockquote>
<p> 不相关也可以用协方差为0表示</p>
</blockquote>
<ul>
<li>$X,Y$的相关系数：</li>
</ul>
<p>$$<br>r(X, Y)=\frac{\operatorname{Cov}(X, Y)}{\sqrt{\operatorname{Var}[X] \operatorname{Var}[Y]}}<br>$$</p>
<blockquote>
<p>不相关也可以用相关系数为0表示</p>
</blockquote>
<h4 id="独立"><a href="#独立" class="headerlink" title="独立"></a>独立</h4><blockquote>
<p>独立一般用他们的概率密度函数来表示。联合分布等于他们各自的独立边缘分布的乘积，则称为独立：</p>
</blockquote>
<p>$$<br>p(X,Y) = p(X)p(Y)<br>$$</p>
<h3 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h3><h4 id="独立-gt-不相关"><a href="#独立-gt-不相关" class="headerlink" title="独立 -&gt; 不相关"></a>独立 -&gt; 不相关</h4><blockquote>
<p>独立是对变量更严苛的要求，如果两个随机变量独立，则必定不相关，也就是说独立是不相关的充分不必要条件。</p>
</blockquote>
<ul>
<li>若已知$X,Y$联合概率密度$f(x, y)$等于二者边缘密度函数$g(x), h(y)$的乘积，则有：</li>
</ul>

$$
E (X,Y)=\iint x y f(x, y) d x d y=\iint x y g(x) h(y) d x d y=\int x g(x) d x \int y h(y) d y=E (X) E(Y)
$$



<ul>
<li>因此独立变量不相关，而相反不相关无法直接推导出独立</li>
</ul>
<h4 id="不相关-–高斯分布–-gt-独立"><a href="#不相关-–高斯分布–-gt-独立" class="headerlink" title="不相关 –高斯分布–&gt; 独立"></a>不相关 –高斯分布–&gt; 独立</h4><blockquote>
<p>在随机变量服从高斯分布时，不相关可以推导出独立：</p>
</blockquote>
<ul>
<li>我们此时考虑稍复杂一些的情况，$X$为$n$维随机变量：</li>
</ul>
<p>$$<br>X^T=[x_1,x_2,…,x_n]<br>$$</p>
<ul>
<li>随机变量之间两两不相关，并且服从高斯分布：</li>
</ul>

$$
Cov(x_i,x_j)=0,i \ne j
$$

$$
x_i \sim N\left(\mu_i, \sigma_i^{2}\right)
$$



<ul>
<li>那么此时$X$的联合概率密度函数为：</li>
</ul>

$$
f\left( {{x_1},{x_x} \ldots ,{x_n}} \right) = \frac{1}{{\sqrt {{{\left( {2\pi } \right)}^n}} {{\left| {\bf{\Sigma }} \right|}^{\frac{1}{2}}}}}{e^{ - \frac{1}{2}{{({\bf{X}} - {\bf{\mu }})}^T}{{\bf{\Sigma }}^{ - 1}}({\bf{X}} - {\bf{\mu }})}}
$$


<ul>
<li>其中${\bf{\Sigma } }$为协方差矩阵，因为随机变量之间两两不相关：</li>
</ul>

$$
{\bf{\Sigma }} = \left( {\begin{array}{*{20}{c}}
{\sigma _1^2}&{}&{}&{}\\
{}&{\sigma _2^2}&{}&{}\\
{}&{}& \ddots &{}\\
{}&{}&{}&{\sigma _n^2}
\end{array}} \right)
$$


<ul>
<li>其中$\sigma_i $为$x_i$的标准差，那么联合概率密度函数可以写为：</li>
</ul>

$$
\begin{aligned}
f\left( {{x_1},{x_x} \ldots ,{x_n}} \right) &= \frac{1}{{\sqrt {{{\left( {2\pi } \right)}^n}} \prod\limits_{i = 1}^n {{\sigma _i}} }}{e^{ - \frac{1}{2}{{({\bf{X}} - {\bf{\mu }})}^T}\left( {\begin{array}{*{20}{c}}
{\frac{1}{{\sigma _1^2}}}&{}&{}&{}\\
{}&{\frac{1}{{\sigma _2^2}}}&{}&{}\\
{}&{}& \ddots &{}\\
{}&{}&{}&{\frac{1}{{\sigma _n^2}}}\\
\end{array}} \right)({\bf{X}} - {\bf{\mu }})}}\\
 &= \frac{1}{{\sqrt {{{\left( {2\pi } \right)}^n}} \prod\limits_{i = 1}^n {{\sigma _i}} }}{e^{ - \frac{1}{2}[\frac{{{x_1} - {\mu _1}}}{{\sigma _1^2}},\frac{{{x_2} - {\mu _2}}}{{\sigma _2^2}},...,\frac{{{x_n} - {\mu _n}}}{{\sigma _n^2}}]({\bf{X}} - {\bf{\mu }})}}\\
 & = \frac{1}{{\sqrt {{{\left( {2\pi } \right)}^n}} \prod\limits_{i = 1}^n {{\sigma _i}} }}{e^{ - \frac{1}{2}\sum\limits_{i = 1}^n {\frac{{{{({x_n} - {\mu _n})}^2}}}{{\sigma _n^2}}} }}\\
 & = \prod\limits_{i = 1}^n {\frac{1}{{\sqrt {2\pi } {\sigma _i}}}} {e^{ - \frac{1}{2}\frac{{{{({x_i} - {\mu _i})}^2}}}{{\sigma _i^2}}}}	\\
 & = \prod\limits_{i = 1}^n {f({x_i})} 
 \end{aligned}
$$


<ul>
<li>因此在随机变量服从高斯分布时，不相关与独立等价，互为充要条件。</li>
</ul>
<h4 id="正交-–-不相关"><a href="#正交-–-不相关" class="headerlink" title="正交 – 不相关"></a>正交 – 不相关</h4><ul>
<li>根据定义可以得知： 当$E[X]，E[Y]$至少有一个为0时正交等价于不相关。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://blog.sciencenet.cn/blog-812827-1096465.html" target="_blank" rel="noopener">http://blog.sciencenet.cn/blog-812827-1096465.html</a></li>
<li><a href="https://blog.csdn.net/wjj5881005/article/details/53320403/" target="_blank" rel="noopener">https://blog.csdn.net/wjj5881005/article/details/53320403/</a></li>
<li><a href="https://www.zhihu.com/question/26583332/answer/33327497" target="_blank" rel="noopener">https://www.zhihu.com/question/26583332/answer/33327497</a></li>
<li><a href="https://baike.baidu.com/item/%E4%B8%8D%E7%9B%B8%E5%85%B3%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F/19126995?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E4%B8%8D%E7%9B%B8%E5%85%B3%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F/19126995?fr=aladdin</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>python PCV 库的安装与使用</title>
    <url>/2021/03/11/python/PCV-install-for-python/PCV-install-for-python/</url>
    <content><![CDATA[<blockquote>
<p>python图像处理中会调用一些开源库，PCV是其中之一，由于该库比较古老，本文记录安装使用方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li><a href="https://github.com/jesolem/PCV" target="_blank" rel="noopener">https://github.com/jesolem/PCV</a></li>
<li><a href="https://codechina.csdn.net/mirrors/jesolem/pcv?utm_source=csdn_github_accelerator" target="_blank" rel="noopener">https://codechina.csdn.net/mirrors/jesolem/pcv?utm_source=csdn_github_accelerator</a></li>
</ul>
<blockquote>
<p>第二个是国内镜像，速度会快一些</p>
</blockquote>
<ul>
<li>git clone到任意目录，或者直接下载zip文件.</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul>
<li>进入下载根目录运行命令：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>

<ul>
<li>如果你使用 python3 你就会发现很多 print 错误</li>
<li>这是由于库过于古老，仍沿用了python2 的print语法</li>
<li>需要逐个将print ‘hello’ 改为 print (‘hello’)</li>
</ul>
<h4 id="修改文件"><a href="#修改文件" class="headerlink" title="修改文件"></a>修改文件</h4><ul>
<li>报错信息包含的文件都在PCV子文件夹中，具体需要修改的文件列表如下: </li>
</ul>
<blockquote>
<p>在列表文件中搜索 print 并安装python3格式修改即可</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;PCV&#x2F;tools&#x2F;ncut.py</span><br><span class="line">.&#x2F;PCV&#x2F;tools&#x2F;imtools.py</span><br><span class="line">.&#x2F;PCV&#x2F;tools&#x2F;ransac.py</span><br><span class="line">.&#x2F;PCV&#x2F;imagesearch&#x2F;imagesearch.py</span><br><span class="line">.&#x2F;PCV&#x2F;classifiers&#x2F;bayes.py</span><br><span class="line">.&#x2F;PCV&#x2F;geometry&#x2F;warp.py</span><br><span class="line">.&#x2F;PCV&#x2F;localdescriptors&#x2F;dsift.py</span><br><span class="line">.&#x2F;PCV&#x2F;localdescriptors&#x2F;sift.py</span><br></pre></td></tr></table></figure>

<h4 id="重新安装"><a href="#重新安装" class="headerlink" title="重新安装"></a>重新安装</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>

<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><ul>
<li>执行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python</span><br><span class="line">import PCV</span><br><span class="line">from PCV.tools import imtools</span><br></pre></td></tr></table></figure>

<blockquote>
<p>没有报错既说明安装成功。</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.it610.com/article/1296222817162960896.htm" target="_blank" rel="noopener">https://www.it610.com/article/1296222817162960896.htm</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>马氏距离 (马哈拉诺比斯距离) (Mahalanobis distance)</title>
    <url>/2021/03/02/math/distance/mahalanobis-distance/</url>
    <content><![CDATA[<blockquote>
<p>马氏距离(Mahalanobis distance)是由印度统计学家马哈拉诺比斯(P. C. Mahalanobis)提出的，表示点与一个分布之间的距离。它是一种有效的计算两个未知样本集的相似度的方法。与<a href="https://baike.baidu.com/item/%E6%AC%A7%E6%B0%8F%E8%B7%9D%E7%A6%BB/1798948" target="_blank" rel="noopener">欧氏距离</a>不同的是，它考虑到各种特性之间的联系，本文介绍马氏距离相关内容。</p>
</blockquote>
<a id="more"></a>

<h3 id="欧氏距离的缺点"><a href="#欧氏距离的缺点" class="headerlink" title="欧氏距离的缺点"></a>欧氏距离的缺点</h3><blockquote>
<p>距离度量在各个学科中有着广泛用途，当数据表示为向量$\overrightarrow{\mathbf{x} }=\left(x_{1}, x_{2}, \cdots, x_{n}\right)^{T}$和$\overrightarrow{\mathbf{y}}=\left(y_{1}, y_{2}, \cdots, y_{n}\right)^{T}$时，最直观的距离度量就是欧式距离了：</p>
</blockquote>

$$
d(x, y):=\sqrt{\left(x_{1}-y_{1}\right)^{2}+\left(x_{2}-y_{2}\right)^{2}+\cdots+\left(x_{n}-y_{n}\right)^{2}}=\sqrt{\sum_{i=1}^{n}\left(x_{i}-y_{i}\right)^{2}}
$$



<blockquote>
<p>但是这种度量方式没有考虑到各个维度之间的差异和相关等因素，不同的向量度量距离时权重都相同，这可能会对结果可信度产生干扰。</p>
</blockquote>
<h3 id="马氏距离"><a href="#马氏距离" class="headerlink" title="马氏距离"></a>马氏距离</h3><blockquote>
<p>度量样本距离某个分布的距离，先将样本与分布标准化到多维标准正态分布后度量欧式距离</p>
</blockquote>
<h4 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h4><ul>
<li>将变量按照主成分进行旋转，消除维度间的相关性</li>
<li>对向量和分布进行标准化，让各个维度同为标准正态分布</li>
</ul>
<h4 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h4><ul>
<li>分布由$n$个$m$维向量刻画，即共$n$条数据，每条数据由一个$m$维向量表示：</li>
</ul>

$$
X = \left[ {\begin{array}{*{20}{c}}
{{x_{11}}}&{{x_{12}}}& \cdots &{{x_{1n}}}\\
{{x_{21}}}&{{x_{22}}}&{}&{{x_{2n}}}\\
\vdots &{}& \ddots & \vdots \\
{{x_{m1}}}&{{x_{m2}}}& \cdots &{{x_{mn}}}
\end{array}} \right]
$$


<ul>
<li>$X$的均值为${\mu _X}$</li>
<li>$X$的协方差矩阵为:</li>
</ul>
<p>$$<br>\sum\nolimits_X  =  \frac{1}{n}(X - {\mu _X}){(X - {\mu _X})^T}<br>$$</p>
<ul>
<li>为消除维度间的相关性，通过一个$m \times m$的矩阵$Q^T$对$X$进行坐标表换，将数据映射到新的坐标系下，用$Y$表示：</li>
</ul>
<p>$$<br>Y=Q^TX<br>$$</p>
<blockquote>
<p>此时我们期望在$Q^T$的作用下，$Y$ 的向量表示中，不同维度之间是相互独立的，此时$Y$ 的协方差矩阵应该是一个对角矩阵（除对角线元素外，其余元素均为0）。</p>
</blockquote>
<ul>
<li>Y 的均值：$u_{Y}=Q^{T} u_{X}$</li>
<li>Y 的协方差矩阵：</li>
</ul>

$$
\begin{aligned}
\Sigma_{Y} &=\frac{1}{n}\left[Y-u_{Y}\right]\left[y-u_{Y}\right]^{T} \\
&=\frac{1}{n}\left[Q^{T}\left(X-u_{x}\right)\right]\left[Q^{T}\left(X-u_{X}\right)\right]^{T} \\
&=Q^{T} \frac{1}{n}\left(X-u_{X}\right)\left(X-u_{X}\right)^{T} Q \\
&=Q^{T} \Sigma_{X} Q
\end{aligned}
$$



<ul>
<li><p>从这里可以发现，当 $Q $是$\Sigma_{X}$的特征向量组成的矩阵时，$\Sigma_{Y}$ 一定是对角矩阵，且值为每个特征向量对应的特征值。由于$\Sigma_{X}$是对称矩阵，因此肯定可以通过特征分解得到 $Q$ ，且 $Q$ 是正交矩阵。</p>
</li>
<li><p>$\Sigma_{Y}$的对角线元素含义为$Y$中每个向量的方差，因此均为非负值，从这个角度可以说明协方差矩阵的特征值为非负值。</p>
</li>
<li><p>而且事实上<a href="https://www.zywvvd.com/2021/03/13/math/linear_algebra/cov-pos-sem/cov-pos-sem/#%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E5%8D%8A%E6%AD%A3%E5%AE%9A">协方差矩阵本身就是半正定的</a>，特征值均非负</p>
</li>
<li><p>不相关与独立的问题：</p>
<ul>
<li>此处我们说明了变换后的向量之间相关系数为0，也就是向量之间不相关</li>
<li>而事实上独立是比不相关更强的约束，不相关往往不能推出独立</li>
<li>但在<a href="https://www.zywvvd.com/2021/03/12/math/probability/orthogonal-independent-uncorrelation/orthogonal-independent-uncorrelation/">高斯分布下，不相关和独立是等价的</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>接下来我们对向量进行标准化</p>
</blockquote>
<ul>
<li><p>当我们减去均值后，向量已经变成了0均值的向量，距离标准化仅差将方差变为1</p>
</li>
<li><p>在经历了$Y=Q^TX$变换后，$Y$的协方差矩阵已经成为了对角阵，对角线元素为$Y$中各个维度数据的方差，那么我们仅需让$Y$中各个维度数据除以该维度数据的标准差即可。</p>
</li>
<li><p>我们将去相关化、0均值化、标准化过后的数据记为$Z$：</p>

  $$
  \begin{aligned}
  Z &= \left[ {\begin{array}{*{20}{c}}
  {\frac{1}{{{\sigma _1}}}}&{}&{}&{}\\
  {}&{\frac{1}{{{\sigma _2}}}}&{}&{}\\
  {}&{}& \ddots &{}\\
  {}&{}&{}&{\frac{1}{{{\sigma _n}}}}
  \end{array}} \right](Y - {\mu _Y}) 
  \\&= \Sigma _Y^{ - \frac{1}{2}}{Q^T}(X - {\mu _X}) \\
  &= ({Q^T}{\Sigma _X}Q)_{}^{ - \frac{1}{2}}{Q^T}(X - {\mu _X})
\end{aligned}
  $$
  
</li>
<li><p>而马氏距离就是度量纠正过后的向量$Z$到分布中心（原点）的欧式距离：</p>


$$
\begin{array}{l}
{D_M}(X) & =
\sqrt {{Z^T}Z}  \\&= \sqrt {{{\left( {X - {u_X}} \right)}^T}Q{{\left( {{Q^T}{\Sigma _X}Q} \right)}^{ - \frac{1}{2}}}{{\left( {{Q^T}{\Sigma _X}Q} \right)}^{ - \frac{1}{2}}}{Q^T}\left( {X - {u_X}} \right)} \\
 &= \sqrt {{{\left( {X - {u_X}} \right)}^T}Q{{\left( {{Q^T}{\Sigma _X}Q} \right)}^{ - 1}}{Q^T}\left( {X - {u_X}} \right)} \\
 &= \sqrt {{{\left( {X - {u_X}} \right)}^T}Q{Q^{ - 1}}\Sigma _X^{ - 1}Q{Q^T}\left( {X - {u_X}} \right)} \\
 &= \sqrt {{{\left( {X - {u_X}} \right)}^T}\Sigma _X^{-1}\left( {X - {u_X}} \right)} \\

\end{array}
$$



</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://baike.baidu.com/item/%E9%A9%AC%E6%B0%8F%E8%B7%9D%E7%A6%BB/8927833?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E9%A9%AC%E6%B0%8F%E8%B7%9D%E7%A6%BB/8927833?fr=aladdin</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/109100222" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/109100222</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
      </categories>
      <tags>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title>Pytorch can&#39;t optimize a non-leaf Tensor</title>
    <url>/2021/03/02/deep_learning/pytorch/none-leaf_tensor/none-leaf_tensor/</url>
    <content><![CDATA[<blockquote>
<p>本文记录 pytorch: can’t optimize a non-leaf Tensor 解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><blockquote>
<p>运行优化时报错</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> optim</span><br><span class="line"> </span><br><span class="line">weights = torch.rand(<span class="number">2</span>,<span class="number">1</span>,<span class="number">128</span>,<span class="number">416</span>)</span><br><span class="line">weights.requires_grad = <span class="literal">True</span></span><br><span class="line">weights = weights.cuda()</span><br><span class="line">optimizer = optim.Adam([weights], lr=<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>报错： can’t optimize a non-leaf Tensor</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><blockquote>
<p>需要先把Tensor放入到GPU中，然后再设置Tensor.requires_grad=True。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> optim</span><br><span class="line"> </span><br><span class="line">weights = torch.rand(<span class="number">2</span>,<span class="number">1</span>,<span class="number">128</span>,<span class="number">416</span>)</span><br><span class="line">weights = weights.cuda()</span><br><span class="line">weights.requires_grad = <span class="literal">True</span></span><br><span class="line">optimizer = optim.Adam([weights], lr=<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/nkhgl/article/details/100047276" target="_blank" rel="noopener">https://blog.csdn.net/nkhgl/article/details/100047276</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Deep Learning</category>
        <category>pytorch</category>
      </categories>
      <tags>
        <tag>pytorch</tag>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>概率论基础 - 1 - 基础概念</title>
    <url>/2021/03/01/math/probability/probability_basic_knowledge/</url>
    <content><![CDATA[<blockquote>
<p>本系列记录概率论基础知识，本文介绍最基本的概率论概念。</p>
</blockquote>
<a id="more"></a>

<h3 id="概率与分布"><a href="#概率与分布" class="headerlink" title="概率与分布"></a>概率与分布</h3><h4 id="条件概率与独立事件"><a href="#条件概率与独立事件" class="headerlink" title="条件概率与独立事件"></a>条件概率与独立事件</h4><h5 id="条件概率"><a href="#条件概率" class="headerlink" title="条件概率"></a>条件概率</h5><ul>
<li>已知$A$事件发生的条件下$B$发生的概率，记作$P(B \mid A)$ ，它等于事件$AB$的概率相对于事件$A$的概率，即：</li>
</ul>
<p>$$<br>P(B \mid A)=\frac{P(A B)}{P(A)}<br>$$</p>
<ul>
<li>其中 ${P(A)} &gt; 0$</li>
</ul>
<h5 id="条件概率分布的链式法则"><a href="#条件概率分布的链式法则" class="headerlink" title="条件概率分布的链式法则"></a>条件概率分布的链式法则</h5><ul>
<li>对于$n$个随机变量${X_{1}, X_{2}, \cdots, X_{n}}$ ，有：</li>
</ul>
<p>$$<br>P\left(X_{1}, X_{2}, \cdots, X_{n}\right)=P\left(X_{1}\right) \prod_{i=2}^{n} P\left(X_{i} \mid X_{1}, \cdots, X_{i} 1\right)<br>$$</p>
<h5 id="变量相互独立"><a href="#变量相互独立" class="headerlink" title="变量相互独立"></a>变量相互独立</h5><ul>
<li>两个随机变量$X,Y$相互独立的数学描述：</li>
</ul>
<p>$$<br>P(X, Y)=P(X) P(Y)<br>$$</p>
<h5 id="变量相对独立"><a href="#变量相对独立" class="headerlink" title="变量相对独立"></a>变量相对独立</h5><ul>
<li>两个随机变量$X,Y$关于随机变量$Z$条件独立的数学描述：</li>
</ul>
<p>$$<br>P(X, Y \mid Z)=P(X \mid Z) P(Y \mid Z)<br>$$</p>
<h4 id="联合概率分布"><a href="#联合概率分布" class="headerlink" title="联合概率分布"></a>联合概率分布</h4><h5 id="联合分布"><a href="#联合分布" class="headerlink" title="联合分布"></a>联合分布</h5><ul>
<li>定义$X$和$Y$的联合分布为：</li>
</ul>

$$
P(a, b)=P\{X \leq a, Y \leq b\}, \quad-\infty < a , b < + \infty
$$



<ul>
<li>$X$的分布可以从联合分布中得到：</li>
</ul>

$$
P_{X}(a)=P\{X \leq a\}=P\{X \leq a, Y \leq \infty\}=P(a, \infty), \quad-\infty < a < + \infty
$$



<ul>
<li>$Y$的分布可以从联合分布中得到：</li>
</ul>

$$
P_{Y}(b)=P\{Y \leq b\}=P\{X \leq \infty, Y \leq b\}=P(\infty, b), \quad-\infty < b < + \infty
$$



<h5 id="联合概率质量函数"><a href="#联合概率质量函数" class="headerlink" title="联合概率质量函数"></a>联合概率质量函数</h5><ul>
<li>当$X$和$Y$都是离散随机变量时， 定义$X$和$Y$的联合概率质量函数为：</li>
</ul>

$$
p(x, y)=P\{X=x, Y=y\}
$$



<ul>
<li>$X$和$Y$的概率质量函数分布为：</li>
</ul>
<p>$$<br>p_{X}(x)=\sum_{y} p(x, y) \quad p_{Y}(y)=\sum_{x} p(x, y)<br>$$</p>
<h5 id="概率密度函数"><a href="#概率密度函数" class="headerlink" title="概率密度函数"></a>概率密度函数</h5><ul>
<li>当$X$和$Y$联合地连续时，即存在函数$p(x,y)$ ，使得对于所有的实数集合$\mathbb{A}$和$\mathbb{B}$满足：</li>
</ul>

$$
P\{X \in \mathbb{A}, Y \in \mathbb{B}\}=\int_{\mathbb{B}} \int_{\mathbb{A}} p(x, y) d x d y
$$



<ul>
<li>则函数$p(x,y)$称为$X$和$Y$的概率密度函数。</li>
<li>$X$和$Y$的联合分布为：</li>
</ul>

$$
P(a, b)=P\{X \leq a, Y \leq b\}=\int_{-\infty}^{a} \int_{-\infty}^{b} p(x, y) d x d y
$$



<ul>
<li>$X$和$Y$的分布函数：</li>
</ul>
<p>$$<br>P_{X}(a)=\int_{-\infty}^{a} \int_{-\infty}^{\infty} p(x, y) d x d y=\int_{-\infty}^{a} p_{X}(x) d x<br>$$</p>
<p>$$<br>P_{Y}(b)=\int_{\infty}^{\infty} \int_{\infty}^{b} p(x, y) d x d y=\int_{\infty}^{b} p_{Y}(y) d y<br>$$</p>
<ul>
<li>$X$和$Y$的概率密度函数：</li>
</ul>
<p>$$<br>p_{X}(x)=\int_{-\infty}^{\infty} p(x, y) d y<br>$$</p>
<p>$$<br>p_{Y}(y)=\int_{-\infty}^{\infty} p(x, y) d x<br>$$</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/2_probability.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>probability</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>probability</tag>
      </tags>
  </entry>
  <entry>
    <title>线性代数 - 1 - 基础知识</title>
    <url>/2021/02/27/math/linear_algebra/basic_knowledge/</url>
    <content><![CDATA[<blockquote>
<p>线性代数，基础知识，温故知新。</p>
</blockquote>
<a id="more"></a>

<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li>向量：</li>
</ul>
<blockquote>
<p>向量默认为列向量：</p>
</blockquote>


$$
\overrightarrow{\mathbf{x}}=\left(x_{1}, x_{2}, \cdots, x_{n}\right)^{T}=\left[\begin{array}{c}
x_{1} \\
x_{2} \\
\vdots \\
x_{n}
\end{array}\right]
$$



<ul>
<li>矩阵 $\mathbf{X} \in \mathbb{R}^{m \times n}$，表示为：</li>
</ul>

$$
\mathbf{X}=\left[\begin{array}{cccc}
x_{1,1} & x_{1,2} & \cdots & x_{1, n} \\
x_{2,1} & x_{2,2} & \cdots & x_{2, n} \\
\vdots & \vdots & \ddots & \vdots \\
x_{m, 1} & x_{m, 2} & \cdots & x_{m, n}
\end{array}\right]
$$



<h3 id="范数"><a href="#范数" class="headerlink" title="范数"></a>范数</h3><h4 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h4><h5 id="1-范数"><a href="#1-范数" class="headerlink" title="1-范数"></a><strong>1-范数</strong></h5><blockquote>
<p>各个元素的绝对值之和</p>
</blockquote>

$$
\|X\|_{1}=\sum_{i=1}^{n}\left|x_{i}\right|
$$



<h5 id="2-范数"><a href="#2-范数" class="headerlink" title="2-范数"></a>2-范数</h5><blockquote>
<p>每个元素的平方和再开平方根</p>
</blockquote>

$$
\|X\|_{2}=\left(\sum_{i=1}^{n} x_{i}^{2}\right)^{\frac{1}{2}}=\sqrt{\sum_{i=1}^{n} x_{i}^{2}}
$$



<h5 id="p-范数"><a href="#p-范数" class="headerlink" title="p-范数"></a><strong>p-范数</strong></h5>
$$
\|X\|_{p}=\left(\sum_{i=1}^{n}\left|x_{i}\right|^{p}\right)^{\frac{1}{p}}
$$



<ul>
<li>其中正整数<em>p</em>≥1，并且有 $\lim _{p \rightarrow \infty}\|X\|_{p}=\max _{1 \leq i \leq n}\left|x_{i}\right|$.</li>
</ul>
<h5 id="无穷范数"><a href="#无穷范数" class="headerlink" title="无穷范数"></a><strong>无穷范数</strong></h5>

$$
\|X\|_{\infty}=\max _ { 1 < i< n}\left|x_{i}\right | 
$$



<blockquote>
<p>为向量中绝对值最大的元素的值。</p>
</blockquote>
<h4 id="矩阵范数"><a href="#矩阵范数" class="headerlink" title="矩阵范数"></a>矩阵范数</h4><h5 id="1-范数（列模）"><a href="#1-范数（列模）" class="headerlink" title="1-范数（列模）"></a><strong>1-范数（列模）</strong></h5><blockquote>
<p>矩阵的每一列上的元素绝对值先求和，再从中取个最大的，（列和最大）</p>
</blockquote>

$$
\|A\|_{1}=\max _{1 \leq j \leq n} \sum_{i=1}^{n} \mid a_{i j}\mid
$$

<h5 id="2-范数（谱模）："><a href="#2-范数（谱模）：" class="headerlink" title="2-范数（谱模）："></a><strong>2-范数（谱模）：</strong></h5><blockquote>
<p>最大特征值开平方根：</p>
</blockquote>

$$
\mid\mid A \|_{2}=\sqrt{\lambda_{\max }\left(A^{T} A\right)}=\sqrt{\max _{1 \leq i \leq n}\left|\lambda_{i}\right|}
$$

<h5 id="无穷范数（行模）："><a href="#无穷范数（行模）：" class="headerlink" title="无穷范数（行模）："></a><strong>无穷范数（行模）</strong>：</h5><blockquote>
<p>矩阵的每一行上的元素绝对值先求和，再从中取个最大的，（行和最大）</p>
</blockquote>

$$
\|A\|_{\infty}=\max _{1 \leq i \leq n} \sum_{j=1}^{n} \mid a_{i j}\mid
$$



<h5 id="L0范数："><a href="#L0范数：" class="headerlink" title="L0范数："></a><strong>L0范数</strong>：</h5><blockquote>
<p>矩阵的非0元素的个数，通常用它来表示稀疏，L0范数越小0元素越多，也就越稀疏</p>
</blockquote>
<h5 id="L1范数："><a href="#L1范数：" class="headerlink" title="L1范数："></a><strong>L1范数：</strong></h5><blockquote>
<p>矩阵中的每个元素绝对值之和，它是L0范数的最优凸近似，因此它也可以近似表示稀疏</p>
</blockquote>
<h5 id="F范数："><a href="#F范数：" class="headerlink" title="F范数："></a><strong>F范数：</strong></h5><blockquote>
<p>矩阵的各个元素平方之和再开平方根，它通常也叫做矩阵的L2范数，它的优点在它是一个凸函数，可以求导求解，易于计算</p>
</blockquote>

$$
\|\mathbf{A}\|_{F}=\sqrt{\sum_{i, j} a_{i, j}^{2}}
$$



<h3 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h3><ul>
<li>方阵 $A$ 的行列式，记作 $det(A)$或$|A|$：</li>
</ul>

$$
D=\left|\begin{array}{llll}
a_{11} & a_{12} & \cdots & a_{1 n} \\
a_{21} & a_{22} & \cdots & a_{2 n} \\
\cdots & \cdots & \cdots & \cdots \\
a_{n 1} & a_{n 2} & \cdots & a_{n n}
\end{array}\right|
$$


<ul>
<li>计算公式：</li>
</ul>
<p>$$<br>D=\sum (- 1) ^ {k } a_{1 k_{ 1} } a_{2 k_{2} } \cdots a_ { n k _ { n} }<br>$$</p>
<ul>
<li>表示的是$n$个$n$维向量构成的n维平行多面体的体积，该体积有正负，若存在线性相关的向量，行列式为0</li>
<li>行列式$A$中某行(或列)用同一数$k$乘,其结果等于$kA$</li>
<li>行列式$A$等于其转置行列式$A^T$($A^T$的第i行为$A$的第$i$列)</li>
<li>行列式$A$中两行（或列）互换,其结果等于$-A$</li>
<li>把行列式$A$的某行（或列）中各元同乘一数后加到另一行（或列）中各对应元上，结果仍然是$A$</li>
</ul>
<h3 id="方阵的迹"><a href="#方阵的迹" class="headerlink" title="方阵的迹"></a>方阵的迹</h3><ul>
<li>方阵$\mathbf{A}=\left(a_{i, j}\right)_{n \times n}$的迹，记作$\operatorname{tr}(\mathbf{A})$，对角线元素之和，也等于特征值的和：</li>
</ul>

$$
\operatorname{tr}(\mathbf{A})=\sum_{i} a_{i, i}
$$



<h3 id="向量积"><a href="#向量积" class="headerlink" title="向量积"></a>向量积</h3><h4 id="点积（Dot-Product）"><a href="#点积（Dot-Product）" class="headerlink" title="点积（Dot Product）"></a>点积<strong>（Dot Product）</strong></h4><blockquote>
<p>对应元素乘积和，结果不是一个向量，而是一个标量（Scalar）</p>
</blockquote>

$$
{\bf{A} } \cdot {\bf{B} } = \sum\limits_i { {a_i}{b_i} }  = \left| A \right|\left| B \right|Cos\left( \theta  \right)
$$



<h4 id="叉乘（cross-product）"><a href="#叉乘（cross-product）" class="headerlink" title="叉乘（cross product）"></a><strong>叉乘（cross product）</strong></h4><h5 id="三维向量的叉积："><a href="#三维向量的叉积：" class="headerlink" title="三维向量的叉积："></a>三维向量的叉积：</h5><blockquote>
<p>用三阶行列式表示</p>
</blockquote>

$$
\overrightarrow{\mathbf{u}}=u_{x} \overrightarrow{\mathbf{i}}+u_{y} \overrightarrow{\mathbf{j}}+u_{z} \overrightarrow{\mathbf{k}}, \quad \overrightarrow{\mathbf{v}}=v_{x} \overrightarrow{\mathbf{i}}+v_{y} \overrightarrow{\mathbf{j}}+v_{z} \overrightarrow{\mathbf{k}}
$$



<blockquote>
<p>其中$\overrightarrow{\mathbf{i}}, \overrightarrow{\mathbf{j}}, \overrightarrow{\mathbf{k}}$分别为$x, y, z$轴的单位向量。</p>
</blockquote>

$$
\overrightarrow{\mathbf{w}}=\overrightarrow{\mathbf{u}} \times \overrightarrow{\mathbf{v}}=\left[\begin{array}{ccc}
\overrightarrow{\mathbf{i}} & \overrightarrow{\mathbf{j}} & \overrightarrow{\mathbf{k}} \\
u_{x} & u_{y} & u_{z} \\
v_{x} & v_{y} & v_{z}
\end{array}\right]
$$



<ul>
<li>$\overrightarrow{\mathbf{u}}, \overrightarrow{\mathbf{v}}$的叉积垂直于$\overrightarrow{\mathbf{u}}, \overrightarrow{\mathbf{v}}$构成的平面，其方向符合右手规则</li>
<li>叉积的模等于$\overrightarrow{\mathbf{u}}, \overrightarrow{\mathbf{v}}$构成的平行四边形的面积</li>
</ul>
<h4 id="向量的并矢"><a href="#向量的并矢" class="headerlink" title="向量的并矢"></a>向量的并矢</h4><blockquote>
<p>给定两个向量 $\overrightarrow{\mathbf{x}}=\left(x_{1}, x_{2}, \cdots, x_{n}\right)^{T}, \overrightarrow{\mathbf{y}}=\left(y_{1}, y_{2}, \cdots, y_{m}\right)^{T}$  ，则向量的并矢记作：</p>
</blockquote>

$$
\overrightarrow{\mathbf{x}} \overrightarrow{\mathbf{y}}=\left[\begin{array}{cccc}
x_{1} y_{1} & x_{1} y_{2} & \cdots & x_{1} y_{m} \\
x_{2} y_{1} & x_{2} y_{2} & \cdots & x_{2} y_{m} \\
\vdots & \vdots & \ddots & \vdots \\
x_{n} y_{1} & x_{n} y_{2} & \cdots & x_{n} y_{m}
\end{array}\right]
$$



<blockquote>
<p>也记作$\overrightarrow{\mathbf{x}} \otimes \overrightarrow{\mathbf{y}}$或者$\overrightarrow{\mathbf{x}} \overrightarrow{\mathbf{y}}^{T}$。</p>
</blockquote>
<h3 id="矩阵运算"><a href="#矩阵运算" class="headerlink" title="矩阵运算"></a>矩阵运算</h3><blockquote>
<p>给定两个矩阵$\mathbf{A}=\left(a_{i, j}\right) \in \mathbb{R}^{m \times n}, \mathbf{B}=\left(b_{i, j}\right) \in \mathbb{R}^{m \times n}$ ，定义：</p>
</blockquote>
<h4 id="阿达马积-Hadamard-product-（又称作逐元素积）"><a href="#阿达马积-Hadamard-product-（又称作逐元素积）" class="headerlink" title="阿达马积(Hadamard product)（又称作逐元素积）"></a>阿达马积(Hadamard product)（又称作逐元素积）</h4>
$$
\mathbf{A} \circ \mathbf{B}=\left[\begin{array}{cccc}
a_{1,1} b_{1,1} & a_{1,2} b_{1,2} & \cdots & a_{1, n} b_{1, n} \\
a_{2,1} b_{2,1} & a_{2,2} b_{2,2} & \cdots & a_{2, n} b_{2, n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m, 1} b_{m, 1} & a_{m, 2} b_{m, 2} & \cdots & a_{m, n} b_{m, n}
\end{array}\right]
$$



<h4 id="克罗内积-Kronnecker-product"><a href="#克罗内积-Kronnecker-product" class="headerlink" title="克罗内积(Kronnecker product)"></a>克罗内积(Kronnecker product)</h4>
$$
\mathbf{A} \otimes \mathbf{B}=\left[\begin{array}{cccc}
a_{1,1} \mathbf{B} & a_{1,2} \mathbf{B} & \cdots & a_{1, n} \mathbf{B} \\
a_{2,1} \mathbf{B} & a_{2,2} \mathbf{B} & \cdots & a_{2, n} \mathbf{B} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m, 1} \mathbf{B} & a_{m, 2} \mathbf{B} & \cdots & a_{m, n} \mathbf{B}
\end{array}\right]
$$



<h3 id="偏导数"><a href="#偏导数" class="headerlink" title="偏导数"></a>偏导数</h3><ul>
<li>标量对标量的偏导数：$\frac{\partial u}{\partial v}$ 。</li>
<li>标量对向量（ $n$ 维向量）的偏导数 ： $\frac{\partial u}{\partial \overrightarrow{\mathbf{v}}}=\left(\frac{\partial u}{\partial v_{1}}, \frac{\partial u}{\partial v_{2}}, \cdots, \frac{\partial u}{\partial v_{n}}\right)^{T}$。</li>
<li>标量对矩阵( $m \times n$阶矩阵)的偏导数：</li>
</ul>

$$
\frac{\partial u}{\partial \mathbf{V}}=\left[\begin{array}{cccc}
\frac{\partial u}{\partial V_{1,1}} & \frac{\partial u}{\partial V_{1,2}} & \cdots & \frac{\partial u}{\partial V_{1, n}} \\
\frac{\partial u}{\partial V_{2,1}} & \frac{\partial u}{\partial V_{2,2}} & \cdots & \frac{\partial u}{\partial V_{2, n}} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial u}{\partial V_{m, 1}} & \frac{\partial u}{\partial V_{m, 2}} & \cdots & \frac{\partial u}{\partial V_{m, n}}
\end{array}\right]
$$



<ul>
<li>向量（ $m$维向量）对标量的偏导数：$\frac{\partial \overrightarrow{\mathbf{u}}}{\partial v}=\left(\frac{\partial u_{1}}{\partial v}, \frac{\partial u_{2}}{\partial v}, \cdots, \frac{\partial u_{m}}{\partial v}\right)^{T}$ 。</li>
<li>向量（ $m$维向量）对向量 ( $n$维向量) 的偏导数（雅可比矩阵，行优先）如果为列优先，则为矩阵的转置。</li>
</ul>

$$
\frac{\partial \overrightarrow{\mathbf{u}}}{\partial \overrightarrow{\mathbf{v}}}=\left[\begin{array}{cccc}
\frac{\partial u_{1}}{\partial v_{1}} & \frac{\partial u_{1}}{\partial v_{2}} & \cdots & \frac{\partial u_{1}}{\partial v_{n}} \\
\frac{\partial u_{2}}{\partial v_{1}} & \frac{\partial u_{2}}{\partial v_{2}} & \cdots & \frac{\partial u_{2}}{\partial v_{n}} \\
\vdots & \vdots & \ddots & \vdots \\
\frac{\partial u_{m}}{\partial v_{1}} & \frac{\partial u_{m}}{\partial v_{2}} & \cdots & \frac{\partial u_{m}}{\partial v_{n}}
\end{array}\right]
$$



<ul>
<li>矩阵( $m \times n$阶矩阵)对标量的偏导数</li>
</ul>

$$
\frac{\partial \mathbf{U}}{\partial v}=\left[\begin{array}{cccc}
   \frac{\partial U_{1,1}}{\partial v} & \frac{\partial U_{1,2}}{\partial v} & \cdots & \frac{\partial U_{1, n}}{\partial v} \\
   \frac{\partial U_{2,1}}{\partial v} & \frac{\partial U_{2,2}}{\partial v} & \cdots & \frac{\partial U_{2, n}}{\partial v} \\
   \vdots & \vdots & \ddots & \vdots \\
   \frac{\partial U_{m, 1}}{\partial v} & \frac{\partial U_{m, 2}}{\partial v} & \cdots & \frac{\partial U_{m, n}}{\partial v}
   \end{array}\right]
$$



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/1_algebra.html" target="_blank" rel="noopener">http://www.huaxiaozhuan.com/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/chapters/1_algebra.html</a></p>
</li>
<li><p><a href="https://blog.csdn.net/zaishuiyifangxym/article/details/81673491" target="_blank" rel="noopener">https://blog.csdn.net/zaishuiyifangxym/article/details/81673491</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>linear_algebra</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>linear_algebra</tag>
      </tags>
  </entry>
  <entry>
    <title>VS code 显示远程 Linux 图形界面</title>
    <url>/2021/02/20/software/ide/vs_code-remote-gui/vs-code-remote-gui/</url>
    <content><![CDATA[<blockquote>
<p>VS code 在远程登录服务器后无法直接像 pycharm 一样显示远程图像，对分析数据十分不便。本文记录vscode实现远程gui的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h3><ul>
<li>本地电脑系统：window10</li>
<li>远程服务器系统：Ubuntu16.04</li>
</ul>
<h3 id="基础工作"><a href="#基础工作" class="headerlink" title="基础工作"></a>基础工作</h3><blockquote>
<p>由于直接用vscode尝试远程界面显示不易调试（不要问我怎么知道的），先实现脱离vscode，使用shell的远程显示</p>
</blockquote>
<ul>
<li>shell的远程显示：<a href="https://www.zywvvd.com/2021/02/20/linux/remote-linux-gui/remote-linux-gui/">Windows Xming +Xshell 实现远程 linux gui 界面本地展示</a></li>
</ul>
<blockquote>
<p>接下来实现VScode远程调试，实现ssh key免密连接远程服务器</p>
</blockquote>
<ul>
<li>vscode远程连接linux主机：<a href="https://www.zywvvd.com/2020/11/02/software/ide/vs_code_remote_debugging/vs_code_remote_debugging/">VS code 远程调试配置</a></li>
</ul>
<h3 id="远程显示实现"><a href="#远程显示实现" class="headerlink" title="远程显示实现"></a>远程显示实现</h3><blockquote>
<p>使用VS code 插件 <a href="https://marketplace.visualstudio.com/items?itemName=spadin.remote-x11" target="_blank" rel="noopener">Remote X11</a> </p>
<p>需要在后台开启 Xming Server</p>
</blockquote>
<ul>
<li>本地安装插件 Remote X11(SSH) （远程端不用安装）</li>
<li>打开VS code <code>文件</code> -&gt; <code>首选项</code> -&gt; <code>设置</code> -&gt; <code>remote x11</code></li>
<li>设置私钥位置、远程Host、远程端口号：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220152108.png"></p>
<ul>
<li>设置 .vscode/launch.json，加入 env</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220152919.png"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用 IntelliSense 了解相关属性。 </span></span><br><span class="line">    <span class="comment">// 悬停以查看现有属性的描述。</span></span><br><span class="line">    <span class="comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Python: 当前文件"</span>,</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"python"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="attr">"program"</span>: <span class="string">"$&#123;file&#125;"</span>,</span><br><span class="line">            <span class="attr">"console"</span>: <span class="string">"integratedTerminal"</span>,</span><br><span class="line">            <span class="attr">"justMyCode"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"env"</span>: &#123;</span><br><span class="line">                <span class="attr">"DISPLAY"</span>:<span class="string">"10.0.2.19:0.0"</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>这样在该工程中就可以使用显示图像的命令显示远程的图像了。</li>
</ul>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ul>
<li>在VS code 终端输入命令：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export DISPLAY&#x3D;本机IP:0.0</span><br><span class="line">xclock</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220094136.png"></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://blog.csdn.net/Dteam_f/article/details/109806294?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=4df63aa8-dedc-4bc9-a1af-5a4e70f6924d&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">https://blog.csdn.net/Dteam_f/article/details/109806294?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=4df63aa8-dedc-4bc9-a1af-5a4e70f6924d&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control</a></p>
</li>
<li><p><a href="https://blog.csdn.net/zb12138/article/details/107160825/" target="_blank" rel="noopener">https://blog.csdn.net/zb12138/article/details/107160825/</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows Xming +Xshell 实现远程 linux gui 界面本地展示</title>
    <url>/2021/02/20/linux/remote-linux-gui/remote-linux-gui/</url>
    <content><![CDATA[<blockquote>
<p>Windows 远程登录服务器后，由于是使用终端远程登录，并且远程服务器没有图形界面，显示图像很不方便。本文记录使用 Xming +Xshell 6 实现远程打开Linux界面的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="基本环境"><a href="#基本环境" class="headerlink" title="基本环境"></a>基本环境</h3><ul>
<li><p>本地电脑系统：window10</p>
</li>
<li><p>远程服务器系统：Ubuntu16.04</p>
</li>
</ul>
<h3 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h3><ul>
<li>服务器没有图形界面，但是相应显示的信息事实上是可以生成的，需要使用X11将该显示转发到其他可以显示的计算机，再由该计算机进行显示。</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220094812.png"></p>
<ul>
<li>X 协议由 X server 和 X client 组成（这里X server对应本地电脑，X Client对应服务器）：<ul>
<li>X server 管理主机上与显示相关的硬件设置（如显卡、硬盘、鼠标等），它负责屏幕画面的绘制与显示，以及将输入设置（如键盘、鼠标）的动作告知 X client。</li>
<li>X client (即 X 应用程序) 则主要负责事件的处理（即程序的逻辑）。</li>
</ul>
</li>
</ul>
<blockquote>
<p>举个例子，如果用户点击了鼠标左键，因为鼠标归 X server 管理，于是 X server 就捕捉到了鼠标点击这个动作，然后它将这个动作告诉 X client，因为 X client 负责程序逻辑，于是 X client 就根据程序预先设定的逻辑（例如画一个圆），告诉 X server 说：“请在鼠标点击的位置，画一个圆”。最后，X server 就响应 X client 的请求，在鼠标点击的位置，绘制并显示出一个圆。</p>
</blockquote>
<h3 id="工具下载安装与配置"><a href="#工具下载安装与配置" class="headerlink" title="工具下载安装与配置"></a>工具下载安装与配置</h3><ul>
<li>Xming 可以去下载免费版：<a href="https://xming.en.softonic.com/download" target="_blank" rel="noopener">https://xming.en.softonic.com/download</a></li>
<li>Xshell 6个人免费版：<a href="https://www.netsarang.com/download/free_license.html" target="_blank" rel="noopener">https://www.netsarang.com/download/free_license.html</a></li>
</ul>
<h4 id="XMing安装"><a href="#XMing安装" class="headerlink" title="XMing安装"></a>XMing安装</h4><ul>
<li>–&gt; Mutiple windows </li>
</ul>
<blockquote>
<p>需要记住安装时的display number 为 0。</p>
</blockquote>
<ul>
<li><p>–&gt; Start no client </p>
</li>
<li><p> –&gt;Clipbard</p>
</li>
</ul>
<blockquote>
<p>建议勾选一个 <code>no access control</code>可能会方便一些</p>
</blockquote>
<ul>
<li> –&gt; 完成</li>
</ul>
<h4 id="XMing配置"><a href="#XMing配置" class="headerlink" title="XMing配置"></a>XMing配置</h4><blockquote>
<p>这时还要设置IP充许，如果不设IP充许，将会被Xming拒绝而打不开：首先打开Xming安装文件夹找到 X*.hosts 文件(*号为上面Display Number 数字），如本例就是找到X0.hosts文件，打开并在localhost下面一行，添加Linux服务器的IP地址。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">localhost</span><br><span class="line">192.168.10.2</span><br><span class="line">192.168.10.3</span><br><span class="line">192.168.10.4</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此处填需要被远程登录的服务器地址。</p>
</blockquote>
<h4 id="Xshell-6-安装"><a href="#Xshell-6-安装" class="headerlink" title="Xshell 6 安装"></a>Xshell 6 安装</h4><blockquote>
<p>没啥可说的，装就完了。</p>
</blockquote>
<h4 id="Xshell-6-配置"><a href="#Xshell-6-配置" class="headerlink" title="Xshell 6 配置"></a>Xshell 6 配置</h4><ul>
<li>设置用户身份认证，账号密码、ssh key都可以的</li>
<li>再SSH –&gt; 隧道选项卡里设置<code>转发X11连接到</code>：<code>X DISPLAY</code>:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">localhost:0.0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此处的 0.0 可以设置为其他，记录下来和服务器端配置相当即可</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220093437.png"></p>
<h3 id="远程配置"><a href="#远程配置" class="headerlink" title="远程配置"></a>远程配置</h3><ul>
<li>X shell 登录远程服务器</li>
<li>设置DISPLAY：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export DISPLAY=本机IP地址：0.0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>本机IP为当前使用的计算机， 0.0 对应在X shell 中转发的 0.0</p>
</blockquote>
<ul>
<li>建议将该设置添加到 <code>~/.bashrc</code> 文件中</li>
</ul>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><blockquote>
<p>此时可以用显示图形的应用测试是否配置成功，此处使用 xclock， xterm进行测试</p>
</blockquote>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><ul>
<li>安装 x11-apps</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt-get install x11-apps</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或</span></span><br><span class="line">yum install xorg-x11-apps*</span><br></pre></td></tr></table></figure>

<ul>
<li>运行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">xclock</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220094136.png"></p>
<ul>
<li>安装 xterm</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get install xterm</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20210220094401.png"></p>
<ul>
<li>显示上述界面说明图形界面转发成功</li>
<li>如果报错可以尝试安装图形界再面试一下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get install xserver-xorg x11-xserver-utils</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://blog.csdn.net/akuoma/article/details/82182913" target="_blank" rel="noopener">https://blog.csdn.net/akuoma/article/details/82182913</a></p>
</li>
<li><p><a href="https://blog.csdn.net/lmyclever/article/details/7422243" target="_blank" rel="noopener">https://blog.csdn.net/lmyclever/article/details/7422243</a></p>
</li>
<li><p><a href="https://blog.csdn.net/Dteam_f/article/details/109806294?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=4df63aa8-dedc-4bc9-a1af-5a4e70f6924d&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">https://blog.csdn.net/Dteam_f/article/details/109806294?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=4df63aa8-dedc-4bc9-a1af-5a4e70f6924d&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Jupyter notebook 启动错误  “sys/un.h” No such file or directory</title>
    <url>/2021/02/20/python/jupyter-error/jupyter-error/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Jupyter notebook 启动错误  “sys/un.h” No such file or directory 的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="错误复现"><a href="#错误复现" class="headerlink" title="错误复现"></a>错误复现</h3><blockquote>
<p>在运行 <code>jupyter notebook</code>命令时，报错如下：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> jupyter notebook</span></span><br><span class="line">_cffi_ext.c</span><br><span class="line">E:\ProgramData\Anaconda3\lib\site-packages\zmq\backend\cffi\__pycache__\_cffi_ext.c(213): fatal error C1083: 无法打开包 括文件: “sys/un.h”: No such file or directory</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "E:\ProgramData\Anaconda3\Scripts\jupyter-notebook-script.py", line 6, in &lt;module&gt;</span><br><span class="line">    from notebook.notebookapp import main</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\notebook\notebookapp.py", line 46, in &lt;module&gt;</span><br><span class="line">    from zmq.eventloop import ioloop</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\__init__.py", line 47, in &lt;module&gt;</span><br><span class="line">    from zmq import backend</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\backend\__init__.py", line 40, in &lt;module&gt;</span><br><span class="line">    reraise(*exc_info)</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\utils\sixcerpt.py", line 34, in reraise</span><br><span class="line">    raise value</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\backend\__init__.py", line 27, in &lt;module&gt;</span><br><span class="line">    _ns = select_backend(first)</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\backend\select.py", line 27, in select_backend</span><br><span class="line">    mod = __import__(name, fromlist=public_api)</span><br><span class="line">  File "E:\ProgramData\Anaconda3\lib\site-packages\zmq\backend\cython\__init__.py", line 6, in &lt;module&gt;</span><br><span class="line">    from . import (constants, error, message, context,</span><br><span class="line">ImportError: DLL load failed: 找不到指定的模块。</span><br></pre></td></tr></table></figure>

<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>卸载pyzmq</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip uninstall pyzmq</span><br></pre></td></tr></table></figure>

<ul>
<li>安装pyzmq</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install pyzmq --user</span><br></pre></td></tr></table></figure>

<ul>
<li>重新启动 jupyter notebook</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jupyter notebook</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>安装 Cuda 10.2 报错</title>
    <url>/2021/02/18/deep_learning/environment/cuda10.2-install-error/cuda10.2-install-error/</url>
    <content><![CDATA[<blockquote>
<p>本文记录 [ERROR]: boost::filesystem::remove: Directory not empty 解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><blockquote>
<p>安装cuda 10.2 时报错（错误在日志中 /var/log/cuda-installer.log）</p>
</blockquote>
<ul>
<li>[ERROR]: boost::filesystem::remove: Directory not empty: “/var/log/nvidia/.uninstallManifests/“</li>
</ul>
<blockquote>
<p>Cuda 包 ：</p>
</blockquote>
<ul>
<li>cuda_10.2.89_440.33.01_linux.run</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>安装时加上参数<code> --librarypath=/usr/local/cuda-10.2</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sh cuda_10.2.89_440.33.01_linux.run --librarypath&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-10.2</span><br></pre></td></tr></table></figure>

<h3 id="测试CUDA是否安装成功"><a href="#测试CUDA是否安装成功" class="headerlink" title="测试CUDA是否安装成功"></a>测试CUDA是否安装成功</h3><ul>
<li>修改 ~/.bashrc 文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-10.2&#x2F;bin$&#123;PATH:+:$&#123;PATH&#125;&#125;</span><br><span class="line">export LD_LIBRARY_PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-10.2&#x2F;lib64$&#123;LD_LIBRARY_PATH:+:$&#123;LD_LIBRARY_PATH&#125;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>更新环境变量配置</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<ul>
<li>使用<code>nvcc -V</code>测试是否能检测到Cuda</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> nvcc -V</span></span><br><span class="line"></span><br><span class="line">nvcc: NVIDIA (R) Cuda compiler driver</span><br><span class="line">Copyright (c) 2005-2019 NVIDIA Corporation</span><br><span class="line">Built on Wed_Oct_23_19:24:38_PDT_2019</span><br><span class="line">Cuda compilation tools, release 10.2, V10.2.89</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://www.freesion.com/article/54731320387/" target="_blank" rel="noopener">https://www.freesion.com/article/54731320387/</a></p>
</li>
<li><p><a href="https://tieba.baidu.com/p/6848132251" target="_blank" rel="noopener">https://tieba.baidu.com/p/6848132251</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Error unsupported compiler 9.3.0</title>
    <url>/2021/02/18/deep_learning/pytorch/unsupported-compiler/unsupported-compiler/</url>
    <content><![CDATA[<blockquote>
<p>本文记录 Error: unsupported compiler: 9.3.0 解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><blockquote>
<p>安装cuda 10.2 时报错</p>
</blockquote>
<ul>
<li>Error: unsupported compiler: 9.3.0</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove gcc gcc-9</span><br><span class="line">sudo apt-get remove g++</span><br><span class="line"></span><br><span class="line">sudo apt install gcc-8 g++-8</span><br><span class="line"></span><br><span class="line">sudo ln -s &#x2F;usr&#x2F;bin&#x2F;gcc-8 &#x2F;usr&#x2F;bin&#x2F;gcc</span><br><span class="line">sudo ln -s &#x2F;usr&#x2F;bin&#x2F;g++-8 &#x2F;usr&#x2F;bin&#x2F;g++</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Nosql 基础概念</title>
    <url>/2021/02/10/dataset/nosql/nosql/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍非关系型数据库的基本概念，及其与关系型数据库直接的关联。</p>
</blockquote>
<a id="more"></a>

<h3 id="Nosql"><a href="#Nosql" class="headerlink" title="Nosql"></a>Nosql</h3><blockquote>
<p>NoSQL(NoSQL = Not Only SQL )，意即”不仅仅是SQL”。</p>
</blockquote>
<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><blockquote>
<p>NoSQL 是一项全新的数据库革命性运动，早期就有人提出，发展至2009年趋势越发高涨。NoSQL的拥护者们提倡运用非关系型的数据存储，相对于铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</p>
<p>指的是非关系型的数据库。NoSQL有时也称作Not Only SQL的缩写，是对不同于传统的关系型数据库的数据库管理系统的统称。</p>
<p>NoSQL用于超大规模数据的存储。（例如谷歌或Facebook每天为他们的用户收集万亿比特的数据）。这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。。</p>
</blockquote>
<h4 id="RDBMS-vs-NoSQL"><a href="#RDBMS-vs-NoSQL" class="headerlink" title="RDBMS vs NoSQL"></a>RDBMS vs NoSQL</h4><p><strong>RDBMS</strong></p>
<ul>
<li>高度组织化结构化数据</li>
<li>结构化查询语言（SQL） (SQL)</li>
<li>数据和关系都存储在单独的表中。</li>
<li>数据操纵语言，数据定义语言</li>
<li>严格的一致性</li>
<li>基础事务</li>
</ul>
<p><strong>NoSQL</strong></p>
<ul>
<li>代表着不仅仅是SQL</li>
<li>没有声明性查询语言</li>
<li>没有预定义的模式键 - 值对存储，列存储，文档存储，图形数据库</li>
<li>最终一致性，而非ACID属性</li>
<li>非结构化和不可预知的数据</li>
<li>CAP定理</li>
<li>高性能，高可用性和可伸缩性</li>
</ul>
<h4 id="NoSQL的优点-缺点"><a href="#NoSQL的优点-缺点" class="headerlink" title="NoSQL的优点/缺点"></a>NoSQL的优点/缺点</h4><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ul>
<li>高可扩展性</li>
<li>分布式计算</li>
<li>低成本</li>
<li>架构的灵活性，半结构化数据</li>
<li>没有复杂的关系</li>
</ul>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><ul>
<li>没有标准化</li>
<li>有限的查询功能（到目前为止）</li>
<li>最终一致是不直观的程序</li>
</ul>
<h3 id="ACID-vs-BASE"><a href="#ACID-vs-BASE" class="headerlink" title="ACID vs BASE"></a>ACID vs BASE</h3><table>
<thead>
<tr>
<th align="left">ACID</th>
<th align="left">BASE</th>
</tr>
</thead>
<tbody><tr>
<td align="left">原子性(<strong>A</strong>tomicity)</td>
<td align="left">基本可用(<strong>B</strong>asically <strong>A</strong>vailable)</td>
</tr>
<tr>
<td align="left">一致性(<strong>C</strong>onsistency)</td>
<td align="left">软状态/柔性事务(<strong>S</strong>oft state)</td>
</tr>
<tr>
<td align="left">隔离性(<strong>I</strong>solation)</td>
<td align="left">最终一致性 (<strong>E</strong>ventual consistency)</td>
</tr>
<tr>
<td align="left">持久性 (<strong>D</strong>urable)</td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="NoSQL-数据库分类"><a href="#NoSQL-数据库分类" class="headerlink" title="NoSQL 数据库分类"></a>NoSQL 数据库分类</h3><table>
<thead>
<tr>
<th>类型</th>
<th>部分代表</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>列存储</td>
<td>Hbase<br />Cassandra<br />Hypertable</td>
<td>顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势。</td>
</tr>
<tr>
<td>文档存储</td>
<td>MongoDB<br />CouchDB</td>
<td>文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有有机会对某些字段建立索引，实现关系数据库的某些功能。</td>
</tr>
<tr>
<td>key-value存储</td>
<td>Tokyo Cabinet / Tyrant<br />Berkeley DB<br />MemcacheDB<br />Redis</td>
<td>可以通过key快速查询到其value。一般来说，存储不管value的格式，照单全收。（Redis包含了其他功能）</td>
</tr>
<tr>
<td>图存储</td>
<td>Neo4J<br />FlockDB</td>
<td>图形关系的最佳存储。使用传统关系数据库来解决的话性能低下，而且设计使用不方便。</td>
</tr>
<tr>
<td>对象存储</td>
<td>db4o<br />Versant</td>
<td>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。</td>
</tr>
<tr>
<td>xml数据库</td>
<td>Berkeley DB XML<br />BaseX</td>
<td>高效的存储XML数据，并支持XML的内部查询语法，比如XQuery,Xpath。</td>
</tr>
</tbody></table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.w3cschool.cn/mongodb/nosql.html" target="_blank" rel="noopener">https://www.w3cschool.cn/mongodb/nosql.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>dataset</category>
      </categories>
      <tags>
        <tag>dataset</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB 简易教程</title>
    <url>/2021/02/10/dataset/mangodb/MongoDB/</url>
    <content><![CDATA[<blockquote>
<p>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为WEB应用提供可扩展的高性能数据存储解决方案，本文记录相关基础知识。</p>
</blockquote>
<a id="more"></a>

<h3 id="MongoDB-概述"><a href="#MongoDB-概述" class="headerlink" title="MongoDB 概述"></a>MongoDB 概述</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>MongoDB是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。他支持的数据结构非常松散，是类似json的bson格式，因此可以存储比较复杂的数据类型。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。</p>
</blockquote>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li><p>它的特点是<strong>高性能</strong>、<strong>易部署</strong> 、<strong>易使用</strong> 。</p>
</li>
<li><p>主要功能特性有：</p>
<ul>
<li><p>面向集合存储，易存储对象类型的数据。</p>
</li>
<li><p>模式自由。</p>
</li>
<li><p>支持动态查询。</p>
</li>
<li><p>支持完全索引，包含内部对象。</p>
</li>
<li><p>支持查询。</p>
</li>
<li><p>支持复制和故障恢复。</p>
</li>
<li><p>使用高效的二进制数据存储，包括大型对象（如视频等）。</p>
</li>
<li><p>自动处理碎片，以支持云计算层次的扩展性</p>
</li>
<li><p>支持RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言。</p>
</li>
<li><p>文件存储格式为BSON（一种JSON的扩展）。</p>
</li>
<li><p>可通过网络访问。</p>
</li>
</ul>
</li>
</ul>
<h4 id="使用原理"><a href="#使用原理" class="headerlink" title="使用原理"></a>使用原理</h4><ul>
<li>面向集合（Collection-Oriented）<ul>
<li>数据被分组存储在数据集中，被称为一个集合（Collection)。每个集合在数据库中都有一个唯一的标识名，并且可以包含无限数目的文档。集合的概念类似关系型数据库（RDBMS）里的表（table），不同的是它不需要定义任何模式（schema)。Nytro MegaRAID技术中的闪存高速缓存算法，能够快速识别数据库内大数据集中的热数据，提供一致的性能改进。</li>
</ul>
</li>
<li>模式自由（schema-free)<ul>
<li>对于存储在mongodb数据库中的文件，我们不需要知道它的任何结构定义。如果需要的话，你完全可以把不同结构的文件存储在同一个数据库里。存储在集合中的文档，被存储为键-值对的形式。键用于唯一标识一个文档，为字符串类型，而值则可以是各种复杂的文件类型。我们称这种存储形式为BSON（Binary Serialized Document Format）。</li>
</ul>
</li>
</ul>
<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ul>
<li>MongoDB 的主要目标是在键/值存储方式（提供了高性能和高度伸缩性）和传统的RDBMS 系统（具有丰富的功能）之间架起一座桥梁，它集两者的优势于一身。</li>
</ul>
<h5 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h5><p>网站数据：Mongo 非常适合实时的插入，更新与查询，并具备网站实时数据存储所需的复制及高度伸缩性。</p>
<ul>
<li><p>缓存：由于性能很高，Mongo 也适合作为信息基础设施的缓存层。在系统重启之后，由Mongo 搭建的持久化缓存层可以避免下层的数据源过载。</p>
</li>
<li><p>大尺寸、低价值的数据：使用传统的关系型数据库存储一些数据时可能会比较昂贵，在此之前，很多时候程序员往往会选择传统的文件进行存储。</p>
</li>
<li><p>高伸缩性的场景：Mongo 非常适合由数十或数百台服务器组成的数据库，Mongo 的路线图中已经包含对MapReduce 引擎的内置支持。</p>
</li>
<li><p>用于对象及JSON 数据的存储：Mongo 的BSON 数据格式非常适合文档化格式的存储及查询。</p>
</li>
</ul>
<h5 id="不适用场景"><a href="#不适用场景" class="headerlink" title="不适用场景"></a>不适用场景</h5><ul>
<li><p>高度事务性的系统：例如，银行或会计系统。传统的关系型数据库目前还是更适用于需要大量原子性复杂事务的应用程序。</p>
</li>
<li><p>传统的商业智能应用：针对特定问题的BI 数据库会产生高度优化的查询方式。对于此类应用，数据仓库可能是更合适的选择。</p>
</li>
<li><p>需要SQL 的复杂的跨文档（表）级联查询问题。</p>
</li>
</ul>
<h4 id="教程链接"><a href="#教程链接" class="headerlink" title="教程链接"></a>教程链接</h4><ul>
<li><p>官网链接: <a href="https://www.mongodb.com/" target="_blank" rel="noopener">https://www.mongodb.com/</a></p>
</li>
<li><p>参考教程: <a href="https://www.w3cschool.cn/mongodb/" target="_blank" rel="noopener">https://www.w3cschool.cn/mongodb/</a></p>
</li>
<li><p>The Little MongoDB Book 中文版: <a href="https://www.w3cschool.cn/kdxuu8/" target="_blank" rel="noopener">https://www.w3cschool.cn/kdxuu8/</a></p>
</li>
<li><p>MongoDB官方文档: <a href="https://docs.mongodb.com/" target="_blank" rel="noopener">https://docs.mongodb.com/</a></p>
</li>
<li><p>MongoDB下载: <a href="https://docs.mongodb.com/" target="_blank" rel="noopener">https://docs.mongodb.com/</a></p>
</li>
</ul>
<h3 id="MongoDB-安装"><a href="#MongoDB-安装" class="headerlink" title="MongoDB 安装"></a>MongoDB 安装</h3><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><ul>
<li><p>MongoDB 提供了可用于 32 位和 64 位系统的预编译二进制包，选择Windows相应的版本即可，你可以从 MongoDB 官网下载安装，MongoDB 预编译二进制包下载地址：<a href="https://www.mongodb.com/try/download/community" target="_blank" rel="noopener">https://www.mongodb.com/try/download/community</a></p>
</li>
<li><p>下载zip包后，解压安装包，并安装它。</p>
</li>
<li><p>强烈建议 <strong>安装选项 “install mongoDB compass” 不勾选</strong>（当然你也可以选择安装它，可能需要更久的安装时间）</p>
<blockquote>
<p>MongoDB Compass 是一个图形界面管理工具，我们可以在后面自己到官网下载安装，下载地址：<a href="https://www.mongodb.com/download-center/compass%E3%80%82" target="_blank" rel="noopener">https://www.mongodb.com/download-center/compass。</a></p>
</blockquote>
</li>
</ul>
<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><ul>
<li>MongoDB 提供了可用于 32 位和 64 位系统的预编译二进制包，选择你使用的Linux系统相应的版本即可，你可以从 MongoDB 官网下载安装，MongoDB 预编译二进制包下载地址：<a href="https://www.mongodb.com/try/download/community" target="_blank" rel="noopener">https://www.mongodb.com/try/download/community</a></li>
<li>这里我们选择 tgz 下载，下载完安装包，并解压 <strong>tgz</strong>（以下演示的是 64 位 Linux上的安装） 。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-ubuntu1604-4.2.8.tgz        # 下载</span><br><span class="line">tar -zxvf mongodb-linux-x86_64-ubuntu1604-4.2.8.tgz                                    # 解压</span><br><span class="line">mv mongodb-src-r4.2.8  /usr/local/mongodb4</span><br></pre></td></tr></table></figure>

<h4 id="运行-MongoDB-服务"><a href="#运行-MongoDB-服务" class="headerlink" title="运行 MongoDB 服务"></a>运行 MongoDB 服务</h4><blockquote>
<p>你可以再命令行中执行mongo安装目录中的bin目录执行mongod命令来启动mongdb服务。</p>
</blockquote>
<h4 id="MongoDB后台管理-Shell"><a href="#MongoDB后台管理-Shell" class="headerlink" title="MongoDB后台管理 Shell"></a>MongoDB后台管理 Shell</h4><blockquote>
<p>MongoDB Shell是MongoDB自带的交互式Javascript shell,用来对MongoDB进行操作和管理的交互式环境。</p>
</blockquote>
<ul>
<li>如果你需要进入MongoDB后台管理，你需要先打开mongodb装目录的下的bin目录，然后执行mongo命令文件。</li>
</ul>
<blockquote>
<p>此处我执行了<code>db.version()</code>命令，你也可以用这个命令判断shell是否正常运行。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20210210172541.png"></p>
<ul>
<li>由于它是一个JavaScript shell，您可以运行一些简单的算术运算:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5 * 5</span><br><span class="line">25</span><br><span class="line">25 + 3</span><br><span class="line">28</span><br></pre></td></tr></table></figure>

<ul>
<li>现在的版本默认将数据存储在<code>bin</code>同级目录<code>data</code>中，可以尝试新建数据条目（默认数据库为<code>test</code>）：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">db.vvd.insert(&#123;x:10&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</span><br><span class="line">db.vvd.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;6023a73a728a5e21792ad6c8&quot;), &quot;x&quot; : 10 &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>该命令将数据 <code>10</code> 插入到<code>test</code>数据库的<code>vvd</code>集合的<code>x</code>字段里。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>dataset</category>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>dataset</tag>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>VS code 停用 justMyCode 调试库代码</title>
    <url>/2021/02/08/software/ide/vs_code_justmycode/justmycode/</url>
    <content><![CDATA[<blockquote>
<p>VS code 调试时默认启用 <code>justMyCode</code> 配置，使得库代码无法调试，本文记录停用该选项调试一切代码的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="修改-launch-json"><a href="#修改-launch-json" class="headerlink" title="修改 launch.json"></a>修改 launch.json</h3><blockquote>
<p>新建 <code>launch.json</code> 文件，在配置<code>configurations</code>中加入 <code>&quot;justMyCode&quot;: false,</code>一行：</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用 IntelliSense 了解相关属性。 </span></span><br><span class="line">    <span class="comment">// 悬停以查看现有属性的描述。</span></span><br><span class="line">    <span class="comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">    <span class="attr">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Python: 当前文件"</span>,</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"python"</span>,</span><br><span class="line">            <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="attr">"program"</span>: <span class="string">"$&#123;file&#125;"</span>,</span><br><span class="line">            <span class="attr">"console"</span>: <span class="string">"integratedTerminal"</span>,</span><br><span class="line">            <span class="attr">"justMyCode"</span>: <span class="literal">false</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>“justMyCode”: false</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>使用 Python Socket 包搭建简易服务器</title>
    <url>/2021/01/30/web/socket_server/socket-server/</url>
    <content><![CDATA[<blockquote>
<p>本文记录使用Python Socket包搭建简易服务器的代码。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p>平时访问网站底层大多是socket封装的http请求，都是基于tcp-ip协议进行通信的；角色分为服务器端和客户端。</p>
</blockquote>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># ipv4  # tcp-ip</span></span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 监听本机 8000 端口</span></span><br><span class="line">    sock.bind((<span class="string">'localhost'</span>, <span class="number">8000</span>))</span><br><span class="line">    <span class="comment"># 最多同时5个链接</span></span><br><span class="line">    sock.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'start listening! '</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 接受请求</span></span><br><span class="line">        conn, addr = sock.accept()</span><br><span class="line">        <span class="comment"># 获取数据</span></span><br><span class="line">        data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">        print(data)</span><br><span class="line">        <span class="comment"># 返回网页显示内容</span></span><br><span class="line">        conn.send(<span class="string">b"HTTP/1.1 200 OK\r\nContent-Type:text/html; charset=utf-8\r\n\r\n"</span>)</span><br><span class="line">        conn.send(<span class="string">"&lt;h2&gt;测试数据&lt;/h2&gt;"</span>.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">        <span class="comment"># 关闭链接</span></span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul>
<li>运行程序后，在浏览器访问 <code>localhost:8000</code>即可进入代码中的 while 循环内，收到返回并在浏览器显示</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20210130003002.png"></p>
<ul>
<li>同时终端收到信息打印出来：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">start listening!</span><br><span class="line">b&#39;GET &#x2F; HTTP&#x2F;1.1\r\nHost: localhost:8000\r\nConnection: keep-alive\r\nCache-Control: max-age&#x3D;0\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.141 Safari&#x2F;537.36\r\nAccept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9\r\nSec-Fetch-Site: none\r\nSec-Fetch-Mode: navigate\r\nSec-Fetch-User: ?1\r\nSec-Fetch-Dest: document\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: zh,en-US;q&#x3D;0.9,en;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-CN;q&#x3D;0.6\r\n\r\n&#39;</span><br><span class="line">b&#39;GET &#x2F;favicon.ico HTTP&#x2F;1.1\r\nHost: localhost:8000\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.141 Safari&#x2F;537.36\r\nAccept: image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,image&#x2F;*,*&#x2F;*;q&#x3D;0.8\r\nSec-Fetch-Site: same-origin\r\nSec-Fetch-Mode: no-cors\r\nSec-Fetch-Dest: image\r\nReferer: http:&#x2F;&#x2F;localhost:8000&#x2F;\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: zh,en-US;q&#x3D;0.9,en;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-CN;q&#x3D;0.6\r\n\r\n&#39;</span><br><span class="line">b&#39;&#39;</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>第一个 Django 工程搭建</title>
    <url>/2021/01/23/web/back_end/django/django-first-porject/django-first-porject/</url>
    <content><![CDATA[<blockquote>
<p>Django是当前最出色基于Python的Web应用开发平台之一，本文对其进行简要介绍并创建一个空的Django工程。</p>
</blockquote>
<a id="more"></a>

<h3 id="前后端"><a href="#前后端" class="headerlink" title="前后端"></a>前后端</h3><ul>
<li>Web开发的目的可以说是为用户提供一个可以获取信息或交互的服务场景，这其中涉及到几个重要的模块：显示模块、业务处理模块和数据存储模块。</li>
</ul>
<pre class="mermaid">graph TB
    A(浏览器)
    subgraph 服务器
        B[解析请求]
        C[生成html页面]
        D[业务处理]

    end
    E(数据库)

    D-->C -- 显示 --> A -- 交互 --> B-->D--数据交互-.-E</pre>



<ul>
<li>大框架就是用户向服务器提出服务请求，服务器接收请求从数据库中提取数据，送入处理模块处理后得到用户需要的内容，再经过显示模块将内容展现在用户面前。</li>
<li>这个过程中，当前把数据处理、业务处理的部分称为后端，向用户展示内容与设计和用户、后端的交互逻辑的部分称为前端。</li>
<li>为了解耦业务处理与界面显示，经过前辈多年开发经历，当前最佳实践为前后端分离，使得前端人员和后端人员约定好接口进行交互，之后前端只需要把界面做好，后端只需要做好业务逻辑处理。</li>
</ul>
<h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><blockquote>
<p>Django 是一个开放源代码的 Web 应用框架，由 Python 写成，其主要目的是简便、快速的开发数据库驱动的网站。它强调代码复用，多个组件可以很方便的以“插件”形式服务于整个框架，Django有许多功能强大的第三方插件，你甚至可以很方便的开发出自己的工具包。</p>
</blockquote>
<ul>
<li>项目源码：<a href="https://github.com/django/django" target="_blank" rel="noopener">https://github.com/django/django</a></li>
<li>官网：<a href="https://www.djangoproject.com/" target="_blank" rel="noopener">https://www.djangoproject.com/</a></li>
<li>Django中文网：<a href="https://www.django.cn/" target="_blank" rel="noopener">https://www.django.cn/</a></li>
</ul>
<h4 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h4><blockquote>
<p>Django 开发组无比勤奋，版本计划很紧凑，迭代很频繁</p>
</blockquote>
<table>
<thead>
<tr>
<th>Release Series</th>
<th>Latest Release</th>
<th>End of mainstream support<a href="https://www.djangoproject.com/download/#ft1" target="_blank" rel="noopener">1</a></th>
<th>End of extended support<a href="https://www.djangoproject.com/download/#ft2" target="_blank" rel="noopener">2</a></th>
</tr>
</thead>
<tbody><tr>
<td>4.2 LTS</td>
<td>April 2023</td>
<td>December 2023</td>
<td>April 2026</td>
</tr>
<tr>
<td>4.1</td>
<td>August 2022</td>
<td>April 2023</td>
<td>December 2023</td>
</tr>
<tr>
<td>4.0</td>
<td>December 2021</td>
<td>August 2022</td>
<td>April 2023</td>
</tr>
<tr>
<td>3.2 LTS</td>
<td>April 2021</td>
<td>December 2021</td>
<td>April 2024</td>
</tr>
<tr>
<td>3.1</td>
<td>3.1.5</td>
<td>April 2021</td>
<td>December 2021</td>
</tr>
<tr>
<td>3.0</td>
<td>3.0.11</td>
<td>August, 2020</td>
<td>April, 2021</td>
</tr>
<tr>
<td>2.2 LTS</td>
<td>2.2.17</td>
<td>December 2, 2019</td>
<td>April 2022</td>
</tr>
<tr>
<td>2.1</td>
<td>2.1.15</td>
<td>April 1, 2019</td>
<td>December 2, 2019</td>
</tr>
<tr>
<td>2.0</td>
<td>2.0.13</td>
<td>August 1, 2018</td>
<td>April 1, 2019</td>
</tr>
<tr>
<td>1.11 LTS <a href="https://www.djangoproject.com/download/#ft3" target="_blank" rel="noopener">3</a></td>
<td>1.11.29</td>
<td>December 2, 2017</td>
<td>April 1, 2020</td>
</tr>
<tr>
<td>1.10</td>
<td>1.10.8</td>
<td>April 4, 2017</td>
<td>December 2, 2017</td>
</tr>
<tr>
<td>1.9</td>
<td>1.9.13</td>
<td>August 1, 2016</td>
<td>April 4, 2017</td>
</tr>
<tr>
<td>1.8 LTS</td>
<td>1.8.19</td>
<td>December 1, 2015</td>
<td>April 1, 2018</td>
</tr>
<tr>
<td>1.7</td>
<td>1.7.11</td>
<td>April 1, 2015</td>
<td>December 1, 2015</td>
</tr>
<tr>
<td>1.6</td>
<td>1.6.11</td>
<td>September 2, 2014</td>
<td>April 1, 2015</td>
</tr>
<tr>
<td>1.5</td>
<td>1.5.12</td>
<td>November 6, 2013</td>
<td>September 2, 2014</td>
</tr>
<tr>
<td>1.4 LTS</td>
<td>1.4.22</td>
<td>February 26, 2013</td>
<td>October 1, 2015</td>
</tr>
<tr>
<td>1.3</td>
<td>1.3.7</td>
<td>March 23, 2012</td>
<td>February 26, 2013</td>
</tr>
</tbody></table>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20210123141536.png"></p>
<ul>
<li>Django基于Python开发，并且基于Python环境运行，不同Django版本对Python版本有不同的需求：</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Django 版本</th>
<th align="left">Python 版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1.8</td>
<td align="left">2.7, 3.2 (until the end of 2016), 3.3, 3.4, 3.5</td>
</tr>
<tr>
<td align="left">1.9, 1.10</td>
<td align="left">2.7, 3.4, 3.5</td>
</tr>
<tr>
<td align="left">1.11</td>
<td align="left">2.7，3.4，3.5，3.6，3.7 (1.11.17添加)</td>
</tr>
<tr>
<td align="left">2.0</td>
<td align="left">3.4，3.5，3.6，3.7</td>
</tr>
<tr>
<td align="left">2.1，2.2</td>
<td align="left">3.5, 3.6, 3.7</td>
</tr>
<tr>
<td align="left">3.0</td>
<td align="left">3.6, 3.7, 3.8</td>
</tr>
<tr>
<td align="left">3.1</td>
<td align="left">3.6, 3.7, 3.8 or later</td>
</tr>
</tbody></table>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul>
<li>确定自己需要的Django版本，当前（2021年1月23日）最新的Django版本为3.1.5，我的python版本3.8.3</li>
<li>使用pip安装：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install Django</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时pip默认按装的是3.0.5版本</p>
</blockquote>
<ul>
<li>如果需要最新版本可以指定：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install Django&#x3D;&#x3D;3.1.5</span><br></pre></td></tr></table></figure>

<ul>
<li>安装官网：<a href="https://www.djangoproject.com/download/" target="_blank" rel="noopener">https://www.djangoproject.com/download/</a></li>
<li>安装后可以使用 <code>pip show</code>命令查看包信息：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip show django</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">Name: Django</span><br><span class="line">Version: 3.0.5</span><br><span class="line">Summary: A high-level Python Web framework that encourages rapid development and clean, pragmatic design.</span><br><span class="line">Home-page: https://www.djangoproject.com/</span><br><span class="line">Author: Django Software Foundation</span><br><span class="line">Author-email: foundation@djangoproject.com</span><br><span class="line">License: BSD</span><br><span class="line">Location: d:\program_files\anaconda3\lib\site-packages</span><br><span class="line">Requires: pytz, asgiref, sqlparse</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m django --version</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">3.0.5</span><br></pre></td></tr></table></figure>



<h3 id="项目创建"><a href="#项目创建" class="headerlink" title="项目创建"></a>项目创建</h3><ul>
<li>找好一个存放Django工程的文件夹，在此处打开终端，键入命令：</li>
</ul>
<blockquote>
<p>假设我们想要创建名为 <code>vvd_django</code> 的工程：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">django-admin startproject vvd_django</span><br></pre></td></tr></table></figure>

<ul>
<li>当前项目的目录结构：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tree /F  # windows</span><br><span class="line">tree -a  # Linux</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">└─vvd_django</span><br><span class="line">    │  manage.py</span><br><span class="line">    └─vvd_django</span><br><span class="line">            asgi.py</span><br><span class="line">            settings.py</span><br><span class="line">            urls.py</span><br><span class="line">            wsgi.py</span><br><span class="line">            __init__.py</span><br></pre></td></tr></table></figure>

<ul>
<li>这些目录和文件的用处是：<ul>
<li>最外层的 <code>vvd_django/</code> 根目录只是你项目的容器， 根目录名称对Django没有影响，你可以将它重命名为任何你喜欢的名称。</li>
<li><code>manage.py</code>: 一个让你用各种方式管理 Django 项目的命令行工具。你可以阅读 <a href="https://docs.djangoproject.com/zh-hans/3.0/ref/django-admin/" target="_blank" rel="noopener">django-admin and manage.py</a> 获取所有 <code>manage.py</code> 的细节。</li>
<li>里面一层的 <code>vvd_django/</code> 目录包含你的项目，它是一个纯 Python 包。它的名字就是当你引用它内部任何东西时需要用到的 Python 包名。 (比如 <code>vvd_django.urls</code>).</li>
<li><code>vvd_django/__init__.py</code>：一个空文件，告诉 Python 这个目录应该被认为是一个 Python 包。如果你是 Python 初学者，阅读官方文档中的 <a href="https://docs.python.org/3/tutorial/modules.html#tut-packages" target="_blank" rel="noopener">更多关于包的知识</a>。</li>
<li><code>vvd_django/settings.py</code>：Django 项目的配置文件。如果你想知道这个文件是如何工作的，请查看 <a href="https://docs.djangoproject.com/zh-hans/3.0/topics/settings/" target="_blank" rel="noopener">Django 配置</a> 了解细节。</li>
<li><code>vvd_django/urls.py</code>：Django 项目的 URL 声明，就像你网站的“目录”。阅读 <a href="https://docs.djangoproject.com/zh-hans/3.0/topics/http/urls/" target="_blank" rel="noopener">URL调度器</a> 文档来获取更多关于 URL 的内容。</li>
<li><code>vvd_django/asgi.py</code>：作为你的项目的运行在 ASGI 兼容的Web服务器上的入口。阅读 <a href="https://docs.djangoproject.com/zh-hans/3.0/howto/deployment/wsgi/" target="_blank" rel="noopener">如何使用 WSGI 进行部署</a> 了解更多细节。</li>
<li><code>vvd_django/wsgi.py</code>：作为你的项目的运行在 WSGI 兼容的Web服务器上的入口。阅读 <a href="https://docs.djangoproject.com/zh-hans/3.0/howto/deployment/wsgi/" target="_blank" rel="noopener">如何使用 WSGI 进行部署</a> 了解更多细节。</li>
<li>同步数据库文件：</li>
</ul>
</li>
</ul>
<blockquote>
<p>Django默认数据库为db.sqlite3</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd vvd_django</span><br><span class="line">python manage.py migrate</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, contenttypes, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  Applying contenttypes.0001_initial... OK</span><br><span class="line">  Applying auth.0001_initial... OK</span><br><span class="line">  Applying admin.0001_initial... OK</span><br><span class="line">  Applying admin.0002_logentry_remove_auto_add... OK</span><br><span class="line">  Applying admin.0003_logentry_add_action_flag_choices... OK</span><br><span class="line">  Applying contenttypes.0002_remove_content_type_name... OK</span><br><span class="line">  Applying auth.0002_alter_permission_name_max_length... OK</span><br><span class="line">  Applying auth.0003_alter_user_email_max_length... OK</span><br><span class="line">  Applying auth.0004_alter_user_username_opts... OK</span><br><span class="line">  Applying auth.0005_alter_user_last_login_null... OK</span><br><span class="line">  Applying auth.0006_require_contenttypes_0002... OK</span><br><span class="line">  Applying auth.0007_alter_validators_add_error_messages... OK</span><br><span class="line">  Applying auth.0008_alter_user_username_max_length... OK</span><br><span class="line">  Applying auth.0009_alter_user_last_name_max_length... OK</span><br><span class="line">  Applying auth.0010_alter_group_name_max_length... OK</span><br><span class="line">  Applying auth.0011_update_proxy_permissions... OK</span><br><span class="line">  Applying sessions.0001_initial... OK</span><br></pre></td></tr></table></figure>

<ul>
<li>启动Django Server ，检查我们当前的项目状态：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python manage.py runserver</span><br><span class="line"></span><br><span class="line"><span class="meta">--&gt;</span></span><br><span class="line">Watching for file changes with StatReloader</span><br><span class="line">Performing system checks...</span><br><span class="line"></span><br><span class="line">System check identified no issues (0 silenced).</span><br><span class="line">January 23, 2021 - 15:42:03</span><br><span class="line">Django version 3.0.5, using settings 'vvd_django.settings'</span><br><span class="line">Starting development server at http://127.0.0.1:8000/</span><br><span class="line">Quit the server with CTRL-BREAK.</span><br></pre></td></tr></table></figure>

<ul>
<li>此时我们使用浏览器访问  <a href="http://127.0.0.1:8000/" target="_blank" rel="noopener">http://127.0.0.1:8000/</a></li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20210123154326.png"></p>
<blockquote>
<p>出现小火箭说明我们的第一个Django工程正常运作。</p>
</blockquote>
<h3 id="编写第一个视图"><a href="#编写第一个视图" class="headerlink" title="编写第一个视图"></a>编写第一个视图</h3><h4 id="新建应用"><a href="#新建应用" class="headerlink" title="新建应用"></a>新建应用</h4><ul>
<li>在工程根目录终端运行：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python manage.py startapp hello_world</span><br></pre></td></tr></table></figure>

<ul>
<li>当前项目文件结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">│  db.sqlite3</span><br><span class="line">│  manage.py</span><br><span class="line">├─hello_world</span><br><span class="line">│  │  admin.py</span><br><span class="line">│  │  apps.py</span><br><span class="line">│  │  models.py</span><br><span class="line">│  │  tests.py</span><br><span class="line">│  │  views.py</span><br><span class="line">│  │  __init__.py</span><br><span class="line">│  └─migrations</span><br><span class="line">│          __init__.py</span><br><span class="line">└─vvd_django</span><br><span class="line">    │  asgi.py</span><br><span class="line">    │  settings.py</span><br><span class="line">    │  urls.py</span><br><span class="line">    │  wsgi.py</span><br><span class="line">    └─ __init__.py</span><br></pre></td></tr></table></figure>

<h4 id="新建视图"><a href="#新建视图" class="headerlink" title="新建视图"></a>新建视图</h4><blockquote>
<p>打开 <code>hello_world/views.py</code>，把下面这些 Python 代码输入进去：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"Hello, world. You're at the vvd hello_world index."</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这是 Django 中最简单的视图。如果想看见效果，我们需要将一个 URL 映射到它</p>
</blockquote>
<h4 id="应用url映射"><a href="#应用url映射" class="headerlink" title="应用url映射"></a>应用url映射</h4><ul>
<li>在 <code>hello_world</code>目录里新建一个 <code>urls.py</code> 文件，并输入代码：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">''</span>, views.index, name=<span class="string">'index'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="根url映射"><a href="#根url映射" class="headerlink" title="根url映射"></a>根url映射</h4><ul>
<li>在根 URLconf 文件中指定我们创建的 <code>hello_world.urls</code> 模块。在 <code>vvd_django/urls.py</code> 文件的 <code>urlpatterns</code> 列表里插入一个 <code>include()</code>， 如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> include, path</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'hello_world/'</span>, include(<span class="string">'hello_world.urls'</span>)),</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>函数 <a href="https://docs.djangoproject.com/zh-hans/3.0/ref/urls/#django.urls.include" target="_blank" rel="noopener"><code>include()</code></a> 允许引用其它 URLconfs,  它的理念是使其可以即插即用。每当 Django 遇到 <a href="https://docs.djangoproject.com/zh-hans/3.0/ref/urls/#django.urls.include" target="_blank" rel="noopener"><code>include()</code></a> 时，它会截断与此项匹配的 URL 的部分，并将剩余的字符串发送到 URLconf 以供进一步处理。他们能够被放在任何路径下，使得应用都能够正常工作。</p>
</blockquote>
<h4 id="运行服务"><a href="#运行服务" class="headerlink" title="运行服务"></a>运行服务</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>

<h4 id="访问应用"><a href="#访问应用" class="headerlink" title="访问应用"></a>访问应用</h4><ul>
<li>此时我们访问我们建立的 <code>serever/hello_world</code>链接——<a href="http://localhost:8000/hello_world/" target="_blank" rel="noopener">http://localhost:8000/hello_world/</a></li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20210123170625.png"></p>
<ul>
<li>表明我们的应用被成功调用</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://github.com/django/django" target="_blank" rel="noopener">https://github.com/django/django</a></li>
<li><a href="https://www.djangoproject.com/" target="_blank" rel="noopener">https://www.djangoproject.com/</a></li>
<li><a href="https://www.django.cn/" target="_blank" rel="noopener">https://www.django.cn/</a></li>
<li><a href="https://docs.djangoproject.com/zh-hans/3.0/intro/tutorial01/" target="_blank" rel="noopener">https://docs.djangoproject.com/zh-hans/3.0/intro/tutorial01/</a></li>
<li><a href="https://blog.csdn.net/weixin_41666747/article/details/104026496" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41666747/article/details/104026496</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>back end</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>back end</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 配置 Linux nfs 磁盘读写权限</title>
    <url>/2021/01/18/windows/linux_nfs_root/win-add-startup/</url>
    <content><![CDATA[<blockquote>
<p>Windows 挂载Linux磁盘时默认设置可能没有对磁盘的写权限，本文记录在Windows使用root用户登录nfs的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="在注册表中添加匿名用户的默认UID和GID"><a href="#在注册表中添加匿名用户的默认UID和GID" class="headerlink" title="在注册表中添加匿名用户的默认UID和GID"></a>在注册表中添加匿名用户的默认UID和GID</h3><h4 id="打开注册表编辑器"><a href="#打开注册表编辑器" class="headerlink" title="打开注册表编辑器"></a>打开注册表编辑器</h4><ul>
<li><p>按下 <code>win + R</code> 调出运行命令，在运行中输入 <code>regedit</code></p>
</li>
<li><p>找到键值：<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ClientForNFS\CurrentVersion\Default</code></p>
</li>
</ul>
<h4 id="添加键值"><a href="#添加键值" class="headerlink" title="添加键值"></a>添加键值</h4><ul>
<li><p>添加 <code>QWORD</code> 键值</p>
</li>
<li><p><code>AnonymousGid </code> 和 <code>AnonymousUid</code></p>
</li>
<li><p>数值不用设置，默认即可</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20210118210624.png"></p>
<ul>
<li>重启计算机</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>SSH 命令介绍</title>
    <url>/2021/01/15/linux/ssh/ssh-usage/ssh-usage/</url>
    <content><![CDATA[<blockquote>
<p>ssh命令多用于登录和文件传输，安全可靠，本文记录ssh命令用法。</p>
</blockquote>
<a id="more"></a>

<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<p> SSH(远程连接工具)连接原理：ssh服务是一个守护进程(demon)，系统后台监听客户端的连接，ssh服务端的进程名为sshd,负责实时监听客户端的请求(IP 22端口)，包括公共秘钥等交换等信息。</p>
</blockquote>
<ul>
<li><p>SSH服务端由2部分组成： </p>
<ul>
<li><strong>openssh(提供ssh服务)</strong> </li>
<li> <strong>openssl(提供加密的程序)</strong></li>
</ul>
</li>
<li><p>SSH是安全的加密协议，用于远程连接Linux服务器        </p>
</li>
<li><p>SSH的默认端口是22，安全协议版本是SSH2</p>
</li>
<li><p>SSH服务器端主要包含2个服务功能SSH连接和SFTP服务器</p>
</li>
<li><p>SSH客户端包含ssh连接命令和远程拷贝scp命令等 </p>
</li>
</ul>
<h3 id="工作机制"><a href="#工作机制" class="headerlink" title="工作机制"></a>工作机制</h3><ul>
<li>服务器启动的时候自己产生一个密钥(768bit公钥)</li>
<li>本地的ssh客户端发送连接请求到ssh服务器</li>
<li>服务器检查连接点客户端发送的数据和IP地址，确认合法后发送密钥(768bits)给客户端</li>
<li>此时客户端将本地私钥(256bit)和服务器的公钥(768bit)结合成密钥对key(1024bit),发回给服务器端</li>
<li>建立连接通过key-pair数据传输。</li>
</ul>
<h3 id="加密技术"><a href="#加密技术" class="headerlink" title="加密技术"></a>加密技术</h3><ul>
<li>加密技术：传输过程，数据加密。      <ul>
<li>SSH1没有对客户端的秘钥进行校验，很容易被植入恶意代码</li>
<li>SSH2增加了一个确认联机正确性的Diffe_Hellman机制，每次数据的传输，Server都会检查数据来源的正确性，避免黑客入侵。          </li>
</ul>
</li>
<li>SSH2支持RSA和DSA密钥  <ul>
<li>DSA(digital signature Algorithm):  数字签名</li>
<li>RSA: 既可以数字签名又可以加密</li>
</ul>
</li>
</ul>
<h3 id="命令参数"><a href="#命令参数" class="headerlink" title="命令参数"></a>命令参数</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh        [-1246AaCfgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]</span><br><span class="line">           [-D [bind_address:]port] [-e escape_char] [-F configfile]</span><br><span class="line">           [-i identity_file] [-L [bind_address:]port:host:hostport]</span><br><span class="line">           [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port]</span><br><span class="line">           [-R [bind_address:]port:host:hostport] [-S ctl_path]</span><br><span class="line">           [-W host:port] [-w local_tun[:remote_tun]]</span><br><span class="line">           [user@]hostname [command]</span><br></pre></td></tr></table></figure>



<h3 id="功能用法"><a href="#功能用法" class="headerlink" title="功能用法"></a>功能用法</h3><h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh -p 22 username@servername</span><br></pre></td></tr></table></figure>

<blockquote>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh root@192.168.25.137 ls -ltr &#x2F;backup&#x2F;data</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="查看已知主机"><a href="#查看已知主机" class="headerlink" title="查看已知主机"></a>查看已知主机</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;.ssh&#x2F;known_hosts</span><br></pre></td></tr></table></figure>

<h4 id="ssh远程执行sudo命令"><a href="#ssh远程执行sudo命令" class="headerlink" title="ssh远程执行sudo命令"></a>ssh远程执行sudo命令</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh -t omd@192.168.25.137 sudo rsync hosts &#x2F;etc&#x2F;</span><br></pre></td></tr></table></figure>

<h4 id="传输文件"><a href="#传输文件" class="headerlink" title="传输文件"></a>传输文件</h4><h5 id="从服务器上下载文件"><a href="#从服务器上下载文件" class="headerlink" title="从服务器上下载文件"></a>从服务器上下载文件</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp username@servername:&#x2F;path&#x2F;filename &#x2F;var&#x2F;www&#x2F;local_dir（本地目录）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>例如: scp <a href="mailto:&#x72;&#x6f;&#x6f;&#x74;&#x40;&#x31;&#x39;&#50;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#x2e;&#x31;&#48;&#x31;">&#x72;&#x6f;&#x6f;&#x74;&#x40;&#x31;&#x39;&#50;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#x2e;&#x31;&#48;&#x31;</a>:/var/www/test.txt 把192.168.0.101上的/var/www/test.txt 的文件下载到/var/www/local_dir（本地目录）</p>
</blockquote>
<h5 id="上传本地文件到服务器"><a href="#上传本地文件到服务器" class="headerlink" title="上传本地文件到服务器"></a>上传本地文件到服务器</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp &#x2F;path&#x2F;filename username@servername:&#x2F;path</span><br></pre></td></tr></table></figure>

<blockquote>
<p>例如: scp /var/www/test.php <a href="mailto:&#x72;&#111;&#111;&#x74;&#x40;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#46;&#48;&#46;&#49;&#48;&#x31;">&#x72;&#111;&#111;&#x74;&#x40;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#46;&#48;&#46;&#49;&#48;&#x31;</a>:/var/www/ 把本机/var/www/目录下的test.php文件上传到192.168.0.101这台服务器上的/var/www/目录中</p>
</blockquote>
<h5 id="从服务器下载整个目录"><a href="#从服务器下载整个目录" class="headerlink" title="从服务器下载整个目录"></a>从服务器下载整个目录</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp -r username@servername:&#x2F;var&#x2F;www&#x2F;remote_dir&#x2F;（远程目录） &#x2F;var&#x2F;www&#x2F;local_dir（本地目录）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>例如: scp -r <a href="mailto:&#114;&#111;&#111;&#x74;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#48;&#x2e;&#x31;&#x30;&#x31;">&#114;&#111;&#111;&#x74;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#48;&#x2e;&#x31;&#x30;&#x31;</a>:/var/www/test /var/www/  </p>
</blockquote>
<h5 id="上传目录到服务器"><a href="#上传目录到服务器" class="headerlink" title="上传目录到服务器"></a>上传目录到服务器</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp -r local_dir username@servername:remote_dir</span><br></pre></td></tr></table></figure>

<blockquote>
<p>例如：scp -r test  <a href="mailto:&#x72;&#111;&#111;&#116;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#46;&#49;&#48;&#x31;">&#x72;&#111;&#111;&#116;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#48;&#46;&#49;&#48;&#x31;</a>:/var/www/  把当前目录下的test目录上传到服务器的/var/www/ 目录</p>
</blockquote>
<h4 id="ssh自带的sftp功能"><a href="#ssh自带的sftp功能" class="headerlink" title="ssh自带的sftp功能"></a>ssh自带的sftp功能</h4><h5 id="Window和Linux的传输工具"><a href="#Window和Linux的传输工具" class="headerlink" title="Window和Linux的传输工具"></a>Window和Linux的传输工具</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wincp  filezip          </span><br><span class="line">sftp --&gt;基于 ssh 的安全加密传输</span><br></pre></td></tr></table></figure>

<h5 id="sftp客户端连接"><a href="#sftp客户端连接" class="headerlink" title="sftp客户端连接"></a>sftp客户端连接</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sftp -oPort&#x3D;22 root@192.168.25.137                   </span><br><span class="line">put &#x2F;etc&#x2F;hosts &#x2F;tmp                   </span><br><span class="line">get &#x2F;etc&#x2F;hosts &#x2F;home&#x2F;omd</span><br></pre></td></tr></table></figure>

<h5 id="sftp小结"><a href="#sftp小结" class="headerlink" title="sftp小结"></a>sftp小结</h5><ul>
<li>linux下使用命令： sftp -oPort=22 <a href="mailto:&#114;&#x6f;&#111;&#116;&#64;&#x78;&#46;&#x78;&#x2e;&#x78;&#x2e;&#120;">&#114;&#x6f;&#111;&#116;&#64;&#x78;&#46;&#x78;&#x2e;&#x78;&#x2e;&#120;</a>                   </li>
<li>put加客户端本地路径上传                  </li>
<li>get下载服务器端内容到本地                   </li>
<li>远程连接默认连接用户的家目录</li>
</ul>
<h3 id="后台服务"><a href="#后台服务" class="headerlink" title="后台服务"></a>后台服务</h3><h4 id="查询openssl软件"><a href="#查询openssl软件" class="headerlink" title="查询openssl软件"></a>查询openssl软件</h4><pre><code>rpm -qa openssh openssl</code></pre>
<h4 id="查询sshd进程"><a href="#查询sshd进程" class="headerlink" title="查询sshd进程"></a>查询sshd进程</h4><pre><code>ps -ef | grep ssh
    --&gt; /usr/sbin/sshd</code></pre>
<h4 id="查看ssh端口"><a href="#查看ssh端口" class="headerlink" title="查看ssh端口"></a>查看ssh端口</h4><pre><code>netstat -lntup | grep ssh  
ss | grep ssh                (效果同上，同下，好用)
netstat -a | grep ssh(记住这个)
netstat -lnt | grep 22    ==&gt;  查看22端口有没有开/ssh服务有没有开启
技巧： netstat -lnt | grep ssh | wc -l --&gt;只要大于2个就是ssh服务就是好的</code></pre>
<h4 id="查看ssh的秘钥目录"><a href="#查看ssh的秘钥目录" class="headerlink" title="查看ssh的秘钥目录"></a>查看ssh的秘钥目录</h4><pre><code>ll /root/.ssh/known_hosts  # 当前用户家目录的.ssh目录下</code></pre>
<h4 id="ssh的配置文件"><a href="#ssh的配置文件" class="headerlink" title="ssh的配置文件"></a>ssh的配置文件</h4><pre><code>cat /etc/ssh/sshd_config   </code></pre>
<h4 id="ssh服务的关闭"><a href="#ssh服务的关闭" class="headerlink" title="ssh服务的关闭"></a>ssh服务的关闭</h4><pre><code>service sshd stop</code></pre>
<h4 id="ssh服务的开启："><a href="#ssh服务的开启：" class="headerlink" title="ssh服务的开启："></a>ssh服务的开启：</h4><pre><code>service sshd start</code></pre>
<h4 id="ssh服务的重启"><a href="#ssh服务的重启" class="headerlink" title="ssh服务的重启"></a>ssh服务的重启</h4><pre><code>service sshd reload    [停止进程后重启] ==&gt; 推荐
service sshd restart   [干掉进程后重启] ==&gt; 不推荐</code></pre>
<h4 id="ssh远程登录"><a href="#ssh远程登录" class="headerlink" title="ssh远程登录"></a>ssh远程登录</h4><pre><code>ssh 192.168.1.100      # 默认利用当前宿主用户的用户名登录
ssh omd@192.168.1.100  # 利用远程机的用户登录
ssh omd@192.168.1.100  -o stricthostkeychecking=no # 首次登陆免输yes登录
ssh omd@192.168.1.100 &quot;ls /home/omd&quot;  # 当前服务器A远程登录服务器B后执行某个命令
ssh omd@192.168.1.100 -t &quot;sh /home/omd/ftl.sh&quot;  # 当前服务器A远程登录服务器B后执行某个脚本</code></pre>
<h3 id="免密设置"><a href="#免密设置" class="headerlink" title="免密设置"></a>免密设置</h3><ul>
<li>进入用户家目录中 <code>.ssh</code> 文件夹内</li>
<li>根据DSA算法生成私钥和公钥</li>
</ul>
<blockquote>
<p>加密协议可以使用<code>RSA</code> 或 <code>DSA</code>，新版本的openssl 与 ssh-keygen中也可以使用更安全更快速的 <code>ecdsa</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t dsa &#x2F; rsa     # 一路回车即可</span><br><span class="line">-&gt; id_dsa         --&gt;私钥(钥匙) </span><br><span class="line">-&gt; id_dsa.pub     --&gt;公钥(锁)</span><br></pre></td></tr></table></figure>

<ul>
<li>将<code>id_dsa.pub</code>的内容放入服务器<code>.ssh</code>目录下的<code>authorized_keys</code>文件中</li>
<li>免密码登录目标服务器：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh username@servername</span><br><span class="line">-&gt; ssh root@192.168.25.110</span><br></pre></td></tr></table></figure>

<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><blockquote>
<p>位置: <code>/etc/ssh/sshd_config</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># cat &#x2F;etc&#x2F;ssh&#x2F;sshd_config </span><br><span class="line">#       $OpenBSD: sshd_config,v 1.80 2008&#x2F;07&#x2F;02 02:24:18 djm Exp $</span><br><span class="line"> </span><br><span class="line"># This is the sshd server system-wide configuration file.  See</span><br><span class="line"># sshd_config(5) for more information.</span><br><span class="line"> </span><br><span class="line"># This sshd was compiled with PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;bin:&#x2F;usr&#x2F;bin</span><br><span class="line"> </span><br><span class="line"># The strategy used for options in the default sshd_config shipped with</span><br><span class="line"># OpenSSH is to specify options with their default value where</span><br><span class="line"># possible, but leave them commented.  Uncommented options change a</span><br><span class="line"># default value.</span><br><span class="line"> </span><br><span class="line">#Port 22</span><br><span class="line">#AddressFamily any</span><br><span class="line">#ListenAddress 0.0.0.0</span><br><span class="line">#ListenAddress ::</span><br><span class="line"> </span><br><span class="line"># Disable legacy (protocol version 1) support in the server for new</span><br><span class="line"># installations. In future the default will change to require explicit</span><br><span class="line"># activation of protocol 1</span><br><span class="line">Protocol 2</span><br><span class="line"> </span><br><span class="line"># HostKey for protocol version 1</span><br><span class="line">#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_key</span><br><span class="line"># HostKeys for protocol version 2</span><br><span class="line">#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key</span><br><span class="line">#HostKey &#x2F;etc&#x2F;ssh&#x2F;ssh_host_dsa_key</span><br><span class="line"> </span><br><span class="line"># Lifetime and size of ephemeral version 1 server key</span><br><span class="line">#KeyRegenerationInterval 1h</span><br><span class="line">#ServerKeyBits 1024</span><br><span class="line"> </span><br><span class="line"># Logging</span><br><span class="line"># obsoletes QuietMode and FascistLogging</span><br><span class="line">#SyslogFacility AUTH</span><br><span class="line">SyslogFacility AUTHPRIV</span><br><span class="line">#LogLevel INFO</span><br><span class="line"> </span><br><span class="line"># Authentication:</span><br><span class="line"> </span><br><span class="line">#LoginGraceTime 2m</span><br><span class="line">#PermitRootLogin yes</span><br><span class="line">#StrictModes yes</span><br><span class="line">#MaxAuthTries 6</span><br><span class="line">#MaxSessions 10</span><br><span class="line"> </span><br><span class="line">#RSAAuthentication yes</span><br><span class="line">#PubkeyAuthentication yes</span><br><span class="line">#AuthorizedKeysFile     .ssh&#x2F;authorized_keys</span><br><span class="line">#AuthorizedKeysCommand none</span><br><span class="line">#AuthorizedKeysCommandRunAs nobody</span><br><span class="line"> </span><br><span class="line"># For this to work you will also need host keys in &#x2F;etc&#x2F;ssh&#x2F;ssh_known_hosts</span><br><span class="line">#RhostsRSAAuthentication no</span><br><span class="line"># similar for protocol version 2</span><br><span class="line">#HostbasedAuthentication no</span><br><span class="line"># Change to yes if you don&#39;t trust ~&#x2F;.ssh&#x2F;known_hosts for</span><br><span class="line"># RhostsRSAAuthentication and HostbasedAuthentication</span><br><span class="line">#IgnoreUserKnownHosts no</span><br><span class="line"># Don&#39;t read the user&#39;s ~&#x2F;.rhosts and ~&#x2F;.shosts files</span><br><span class="line">#IgnoreRhosts yes</span><br><span class="line"> </span><br><span class="line"># To disable tunneled clear text passwords, change to no here!</span><br><span class="line">#PasswordAuthentication yes</span><br><span class="line">#PermitEmptyPasswords no</span><br><span class="line">PasswordAuthentication yes</span><br><span class="line"> </span><br><span class="line"># Change to no to disable s&#x2F;key passwords</span><br><span class="line">#ChallengeResponseAuthentication yes</span><br><span class="line">ChallengeResponseAuthentication no</span><br><span class="line"> </span><br><span class="line"># Kerberos options</span><br><span class="line">#KerberosAuthentication no</span><br><span class="line">#KerberosOrLocalPasswd yes</span><br><span class="line">#KerberosTicketCleanup yes</span><br><span class="line">#KerberosGetAFSToken no</span><br><span class="line">#KerberosUseKuserok yes</span><br><span class="line"> </span><br><span class="line"># GSSAPI options</span><br><span class="line">#GSSAPIAuthentication no</span><br><span class="line">GSSAPIAuthentication yes</span><br><span class="line">#GSSAPICleanupCredentials yes</span><br><span class="line">GSSAPICleanupCredentials yes</span><br><span class="line">#GSSAPIStrictAcceptorCheck yes</span><br><span class="line">#GSSAPIKeyExchange no</span><br><span class="line"> </span><br><span class="line"># Set this to &#39;yes&#39; to enable PAM authentication, account processing, </span><br><span class="line"># and session processing. If this is enabled, PAM authentication will </span><br><span class="line"># be allowed through the ChallengeResponseAuthentication and</span><br><span class="line"># PasswordAuthentication.  Depending on your PAM configuration,</span><br><span class="line"># PAM authentication via ChallengeResponseAuthentication may bypass</span><br><span class="line"># the setting of &quot;PermitRootLogin without-password&quot;.</span><br><span class="line"># If you just want the PAM account and session checks to run without</span><br><span class="line"># PAM authentication, then enable this but set PasswordAuthentication</span><br><span class="line"># and ChallengeResponseAuthentication to &#39;no&#39;.</span><br><span class="line">#UsePAM no</span><br><span class="line">UsePAM yes</span><br><span class="line"> </span><br><span class="line"># Accept locale-related environment variables</span><br><span class="line">AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES</span><br><span class="line">AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT</span><br><span class="line">AcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE</span><br><span class="line">AcceptEnv XMODIFIERS</span><br><span class="line"> </span><br><span class="line">#AllowAgentForwarding yes</span><br><span class="line">#AllowTcpForwarding yes</span><br><span class="line">#GatewayPorts no</span><br><span class="line">#X11Forwarding no</span><br><span class="line">X11Forwarding yes</span><br><span class="line">#X11DisplayOffset 10</span><br><span class="line">#X11UseLocalhost yes</span><br><span class="line">#PrintMotd yes</span><br><span class="line">#PrintLastLog yes</span><br><span class="line">#TCPKeepAlive yes</span><br><span class="line">#UseLogin no</span><br><span class="line">#UsePrivilegeSeparation yes</span><br><span class="line">#PermitUserEnvironment no</span><br><span class="line">#Compression delayed</span><br><span class="line">#ClientAliveInterval 0</span><br><span class="line">#ClientAliveCountMax 3</span><br><span class="line">#ShowPatchLevel no</span><br><span class="line">#UseDNS yes</span><br><span class="line">#PidFile &#x2F;var&#x2F;run&#x2F;sshd.pid</span><br><span class="line">#MaxStartups 10</span><br><span class="line">#PermitTunnel no</span><br><span class="line">#ChrootDirectory none</span><br><span class="line"> </span><br><span class="line"># no default banner path</span><br><span class="line">#Banner none</span><br><span class="line"> </span><br><span class="line"># override default of no subsystems</span><br><span class="line">Subsystem       sftp    &#x2F;usr&#x2F;libexec&#x2F;openssh&#x2F;sftp-server</span><br><span class="line"> </span><br><span class="line"># Example of overriding settings on a per-user basis</span><br><span class="line">#Match User anoncvs</span><br><span class="line">#       X11Forwarding no</span><br><span class="line">#       AllowTcpForwarding no</span><br><span class="line">#       ForceCommand cvs server</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://www.cnblogs.com/jiangyao/archive/2011/01/26/1945570.html" target="_blank" rel="noopener">https://www.cnblogs.com/jiangyao/archive/2011/01/26/1945570.html</a></p>
</li>
<li><p><a href="https://www.cnblogs.com/machangwei-8/p/10352725.html" target="_blank" rel="noopener">https://www.cnblogs.com/machangwei-8/p/10352725.html</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTPIE 工具使用入门</title>
    <url>/2021/01/14/tools/httpie/httpie/</url>
    <content><![CDATA[<blockquote>
<p>HTTPie 是一个 HTTP 的命令行客户端，目标是让 CLI 和 web 服务之间的交互尽可能的人性化，本文介绍相关内容。</p>
</blockquote>
<a id="more"></a>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>HTTPie 工具提供了简洁的 http 命令，允许通过自然的语法发送任意 HTTP 请求数据，展示色彩化的输出。HTTPie 可用于与 HTTP 服务器做测试、调试和常规交互     ——   <a href="https://blog.mimvp.com/2017/10/httpie-gong-ju-shi-yong-ru-men/" target="_blank" rel="noopener"> 米扑博客</a></p>
</blockquote>
<ul>
<li>官网 <strong>Github</strong>：<a href="https://github.com/jakubroztocil/httpie" target="_blank" rel="noopener">https://github.com/jakubroztocil/httpie</a></li>
</ul>
<h3 id="主要特性"><a href="#主要特性" class="headerlink" title="主要特性"></a>主要特性</h3><ul>
<li>直观的语法</li>
<li>格式化和色彩化的终端输出</li>
<li>内置 JSON 支持</li>
<li>支持上传表单和文件</li>
<li>HTTPS、代理和认证</li>
<li>任意请求数据</li>
<li>自定义头部</li>
<li>持久性会话</li>
<li>类 Wget 下载</li>
<li>支持 Python 2.6, 2.7 和 3.x</li>
<li>支持 Linux, Mac OS X 和 Windows</li>
<li>插件</li>
<li>文档</li>
<li>测试覆盖率</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><blockquote>
<p>httpie 是跨平台命令，支持 Mac OS X、 Linux、 Windows</p>
</blockquote>
<h4 id="Mac-OS-X"><a href="#Mac-OS-X" class="headerlink" title="Mac OS X"></a>Mac OS X</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">brew install httpie      // brew 命令安装</span><br><span class="line">port install httpie      // ports 命令安装</span><br></pre></td></tr></table></figure>

<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">easy_install httpie （CentOS 5.6/6.5/7.2 都成功）</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Debian, Ubuntu, etc.</span></span><br><span class="line">apt-get install httpie</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Fedora, CentOS, RHEL, …</span></span><br><span class="line">yum install httpie</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Arch Linux</span></span><br><span class="line">pacman -S httpie</span><br></pre></td></tr></table></figure>

<h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Make sure we have an up-to-date version of pip and setuptools:</span></span><br><span class="line">pip install --upgrade pip setuptools</span><br><span class="line">pip install --upgrade httpie</span><br></pre></td></tr></table></figure>

<h3 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># http</span><br><span class="line">usage: http [--json] [--form] [--pretty &#123;all,colors,format,none&#125;]</span><br><span class="line">            [--style STYLE] [--print WHAT] [--headers] [--body] [--verbose]</span><br><span class="line">            [--all] [--history-print WHAT] [--stream] [--output FILE]</span><br><span class="line">            [--download] [--continue]</span><br><span class="line">            [--session SESSION_NAME_OR_PATH | --session-read-only SESSION_NAME_OR_PATH]</span><br><span class="line">            [--auth USER[:PASS]] [--auth-type &#123;basic,digest&#125;]</span><br><span class="line">            [--proxy PROTOCOL:PROXY_URL] [--follow]</span><br><span class="line">            [--max-redirects MAX_REDIRECTS] [--timeout SECONDS]</span><br><span class="line">            [--check-status] [--verify VERIFY]</span><br><span class="line">            [--ssl &#123;ssl2.3,ssl3,tls1,tls1.1,tls1.2&#125;] [--cert CERT]</span><br><span class="line">            [--cert-key CERT_KEY] [--ignore-stdin] [--help] [--version]</span><br><span class="line">            [--traceback] [--default-scheme DEFAULT_SCHEME] [--debug]</span><br><span class="line">            [METHOD] URL [REQUEST_ITEM [REQUEST_ITEM ...]]</span><br><span class="line">http: error: the following arguments are required: URL</span><br></pre></td></tr></table></figure>

<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><h5 id="显示请求信息（包含返回头200）"><a href="#显示请求信息（包含返回头200）" class="headerlink" title="显示请求信息（包含返回头200）"></a>显示请求信息（包含返回头200）</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="显示详细的请求（包含请求和返回头200）"><a href="#显示详细的请求（包含请求和返回头200）" class="headerlink" title="显示详细的请求（包含请求和返回头200）"></a>显示详细的请求（包含请求和返回头200）</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -v mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="只显示Header"><a href="#只显示Header" class="headerlink" title="只显示Header"></a>只显示Header</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -h mimvp.com</span><br><span class="line">http --head mimvp.com</span><br><span class="line">http --header mimvp.com</span><br><span class="line">http --headers mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="只显示Body"><a href="#只显示Body" class="headerlink" title="只显示Body"></a>只显示Body</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -b mimvp.com</span><br><span class="line">http --body mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -d mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="模拟提交表单"><a href="#模拟提交表单" class="headerlink" title="模拟提交表单"></a>模拟提交表单</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -f POST mimvp.com username&#x3D;&#39;mimvp-user&#39;</span><br></pre></td></tr></table></figure>

<h5 id="请求删除的方法"><a href="#请求删除的方法" class="headerlink" title="请求删除的方法"></a>请求删除的方法</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http DELETE mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="传递JSON数据请求-默认就是JSON数据请求"><a href="#传递JSON数据请求-默认就是JSON数据请求" class="headerlink" title="传递JSON数据请求(默认就是JSON数据请求)"></a>传递JSON数据请求(默认就是JSON数据请求)</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http PUT mimvp.com username&#x3D;&#39;mimvp-user&#39; password&#x3D;&#39;mimvp-pwd&#39;</span><br></pre></td></tr></table></figure>

<h5 id="如果JSON数据存在不是字符串则用-分隔，例如"><a href="#如果JSON数据存在不是字符串则用-分隔，例如" class="headerlink" title="如果JSON数据存在不是字符串则用:=分隔，例如"></a>如果JSON数据存在不是字符串则用:=分隔，例如</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http PUT mimvp.com username&#x3D;&#39;mimvp-user&#39; password&#x3D;&#39;mimvp-pwd&#39; age:&#x3D;28 a:&#x3D;true streets:&#x3D;&#39;[&quot;a&quot;, &quot;b&quot;]&#39;</span><br></pre></td></tr></table></figure>

<h5 id="模拟Form的Post请求-Content-Type-application-x-www-form-urlencoded-charset-utf-8"><a href="#模拟Form的Post请求-Content-Type-application-x-www-form-urlencoded-charset-utf-8" class="headerlink" title="模拟Form的Post请求, Content-Type: application/x-www-form-urlencoded; charset=utf-8"></a>模拟Form的Post请求, Content-Type: application/x-www-form-urlencoded; charset=utf-8</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http --form POST mimvp.com username&#x3D;&#39;mimvp-user&#39;</span><br></pre></td></tr></table></figure>

<h5 id="模拟Form的上传-Content-Type-multipart-form-data"><a href="#模拟Form的上传-Content-Type-multipart-form-data" class="headerlink" title="模拟Form的上传, Content-Type: multipart/form-data"></a>模拟Form的上传, Content-Type: multipart/form-data</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -f POST example.com&#x2F;jobs username&#x3D;&#39;mimvp-user&#39; file@~&#x2F;test.pdf</span><br></pre></td></tr></table></figure>

<h5 id="修改请求头-使用-分隔"><a href="#修改请求头-使用-分隔" class="headerlink" title="修改请求头, 使用:分隔"></a>修改请求头, 使用:分隔</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http mimvp.com  User-Agent:mimvp-agent&#x2F;1.0  &#39;Cookie:a&#x3D;b;b&#x3D;c&#39;  Referer:http:&#x2F;&#x2F;mimvp.com&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http -a username:password mimvp.com</span><br><span class="line">http --auth-type&#x3D;digest -a username:password mimvp.com</span><br></pre></td></tr></table></figure>

<h5 id="使用http代理"><a href="#使用http代理" class="headerlink" title="使用http代理"></a>使用http代理</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http --proxy&#x3D;http:http:&#x2F;&#x2F;217.107.197.174:8081 proxy.mimvp.com</span><br><span class="line">http --proxy&#x3D;http:http:&#x2F;&#x2F;user:pass@217.107.197.174:8081 proxy.mimvp.com</span><br><span class="line">http --proxy&#x3D;https:http:&#x2F;&#x2F;112.114.96.34:8118 proxy.mimvp.com</span><br><span class="line">http --proxy&#x3D;https:http:&#x2F;&#x2F;user:pass@112.114.96.34:8118 proxy.mimvp.com</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.mimvp.com/2017/10/httpie-gong-ju-shi-yong-ru-men/" target="_blank" rel="noopener">https://blog.mimvp.com/2017/10/httpie-gong-ju-shi-yong-ru-men/</a></li>
<li><a href="https://www.cnblogs.com/new_2050/p/7745788.html" target="_blank" rel="noopener">https://www.cnblogs.com/new_2050/p/7745788.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>tools</category>
        <category>httpie</category>
      </categories>
      <tags>
        <tag>tools</tag>
        <tag>httpie</tag>
      </tags>
  </entry>
  <entry>
    <title>Python Opencv 错误记录</title>
    <url>/2021/01/14/python/opencv-error/opencv-error/</url>
    <content><![CDATA[<blockquote>
<p>本文记录在使用Python中的Opencv库的过程中踩过的坑，以史为鉴。</p>
</blockquote>
<a id="more"></a>

<h3 id="cv2-rectangle"><a href="#cv2-rectangle" class="headerlink" title="cv2.rectangle"></a>cv2.rectangle</h3><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><ul>
<li>{TypeError}an integer is required (got type tuple)</li>
<li>{TypeError}argument for rectangle() given by name (‘color’) and position (3)</li>
<li>{TypeError}argument for rectangle() given by name (‘thickness’) and position (4)</li>
<li>{TypeError}an integer is required (got type tuple)</li>
</ul>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><ul>
<li>坐标pt1,pt2需要是整型</li>
<li>img=np.ascontiguousarray(img)，然后调用rectangle</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/csdn_zhishui/article/details/105878092" target="_blank" rel="noopener">https://blog.csdn.net/csdn_zhishui/article/details/105878092</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 进度条神器 tqdm 用法</title>
    <url>/2021/01/09/python/tqdm/tqdm/</url>
    <content><![CDATA[<blockquote>
<p>程序运行过程中进度条显示特别重要，Python中使用<code>tqdm</code>库作为进度条操作工具，本文简要介绍<code>tqdm</code>常用功能。</p>
</blockquote>
<a id="more"></a>

<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><blockquote>
<p><code>tqdm</code>源自阿拉伯语 taqaddum，意思是进程( “progress”)；</p>
<p>也是西班牙语中 “I love you so much” (te quiero demasiado)的缩写（这个是碰了巧了）</p>
</blockquote>
<ul>
<li>该模块的作用就是通过装饰<code>tqdm(iterable)</code>任何可迭代的对象，使代码中的循环(loop)在运行过程中为用户展示进度条。</li>
<li>盗了<a href="https://pypi.org/project/tqdm/" target="_blank" rel="noopener">官网</a>的图直观展示一下效果</li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20210109164234.gif"></p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><h4 id="引入包"><a href="#引入包" class="headerlink" title="引入包"></a>引入包</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br></pre></td></tr></table></figure>

<h4 id="生成tqdm对象"><a href="#生成tqdm对象" class="headerlink" title="生成tqdm对象"></a>生成tqdm对象</h4><blockquote>
<p>tqdm类的构造函数：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__init__(iterable=<span class="literal">None</span>, desc=<span class="literal">None</span>, total=<span class="literal">None</span>, leave=<span class="literal">True</span>, file=<span class="literal">None</span>, ncols=<span class="literal">None</span>, mininterval=<span class="number">0.1</span>, maxinterval=<span class="number">10.0</span>, miniters=<span class="literal">None</span>, ascii=<span class="literal">None</span>, disable=<span class="literal">False</span>, unit=<span class="string">'it'</span>, unit_scale=<span class="literal">False</span>, dynamic_ncols=<span class="literal">False</span>, smoothing=<span class="number">0.3</span>, bar_format=<span class="literal">None</span>, initial=<span class="number">0</span>, position=<span class="literal">None</span>, postfix=<span class="literal">None</span>, unit_divisor=<span class="number">1000</span>, write_bytes=<span class="literal">None</span>, lock_args=<span class="literal">None</span>, nrows=<span class="literal">None</span>, colour=<span class="literal">None</span>, gui=<span class="literal">False</span>, **kwargs)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参数很复杂，这里介绍几个常用参数和方法，详细情况参考<a href="https://tqdm.github.io/docs/tqdm/#__init__" target="_blank" rel="noopener">官网文档</a></p>
</blockquote>
<ul>
<li>iterable: 最常用的参数，表示使用这个迭代对象来初始化<code>tqdm</code>对象，如果手动更新进度条的话该参数可以为<code>None</code></li>
<li>desc: 进度条的描述信息</li>
<li>total: 进度条总格子数量</li>
<li>miniters: int, optional。迭代过程中进度显示的最小更新间隔。</li>
<li>unit : str, optional。定义每个迭代的单元。默认为<code>&quot;it&quot;</code>，即每个迭代，在下载或解压时，设为<code>&quot;B&quot;</code>，代表每个“字节”。</li>
<li>unit_scale: bool or int or float, optional。默认为<code>False</code>，如果设置为<code>1</code>或者<code>True</code>，会自动根据国际单位制进行转换 (kilo, mega, etc.) 。比如，在下载进度条的例子中，如果为<code>False</code>，数据大小是按照字节显示，设为<code>True</code>之后转换为Kb、Mb。</li>
</ul>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><h4 id="自动控制进度"><a href="#自动控制进度" class="headerlink" title="自动控制进度"></a>自动控制进度</h4><ul>
<li>将<code>tqdm()</code> 直接包装在任意迭代器上：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(range(<span class="number">10000</span>)):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="number">100</span>%|██████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">00</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">1248304.76</span>it/s]</span><br></pre></td></tr></table></figure>

<ul>
<li>加入描述：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(range(<span class="number">10000</span>), desc=<span class="string">'test str:'</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; test str:: <span class="number">100</span>%|█████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">00</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">1666257.75</span>it/s]</span><br></pre></td></tr></table></figure>

<ul>
<li><code>trange(i)</code> 是对<code>tqdm(range(i))</code> 特殊优化过的实例：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="number">100</span>%|██████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">00</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">1191844.79</span>it/s]</span><br></pre></td></tr></table></figure>

<ul>
<li>如果要精细控制<code>tqdm</code>对象，需要提前生成对象，并在循环中加以控制：</li>
</ul>
<blockquote>
<p>使用外部对象可以直接建立对象，此时在循环之外需要关闭该对象：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">pbar = tqdm(range(<span class="number">10000</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pbar:</span><br><span class="line">    pbar.set_description(str(i))</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">pbar.close()</span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="number">9999</span>: <span class="number">100</span>%|█████████████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">02</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">4677.99</span>it/s]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>也可以使用<code>with</code>功能，在循环体之外由编译器自动结束其生命周期：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">with</span> tqdm(range(<span class="number">10000</span>)) <span class="keyword">as</span> pbar:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pbar:</span><br><span class="line">        pbar.set_description(str(i))</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">&gt;&gt; <span class="number">9999</span>: <span class="number">100</span>%|█████████████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">02</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">4659.45</span>it/s]</span><br></pre></td></tr></table></figure>

<h4 id="手动控制进度"><a href="#手动控制进度" class="headerlink" title="手动控制进度"></a>手动控制进度</h4><ul>
<li>手动运行时<code>tqdm</code>对象不需要迭代器作为初始化参数，但需要指定最大长度<code>total</code>的值：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">with</span> tqdm(total=<span class="number">10000</span>) <span class="keyword">as</span> pbar:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">        pbar.update(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">&gt;&gt; <span class="number">100</span>%|████████████████████████████| <span class="number">10000</span>/<span class="number">10000</span> [<span class="number">00</span>:<span class="number">00</span>&lt;<span class="number">00</span>:<span class="number">00</span>, <span class="number">99888.16</span>it/s]</span><br></pre></td></tr></table></figure>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://pypi.org/project/tqdm/" target="_blank" rel="noopener">https://pypi.org/project/tqdm/</a></p>
</li>
<li><p><a href="https://tqdm.github.io/docs/tqdm" target="_blank" rel="noopener">https://tqdm.github.io/docs/tqdm</a></p>
</li>
<li><p><a href="https://blog.csdn.net/qq_33472765/article/details/82940843" target="_blank" rel="noopener">https://blog.csdn.net/qq_33472765/article/details/82940843</a></p>
</li>
<li><p><a href="https://blog.csdn.net/qq_40666028/article/details/79335961" target="_blank" rel="noopener">https://blog.csdn.net/qq_40666028/article/details/79335961</a></p>
</li>
<li><p><a href="https://www.cnblogs.com/harp-yestar/articles/tqdm.html" target="_blank" rel="noopener">https://www.cnblogs.com/harp-yestar/articles/tqdm.html</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>矩阵对变化的敏感程度评价指标 Condition Number</title>
    <url>/2021/01/06/math/linear_algebra/condition-num/condition-num/</url>
    <content><![CDATA[<blockquote>
<p>矩阵对变化的敏感程度可以用Condition Number来评估，本文对其进行简略介绍。</p>
</blockquote>
<a id="more"></a>

<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li><a href="https://bk.tw.lvfukeji.com/baike-%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90" target="_blank" rel="noopener">数值分析</a>中，一个问题的<strong>条件数</strong>是该数量在数值计算中的容易程度的衡量，也就是该问题的<a href="https://bk.tw.lvfukeji.com/w/index.php?title=%E9%80%82%E5%AE%9A%E6%80%A7&action=edit&redlink=1" target="_blank" rel="noopener">适定性</a>。一个低条件数的问题称为<strong>良置</strong>的，而高条件数的问题称为<strong>病态</strong>（或者说非良置）的。                                —— <a href="https://bk.tw.lvfukeji.com/baike-%E6%9D%A1%E4%BB%B6%E6%95%B0" target="_blank" rel="noopener">维基百科</a></li>
</ul>
<blockquote>
<p>直白来说就是描述一个矩阵是否变化率在可控范围内，下方这个示例程序可以看到，当调整<code>a</code>, <code>b</code>, <code>c</code>的值使得条件数很大时，二次型描述的曲面在某个方向上会拉的很长；在这种情况下，曲面上的点沿着某个方向会得到巨大的变化率，而沿着某些方向变化率又很小，当条件数为无穷大时甚至这个比值甚至会变得无穷大。</p>
</blockquote>
<script src="/js/deployggb.js"></script>
<script>
var parameters = {
"id": "ggbApplet",
"width":888,
"height":694,
"showMenuBar":false,
"showAlgebraInput":false,
"showToolBar":false,
"customToolBar":"0 73 62 | 1 501 67 , 5 19 , 72 75 76 | 2 15 45 , 18 65 , 7 37 | 4 3 8 9 , 13 44 , 58 , 47 | 16 51 64 , 70 | 10 34 53 11 , 24  20 22 , 21 23 | 55 56 57 , 12 | 36 46 , 38 49  50 , 71  14  68 | 30 29 54 32 31 33 | 25 17 26 60 52 61 | 40 41 42 , 27 28 35 , 6",
"showToolBarHelp":true,
"showResetIcon":true,
"enableLabelDrags":false,
"enableShiftDragZoom":true,
"enableRightClick":false,
"errorDialogsActive":false,
"useBrowserForJS":false,
"allowStyleBar":false,
"preventFocus":false,
"showZoomButtons":true,
"capturingThreshold":3,
// add code here to run when the applet starts
"appletOnLoad":function(api){ /* api.evalCommand('Segment((1,2),(3,4))');*/ },
"showFullscreenButton":true,
"scale":1,
"disableAutoScale":false,
"allowUpscale":false,
"clickToLoad":false,
"appName":"classic",
"showSuggestionButtons":true,
"buttonRounding":0.7,
"buttonShadows":false,
"language":"zh",
// use this instead of ggbBase64 to load a material from geogebra.org
// "material_id":"RHYH3UQ8",
// use this instead of ggbBase64 to load a .ggb file
// "filename":"myfile.ggb",
"ggbBase64":"UEsDBBQACAgIAKBzKVIAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmltz4yYUgJ+7v4LhqX2IDbJkO5koO9md6TQzSTbTZDp9xRKSaWRQBUrk/PoikCV5bWfjS9b2bvMQdBA3fedwOIDPPxaTBDzRTDLBfYg7CALKAxEyHvswV9HJEH68+HAeUxHTUUZAJLIJUT70ypJ1PS11+g4q80ia+jBIiJQsgCBNiCqr+FBEUcI4hQAUkp1xcUsmVKYkoPfBmE7ItQiIMm2NlUrPut3n5+fOrNeOyOKublh2Cxl241h1dAqBHjqXPqweznS7c7Wfe6aegxDu/n1zbfs5YVwqwgM9EP1ZIY1IniipH2lCJ5QroKYp9WEqGFcQJGREEx/elRL4Ncoo/Q2CqpKmheDFh1/O5Vg8AzH6hwY6T2U5resZoVuW0a8/i0RkIPPhYABBbJORDx3P09CSdEx8iGzhhExpBp5IUueQXInA1De5EUkknZXVPd2IkNo3blWes4nBCaSiWh+ogyGQKaWhHjWsvhEb9UyNplstBkJkoQSFD2/JLQTTKn2xqSli6Nyzl6pTr52rpgltjf28W4F9G+KQppSHutAcZ7wR5/7QcC6TkU2OG7P73pj7R4J5D5Dx+pS/8DZbZyO22PEMXJN+L2dxFK7iiv9JYz3mNuPe/4x3ynjegt2N6CLDFh3tUmeKWIqy/K9jGzFJE1rsEL2NiyqM10aosTubxRht7GhP0NHG0EsgFp8as+CRUylLtk275cMfLNQrmOlP6DiSKd0SHgxtC/RfPqc0pnXGdJnXFRHlPFDGqVRwP+fZU1sbPRftQx9Nmxt7lxXK2Jb0apaSxqVUc7mfyY1pbxbW/eymLXKVlD1fcaW3X9QYrFz4uEdK0wfd1Bf+kBEuyz3YvC2t1lxGpq9pzTsGrf1sOpt5Lv5EsloTba1tFhutXL07jrdv1a3hxtsgtg9jDsp817TNrYyov9nUd5C7nF5ncMBG9KQ/TzQY/qrEJhQ4isDswPzgkmiaZIpKRvi3difJNG7N6LuZXOtjYPWx/RjX3j96PaNTDy/YN0b2D7unCOM+dvat5tcBz+1D7uqMBjHeE+KDDflW8wwEL8+/Z/sIK9Uk3R/Meexgw8Ziyq3PlQAUyBSbIlP5BVU3EwU28hSbty/YZpv6euAZK8ClrXFpC146NunZxLWJVwPabJdoVJtqv9WKkr9aHNzNtjbH5Ep+SKV/h0id5xOatVzD7UyujcezzkG3l9M51b7BFayyk9VWIRMWahOaMK2kE629CSmMFslIiiRX9D7IKOXN9Zw142cWqnEZ2um+I1aU5mLbBGORsRfBVU0DlLPgMjEXeXNHGcvMx3ktcp0z1u3cM+Fx0szGSys1GrCn9abQ18d4yxTTZogqhP2OM+zhoddDAzw49Yb9NyLFwwapffFmoov2gdEOLGStee4sm+ckC5oz0h5a7nhQB+GB6/WcU8fDp6eufvB2vxX8vc5otjWHeKRnLGCh6Lud1iUiyGVzBm2lmtDwKMKVdU7qSF6whJFsup21r8VY0aIJGR6M0PopwUEijrTbAVKvT1HtevQ8vimXYNc+610BnK2k37jm0NqKm++5slLrkt8SiJhGz8lEV7BjYPwTCR7jTOQ8XFy9dsIL7zuYWg1tJERCSeO/Ps3k1tXyQrywClC1RO/TooIxDR5Hophb4l53TUw20+baCK0r3yXT5u1fubg8nrybKazjndY/1FvrJnJFZNNWQbf1y6ju7GdYF/8BUEsHCI//M80IBQAALiYAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZjdbtMwFMev4Sks39PYaZIt0zJUwQVIgIZ2w62XnLaGxA62uzZ7Nd6BZ+LEzroUVsSqbRKIXvT46xzbv79zGvf05aapyRUYK7UqKJ8wSkCVupJqUdCVm784pi/Pnp8uQC/g0ggy16YRrqBpP3Lrh7VJFrO+TbRtQctaWCtLStpauN6loHo+r6UCSsjGyhOlP4gGbCtKuCiX0Ih3uhTOx1o6155E0Xq9ntzMOtFmEWFgG21sFS0WboKWEly6sgUdCicYd8d7PfV+MWM8+vT+XZjnhVTWCVXiQnBbFczFqnYWi1BDA8oR17WAG9BKllOcoxaXUBf0rXK4Vyj7JZJyZa7Qf3Au6JSnjJ49f3Zql3pN9OVnHFdQZ1aw9feVqB+D3a90rQ0xBY05JYiZM7SXaPMY+dXtUhSUTTgLH57kjPOMx8G/Fh0YciUwKAstYuV06UP61rmoLdyMxcnf6wpCTzKMV7LxrIl1gGLh5LYFqHwpbJ955Tp/CMbxUMAL19VA3FKWXxRYxJ+OnPrCG1lV0J+l4ANyAeoKiWhjUXvmZ+mYH37NhiO34b7ecd97zUOz98elGrkhs+AxCwNncTDTYJJg0i0S+KrCOm3/XdBWGDxuGKjs+0+jQexfZBcbaaevt6rNhupIaTY9SGnmhWZeZnYr8mNJiqfncUXdz5cMZcBdf//2e9z+QSqFcWClUKPH7VXf8TP57G8g/5jc94PE+ApG/M59fYcfpsGD+OW5Bxjz3CP0dpuj0ofCWGptKks2IQ2E5OC/19uQc9H/KA2z7M2Od0FlB0LVdbeEymh1y3XUdIt2OqA95Em6rxw8nXo9Uv7ziZ4kA5I0z1iSJQ+mzaFH/F5kZ6ZcygYqELtoUdinQhvz8HOcHHm0vfk32J53mJFltcv16Y6sTxm4+Dxwjf+ZM3tupG12qfInpJqFxByo5tlfSVWB2+7zQ18eZ9X0f1a9D8uvK1H5N7Bhqx9v6mOm/MCLyv7UmCV5/znKeHrMk5g/FKDHuGzcedXoG8N9ogvmOt4GvO/tg8yyYI6COQ4m33szkU1by1K630trV2aOV+W7XpWHrl2Vk8NURr87X5YnR3967G8DP9FFhf/pu100uutHN38snP0AUEsHCArjiZZLAwAAABEAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAAFgAAAGdlb2dlYnJhX2phdmFzY3JpcHQuanNLK81LLsnMz1NIT0/yz/PMyyzR0FSorgUAUEsHCNY3vbkZAAAAFwAAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAADAAAAGdlb2dlYnJhLnhtbO1b7Y/cxBn/DH/FyJVQUrK7nvE77AXtXdKClKQRl1aID1Re27fnxmsvtvdu95QPtKKCkFAqoUJAES8ilFA1CLU0DSjwgT8F3d6ln/gX+jwzttfe3cvt3h0QaE+3N563Z2Z+zzO/55lZX/OJQTcgG16c+FG4JNG6LBEvdCLXDztLUj9dq5nSEycfbna8qOO1Y5usRXHXTpckDVsW/SBX15mMZXavtyQ5gZ0kviORXmCn2GVJitbWAj/0JOK7S9KyohsrmrpSU1ZWaE21WqzWOtVSakz5xTI9faqltuRTEiGDxH8sjM7ZXS/p2Y636qx7XftM5NgpH3U9TXuPNRqbm5v1fH71KO40YApJY5C4jU6nXYdUIrDIMFmSsofHQG6l96bC+zFZpo1nzp4R49T8MEnt0IEpIwB9/+TDDzU3/dCNNsmm76brABdTDImse35nHSAxmC6RBrbqAS49z0n9DS+BvqUsX33a7Um8mR1i/UPiiQTFwiTi+hu+68VLklxnFtNVRbWYwmTKLFUiUex7YZq1pdmYjVxac8P3NoVYfOIjQqc0ioK2jRLJpUuEyUwmJzChImGiVBZZWREJE4kqEk20UUVPVTRVRRtVtFEVsAo/8duBtySt2UGCCg/XYlBhkU/SYeDxqWQF44XTE7CcxN+CxooMxiTghnJZPoEfHT4qVjSq6zNL66O4iEuE4ux5ohCcN+Xzx0TNsrrIGjyhclZqilILs/ohF6McaDGqbBmLDJzG/b1AVOmMcQ34aNr0uLQ0qJC5wGLHS9XZ/EtlhwK4GJOh6NRuL0mtM788vfx0a3oGTJs9A3pIHc/UMIzFf/lnakhloVVPafcAI+qV/X80C9b2Mml9FsrMPJpRVXPuRRvyTNITKc3So1GFNb8qNMqq0yKUaEBYGqEWMKiObMQI1YgKJSaUGETBMo2qRCHYhCqEk63KiUuHGqyGv7CnCUVShoURIHRYJEMe1zSiQTMD+yIl6haXJ8MHW8OM4KNgmaLAh5cpKnyQ2TUQpAkxMA9N0fmTxv8iVWowioawEl4FZaoFw2GBZlCiwEwgb8gE5Co4COWrAR+Cv5QI92EQZhIulcuX2WGoaLxDmLEPFTUbubNsZjohyTq2zgZNvW6CWjIUorNCVzpCmSnMYMTQiKGX1HYCFadrY92h5syK7jSzqkAdCw1uDYAUYi80ydRcmScydV6aUifgro6hhwmiKEoIGAzRUUWZDmAWrNAC01ARTCegKY0RHW1oD4VAEBclfgHtuhf0CtA5hn7Y66cV3Jyumz+mEbS2Ax6cZe3dyLm4XCCdSfLsJC2LhXhmHDWJ+KYSVD3UDOy2BxFlZxUtgZANO0CPwEdYi8KUZEYABM/LnChMzsdRuhIF/W6YEOJEgVxMOApo6ZkVM4GMUqpQyxVaqUIvPRt5o8q4EdSQfuLB+FGcFHJs130Km4wNG1D5VRgMl2PPvtiL/DBNSvKaDR6INr2+E/iub4e/AfvNg75z/W7biwl/jFBZfAIIA8kjVu6d84BVN1g+xyh2V4cJmDsZPOvF0JnVIdY0dNjelqrLCt+SQ1GlmUqdGha1TMMygRE0mLRj41ZVlbpqapasWVTWmaFh1XB2HbgkPrS3seqlKagxIfbAG8PQiZEtS5mnkuUoGBdxZFbsXtqP+VEFYoEYV9UKO4HHTYJ7OojknYvtaLAq4gRdyLow7HmFsbQ7XCUEqIRpMOFOlrZFytvg1IpWMm8j8xayqEehRT21GG/B07ZIeSs8/whrFUul+TLlfBQ/ISJf3Rzc1PFY0A/99EyeSX3nYrZSKjoIA0gyW6zKpEcls9mYML65jJHNMEatbIymfB9jtGhhfaoFh83SDx1bn1W3yj+mPrY+Td7D3MSu/V+wNnlfa8vim6M0tkOKnLa1Xhy17bYf+OlwxQ6cfmCnUcy9ip+ksd/uo6MiKYccFuYnK/0uNgKvMdamjaFEykeCoEDKvBgUgBMh3cgVfQNcQA1dHqg6o9NmgufuBKaOGgrQHcFwMCnHc/sx9Hv27OnWud9eOL16QSJdzwafec4+B6tzs4e8wIn6YZo9YztWNMyfiiLetCjtB8GTw16WC7wNxFKuWxoegHx47oeutwaqd8G3OJVlI8KnB+hCPbdSeMpfW6sUPB1tnvdixwvTSjGseLLYEd4UNph0sgkV8VA4Yo7V//M/bL4xy1hPQiQ1ew81szAtZ3HcCEIazZk5COxe4rmiVBaDVHo1L3px6AXYGmKdRDklmo4pAmIdoN9+1E9ETSlSgg7n7XS9FbpPex2Y6flim04KcT3H70JHUZ7xnY1c/GsgGFHqep3Yy3lJTFGwYRYokqQHEZabrHteWnCi8D3jZtkS80U1UxuOJPws1/VhJ9eAcrv2gN9jgL/qFSThxH4PvQxpw7HkYmm7AUuhCLcc0lUoTjm1hw+syRB0GYqhQfRELVnRLVUtnCJU6rKhUAisTMVSDVUH2trK6midalTTmMosxTRkwyo8pq7VFUuHOE5VoVo3odOAuzRYCAjfyp5ruvl9eM8pX/lj8FAlkezIROKtuVcJ1+aOHcCUej20PNhNFfIeZ8SxKBspjn6XObHcZ067XbRJfo6BGWZt/RRXAC6mn65HMb+xhilDivYceF2gokxg2O96MX4VkOFh86tv2F39bI+p9cy6cJYkauN8JjAcIwPVe0RGxA566zb6QppHhqolU6rTPB6yhxiPFts6O0GenWS5JMCb93yDy/kOxxHaCbi71Ft1gFnC8fcQYq5ZUMvvIgcYz8LuBKF437PmD0ocAID5W0CDBadx/bQER5UXO47g0nUwm9BL8NCA11p5eIMPT/qu64XF9O0QqJErCU7LnrD0oj0Y1pBvwdKBMlPXvoprTypOq7OfsuIM5SeiOGdScTX209ScYXLNMUX/8WhuAFFIgl+i5sCvSQQKl6QtskSO2eTnZPDcMXb8OHmUHGtDbljkjjlYeRzLjufjPd+3Xa76xpRVFFXFOHMYAPE28MvDKTtglHJLUA1uCpgUtqCr/PRt6FQzqcronKaQlXK9TcZ7M7Wi3V8pnt/xwg1YVwTxIxnIODVDNwwNNjbYqKkxA6+0ZDFl2YCgSbGYqkEbkLwlc7kDKmKraj3GXXS2vC0q+jGeDEWyxfg369WfbIuA4cT+gLRgvBp6QtLCIZFaSUv0bikiUVEIwN7SRF4XiSESUyQWTisLBbznQwFaIuINiAji/e0v9QYpy2zwkef7Ufr49hdXd/7+/uidK7vvfvyfa//69u7bolyaNjLsLFUl3d/K8ttfNDN5br5ZzKRmcwgShqJwwlAUeT5clAou4i9uRYc0CMNNKYq+fo/w36JBu6jKkJuxP6egUx5o6OBIIbAz6f7YdTLcOseAr4DWjg1IjdhIXfypDYRWIw4yGwCpzkJnrR/yyFMai5xCp3qxeV/+EuBQ+ZDwHAVZkahnO3ASx4jDnM8M6WwztKcMsGyDk0a6gCXS+S3R/AEMkWWbeA5DXM+QG4IVFk6dv5Y0DYN4W6noeHhz+y6MjV8UJIhDFrWCtxnLOaQlzudCnKjbtUOXhPzr2afwGjUBgKTxV4O2zCnAplwBNit8dNRP8/qWEJsJm1IGv0IowG4dShu6ydWBSVskB1PIGHulbprU0nWIA5gmU1njusAwG1+M0mXVgmKFKl4NXzfZGp++cVX4ZUF2Ei6XTl1CHQ5xNoX48iKILz9giOt1CLlkRbFM01At0/qOEZ/Nw+oe4cDgWOv4gYhWfbCJVkRLqqLOB4+2JzzLB4NHe5DhYVTO4FHmg0evwDP68KXR3T+MXrg7f2ytP9ABoqJlcMzhlnE1RgWOlSh0+Tsn5/rd+RExfhSImPsR+toEk4PIjFMe6cAWElnYQ4Lgi1pB9OPaScLv3p/wJ6+NupPXRtOce7j7oQMh8M3lGwcGIFwMgHASgGk3f3QAzN4U5h4U2oVYPjwQh5oP9BZhNNsjhj4fQFaVRL98ffvOje07fyvYdPTnqzu3Pth58/a3d6+K6wvIjj55G7I71y/vXH9h9OlrSLo/G9iPOznnkFC8u3Lv9itQDX+377wqJPJ2Qs7u2y9i9xsfjV67Nrr6xu6fXhLNeRN8/OTznWuvb9/FytFXb45e/rQYbTyXFz6699lNaLx7858wqfmJzlpci+PV8TfMsl64bwSrLKBs4g5hn/pOXM50yhnRwUFBq/ifG0fJoiq3EE2dM0hDt7yfidz77N2yiUC2YiKg4z1MZA8L2VP9XNLh1Q9rmvvydh/1L4P6g8XUP6lIekBF0gUVSScVKVAsFInagr1+/fKEOnf+8T5WvfP7haIrusCtx/1B5s4J7+p53PtDoc0ytOe9Y6reAX/93taSTQbPsUfbZAh/HTIgwwXA/J7uge8Ljp+csS94z0xeofCXhRPw/GuVr8jPll4kl6X8AmT/U5IqjgHMmhNnZfZd+84bn+/evLLQXTv9nm6MD7ff1XmBUSe3+5ixb10bXb8piz0+RqzqjbfvfLHz5nu7H/+bM/LOrRvQ/N6VD0d/vL395Vu7lz8ffYV8gK1ufQBiRi+/Bc+jV18R8YFgDt61NMBlkLjzl0/Be5R9+ei1V7c/v7L9xV93X7y9gLYWOOwvwi/fXH73O6OXJLXj9DxelvAbx7ohwzFA1gxNN5hmUaFg/L6M6oZuWYahyAwCZmV8A1PWe6P8Sgl/tT37J86T/wVQSwcI1k8N1cYNAACWOgAAUEsBAhQAFAAICAgAoHMpUo//M80IBQAALiYAABcAAAAAAAAAAAAAAAAAAAAAAGdlb2dlYnJhX2RlZmF1bHRzMmQueG1sUEsBAhQAFAAICAgAoHMpUgrjiZZLAwAAABEAABcAAAAAAAAAAAAAAAAATQUAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1sUEsBAhQAFAAICAgAoHMpUtY3vbkZAAAAFwAAABYAAAAAAAAAAAAAAAAA3QgAAGdlb2dlYnJhX2phdmFzY3JpcHQuanNQSwECFAAUAAgICACgcylS1k8N1cYNAACWOgAADAAAAAAAAAAAAAAAAAA6CQAAZ2VvZ2VicmEueG1sUEsFBgAAAAAEAAQACAEAADoXAAAAAA==",    
};
// is3D=is 3D applet using 3D view, AV=Algebra View, SV=Spreadsheet View, CV=CAS View, EV2=Graphics View 2, CP=Construction Protocol, PC=Probability Calculator DA=Data Analysis, FI=Function Inspector, macro=Macros
var views = {'is3D': 1,'AV': 0,'SV': 0,'CV': 0,'EV2': 0,'CP': 0,'PC': 0,'DA': 0,'FI': 0,'macro': 0};
var applet = new GGBApplet(parameters, '5.0', views);
window.onload = function() {applet.inject('ggbApplet')};
applet.setPreviewImage('data:image/gif;base64,R0lGODlhAQABAAAAADs=','https://www.geogebra.org/images/GeoGebra_loading.png','https://www.geogebra.org/images/applet_play.png');
</script>



<div id="ggbApplet"></div>



<blockquote>
<p>以优化二次型为例，我们的目的时找到矩阵的极值，然而在摸索过程中，沿着有些方向走一小步结果就产生了巨大的变化，如果往另一个方向还走这么大步子又可能对结果没什么影响，这样的二次型矩阵相对那些各个方向变化率差异小的二次型就更加难以优化。</p>
</blockquote>
<ul>
<li>矩阵${\bf{A} } (n\times n)$的<code>条件数</code>，用$Cond(\bf{A})$表示，数学上的定义为矩阵绝对值最大的奇异值(用$\lambda$表示)与绝对值最小的奇异值的商：</li>
</ul>
<p>$$<br>Cond({\bf{A} }) = \frac{ { {\lambda _1} } } { { {\lambda _n} } }<br>$$</p>
<blockquote>
<p>这个定义的解释是直观的，最大的奇异值表示矩阵的能量主轴，表示可能产生的最大变化率：</p>
</blockquote>
<p>$$<br>\max \frac{ {\left|| { {\bf{A}}x} \right||} }{ {\left|| x \right||} } = {\lambda _1}<br>$$</p>
<blockquote>
<p>然后最小奇异值$\lambda _n$对应最小的变化率：</p>
</blockquote>
<p>$$<br>\min \frac{ {\left|| { {\bf{A}}x} \right||} }{ {\left|| x \right||} } = {\lambda _n}<br>$$</p>
<blockquote>
<p>二者的商就是矩阵的<code>条件数</code>。</p>
</blockquote>
<h3 id="另一种推导思路"><a href="#另一种推导思路" class="headerlink" title="另一种推导思路"></a>另一种推导思路</h3><ul>
<li><p>在衡量某个函数敏感度与稳定性时，常使用的一种方法是求导。即观察导数 $df(x)/dx$ 的大小。</p>
</li>
<li><p>考虑线性系统$\bf{A}x=b$，其中矩阵$\bf{A}$为$n$阶可逆方阵</p>
</li>
<li><p>在$\bf{x}$上加入一个小扰动$\delta $，系统变为：</p>
</li>
</ul>
<p>$$<br>{\bf{A} }( {\bf{x}} + {\bf{\delta } }) = b + {\bf{A\delta } }<br>$$</p>
<ul>
<li>用在$\bf{b}$上的变化率与$\bf{x}$上的变化率的比值表示线性系统的稳定程度，这个稳定程度我们用字母$C$表示：</li>
</ul>

$$
\begin{array}{l}
C &= \frac{{\left| {\left| {{\bf{A\delta }}} \right|} \right|/\left| {\left| {\bf{b}} \right|} \right|}}{{\left| {\left| {\bf{\delta }} \right|} \right|/\left| {\left| {\bf{x}} \right|} \right|}}\\
 &= \frac{{\left| {\left| {{\bf{A\delta }}} \right|} \right|}}{{\left| {\left| {\bf{\delta }} \right|} \right|}} \cdot \frac{{\left| {\left| {\bf{x}} \right|} \right|}}{{\left| {\left| {\bf{b}} \right|} \right|}}\\
 &= \frac{{\left| {\left| {{\bf{A\delta }}} \right|} \right|}}{{\left| {\left| {\bf{\delta }} \right|} \right|}} \cdot \frac{{\left| {\left| {{{\bf{A}}^{ - 1}}{\bf{b}}} \right|} \right|}}{{\left| {\left| {\bf{b}} \right|} \right|}}
\end{array}
$$


<ul>
<li>其中模长为范数操作，根据范数的<a href="https://baike.baidu.com/item/%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0/5296169?fr=aladdin" target="_blank" rel="noopener">相容性</a>，有：</li>
</ul>

$$
\begin{array}{l}
C &= \frac{{\left| {\left| {{\bf{A\delta }}} \right|} \right|}}{{\left| {\left| {\bf{\delta }} \right|} \right|}} \cdot \frac{{\left| {\left| {{{\bf{A}}^{ - 1}}{\bf{b}}} \right|} \right|}}{{\left| {\left| {\bf{b}} \right|} \right|}}\\
 &\le \frac{{\left| {\left| {\bf{A}} \right|} \right|\left| {\left| {\bf{\delta }} \right|} \right|}}{{\left| {\left| {\bf{\delta }} \right|} \right|}} \cdot \frac{{\left| {\left| {{{\bf{A}}^{ - 1}}} \right|} \right|\left| {\left| {\bf{b}} \right|} \right|}}{{\left| {\left| {\bf{b}} \right|} \right|}}\\
 &= \left| {\left| {\bf{A}} \right|} \right|\left| {\left| {{{\bf{A}}^{ - 1}}} \right|} \right|
\end{array}
$$


<h3 id="条件数的性质"><a href="#条件数的性质" class="headerlink" title="条件数的性质"></a>条件数的性质</h3><ul>
<li><p>对任何非零矩阵$ \bf{A}$, $Cond{\rm{ } }\left( A \right){\rm{ } } \ge {\rm{ } }1$</p>
</li>
<li><p>$Cond\left( \bf{I} \right){\rm{ } } = {\rm{ } }1$, $\bf{I}$ 是单位矩阵</p>
</li>
<li><p>$Cond\left( {s{\bf{A} } } \right){\rm{ } } = {\rm{ } }Cond\left( {\bf{A} } \right)$, 其中$s$是一个标量</p>
</li>
<li><p>对于任何对角矩阵${\bf{A} }{\rm{ } } = {\rm{ } }diag\left( {\bf{d} } \right)$，$Cond\left( {\bf{A} } \right){\rm{ } } = {\rm{ } }max({\bf{d} }){\rm{ } }/{\rm{ }}min({\bf{d} })$</p>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/bitcarmanlee/article/details/51945271" target="_blank" rel="noopener">https://blog.csdn.net/bitcarmanlee/article/details/51945271</a></li>
<li><a href="https://blog.csdn.net/adminabcd/article/details/46619627" target="_blank" rel="noopener">https://blog.csdn.net/adminabcd/article/details/46619627</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/81053589" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/81053589</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>math</category>
        <category>linear_algebra</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>linear_algebra</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 读取大图片</title>
    <url>/2021/01/05/python/load-large-image/load-large-image/</url>
    <content><![CDATA[<blockquote>
<p>python 在读取大图像时会报错，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="读取大图像"><a href="#读取大图像" class="headerlink" title="读取大图像"></a>读取大图像</h3><ul>
<li>open cv 在读取超过 1G 的图像时会返回 None</li>
<li>PIL 读取超过一定像素个数的图像会报错</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>解除PIL最大像素个数限制</li>
<li>之后可以使用skimage或matplot读取大图像</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> skimage <span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> gImage</span><br><span class="line"></span><br><span class="line">image_file = <span class="string">'test.bmp'</span></span><br><span class="line"></span><br><span class="line">Image.MAX_IMAGE_PIXELS = <span class="literal">None</span></span><br><span class="line">img_sk = io.imread(image_file)</span><br><span class="line">img_ml = gImage.imread(image_file)</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 6 - 共轭梯度法</title>
    <url>/2020/12/26/machine_learning/conjugate-gradient-algorithm/conjugate-alg/conjugate-alg/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍二次型优化方法中比较优秀的迭代方法——共轭梯度法。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><blockquote>
<p>重述我们需要优化的问题：</p>
</blockquote>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{x^TAx} } - { {\bf{b} }^{\bf{T} } }{\bf{x} } + {\bf{c} } \tag{1} \label{1}<br>$$</p>
<ul>
<li>矩阵$\bf{A}$正定对称</li>
<li>目标为优化$\bf{x}$，使得$f(\bf{x})$取得最小值</li>
</ul>
<h3 id="最速下降法的问题"><a href="#最速下降法的问题" class="headerlink" title="最速下降法的问题"></a>最速下降法的问题</h3><ul>
<li>贪心计算局部最小值</li>
<li>没有全局视野，没有使用真正的模型建模</li>
<li>导致优化过程需要反复迭代才能逐步逼近最优值</li>
</ul>
<h3 id="轭"><a href="#轭" class="headerlink" title="轭"></a>轭</h3><blockquote>
<p>轭是一个汉字，读作è，本意是指驾车时套在牲口脖子上的曲木，引申义是束缚，控制。该文字在《仪礼·既夕礼》和《荀子·正论》等文献均有记载。        ——百度百科</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20201226144811.jpg"></p>
<ul>
<li>数学中很多轭相关的内容，此处的共轭表示相互约束，在某个条件下可以相互作用的意思。</li>
</ul>
<h3 id="共轭梯度法思想来源"><a href="#共轭梯度法思想来源" class="headerlink" title="共轭梯度法思想来源"></a>共轭梯度法思想来源</h3><ul>
<li>为解决最速下降法来回往复的问题，人们开始思考是否有可以直接在需要优化的二次函数定义下直接对其进行优化，是否可以通过有限步计算得到真正的最优解</li>
<li>那么假设我们使用关于该问题精确的模型而不是近似的局部最优模型，我们如果可以在某个N维空间中，分别计算出最优解的各个维度的坐标，就可以达到上述目的</li>
<li>那么如何设计这个空间，如何可以分步计算并且可以整合成真正的结果，是共轭梯度法来解决的问题</li>
<li>该方法的核心思想是建立一组N维空间线性无关的一组基，理论上这组基的线性组合可以表示空间中任意一点，共轭梯度法通过多次计算，精确求解目标在空间中位置在这组基空间中的各个系数分量，达到求解最优值的目的</li>
<li>该方法和最速下降法却别在精确建模，有了上帝视角，每次迭代计算将该方向需要调整的分量值调整到极致，也就是说之后的计算再也不用考虑该方向上的运动分量了，这是一个精确求解问题的过程，不是逐步简单建模向最优值挪动的逼近过程</li>
</ul>
<h3 id="共轭基的定义"><a href="#共轭基的定义" class="headerlink" title="共轭基的定义"></a>共轭基的定义</h3><p>设$\bf{A}$为$n$阶实对称正定矩阵，如果有两个$n$维列<a href="https://baike.baidu.com/item/%E5%90%91%E9%87%8F" target="_blank" rel="noopener">向量</a>$\bf{s}_1$和$\bf{s}_2$满足</p>

$$
{\bf{s}}_1^T{\bf{A}}{{\bf{s}}_2} = 0 \tag{2} \label{2}
$$


<p>则称向量$\bf{s}_1$和$\bf{s}_2$对于矩阵$\bf{A}$共轭。如果$\bf{A}$为单位矩阵，则式$\eqref{2}$即成为$\bf{s}_1$$\bf{s}_2$，这样两个向量的点积为零，此二向量在几何上是正交的，它是共轭的一种特例。</p>
<p>设A为对称正定矩阵，若一组非零向量$\bf{s}_1$,$\bf{s}_2$,…,$\bf{s}_n$满足</p>

$$
{\bf{s}}_i^T{\bf{A}}{{\bf{s}}_j} = 0   (i≠j) \tag{3}
$$

则称向量系${{\bf{s}}_i}(1 \le i \le n)$为关于矩阵$\bf{A}$共轭。

若${{\bf{s}}_i}(1 \le i \le n)$之间线性无关，那么我们称该向量集合为$n$维空间中关于矩阵$\bf{A}$的一组共轭基。


<h3 id="共轭基的作用"><a href="#共轭基的作用" class="headerlink" title="共轭基的作用"></a>共轭基的作用</h3><ul>
<li>假设有一组关于矩阵$\bf{A}$的共轭基$\bf{D}$：</li>
</ul>
<p>$$<br>\bf{D}={ {\bf{d}_1},{\bf{d}_2},…,{\bf{d}_n}}  \tag{4}<br>$$</p>
<ul>
<li>设二次型函数$\eqref{1}$的极值为$\bf{x}^*$，用$\bf{D}$表似为：</li>
</ul>

$$
{ {\bf{x} }^*} = {\lambda _1}{ {\bf{d} }_1} + {\lambda _2}{ {\bf{d} }_2} +  \cdots  + {\lambda _n}{ {\bf{d} }_n} \tag{5}
$$



<ul>
<li>因为函数极值处在各个方向的导数为0有：</li>
</ul>

$$
\begin{array}{l}
f'({{\bf{x}}^*}) = {\bf{A}}{{\bf{x}}^*} - {\bf{b}} = 0\\
 \Rightarrow {\bf{A}}{{\bf{x}}^*} = {\bf{b}}
\end{array} \tag{6}
$$



<ul>
<li>我们计算${\bf{d}}_i^T{\bf{A}}{{\bf{x}}^*}$，根据不同共轭基之间相互共轭：

</li>
</ul>

$$
\begin{array}{l}
{\bf{d}}_i^T{\bf{A}}{{\bf{x}}^*} &= {\bf{d}}_i^T{\bf{A}}\left( {{\lambda _0}{{\bf{d}}_0} +  \ldots  + {\lambda _{n - 1}}{{\bf{d}}_{n - 1}}} \right)\\
 &= {\lambda _i}{\bf{d}}_i^T{\bf{A}}{{\bf{d}}_i} + 0\\ \tag{7}
\end{array} 
$$



<ul>
<li>得到：</li>
</ul>

$$
{\lambda _i} = \frac{{{\bf{d}}_i^T{\bf{A}}{{\bf{x}}^*}}}{{{\bf{d}}_i^T{\bf{A}}{{\bf{d}}_i}}} = \frac{{{\bf{d}}_i^T{\bf{b}}}}{{{\bf{d}}_i^T{\bf{A}}{{\bf{d}}_i}}} \tag{8} \label{8}
$$



<ul>
<li>对于${\lambda _i}$的求解，我们已知的变量为$\bf{b}$和$\bf{A}$，如果我们已经得到了空间中关于$\bf{A}$的共轭基（任意一组），我们都可以直接解得${\lambda _i}$</li>
<li>这是一个令人振奋的结论，所以我们当前的工作重点转为了如何快速地求得一组关于$\bf{A}$的共轭基</li>
</ul>
<h3 id="根据定义获取共轭基"><a href="#根据定义获取共轭基" class="headerlink" title="根据定义获取共轭基"></a>根据定义获取共轭基</h3><ul>
<li>有了定义，我们不难想到暴力获取共轭基的方法：</li>
</ul>
<pre class="mermaid">    graph TB
        A(随机生成n个n维向量)
        B{i=1-n循环}
        C[剔除向量j=1-i的分量]
        E[收集向量1-n]
        D[得到向量i]

        A-->B
        C --> D
        D --> B
        B-- 循环结束 --> E --> F(输出共轭基)
        B-- 循环未结束 -->C</pre>

<ul>
<li>这套方法下来，我们就可以得到根据定义计算出来的共轭基，带入$\eqref{8}$计算得到极值，没有任何问题</li>
<li>但事实上这个运算量与代数法解${\bf{A}}{{\bf{x}}} = {\bf{b}}$的过程具有相当的运算复杂度，没有给该优化问题带来性能收益</li>
</ul>
<h3 id="共轭梯度法"><a href="#共轭梯度法" class="headerlink" title="共轭梯度法"></a>共轭梯度法</h3><blockquote>
<p>此算法核心步骤与最速下降法相同，分别为寻找共轭方向与计算运动步长。</p>
</blockquote>
<h4 id="寻找共轭方向"><a href="#寻找共轭方向" class="headerlink" title="寻找共轭方向"></a>寻找共轭方向</h4><blockquote>
<p>由于计算梯度简单，寻找共轭梯度的过程依附于梯度方向的计算。</p>
</blockquote>
<ul>
<li>优化目标为$\bf{x}^*$，初始位置为$\bf{x}_1$，需要求得的共轭基为 $\bf{D}={ {\bf{d}_1},{\bf{d}_2},…,{\bf{d}_n}}$</li>
<li>计算初始$\bf{x}_1$位置的梯度，第一个共轭基为梯度的反方向：</li>
</ul>

$$
{{\bf{d}}_1} =  - {{\bf{g}}_1} =  - ({\bf{A}}{{\bf{x}}_1} - {\bf{b}}) = {\bf{b}} - {\bf{A}}{{\bf{x}}_1} \tag{9}
$$



<ul>
<li>第$i$个梯度若要剔除掉第$j$个共轭基$(j&lt;i)$方向的分量，需要减去该方向的$\beta_j $分量：</li>
</ul>

$$
\begin{array}{l}
{\bf{d}}_j^T{\bf{A}}({{\bf{g}}_i} - \beta_j {{\bf{d}}_j}) = 0\\
{\bf{d}}_j^T{\bf{A}}{{\bf{g}}_i} = \beta_j {\bf{d}}_j^T{\bf{A}}{{\bf{d}}_j}\\
\beta_j  = \frac{{{\bf{d}}_j^T{\bf{A}}{{\bf{g}}_i}}}{{{\bf{d}}_j^T{\bf{A}}{{\bf{d}}_j}}}
\end{array} \tag{10} \label{10}
$$


<ul>
<li>因此第$k$个共轭基为：</li>
</ul>

$$
\begin{array}{l}
{{\bf{d}}_k} = {{\bf{g}}_k} - \sum\limits_{i = 1}^{k - 1} {\frac{{{\bf{d}}_i^T{\bf{A}}{{\bf{g}}_k}}}{{{\bf{d}}_i^T{\bf{A}}{{\bf{d}}_i}}}{{\bf{d}}_i}} \\
{{\bf{d}}_k}={{\bf{g}}_k} -\sum\limits_{i = 1}^{k - 1}\beta_i{{\bf{d}}_i}

\end{array} \tag{11} \label{11}
$$


<ul>
<li>目前，我们如果可以确定每一次迭代移动的$\bf{x}_i$的位置，求得$\bf{g}_i$，那么就可以根据第1到第$i-1$个共轭基确定当前第$i$个共轭基</li>
<li>因此当前我们的目标是在有了共轭方向后，如何确定在该方向上的运动距离</li>
</ul>
<h4 id="确定运动距离"><a href="#确定运动距离" class="headerlink" title="确定运动距离"></a>确定运动距离</h4><blockquote>
已经运动到了$\bf{x}_k$的位置，下一个前进方向为${{\bf{d}}_k}$，前进步长${\alpha _k}$，误差为$\bf{e}_{k}=\bf{x}^*-x_{k}$，也就是说：

$$
{{\bf{x}}_{k + 1}}={{\bf{x}}_k} + {\alpha _k}{{\bf{d}}_k} \tag{12}
$$

</blockquote>
<blockquote>
<p>这里介绍两种求前进步长${\alpha _k}$的思路。</p>
</blockquote>
<h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><blockquote>
<p>确定第$k$步的运动步长${\alpha _k}$，也就是一个共轭基的系数，限制该系数的条件为：</p>
</blockquote>
<ul>
<li>当前共轭基的方向$\bf{d}_{k}$与误差向量$\bf{e}_{k+1}=\bf{x}^*-x_{k+1}$共轭：

$$
\begin{aligned}
\bf{d}_{k}^{T^{\prime}} A e_{k+1} &=\bf{d}_{k}^{T} A\left(x^{*}-x_{k+1}\right) \\
&=\bf{d}_{k}^{T} A\left(x^{*}-x_{k}+x_{k}-x_{k+1}\right) \\
&=\bf{d}_{k}^{T} A\left(e_{k}-\alpha_{k} \bf{d}_{k}\right) \\
&=\bf{d}_{k}^{T} A e_{k}-\alpha_{k} \bf{d}_{k}^{T} A \bf{d}_{k}=0
\end{aligned} \tag{13} \label{13}
$$


</li>
<li><p>有：</p>
</li>
</ul>

$$
\begin{aligned}
\alpha_{k} &=\frac{\bf{d}_{k}^{T} A e_{k}}{\bf{d}_{k}^{T} A \bf{d}_{k}} \\
&=\frac{\bf{d}_{k}^{T} A\left(x^{*}-x_{k}\right)}{\bf{d}_{k}^{T} A \bf{d}_{k}} \\
&=\frac{\bf{d}_{k}^{T}\left(A x^{*}-A x_{k}\right)}{\bf{d}_{k}^{T} A \bf{d}_{k}} \\
&=\frac{\bf{d}_{k}^{T}\left(b-A x_{k}\right)}{\bf{d}_{k}^{T} A \bf{d}_{k}} \\
&=-\frac{\bf{d}_{k}^{T} g_{k}}{\bf{d}_{k}^{T} A \bf{d}_{k}}
\end{aligned} \tag{14}
$$


<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><blockquote>
对$f({{\bf{x}}_{k + 1}})$中的${\alpha _k}$求导，使得导数为0，计算${\alpha _k}$:
</blockquote>
<ul>
<li>用${{\bf{x}}_k}$表示${{\bf{x}}_{k+1}}$:

$$
\begin{array}{l}
f({{\bf{x}}_{k + 1}}) &= f({{\bf{x}}_k} + {\alpha _k}{{\bf{d}}_k})\\
 &= \frac{1}{2}{\bf{x}}_{k + 1}^T{\bf{A}}{{\bf{x}}_{k + 1}} - {{\bf{b}}^T}({{\bf{x}}_k} + {\alpha _k}{{\bf{d}}_k}) + c
\end{array} \tag{15}
$$


</li>
<li>对$f({{\bf{x}}_{k + 1}})$中${\alpha _k}$求导:

$$
\begin{array}{l}
f'({{\bf{x}}_{k + 1}}|{\alpha _k}) &= \frac{{\partial f({{\bf{x}}_{k + 1}})}}{{\partial {{\bf{x}}_{k + 1}}}}\frac{{\partial {{\bf{x}}_{k + 1}}}}{{\partial {\alpha _k}}}\\
 &= {({\bf{A}}{{\bf{x}}_{k + 1}} - {\bf{b}})^T}{{\bf{d}}_k}\\
 &= {({\bf{A}}{{\bf{x}}_k} + {\alpha _k}{\bf{A}}{{\bf{d}}_k} - {\bf{b}})^T}{{\bf{d}}_k}\\
 &= {({\alpha _k}{\bf{A}}{{\bf{d}}_k} + {{\bf{g}}_k})^T}{{\bf{d}}_k}\\
 &= {\alpha _k}{\bf{d}}_k^TA{{\bf{d}}_k} + {\bf{g}}_k^T{{\bf{d}}_k}
\end{array} \tag{16}
$$


</li>
<li>使导数为0，有:

$$
\begin{array}{l}
{\alpha _k}{\bf{d}}_k^TA{{\bf{d}}_k} + {\bf{g}}_k^T{{\bf{d}}_k} = 0\\
{\alpha _k} =  - \frac{{{\bf{g}}_k^T{{\bf{d}}_k}}}{{{\bf{d}}_k^TA{{\bf{d}}_k}}} 
=  - \frac{{{\bf{d}}_k^T{{\bf{g}}_k}}}{{{\bf{d}}_k^TA{{\bf{d}}_k}}}
\end{array} \tag{17}
$$



</li>
</ul>
<blockquote>
<p>此时我们已经计算得到了一系列计算共轭梯度的方法，能够依次求得一套共轭基了，但是其中有些步骤仍然可以继续简化计算。</p>
</blockquote>
<h4 id="简化计算与一些推论"><a href="#简化计算与一些推论" class="headerlink" title="简化计算与一些推论"></a>简化计算与一些推论</h4><h5 id="推论一"><a href="#推论一" class="headerlink" title="推论一"></a>推论一</h5><ul>
<li>第$k$步计算的梯度$\bf{g}_k$和前$k-1$步的共轭向量${\bf{d}_1,\bf{d}_1,...,\bf{d}_{k-1}}$正交:</li>
<li>证明，当$i < j$时：

$$
\begin{array}{l}
\bf{d}_i^T{g_j} &= \bf{d}_i^T(A{x_j} - b)\\
 &= \bf{d}_i^T(A{x_j} - A{x^*})\\
 &=  - \bf{d}_i^T(A{x^*} - {x_{i + 1}} + {x_{i + 1}} - {x_j})\\
 &=  - \bf{d}_i^TA({e_{i + 1}} - \sum\limits_{k = i + 1}^{j - 1} {{\alpha _k}{d_k})} \\
 &=  - \bf{d}_i^TA{e_{i + 1}} + \sum\limits_{k = i + 1}^{j - 1} {{\alpha _k}d_i^TA{d_k}} 
\end{array} \tag{18} \label{18}
$$


</li>
<li><p>式$\eqref{18}$左边由于$\bf{d}_i$计算过程$\eqref{13}$为0，右边由于不同的共轭向量间两两共轭值为0，所以最终的值也为0</p>
</li>
<li>因此证明了：第$ k $步计算的梯度 $ \bf{g}_k$ 和前$k-1$步的共轭向量 $ { \bf{d}_1,\bf{d}_1,...,\bf{d}_{k-1}}$正交。

</li>
</ul>
<h5 id="推论二"><a href="#推论二" class="headerlink" title="推论二"></a>推论二</h5><ul>
<li>第$k$步计算的梯度$\bf{g}_k$和前$k-1$步的梯度${\bf{g}_1,\bf{g}_1,...,\bf{g}_{k-1}}$正交:</li>
<li>证明，当$i < j$时：
</li>
<li><p>由$\eqref{11}$得：</p>
</li>
</ul>

$$
{{\bf{g}}_i}={{\bf{d}}_i} +\sum\limits_{k = 1}^{i - 1}\beta_k{{\bf{d}}_k} \tag{19}
$$


<ul>
<li>有：</li>
</ul>

$$
\begin{array}{l}
{\bf{g}}_i^T{{\bf{g}}_j} &= {({{\bf{d}}_i} + \sum\limits_{k = 1}^{i - 1} {{\beta _k}} {{\bf{d}}_k})^T}{{\bf{g}}_j}\\
 &= \sum\limits_{k = 1}^i {{\beta _k}} {{\bf{d}}_k}^T{{\bf{g}}_j} \qquad ({\beta _i} = 1) \tag{20} \label{20}
\end{array}
$$


<ul>
<li>根据<strong>推论一</strong>，式$\eqref{20}$值为0</li>
<li>证得结论：第$k$步计算的梯度$\bf{g}_k$和前$k-1$步的梯度${\bf{g}_1,\bf{g}_1,...,\bf{g}_{k-1}}$正交。</li>
<li>那么对于两个不同的梯度$\bf{g}_i, \bf{g}_j(i \ne j)$，那么二者必分前后，因此各个梯度之间相互正交，即${\bf{G}} = \{ {{\bf{g}}_{1,}}{{\bf{g}}_2},...,{{\bf{g}}_n}\} $组成了$n$维空间中的一组正交基

</li>
</ul>
<h5 id="推论三"><a href="#推论三" class="headerlink" title="推论三"></a>推论三</h5><ul>
<li>计算${\bf{g}}_{j + 1}^T{{\bf{g}}_i}$:

$$
\begin{array}{l}

{\bf{g}}_{j + 1}^T{{\bf{g}}_i} &= {({\bf{A}}{{\bf{x}}_{j + 1}} - {\bf{b}})^T}{{\bf{g}}_i}\\
 &= {({\bf{A}}({{\bf{x}}_j} + {\alpha _j}{{\bf{d}}_j}) - {\bf{b}})^T}{{\bf{g}}_i}\\
 &= {({\bf{A}}{{\bf{x}}_j} - {\bf{b}} + {\alpha _j}{\bf{A}}{{\bf{d}}_j})^T}{{\bf{g}}_i}\\
& = {({{\bf{g}}_j} + {\alpha _j}{\bf{A}}{{\bf{d}}_j})^T}{{\bf{g}}_i}\\
 &= {\bf{g}}_j^T{{\bf{g}}_i} + {\alpha _j}{\bf{d}}_j^TA{{\bf{g}}_i}\\
{\bf{d}}_j^TA{{\bf{g}}_i}& = \frac{1}{{{\alpha _j}}}({\bf{g}}_{j + 1}^T{{\bf{g}}_i} - {\bf{g}}_j^T{{\bf{g}}_i})
\end{array} \tag{21} \label{21}
$$


</li>
<li><p>根据式$\eqref{21}$和<strong>推论二</strong>，由于一般情况下$\alpha _j$不为0，因此对于所有情况为保证$\eqref{20}$成立，需要当$i \ne j$且$i \ne j+1$时，${\bf{d}}_j^TA{{\bf{g}}_i}=0$ </p>
</li>
<li><p>这意味着当前的梯度方向与上一个共轭方向之前的和当前之后的所有共轭方向共轭正交</p>
</li>
</ul>
<h5 id="简化计算"><a href="#简化计算" class="headerlink" title="简化计算"></a>简化计算</h5><ul>
<li>对于式$\eqref{11}$中，在求解$\bf{d}_k$过程中产生的系数$\beta$，此处强调一下$\eqref{10}$:</li>
</ul>

$$
{\beta _i} = \frac{{{\bf{d}}_i^T{\bf{A}}{{\bf{g}}_k}}}{{{\bf{d}}_i^T{\bf{A}}{{\bf{d}}_i}}}
$$
 

<ul>
<li><p>由<strong>推论三</strong>，$\eqref{10}$中当$i\ne k$且$i \ne k-1$时，${{\bf{d}}_i^T{\bf{A}}{{\bf{g}}_k}}$值为0 </p>
</li>
<li>因此式$\eqref{11}$可以简化为：

$$
\begin{array}{l}
{{\bf{d}}_k} &= {{\bf{g}}_k} - \sum\limits_{i = 1}^{k - 1} {{\beta _i}} {{\bf{d}}_i}\\
&= {{\bf{g}}_k} -  {{\beta _{k-1}}} {{\bf{d}}_{k-1}}
\end{array} \tag{22} \label{22}
$$

 
</li>
<li><p>即在求解第$k$个共轭基时，仅需要在当前梯度$\bf{g}_k$上减去第$k-1$个共轭基的共轭分量即可</p>
</li>
</ul>
<h5 id="推论四"><a href="#推论四" class="headerlink" title="推论四"></a>推论四</h5><ul>
<li>根据<strong>简化计算</strong>的公式$\eqref{22}$，有:</li>
</ul>

$$
\begin{array}{l}
{{\bf{d}}_k} &= {{\bf{g}}_k} - {\beta _{k - 1}}{{\bf{d}}_{k - 1}}\\
 &= {{\bf{g}}_k} - {\beta _{k - 1}}({{\bf{g}}_{k - 1}} - {\beta _{k - 2}}{{\bf{d}}_{k - 2}})\\
 &= {{\bf{g}}_k} + {\gamma _{k - 1}}{{\bf{g}}_{k - 1}} + {\gamma _{k - 2}}{{\bf{g}}_{k - 2}} +  \cdots {\gamma _1}{{\bf{g}}_1}\\
 &= \sum\limits_{i = 1}^k {{\gamma _i}{{\bf{g}}_i}} 
\end{array} \tag{23}
$$
 

<ul>
<li>其中固定的常数系数用$\gamma$表示</li>
<li>那么有：</li>
</ul>

$$
\begin{array}{l}
{\bf{g}}_i^T{{\bf{d}}_j} &= {\bf{g}}_i^T\sum\limits_{k = 1}^j {{\gamma _k}{{\bf{g}}_k}} \\
& = \sum\limits_{k = 1}^j {{\gamma _k}{\bf{g}}_i^T{{\bf{g}}_k}} 
\end{array} \tag{24} \label{24}
$$
 

<ul>
<li>式$\eqref{24}$根据<strong>推论二</strong>的结论，值为：</li>
</ul>

$$
{\bf{g}}_i^T{{\bf{d}}_j} = \left\{ {\begin{array}{*{20}{c}}
{0,i > j}\\
{\gamma_i{\bf{g}}_i^T{{\bf{g}}_i},i \le j}
\end{array}} \right. \tag{25}
$$
 

<ul>
<li>即某个梯度与所有共轭基的投影为0或一个常数（对该方法来说不是一个有实用性的结论）</li>
</ul>
<h4 id="共轭梯度法实操步骤"><a href="#共轭梯度法实操步骤" class="headerlink" title="共轭梯度法实操步骤"></a>共轭梯度法实操步骤</h4><ul>
<li>初始条件：已知$\bf{A}, \bf{b}$，初始位置$\bf{x}_1$</li>
<li>$\bf{g}_1=\bf{A}\bf{x}_1-\bf{b}$ </li>
<li>${{\bf{d}}_1} =  - {{\bf{g}}_{\bf{1}}}$ </li>
<li>$k=1$</li>
<li>$while  \quad k \le  n:$<ul>
<li>$\alpha_{k}  = - \frac{{{\bf{d}}_k^T{{\bf{g}}_k}}}{{{\bf{d}}_k^TA{{\bf{d}}_k}}}$ </li>
<li>$\bf{x}_{k+1}=\bf{x}_k+\alpha_{k}{\bf{d}}_k$ </li>
<li>$\bf{g}_{k+1}=\bf{A}\bf{x}_{k+1}-\bf{b}$ </li>
<li>${\beta _k} = \frac{{{\bf{d}}_k^T{\bf{A}}{{\bf{g}}_{k+1}}}}{{{\bf{d}}_k^T{\bf{A}}{{\bf{d}}_k}}}$ </li>
<li>${{\bf{d}}_{k+1}}={{\bf{g}}_{k+1}} -  {{\beta _{k}}} {{\bf{d}}_{k}}$ </li>
<li>$k=k+1$</li>
</ul>
</li>
<li>$return  \quad  \bf{x}_{n+1}$</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://baike.baidu.com/item/%E5%85%B1%E8%BD%AD%E6%96%B9%E5%90%91/9312634?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/%E5%85%B1%E8%BD%AD%E6%96%B9%E5%90%91/9312634?fr=aladdin</a></li>
<li><a href="https://blog.csdn.net/lusongno1/article/details/78550803" target="_blank" rel="noopener">https://blog.csdn.net/lusongno1/article/details/78550803</a></li>
<li><a href="https://blog.csdn.net/weixin_37895339/article/details/84640137" target="_blank" rel="noopener">https://blog.csdn.net/weixin_37895339/article/details/84640137</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/64227658" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/64227658</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -15- 折叠博客内容</title>
    <url>/2020/12/26/hexo/16_fold-content/fold-content/</url>
    <content><![CDATA[<blockquote>
<p>在写博客时，可能会遇到需要读者选读的内容，此时出现了折叠博客内容的需求。本文介绍在Hexo中自定义折叠部分内容的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h3><ul>
<li>可折叠部分内容，暴露标题，在读者需要查看标题下内容时点击展开</li>
<li>支持尽可能多的markdown语法</li>
<li>方便快速</li>
</ul>
<h3 id="方法一：-HTML语法-使用-details-元素"><a href="#方法一：-HTML语法-使用-details-元素" class="headerlink" title="方法一： HTML语法 - 使用 details 元素"></a>方法一： HTML语法 - 使用 details 元素</h3><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><blockquote>
<p>使用 <code>&lt;details&gt; &lt;/details&gt;</code> 标签包裹需要隐藏的内容<br>在其中使用<code>&lt;summary&gt; &lt;/summary&gt;</code>标签包裹需要隐藏内容的标题</p>
</blockquote>
<details>
  <summary>隐藏内容的标题</summary>

<p>隐藏文字隐藏文字隐藏文字。  </p>
<p>支持 <code>markdown</code> 语法</p>
<h5 id="支持标题"><a href="#支持标题" class="headerlink" title="支持标题"></a>支持标题</h5><h5 id="支持简单文本编辑"><a href="#支持简单文本编辑" class="headerlink" title="支持简单文本编辑"></a>支持简单文本编辑</h5><ul>
<li>支持 <strong>粗体</strong>、<em>斜体</em></li>
</ul>
<h5 id="支持列表"><a href="#支持列表" class="headerlink" title="支持列表"></a>支持列表</h5><ul>
<li>列表1</li>
<li>列表2</li>
</ul>
<h5 id="支持图片"><a href="#支持图片" class="headerlink" title="支持图片"></a>支持图片</h5><ul>
<li>md插入图片语法：<img src="https://www.zywvvd.com/about/index/1.png" alt="markdown 图片"></li>
<li>html插入图片语法：</li>
</ul>
<div style='margin:0 auto'>
<img src="https://www.baidu.com/img/baidu_jgylogo3.gif"  />
</div>

<h5 id="支持代码块"><a href="#支持代码块" class="headerlink" title="支持代码块"></a>支持代码块</h5><ul>
<li>行内代码 <code>markdown</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">A</span> &#123;</span></span><br><span class="line">A() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"1"</span>; &#125;</span><br><span class="line">A(<span class="keyword">int</span>) &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"2"</span>; &#125;</span><br><span class="line">A(<span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;) &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"3"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">A a1;</span><br><span class="line">A a2&#123;&#125;;</span><br><span class="line">A a3&#123; <span class="number">1</span> &#125;;</span><br><span class="line">A a4&#123; <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="支持表格"><a href="#支持表格" class="headerlink" title="支持表格"></a>支持表格</h5><table>
<thead>
<tr>
<th>文字</th>
<th>文字</th>
</tr>
</thead>
<tbody><tr>
<td>文字</td>
<td>文字</td>
</tr>
</tbody></table>
<h5 id="支持公式"><a href="#支持公式" class="headerlink" title="支持公式"></a>支持公式</h5><ul>
<li>行内公式$Y=aX^2+bX+c$<br>$$<br>Y=aX^2+bX+c<br>$$</li>
</ul>
</details>

<h4 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h4><blockquote>
<p>上述示例代码如下(由于markdown解码问题，示例cpp代码段前后的 ``` 请自行补全)：</p>
</blockquote>
<details>
  <summary>示例代码</summary>


<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;details&gt;</span><br><span class="line">  &lt;summary&gt;隐藏内容的标题&lt;&#x2F;summary&gt;</span><br><span class="line"></span><br><span class="line">隐藏文字隐藏文字隐藏文字。  </span><br><span class="line"></span><br><span class="line">支持 &#96;markdown&#96; 语法</span><br><span class="line"></span><br><span class="line">##### 支持标题</span><br><span class="line"></span><br><span class="line">##### 支持简单文本编辑</span><br><span class="line">- 支持 **粗体**、*斜体*</span><br><span class="line"></span><br><span class="line">##### 支持列表</span><br><span class="line">- 列表1</span><br><span class="line">- 列表2</span><br><span class="line"></span><br><span class="line">##### 支持图片</span><br><span class="line">- md插入图片语法：![markdown 图片](https:&#x2F;&#x2F;www.zywvvd.com&#x2F;about&#x2F;index&#x2F;1.png)</span><br><span class="line">- html插入图片语法：</span><br><span class="line"></span><br><span class="line">&lt;div style&#x3D;&#39;margin:0 auto&#39;&gt;</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;baidu_jgylogo3.gif&quot;  &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">##### 支持代码块</span><br><span class="line">- 行内代码 &#96;markdown&#96;</span><br><span class="line"></span><br><span class="line">cpp</span><br><span class="line">#include &lt;initializer_list&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">struct A &#123;</span><br><span class="line">    A() &#123; std::cout &lt;&lt; &quot;1&quot;; &#125;</span><br><span class="line">    A(int) &#123; std::cout &lt;&lt; &quot;2&quot;; &#125;</span><br><span class="line">    A(std::initializer_list&lt;int&gt;) &#123; std::cout &lt;&lt; &quot;3&quot;; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main(int argc, char *argv[]) &#123;</span><br><span class="line">    A a1;</span><br><span class="line">    A a2&#123;&#125;;</span><br><span class="line">    A a3&#123; 1 &#125;;</span><br><span class="line">    A a4&#123; 1, 2 &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">##### 支持表格</span><br><span class="line"></span><br><span class="line">| 文字 | 文字 |</span><br><span class="line">| ---- | ---- |</span><br><span class="line">| 文字 | 文字 |</span><br><span class="line"></span><br><span class="line">##### 支持公式</span><br><span class="line">- 行内公式$Y&#x3D;aX^2+bX+c$</span><br><span class="line">$$</span><br><span class="line">Y&#x3D;aX^2+bX+c</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;details&gt;</span><br></pre></td></tr></table></figure>

</details>

<h3 id="方法二：-使用hexo-sliding-spoiler插件"><a href="#方法二：-使用hexo-sliding-spoiler插件" class="headerlink" title="方法二： 使用hexo-sliding-spoiler插件"></a>方法二： 使用hexo-sliding-spoiler插件</h3><h4 id="官网链接"><a href="#官网链接" class="headerlink" title="官网链接"></a>官网链接</h4><p><a href="https://github.com/fletchto99/hexo-sliding-spoiler" target="_blank" rel="noopener">hexo-sliding-spoiler</a></p>
<h4 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-sliding-spoiler --save</span><br></pre></td></tr></table></figure>

<h4 id="自定义设置"><a href="#自定义设置" class="headerlink" title="自定义设置"></a>自定义设置</h4><ul>
<li>可以修改<code>css</code>文件来自定义配置样式</li>
</ul>
<blockquote>
<p>例如：可以自定义修改默认的 <code>show hide</code> 关键字</p>
<ul>
<li>打开文件 <code>hexo\node_modules\hexo-sliding-spoiler\assets\spoiler.css</code>，找到25-31行，修改其中的 <code>content</code>。</li>
<li>例如： 将<code>Show</code> 改为 <code>▶</code> ，<code>Hide</code>改为<code>▼</code></li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.spoiler.collapsed .spoiler-title:before &#123;</span><br><span class="line">    content: &quot;Show: &quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.spoiler.expanded .spoiler-title:before &#123;</span><br><span class="line">    content: &quot;Hide: &quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用方法-1"><a href="#使用方法-1" class="headerlink" title="使用方法"></a>使用方法</h4><blockquote>
<p>安装好插件后，使用 <code> {% spoiler "隐藏内容的标题" %} </code> 和<code> {% endspoiler %}</code>包裹需要隐藏的内容即可。</p>
</blockquote>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        隐藏内容的标题
    </div>
    <div class='spoiler-content'>
        <p>隐藏文字隐藏文字隐藏文字。  </p>
<p>支持 <code>markdown</code> 语法</p>
<h5 id="支持标题"><a href="#支持标题" class="headerlink" title="支持标题"></a>支持标题</h5><h5 id="支持简单文本编辑"><a href="#支持简单文本编辑" class="headerlink" title="支持简单文本编辑"></a>支持简单文本编辑</h5><ul>
<li>支持 <strong>粗体</strong>、<em>斜体</em></li>
</ul>
<h5 id="支持列表"><a href="#支持列表" class="headerlink" title="支持列表"></a>支持列表</h5><ul>
<li>列表1</li>
<li>列表2</li>
</ul>
<h5 id="支持图片"><a href="#支持图片" class="headerlink" title="支持图片"></a>支持图片</h5><ul>
<li>md插入图片语法：<img src="https://www.zywvvd.com/about/index/1.png" alt="markdown 图片"></li>
<li>html插入图片语法：</li>
</ul>
<div style='margin:0 auto'>
<img src="https://www.baidu.com/img/baidu_jgylogo3.gif"  />
</div>

<h5 id="支持代码块"><a href="#支持代码块" class="headerlink" title="支持代码块"></a>支持代码块</h5><ul>
<li>行内代码 <code>markdown</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">A</span> &#123;</span></span><br><span class="line">    A() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"1"</span>; &#125;</span><br><span class="line">    A(<span class="keyword">int</span>) &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"2"</span>; &#125;</span><br><span class="line">    A(<span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;) &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"3"</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    A a1;</span><br><span class="line">    A a2&#123;&#125;;</span><br><span class="line">    A a3&#123; <span class="number">1</span> &#125;;</span><br><span class="line">    A a4&#123; <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="支持表格"><a href="#支持表格" class="headerlink" title="支持表格"></a>支持表格</h5><table>
<thead>
<tr>
<th>文字</th>
<th>文字</th>
</tr>
</thead>
<tbody><tr>
<td>文字</td>
<td>文字</td>
</tr>
</tbody></table>
<h5 id="支持公式"><a href="#支持公式" class="headerlink" title="支持公式"></a>支持公式</h5><ul>
<li>行内公式$Y=aX^2+bX+c$<br>$$<br>Y=aX^2+bX+c<br>$$</li>
</ul>

    </div>
</div>

<h4 id="示例代码-1"><a href="#示例代码-1" class="headerlink" title="示例代码"></a>示例代码</h4><blockquote>
<p>上述示例代码如下(由于markdown解码问题，示例cpp代码段前后的 ``` 请自行补全)：</p>
</blockquote>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        示例代码
    </div>
    <div class='spoiler-content'>
        <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% spoiler &quot;隐藏内容的标题&quot; %&#125;</span><br><span class="line"></span><br><span class="line">隐藏文字隐藏文字隐藏文字。  </span><br><span class="line"></span><br><span class="line">支持 &#96;markdown&#96; 语法</span><br><span class="line"></span><br><span class="line">##### 支持标题</span><br><span class="line"></span><br><span class="line">##### 支持简单文本编辑</span><br><span class="line">- 支持 **粗体**、*斜体*</span><br><span class="line"></span><br><span class="line">##### 支持列表</span><br><span class="line">- 列表1</span><br><span class="line">- 列表2</span><br><span class="line"></span><br><span class="line">##### 支持图片</span><br><span class="line">- md插入图片语法：![markdown 图片](https:&#x2F;&#x2F;www.zywvvd.com&#x2F;about&#x2F;index&#x2F;1.png)</span><br><span class="line">- html插入图片语法：</span><br><span class="line"></span><br><span class="line">&lt;div style&#x3D;&#39;margin:0 auto&#39;&gt;</span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;www.baidu.com&#x2F;img&#x2F;baidu_jgylogo3.gif&quot;  &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">##### 支持代码块</span><br><span class="line">- 行内代码 &#96;markdown&#96;</span><br><span class="line"></span><br><span class="line">cpp</span><br><span class="line">#include &lt;initializer_list&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">struct A &#123;</span><br><span class="line">    A() &#123; std::cout &lt;&lt; &quot;1&quot;; &#125;</span><br><span class="line">    A(int) &#123; std::cout &lt;&lt; &quot;2&quot;; &#125;</span><br><span class="line">    A(std::initializer_list&lt;int&gt;) &#123; std::cout &lt;&lt; &quot;3&quot;; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main(int argc, char *argv[]) &#123;</span><br><span class="line">    A a1;</span><br><span class="line">    A a2&#123;&#125;;</span><br><span class="line">    A a3&#123; 1 &#125;;</span><br><span class="line">    A a4&#123; 1, 2 &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##### 支持表格</span><br><span class="line"></span><br><span class="line">| 文字 | 文字 |</span><br><span class="line">| ---- | ---- |</span><br><span class="line">| 文字 | 文字 |</span><br><span class="line"></span><br><span class="line">##### 支持公式</span><br><span class="line">- 行内公式$Y&#x3D;aX^2+bX+c$</span><br><span class="line">$$</span><br><span class="line">Y&#x3D;aX^2+bX+c</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">&#123;% endspoiler %&#125;</span><br></pre></td></tr></table></figure>



    </div>
</div>

<h3 id="方法对比"><a href="#方法对比" class="headerlink" title="方法对比"></a>方法对比</h3><table>
<thead>
<tr>
<th></th>
<th>details</th>
<th>endspoiler</th>
</tr>
</thead>
<tbody><tr>
<td>markdown支持</td>
<td>基本支持常用语法</td>
<td>基本支持常用语法</td>
</tr>
<tr>
<td>使用</td>
<td>直接使用</td>
<td>需要安装插件</td>
</tr>
<tr>
<td>外观</td>
<td>简洁清爽，保留原始格式</td>
<td>默认灰色底边，内容带框</td>
</tr>
<tr>
<td>动画</td>
<td>无</td>
<td>有过渡动画</td>
</tr>
<tr>
<td>配置</td>
<td>不需要/无法配置</td>
<td>可以自定义配置显示样式</td>
</tr>
</tbody></table>
<blockquote>
<p>个人建议使用 <code>endspoiler</code>插件，毕竟是为hexo设计的插件，可以进行自定义配置。</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/qq_36408085/article/details/104323711" target="_blank" rel="noopener">https://blog.csdn.net/qq_36408085/article/details/104323711</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -15- 解决 Hexo Mathjax 无法显示多行公式的问题</title>
    <url>/2020/12/22/hexo/15_formula/formula-error/</url>
    <content><![CDATA[<blockquote>
<p>Hexo比较好用的公式插件是Mathjax，但由于swig的文件解析机制，使得多行公式无法在Hexo中正常显示，本文介绍该问题的解决方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><ul>
<li>准备输入一个矩阵：</li>
</ul>

$$
A = \left( {\begin{array}{*{20}{c}}
1&{}&{}&{}\\
{}&1&{}&{}\\
{}&{}&1&{}\\
{}&{}&{}&1
\end{array}} \right)
$$


<ul>
<li>再输入一个多行公式</li>
</ul>

$$
\begin{array}{l}
z &= {(x + y)^2}\\
 &= {x^2} + {y^2} + 2xy
\end{array}
$$



<h4 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h4><ul>
<li>此时运行 <code>hexo g</code> 或<code>hexo s</code>有可能报错：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Unhandled rejection Nunjucks Error:  [Line 11, Column 65] expected variable end</span><br><span class="line">    &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;               Context Dump               &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">    &#x3D;&#x3D;&#x3D; (line number probably different from source) &#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<h4 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h4><ul>
<li>或者显示公式不正常，多行公式会挤成一行：</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201222003739.png"></p>
<h3 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h3><h4 id="问题1-1"><a href="#问题1-1" class="headerlink" title="问题1"></a>问题1</h4><ul>
<li>由于hexo解码时关注{{，}}，%% 等连续字符，会将这部分代码解读为其他带有特殊含义的内容</li>
<li>如果公式中恰巧出现了此类字符，会报出上述错误</li>
</ul>
<h4 id="问题2-1"><a href="#问题2-1" class="headerlink" title="问题2"></a>问题2</h4><ul>
<li>由于hexo在公式中的<code>\\</code>错会成了转义符，也就是说他只看见了一个反斜杠，不会执行换行命令，导致公式堆成一行</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><h4 id="临时方案"><a href="#临时方案" class="headerlink" title="临时方案"></a>临时方案</h4><h5 id="针对问题1"><a href="#针对问题1" class="headerlink" title="针对问题1"></a>针对问题1</h5><ul>
<li>可以在连续的 <code>{</code> <code>}</code> <code>%</code>中间插入空格，分开就没事了</li>
</ul>
<h5 id="针对问题2"><a href="#针对问题2" class="headerlink" title="针对问题2"></a>针对问题2</h5><ul>
<li>可以将<code>\\</code>换成<code>\\\\</code>，可以实现公式的多行正确显示</li>
</ul>
<h4 id="终极方案"><a href="#终极方案" class="headerlink" title="终极方案"></a>终极方案</h4><ul>
<li><p>在官方文档中提到了可以为hexo提供标记，阻止其按照自己的规则解释我们的字符串，显示其原本的含义</p>
</li>
<li><p>标记为 </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">...</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>geogebra 图形嵌入网页，Hexo文章</title>
    <url>/2020/12/19/tools/geogebra/geogebra-html-embed/geogebra-html-embed/</url>
    <content><![CDATA[<blockquote>
<p>geogebra是优秀的数学绘图工具，可以描述数学图像并演示，支持互动，功能强大。本文介绍将geogebra嵌入网页的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h3><blockquote>
<p><code>geogebra</code>的强大功能勾引着我想要在自己的博客里实现演示功能，有一些自己设定的需求：</p>
</blockquote>
<ul>
<li>可以展示我自己设计的<code>geogebra</code>图形；</li>
<li>带有滑块可以互动控制；</li>
<li>可以支持动画自动演示；</li>
<li>不要带其他编辑控件，仅能控制我设计的部分；</li>
<li>可以控制显示的图形按钮；</li>
<li>不依赖<code>geogebra</code>官网，搭建属于自己的服务；</li>
<li>可以方便地在博客/网页中插入、编辑、删除各个演示内容；</li>
<li>不依赖已经分享好的链接，仅依赖实际演示图信息；</li>
<li>速度不能太慢；</li>
<li>演示图形要居中。</li>
</ul>
<h3 id="调研报告"><a href="#调研报告" class="headerlink" title="调研报告"></a>调研报告</h3><blockquote>
<p>为满足上述需求我做了几天的调研，网上清楚明白说这个事情的信息很少，而且很杂乱，我把我获取到的信息汇总在这里。</p>
</blockquote>
<h4 id="geogebra"><a href="#geogebra" class="headerlink" title="geogebra"></a>geogebra</h4><ul>
<li><p>官方网站：<a href="https://www.geogebra.org/" target="_blank" rel="noopener">https://www.geogebra.org/</a></p>
</li>
<li><p>当前流行的版本主要是<code>geogebra 5</code> 和 <code>geogebra 6</code></p>
</li>
<li><p><code>geogebra 5</code>更加经典，可以导出动画，6不支持动画导出</p>
</li>
<li><p>二者可以导出<code>ggb文件</code>和html代码</p>
</li>
<li><p>但是使用官方html代码得到的演示图必须带编辑工具控件，删除会使图形失效</p>
</li>
</ul>
<h4 id="desmos"><a href="#desmos" class="headerlink" title="desmos"></a>desmos</h4><ul>
<li><code>desmos</code>也是类似的数学画板工具，加载很快，嵌入链接分享很方便，使用逻辑和<code>geogebra</code>几乎相同</li>
<li>有一个不得不弃用的问题是导出的演示图不带滑块，无法动态互动</li>
</ul>
<h4 id="geogebra-图形信息"><a href="#geogebra-图形信息" class="headerlink" title="geogebra 图形信息"></a>geogebra 图形信息</h4><ul>
<li>事实上绘制好的图形信息是有固定格式的</li>
<li>为了唯一确定该信息并在别处引用，我目前了解到四种方法：<ul>
<li><code>material_id</code> ： 一些在<code>geogebra</code>官网上的图形有固定的唯一ID，可以将其作为确定内容的标识</li>
<li><code>ggb文件</code>： 直接记录和保存图形信息的文件</li>
<li><code>ggbBase64代码</code>：将图形信息编码成字符串的一种信息保存方式，从信息量来看和<code>ggb文件</code>是等价的</li>
<li>分享链接：可以将编辑好的图形上传到<code>geogebra</code>官网上，官网生成唯一的链接返回来用于分享</li>
</ul>
</li>
<li>四种方式中，分享链接是最方便的，不需要对博客/网页项目进行任何修改，用<code>iframe</code>插入引用控件，直接引入来自官网的图形</li>
<li>material_id我还不知道如何获取，了解不多，而且因为这个ID不包含任何内容信息，总有一种不靠谱的感觉</li>
<li>我比较信赖的<code>geogebra</code>图形引用形式还是<code>ggb文件</code>和<code>ggbBase64代码</code>的引用方式</li>
<li>选中别人分享的图形，按下快捷键<code>ctrl + shift + B</code>可以复制该图形的<code>ggbBase64</code>代码</li>
</ul>
<h4 id="学习资料"><a href="#学习资料" class="headerlink" title="学习资料"></a>学习资料</h4><ul>
<li><code>geogebra</code>制作的教程千千万，在此不表，本文主要关注图形嵌入网页的教程</li>
<li>网页嵌入官方教程：<a href="https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters" target="_blank" rel="noopener">https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters</a></li>
</ul>
<blockquote>
<p>目前见到满足我需求最靠谱的站长，在此感谢大神分享，大家有需要也可以去他的站点学习</p>
</blockquote>
<ul>
<li><a href="https://kz16.top/" target="_blank" rel="noopener">https://kz16.top/</a></li>
</ul>
<blockquote>
<p>也是这位大佬，在B站发布的视频教程，很良心</p>
</blockquote>
<ul>
<li><a href="https://www.bilibili.com/video/av80321187/" target="_blank" rel="noopener">https://www.bilibili.com/video/av80321187/</a></li>
</ul>
<h3 id="网页嵌入方法"><a href="#网页嵌入方法" class="headerlink" title="网页嵌入方法"></a>网页嵌入方法</h3><h4 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h4><blockquote>
<p><code>iframe</code> 元素会创建包含另外一个文档的内联框架（即行内框架）。</p>
</blockquote>
<h5 id="获取geogebra图形的iframe代码"><a href="#获取geogebra图形的iframe代码" class="headerlink" title="获取geogebra图形的iframe代码"></a>获取<code>geogebra</code>图形的<code>iframe</code>代码</h5><ul>
<li>打开<code>geogebra 6</code>（网页版、客户端都可以），<a href="https://www.geogebra.org/classic" target="_blank" rel="noopener">https://www.geogebra.org/classic</a> 并编辑内容</li>
<li>分享后获得分享链接，替换<code>src</code>内容部分</li>
<li>此处以<a href="https://blog.csdn.net/fatty_zhu/article/details/77411254%E7%9A%84%E7%A4%BA%E4%BE%8Bsrc%E4%B8%BA%E4%BE%8B%EF%BC%9A" target="_blank" rel="noopener">https://blog.csdn.net/fatty_zhu/article/details/77411254的示例src为例：</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;iframe </span><br><span class="line">scrolling&#x3D;&quot;no&quot; </span><br><span class="line">title&#x3D;&quot;布丰投针实验&quot; src&#x3D;&quot;https:&#x2F;&#x2F;www.geogebra.org&#x2F;material&#x2F;iframe&#x2F;id&#x2F;A25F9Tzs&#x2F;width&#x2F;1347&#x2F;height&#x2F;598&#x2F;border&#x2F;888888&#x2F;smb&#x2F;false&#x2F;stb&#x2F;false&#x2F;stbh&#x2F;false&#x2F;ai&#x2F;false&#x2F;asb&#x2F;false&#x2F;sri&#x2F;true&#x2F;rc&#x2F;false&#x2F;ld&#x2F;false&#x2F;sdz&#x2F;true&#x2F;ctl&#x2F;false&quot; </span><br><span class="line">width&#x3D;&quot;800px&quot; </span><br><span class="line">height&#x3D;&quot;400px&quot;&gt;</span><br><span class="line">&lt;&#x2F;iframe&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>上述代码放在单独的html文件中即可运行</li>
</ul>
<h4 id="官网js解析ggb文件信息"><a href="#官网js解析ggb文件信息" class="headerlink" title="官网js解析ggb文件信息"></a>官网js解析ggb文件信息</h4><ul>
<li>将画好的图形下载成<code>ggb文件</code>格式</li>
<li>将该文件上传到网络（不允许读取本地的文件），链接必须为<code>http, data, chrome, chrome-extension, chrome-untrusted, https</code>类型之一。</li>
<li>获取文件链接，以我的链接 <a href="https://photos.zywvvd.com/images_matrixtime/20201219164932.ggb" target="_blank" rel="noopener">https://photos.zywvvd.com/images_matrixtime/20201219164932.ggb</a> 为例</li>
<li>向html文件黏贴代码：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.geogebra.org&#x2F;apps&#x2F;deployggb.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;ggbApplet&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var parameters &#x3D; &#123;</span><br><span class="line">&quot;id&quot;: &quot;ggbApplet&quot;,</span><br><span class="line">&quot;width&quot;:468,</span><br><span class="line">&quot;height&quot;:492,</span><br><span class="line">&quot;showToolBar&quot;:true,</span><br><span class="line">&quot;language&quot;:&quot;zh&quot;,</span><br><span class="line">&quot;filename&quot;:&quot;https:&#x2F;&#x2F;photos.zywvvd.com&#x2F;images_matrixtime&#x2F;20201219164932.ggb&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&#x2F;&#x2F; is3D&#x3D;is 3D applet using 3D view, AV&#x3D;Algebra View, SV&#x3D;Spreadsheet View, CV&#x3D;CAS View, EV2&#x3D;Graphics View 2, CP&#x3D;Construction Protocol, PC&#x3D;Probability Calculator DA&#x3D;Data Analysis, FI&#x3D;Function Inspector, macro&#x3D;Macros</span><br><span class="line">var views &#x3D; &#123;&#39;is3D&#39;: 0,&#39;AV&#39;: 0,&#39;SV&#39;: 0,&#39;CV&#39;: 0,&#39;EV2&#39;: 0,&#39;CP&#39;: 0,&#39;PC&#39;: 0,&#39;DA&#39;: 0,&#39;FI&#39;: 0,&#39;macro&#39;: 0&#125;;</span><br><span class="line">var applet &#x3D; new GGBApplet(parameters, &#39;5.0&#39;, views);</span><br><span class="line">window.onload &#x3D; function() &#123;applet.inject(&#39;ggbApplet&#39;)&#125;;</span><br><span class="line">applet.setPreviewImage(&#39;data:image&#x2F;gif;base64,R0lGODlhAQABAAAAADs&#x3D;&#39;,&#39;https:&#x2F;&#x2F;www.geogebra.org&#x2F;images&#x2F;GeoGebra_loading.png&#39;,&#39;https:&#x2F;&#x2F;www.geogebra.org&#x2F;images&#x2F;applet_play.png&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>



<h4 id="官网js解析ggbBase64信息"><a href="#官网js解析ggbBase64信息" class="headerlink" title="官网js解析ggbBase64信息"></a>官网js解析ggbBase64信息</h4><ul>
<li><h5 id="事实上就是按照官方教程行事-https-wiki-geogebra-org-en-Reference-GeoGebra-App-Parameters"><a href="#事实上就是按照官方教程行事-https-wiki-geogebra-org-en-Reference-GeoGebra-App-Parameters" class="headerlink" title="事实上就是按照官方教程行事 https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters"></a>事实上就是按照官方教程行事 <a href="https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters" target="_blank" rel="noopener">https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters</a></h5></li>
<li><p>获取<code>ggbBase64</code>可以在 <a href="https://geogebra.kz16.top/" target="_blank" rel="noopener">https://geogebra.kz16.top/</a> 上作图，直接得到代码</p>
</li>
<li><p>也可以将画好的图形下载成<code>网页.html</code>格式</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201219152843.png"></p>
<ul>
<li>得到如下这段代码，这段代码直接黏贴到一个空的html文件联网即可运行。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.geogebra.org&#x2F;apps&#x2F;deployggb.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;ggbApplet&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var parameters &#x3D; &#123;</span><br><span class="line">&quot;id&quot;: &quot;ggbApplet&quot;,</span><br><span class="line">&quot;width&quot;:468,</span><br><span class="line">&quot;height&quot;:492,</span><br><span class="line">&quot;showToolBar&quot;:true,</span><br><span class="line">&quot;language&quot;:&quot;zh&quot;,</span><br><span class="line">&#x2F;&#x2F; use this instead of ggbBase64 to load a material from geogebra.org</span><br><span class="line">&#x2F;&#x2F; &quot;material_id&quot;:&quot;RHYH3UQ8&quot;,</span><br><span class="line">&#x2F;&#x2F; use this instead of ggbBase64 to load a .ggb file</span><br><span class="line">&#x2F;&#x2F; &quot;filename&quot;:&quot;myfile.ggb&quot;,</span><br><span class="line">&quot;ggbBase64&quot;:&quot;UEsDBBQACAgIABxZk1EAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmk9z4jYUwM&#x2F;dT+HRqT0EJIOBZOLsZHem08xks5km0+lV2MKoEZJrycHk01eWjG0WnAZDFpLdHCI&#x2F;WX9&#x2F;7+npSeb8YzZjziNJJBXcB6gDgUN4IELKIx+kanIyAh8vPpxHRERknGBnIpIZVj7w8pJlPS11Bi7M83Ac+yBgWEoaACdmWOVVfCAmE0Y5AY6TSXrGxQ2eERnjgNwFUzLD1yLAyrQ1VSo+63bn83ln2WtHJFFXNyy7mQy7UaQ6OgWOHjqXPigeznS7K7XnPVPPhRB1&#x2F;&#x2F;5ybfs5oVwqzAM9ED2tkExwypTUj4SRGeHKUYuY+CAWlCvgMDwmzAe3ueT8OkkI+Q04RSVNC4KLD7+cy6mYO2L8Dwl0nkpSUtYzQjcvo19&#x2F;FkwkTuKD4RA4kU3GPnA9T0Nj8RT7ANrCDC9I4jxiVubgVInA1De5E8wkWZbVPX0RIbFv+kV5TmcGpyMV0fqAHQQcGRMS6lGDYo7IqGdhNF1rMRAiCaWT+eAG3wBnUaRPNjVFDJ07+lR06tVz1YKR2tjPuwXYlyEOSUx4qAutcEatOA9GhnOejG3y2phfE3L&#x2F;tSEPfkJugoy2p&#x2F;yV19m6rdgi1zNwTfq9XMWbcBRX&#x2F;E8S6THXGfd+Mt4r41UL7reiCw1b+EbJmiKWocz&#x2F;67hGzGJGsj2CtzFRAfHaCCV0t118UYcODxRbwNbQcyAWn5rS4IETKXO2Vbv5wx801PuX6U&#x2F;oGJIq3RIajmwL5F++ojSqdUZ1mecVMUl5oIxLKeB+TpPHujZ6fXgIfVRttl4BDcrYlXQzS0miXCq53C3lyrTbhXQ&#x2F;ummLVLG85yuu9NGLGIOVa5N7ICS+10195fcJ5jI&#x2F;f63aUrPmErx4TmveW9Daj6azpefijzgpNVHXWrvIqHHv7rjeoVW3hRuvg9g9iDkq893SNncyokG7pe&#x2F;C&#x2F;mZ6neERG9Gjnp6oMPxViFUo8CYCsyPzgxuiaZwoIinm&#x2F;3c2YYuotqJvl3Kpj6HVx+5j3Pr06PWMTj20Zt8I2j&#x2F;UP4UIDZB7aDU&#x2F;D3jlHHJbZlSI0YEQH23I18wzEDy&#x2F;+16eI6xUkuy&#x2F;M+exhwMbjQi3Plc6TgZNsQU0lZ9g8VUiQ0ZeIPP2CdlsU18PPKGZc2lrXNqCl65Nejbp28QrAbU7JRrVxtpv1aLkbzaHfrujzVtyJe9S6d8hUufpjCQ113CzlEvj8axz0O2lZEW1L3AFTXbSbBWS0VCb0IxqJZ1o7c1wZrSIx1KwVJG7ICGEV5&#x2F;mrBnPaaimeWin+57QLDcX26YzFQl9ElyVNJx8FVwy8xFv5Spjk&#x2F;m4z0WuK8a6m3vGPGLVary0UqUBe1dvCn17jbdJMXWGsEA46LijHhp5PThEw1NvNHghUjSqkNoXLya6bh8I7sFCtlrn7qZ1jpOguiPtwc2OB3YgGva9nnvqeuj0tK8fvP0fBX8vM6pjzTFe6RkLWCv6ard1TASprO6grVQSGr2zcAWnGWUUJ4vdbH0rwopkVcBwb4TajwiOEHDzVDT2qBralZVqX+rtZCZUU+R4pivYTij&#x2F;hIOHKBEpD9e3ob1MHR3atpqhjYVgBFeO6NNSrn0hXtv4mwAVe+0hV18wJcHDWGQre9XzPobKagVcG6H25XbDCnj5LNf3uZODm0Kbu7mtPig2BCh1BXRrP27qLn9JdfEfUEsHCHwZzHbqBAAA8SUAAFBLAwQUAAgICAAcWZNRAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZjNbts4EMfP7VMQvFciZUmJgiiF0T3sAm2Qope9MtLYZlciVZKOrbxa36HP1BGpOHI3CRojCdCiPmT4NUPy9x9RYk7fbtuGXIGxUquS8ohRAqrStVTLkq7d4s0xfXv2+nQJegmXRpCFNq1wJc2GkTs&#x2F;rEV5woY20XUlrRphrawo6RrhBpeS6sWikQooIVsrT5Q+Fy3YTlTwqVpBK97rSjgfa+VcdxLHm80mupk10mYZY2Abb20dL5cuQksJLl3Zko6FE4y7572Zeb+EMR7&#x2F;++F9mOeNVNYJVeFCcFs1LMS6cRaL0EALyhHXd4Ab0EpWM5yjEZfQlPQf5XCvUA1LJNXaXKH&#x2F;6FzSGc8YPXv96tSu9Iboy884rqTOrGHn7yvxMAa73+lGG2JKmnBKEDNnaC&#x2F;RFgnya7qVKCmLOAs&#x2F;nhaM85wnwb8RPRhyJTAoCy1i7XTlQ&#x2F;rWhWgs3IzFyT&#x2F;oGkJPOo5XsvWsiXWAYuHktgOofSlsn3nlep8E03go4CfXN0DcSlb&#x2F;KbCIP5s4DYW&#x2F;ZV3DkEvBB+QS1BUS0cai9szP0jM&#x2F;&#x2F;JqNKbflvt5z33vNQ7P3x6UauSXz4DEPA+dJMLNg0mCyHRL4osI67fC3pJ0wmG4YqBr6T+NR7P&#x2F;JLrbSzv7aqTYfqxOl2ewgpZkXmnmZ2a3IzyUpZs&#x2F;zino&#x2F;XzKWAXf97evDuP2DVAnjwEqhJo&#x2F;bu6HjR&#x2F;L5r0D+ObnfDxLjK5jwu&#x2F;D1PX54DB7Eryg8wIQXHqG3uzMqeyqMldamtmRb0nNxjgfBaK9HuwnWD12I4eU0zhbxB2CyA2Hqpl9BbbS65TlpukU6G5Ee8gQ9VgaezbwOGf8xk6N0fFFkRc7SPH0yTQ5N7UeRnZtqJVuoQeyjxdfdS6FNeHgNp0ce7WB+D7YXPZ7Est7n+nIp648KXHwRuCa&#x2F;Tc5eGGnbfar8Banm4UAOVIv8l6SqwO32eT6Up6dq9udUfQzLL2tR+y+vcasfb+pTpvzAC8r9R2OeFsPvKOfZMU8T&#x2F;lSAnuOScecVY2gM94g+mOtkF&#x2F;Cxtw4yz4M5CuY4mOLeG4lsu0ZW0j0srV2bBV6R7&#x2F;pEHrv2VU4PUxn97vxIjo5+Nu1vA7&#x2F;IZzL&#x2F;2S+7eHLDj2&#x2F;+nXD2HVBLBwgHivsrUgMAAPYQAABQSwMEFAAICAgAHFmTUQAAAAAAAAAAAAAAABYAAABnZW9nZWJyYV9qYXZhc2NyaXB0LmpzSyvNSy7JzM9TSE9P8s&#x2F;zzMss0dBUqK4FAFBLBwjWN725GQAAABcAAABQSwMEFAAICAgAHFmTUQAAAAAAAAAAAAAAAAwAAABnZW9nZWJyYS54bWzlWOtv2zYQ&#x2F;9z+FQd92iO2ST2twm6RDsM2IC2KphuGfaMk2uYiS5pIP1L0j98dKcly2mDJWhQY5kSmSB7v9TvekV68OG5L2MtWq7paenzKPJBVXheqWi+9nVlN5t6L508Xa1mvZdYKWNXtVpilFxHlsA5709hnNCaaZunlpdBa5R40pTC0ZOnVq1WpKumBKpZekuaFHyZykkRxOAmjNJykYhVOmJwH0YoxKVLuARy1elbVr8VW6kbk8jrfyK24qnNhrNSNMc2z2exwOEx7&#x2F;aZ1u56hCnp21MVsvc6m2HqARlZ66XUvz5Dv2epDYNf5jPHZ76+unJyJqrQRVY4qkwN26vnTJ4uDqor6AAdVmM3SC+O5Bxup1hv0SJj6HsyIqEG3NDI3ai81Lh11rfFm23iWTFQ0&#x2F;8S9QTnY5UGh9qqQ7dJj09BPgoidvgMP6lbJynTEvBM669kt9koeHF96syJDliYIl9IqK+XSW4lSExLVqkXfDn1tbkuZCRRr2h32TxrxC&#x2F;uHJOq9JHYItHMFzjF2QU+CTxQxp85IdsTRL6auS8uZwQfgEDF8gKdwAXGCIz7wCEIcmeNIAgGNRTyEAIiEBxCG2IY0zGOcoWn8RnHAOc6Az8D3wefgB9iNIoiQLKG1PtLGqeXH8CFq1AifgMaCAB87FoT4+PSGjCLHBvWIgti+RUSN&#x2F;COfLLCDwRzCFAXRQJRwCFAH7CcMkGNA7Lm1I2RA&#x2F;xxCYu8n4M8B+aHpxJn5jwGmG7iDTI9L9ClcYnwsYHdwCc9RQRAY2nZBDXcNqRvHboq5MRa4xndN6JrI0YRueehInbUsdDRh8Llm9kYGjzFyPjKSkxEICmlvmwBIb271pybsurHr2mhjnHWjc&#x2F;pKqYM+ief25TNtCv6VTXwk1W3UR2zkXiJP5w+X+HkhOljpE2sjsqV3efXTjy&#x2F;fXj7C5s909WB2NHJ0hAmL&#x2F;u3zkcjgUVbf7+iHS4zPtuRXN5j78y8jM5w&#x2F;WGbCPpmFXMu79usAsZj1hXPRaQR6Q7TdHjNyq0nHIIUkgNgfCllMdaarZokPSQRJPKppF1TV4uhU2Kiszc8KWzQ&#x2F;r24xDSa2VKI8KkyuzPlhX+kuulr34aNah6UpPFUnVJBYcQCspjZr9WUKtfCHQuVHVKt8zGtYI32IKU&#x2F;eU7PwTFdrNfh2I8tmQMG6UVXNzpy5Lt8W&#x2F;aupkVqU9qzW0Rd1fvNycHbHSQptxmzxeHM6Rbnjztkh68miFJnEA+b6miIBYC9K2kNWwqquDPRR4HuWnT3PLeQuL1WhRPUbQt+fnV7vtplswb7WZKRlQsvh0we&#x2F;IHUkeV23xfWtxkiB4x+yxcV+zKfp6DPHZHjbTQX+lI0+HHe&#x2F;zgUFeZieLUpx5rabitjZIhbETrbcX0tj0H4N4ih17+91q4rx+y&#x2F;6ZV0Wg2ebWlXmB9GYXWsP&#x2F;KhdS0ZdVutSWk9akPE8nN9k9fHapfHY8Xp321DpcvKz9Q91WbeAO9CPIiTo2sy1loYUG6iYpWGWosOJmA7znI7T667NXGup6BbhQHaG8t5K1ktRGlz&#x2F;LAptgNDhelcpc9V3jMpvToYSvYO&#x2F;9+A5S&#x2F;6FWC5mdyJvcSPbSpYuiirEcVfvtAtiB5XVY6flG2E2l1XxVq5xB74RlAQNsnakJ40LmastLnTjnecEoforqupGC7luZW+h25LOr93eAd20UhR6I6UZvOtifExmzenVX2B5L6VN71uFGWKC4G3F0R4hcF803XZa6LxVDYUrZJiqb+QpJAuliUUxMpxcotG2nLIOuteQazF9iJ3Z1K29LwmDQ&#x2F;ZWdajbG6vyO3k0ILJ6jzPFCmNIloTcem1ZylJu8RIFxgZxtdvKlu6rHaLCskIDd52ZfRJAMKHO&#x2F;sS8cycGTq7H6XuCHETZbARd6viw51PGecz70Ba3lHhGqctyf1UXd9Qo6XbYeTjqPIytyHRd7gxelBHY6nRRdpp2ucuewo505sSsQgnFg5U6jhBAn6r3GIRDRNkYvnQRMrb0tBPNBmMer5+0HamiW6d2Lz+ropDVoLuoMDAtkJi+pdtTA32DHrCJ6IT9rEPqHzHL&#x2F;j+Ypf8hzI6YRDT9StR7HbciDi69W1jCNwK+g+O38D1kPUf3I9HHW9SNDzwegCzIPd1yHwrwA+HszxTk&#x2F;rtZ1yZHTUBNuAUKv9&#x2F;bzv2+j+51PdSNyJUhNsm8q&#x2F;J&#x2F;VY6BdvUFHVkqpLnr9dk4Y9rjTvf72PO&#x2F;AVBLBwi8SnA4iQYAAPETAABQSwECFAAUAAgICAAcWZNRfBnMduoEAADxJQAAFwAAAAAAAAAAAAAAAAAAAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWxQSwECFAAUAAgICAAcWZNRB4r7K1IDAAD2EAAAFwAAAAAAAAAAAAAAAAAvBQAAZ2VvZ2VicmFfZGVmYXVsdHMzZC54bWxQSwECFAAUAAgICAAcWZNR1je9uRkAAAAXAAAAFgAAAAAAAAAAAAAAAADGCAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc1BLAQIUABQACAgIABxZk1G8SnA4iQYAAPETAAAMAAAAAAAAAAAAAAAAACMJAABnZW9nZWJyYS54bWxQSwUGAAAAAAQABAAIAQAA5g8AAAAA&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&#x2F;&#x2F; is3D&#x3D;is 3D applet using 3D view, AV&#x3D;Algebra View, SV&#x3D;Spreadsheet View, CV&#x3D;CAS View, EV2&#x3D;Graphics View 2, CP&#x3D;Construction Protocol, PC&#x3D;Probability Calculator DA&#x3D;Data Analysis, FI&#x3D;Function Inspector, macro&#x3D;Macros</span><br><span class="line">var views &#x3D; &#123;&#39;is3D&#39;: 0,&#39;AV&#39;: 0,&#39;SV&#39;: 0,&#39;CV&#39;: 0,&#39;EV2&#39;: 0,&#39;CP&#39;: 0,&#39;PC&#39;: 0,&#39;DA&#39;: 0,&#39;FI&#39;: 0,&#39;macro&#39;: 0&#125;;</span><br><span class="line">var applet &#x3D; new GGBApplet(parameters, &#39;5.0&#39;, views);</span><br><span class="line">window.onload &#x3D; function() &#123;applet.inject(&#39;ggbApplet&#39;)&#125;;</span><br><span class="line">applet.setPreviewImage(&#39;data:image&#x2F;gif;base64,R0lGODlhAQABAAAAADs&#x3D;&#39;,&#39;https:&#x2F;&#x2F;www.geogebra.org&#x2F;images&#x2F;GeoGebra_loading.png&#39;,&#39;https:&#x2F;&#x2F;www.geogebra.org&#x2F;images&#x2F;applet_play.png&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="本地js解析ggbBase64信息"><a href="#本地js解析ggbBase64信息" class="headerlink" title="本地js解析ggbBase64信息"></a>本地js解析ggbBase64信息</h4><ul>
<li>继续按照官方教程行事 <a href="https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters" target="_blank" rel="noopener">https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters</a></li>
<li>主要在<code>Offline and Self-Hosted Solution</code>这一部分</li>
<li>需要自己<a href="https://download.geogebra.org/package/geogebra-math-apps-bundle" target="_blank" rel="noopener">下载相关的js文件</a>（<code>deployggb.js</code>和<code>5.0/web3d/</code>）</li>
<li>配置<code>deployggb.js</code>和<code>5.0/web3d/</code>的位置</li>
<li>我将<code>deployggb.js</code>放在了<code>/js/deployggb.js</code>下；<code>web3d</code>放在了<code>/js/5.0/web3d/</code>位置</li>
<li>代数区输入公式 $y=ax+b$创建图形</li>
<li>为了让图形居中显示，在调用的div模块上加入style设置<code>style=&#39;margin:0 auto&#39;</code>：</li>
<li>综上，在html贴上如下代码：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;&#x2F;js&#x2F;deployggb.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var parameters &#x3D; &#123;</span><br><span class="line">&quot;id&quot;: &quot;ggbApplet&quot;,</span><br><span class="line">&quot;width&quot;:500,</span><br><span class="line">&quot;height&quot;:500,</span><br><span class="line">&quot;showResetIcon&quot;:true,</span><br><span class="line">&quot;borderColor&quot;:&quot;white&quot;,</span><br><span class="line">&quot;language&quot;:&quot;en&quot;,</span><br><span class="line">&quot;ggbBase64&quot;:&quot;UEsDBBQACAgIAA1ak1EAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmk9z4jYUwM&#x2F;dT+HRqT0EJIOBZOLsZHem08xks5km0+lV2MKoEZJrycHk01eWjG0WnAZDFpLdHCI&#x2F;WX9&#x2F;7+npSeb8YzZjziNJJBXcB6gDgUN4IELKIx+kanIyAh8vPpxHRERknGBnIpIZVj7w8pJlPS11Bi7M83Ac+yBgWEoaACdmWOVVfCAmE0Y5AY6TSXrGxQ2eERnjgNwFUzLD1yLAyrQ1VSo+63bn83ln2WtHJFFXNyy7mQy7UaQ6OgWOHjqXPigeznS7K7XnPVPPhRB1&#x2F;&#x2F;5ybfs5oVwqzAM9ED2tkExwypTUj4SRGeHKUYuY+CAWlCvgMDwmzAe3ueT8OkkI+Q04RSVNC4KLD7+cy6mYO2L8Dwl0nkpSUtYzQjcvo19&#x2F;FkwkTuKD4RA4kU3GPnA9T0Nj8RT7ANrCDC9I4jxiVubgVInA1De5E8wkWZbVPX0RIbFv+kV5TmcGpyMV0fqAHQQcGRMS6lGDYo7IqGdhNF1rMRAiCaWT+eAG3wBnUaRPNjVFDJ07+lR06tVz1YKR2tjPuwXYlyEOSUx4qAutcEatOA9GhnOejG3y2phfE3L&#x2F;tSEPfkJugoy2p&#x2F;yV19m6rdgi1zNwTfq9XMWbcBRX&#x2F;E8S6THXGfd+Mt4r41UL7reiCw1b+EbJmiKWocz&#x2F;67hGzGJGsj2CtzFRAfHaCCV0t118UYcODxRbwNbQcyAWn5rS4IETKXO2Vbv5wx801PuX6U&#x2F;oGJIq3RIajmwL5F++ojSqdUZ1mecVMUl5oIxLKeB+TpPHujZ6fXgIfVRttl4BDcrYlXQzS0miXCq53C3lyrTbhXQ&#x2F;ummLVLG85yuu9NGLGIOVa5N7ICS+10195fcJ5jI&#x2F;f63aUrPmErx4TmveW9Daj6azpefijzgpNVHXWrvIqHHv7rjeoVW3hRuvg9g9iDkq893SNncyokG7pe&#x2F;C&#x2F;mZ6neERG9Gjnp6oMPxViFUo8CYCsyPzgxuiaZwoIinm&#x2F;3c2YYuotqJvl3Kpj6HVx+5j3Pr06PWMTj20Zt8I2j&#x2F;UP4UIDZB7aDU&#x2F;D3jlHHJbZlSI0YEQH23I18wzEDy&#x2F;+16eI6xUkuy&#x2F;M+exhwMbjQi3Plc6TgZNsQU0lZ9g8VUiQ0ZeIPP2CdlsU18PPKGZc2lrXNqCl65Nejbp28QrAbU7JRrVxtpv1aLkbzaHfrujzVtyJe9S6d8hUufpjCQ113CzlEvj8axz0O2lZEW1L3AFTXbSbBWS0VCb0IxqJZ1o7c1wZrSIx1KwVJG7ICGEV5&#x2F;mrBnPaaimeWin+57QLDcX26YzFQl9ElyVNJx8FVwy8xFv5Spjk&#x2F;m4z0WuK8a6m3vGPGLVary0UqUBe1dvCn17jbdJMXWGsEA46LijHhp5PThEw1NvNHghUjSqkNoXLya6bh8I7sFCtlrn7qZ1jpOguiPtwc2OB3YgGva9nnvqeuj0tK8fvP0fBX8vM6pjzTFe6RkLWCv6ard1TASprO6grVQSGr2zcAWnGWUUJ4vdbH0rwopkVcBwb4TajwiOEHDzVDT2qBralZVqX+rtZCZUU+R4pivYTij&#x2F;hIOHKBEpD9e3ob1MHR3atpqhjYVgBFeO6NNSrn0hXtv4mwAVe+0hV18wJcHDWGQre9XzPobKagVcG6H25XbDCnj5LNf3uZODm0Kbu7mtPig2BCh1BXRrP27qLn9JdfEfUEsHCHwZzHbqBAAA8SUAAFBLAwQUAAgICAANWpNRAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZjNbts4EMfP7VMQvFciZUmJgiiF0T3sAm2Qope9MtLYZlciVZKOrbxa36HP1BGpOHI3CRojCdCiPmT4NUPy9x9RYk7fbtuGXIGxUquS8ohRAqrStVTLkq7d4s0xfXv2+nQJegmXRpCFNq1wJc2GkTs&#x2F;rEV5woY20XUlrRphrawo6RrhBpeS6sWikQooIVsrT5Q+Fy3YTlTwqVpBK97rSjgfa+VcdxLHm80mupk10mYZY2Abb20dL5cuQksJLl3Zko6FE4y7572Zeb+EMR7&#x2F;++F9mOeNVNYJVeFCcFs1LMS6cRaL0EALyhHXd4Ab0EpWM5yjEZfQlPQf5XCvUA1LJNXaXKH&#x2F;6FzSGc8YPXv96tSu9Iboy884rqTOrGHn7yvxMAa73+lGG2JKmnBKEDNnaC&#x2F;RFgnya7qVKCmLOAs&#x2F;nhaM85wnwb8RPRhyJTAoCy1i7XTlQ&#x2F;rWhWgs3IzFyT&#x2F;oGkJPOo5XsvWsiXWAYuHktgOofSlsn3nlep8E03go4CfXN0DcSlb&#x2F;KbCIP5s4DYW&#x2F;ZV3DkEvBB+QS1BUS0cai9szP0jM&#x2F;&#x2F;JqNKbflvt5z33vNQ7P3x6UauSXz4DEPA+dJMLNg0mCyHRL4osI67fC3pJ0wmG4YqBr6T+NR7P&#x2F;JLrbSzv7aqTYfqxOl2ewgpZkXmnmZ2a3IzyUpZs&#x2F;zino&#x2F;XzKWAXf97evDuP2DVAnjwEqhJo&#x2F;bu6HjR&#x2F;L5r0D+ObnfDxLjK5jwu&#x2F;D1PX54DB7Eryg8wIQXHqG3uzMqeyqMldamtmRb0nNxjgfBaK9HuwnWD12I4eU0zhbxB2CyA2Hqpl9BbbS65TlpukU6G5Ee8gQ9VgaezbwOGf8xk6N0fFFkRc7SPH0yTQ5N7UeRnZtqJVuoQeyjxdfdS6FNeHgNp0ce7WB+D7YXPZ7Est7n+nIp648KXHwRuCa&#x2F;Tc5eGGnbfar8Banm4UAOVIv8l6SqwO32eT6Up6dq9udUfQzLL2tR+y+vcasfb+pTpvzAC8r9R2OeFsPvKOfZMU8T&#x2F;lSAnuOScecVY2gM94g+mOtkF&#x2F;Cxtw4yz4M5CuY4mOLeG4lsu0ZW0j0srV2bBV6R7&#x2F;pEHrv2VU4PUxn97vxIjo5+Nu1vA7&#x2F;IZzL&#x2F;2S+7eHLDj2&#x2F;+nXD2HVBLBwgHivsrUgMAAPYQAABQSwMEFAAICAgADVqTUQAAAAAAAAAAAAAAABYAAABnZW9nZWJyYV9qYXZhc2NyaXB0LmpzSyvNSy7JzM9TSE9P8s&#x2F;zzMss0dBUqK4FAFBLBwjWN725GQAAABcAAABQSwMEFAAICAgADVqTUQAAAAAAAAAAAAAAAAwAAABnZW9nZWJyYS54bWzdGNtu2zb0uf2KAz3tktikrlZht0iHYRuQFkXTDcPeKIm2uciSJtKXFP34nUNKspwmWLIUBTYnMkXy8Nxv9PzVYVPCTrZa1dXC4xPmgazyulDVauFtzfJ85r16+Xy+kvVKZq2AZd1uhFl4EUEO53A2iX1Ga6JpFl5eCq1V7kFTCkNHFl69XJaqkh6oYuElaV74YSLPkygOz8MoDc9TsQzPmZwF0ZIxKVLuARy0elHVb8VG6kbk8ipfy424rHNhLNW1Mc2L6XS&#x2F;3096&#x2F;iZ1u5oiC3p60MV0tcomOHqAQlZ64XUvLxDvyel9YM&#x2F;5jPHp728uHZ1zVWkjqhxZJgVs1cvnz+Z7VRX1HvaqMOuFF8YzD9ZSrdaokTD1PZgSUINqaWRu1E5qPDqaWuHNpvEsmKho&#x2F;5l7g3KQy4NC7VQh24XHJqGfBBE7fgce1K2SlemAeUd02qOb75TcO7z0ZkmGLE3QXEqrrJQLbylKTZaoli3qdphrc1PKTCBZ025xfuSIn9k&#x2F;BFEfJaFDQztV4B5jZ&#x2F;Qk+EQRc+yMaEcc9WLqurSYGXwCDhHDB3gKZxAnuOIDjyDElRmuJBDQWsRDCIBAeABhiGNIyzzGHdrGbyQHnOMO+Ax8H3wOfoDTKIIIwRI66yNsnFp8DB+CRo7wCWgtCPCxa0GIj09viChyaJCPKIjtW0TQiD&#x2F;ySQK7GMwgTJEQLUQJhwB5wHnCADEGhJ5bOUIG9M8hJPR+Av4MEB+KTpiZ&#x2F;xjDdAu3LNPbJbrLLjE+1mC37BKeWgWNwFC2Mxq4G4jdOHZbzK2xwA2+G0I3RA4mdMdDB+qkZaGDCYOnitkLGTxGyNlISE5CoFGIezsEQHxzyz8NYTeN3dR6G+OsW53RV0oT1Ek8sy9PlCn4VzLxEVUXqI8I5J4iT2cPp&#x2F;g0Fx2k9Am1EdnCu7j86cfX7y8eIfMTVT2IHY0UHWHCon&#x2F;7fEYyeJTU9yv64RTjk5D86gJzf&#x2F;ZlaIazB9NM2J1ZyI28G7+OIebTvnDOO45Arwm2izEjN5p4DFJIAoj9oZDFVGe6apb4kESQxKOadkZVLY6OhY3K2uyksEWz0+oW02JiSyXSo8Lkypwf9pXurKt1nz6rdViawmN1QgYJFQfAamqzVl+mkAt&#x2F;KFR+RLXKx7yGNdKHmPLkPTULe7paq0G3a1k2gxWsGlXVbM2J6vJN0b+aGqFFaXu1Dr6o8+vXg7I7TFJoM0aL7c2xi3LtzkmT9Wxeikxig7m6Ik8A2ImSYshSWNaVgd4LfM+is&#x2F;3cXG7zUhVKVL+h6fve6e12k8kW7GtNQlokdBzubvyC1IHkdd0WVzcaPQUOf8gWD&#x2F;sxn6SjzwyT4U23FfgTNvpwjH6dC3LyMD05lOLOTbcVsZNDLIgdbbm7ksag&#x2F;BrEQepe36tWFeP3X&#x2F;TruiwGzTa1qswPojHb1jb8yF1LQl1Uq1JaTVojYz+cX2f14cql8djh+nDTUOly9LPVD3VZt4AR6EcRAnRj5kYLQ4wNUMzCMAvR2YmQDvuc2ulVN2ZutFB0i3BGdoLyXkrWU1Ea3PzEC62DUHO9rZS57CdG5ddHQQnemb&#x2F;X4ClK&#x2F;oVQzqe3PG9+LdtKls6LKrTjtt5q58TOVJaPrZbvhFlfVMV7ucIIfCcoCRpE7UCPHBcyVxs86NY7zQmy6q&#x2F;Iqlst5KqVvYQuJJ1eu9gB3bRSFHotpRm063x8DOaiw4gWvQZpUmY45WY+7YWbY&#x2F;EvpU3+G4X54xxNuxEH22Bg1DRdsM113qqGnBkyTOTX8uiwhdKEohiphRSmkVZuKRtlSPGYXMTWrOvW3qaEwSV759rX7bUV6IM8GBBZvcOdYokeJkuy62plUcpSbvCKBca6eLXdyJZus529hUWFMm47JZzzSdDFAZkb6uxPzEy3vORoHNy+JwxAlM1a0LWPD1khZZzHvHd+cUOpaaR5i&#x2F;1NXXSs9NmqpPtjp+Wo0zKOItN1uTV4lUbTV8ertOO0y262TztQV4p5h1KOB0t1GFkB9ao+opsOVrZefuF8aCzpMVbNGqMCL6gUsFTzrWK7l59VUchq4F0MboQJXrqoG+Ab1IBNVaNQcsb6R7Nlt82Gl+v&#x2F;r9XS&#x2F;47VDphnNP2Q1Csd4xEXF94NLOAbAd&#x2F;B4Vv4HrIeofsd6fM4desDjgcYFuSOLsIPte8Drdm3HaT924nZ5k9NdrI5gyyFivqI9j564536j+5VP9SNyJUhTMms6wb+qhwC7eoQarNUCHNb9dNx7rRtUfc72su&#x2F;AVBLBwhclqmpmwYAABkUAABQSwECFAAUAAgICAANWpNRfBnMduoEAADxJQAAFwAAAAAAAAAAAAAAAAAAAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWxQSwECFAAUAAgICAANWpNRB4r7K1IDAAD2EAAAFwAAAAAAAAAAAAAAAAAvBQAAZ2VvZ2VicmFfZGVmYXVsdHMzZC54bWxQSwECFAAUAAgICAANWpNR1je9uRkAAAAXAAAAFgAAAAAAAAAAAAAAAADGCAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc1BLAQIUABQACAgIAA1ak1FclqmpmwYAABkUAAAMAAAAAAAAAAAAAAAAACMJAABnZW9nZWJyYS54bWxQSwUGAAAAAAQABAAIAQAA+A8AAAAA&quot;&#125;;</span><br><span class="line">var applet &#x3D; new GGBApplet(parameters, &#39;5.0&#39;);</span><br><span class="line">applet.setHTML5Codebase(&#39;&#x2F;js&#x2F;5.0&#x2F;web3d&#x2F;&#39;);</span><br><span class="line">window.onload &#x3D; function() &#123;applet.inject(&#39;ggbApplet&#39;)&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;ggbApplet&quot; style&#x3D;&#39;margin:0 auto&#39;&gt;&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>



<script src="/js/deployggb.js"></script>
<script>
var parameters = {
"id": "ggbApplet",
"width":500,
"height":500,
"showResetIcon":true,
"borderColor":"white",
"language":"en",
"ggbBase64":"UEsDBBQACAgIAA1ak1EAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmk9z4jYUwM/dT+HRqT0EJIOBZOLsZHem08xks5km0+lV2MKoEZJrycHk01eWjG0WnAZDFpLdHCI/WX9/7+npSeb8YzZjziNJJBXcB6gDgUN4IELKIx+kanIyAh8vPpxHRERknGBnIpIZVj7w8pJlPS11Bi7M83Ac+yBgWEoaACdmWOVVfCAmE0Y5AY6TSXrGxQ2eERnjgNwFUzLD1yLAyrQ1VSo+63bn83ln2WtHJFFXNyy7mQy7UaQ6OgWOHjqXPigeznS7K7XnPVPPhRB1//5ybfs5oVwqzAM9ED2tkExwypTUj4SRGeHKUYuY+CAWlCvgMDwmzAe3ueT8OkkI+Q04RSVNC4KLD7+cy6mYO2L8Dwl0nkpSUtYzQjcvo19/FkwkTuKD4RA4kU3GPnA9T0Nj8RT7ANrCDC9I4jxiVubgVInA1De5E8wkWZbVPX0RIbFv+kV5TmcGpyMV0fqAHQQcGRMS6lGDYo7IqGdhNF1rMRAiCaWT+eAG3wBnUaRPNjVFDJ07+lR06tVz1YKR2tjPuwXYlyEOSUx4qAutcEatOA9GhnOejG3y2phfE3L/tSEPfkJugoy2p/yV19m6rdgi1zNwTfq9XMWbcBRX/E8S6THXGfd+Mt4r41UL7reiCw1b+EbJmiKWocz/67hGzGJGsj2CtzFRAfHaCCV0t118UYcODxRbwNbQcyAWn5rS4IETKXO2Vbv5wx801PuX6U/oGJIq3RIajmwL5F++ojSqdUZ1mecVMUl5oIxLKeB+TpPHujZ6fXgIfVRttl4BDcrYlXQzS0miXCq53C3lyrTbhXQ/ummLVLG85yuu9NGLGIOVa5N7ICS+10195fcJ5jI/f63aUrPmErx4TmveW9Daj6azpefijzgpNVHXWrvIqHHv7rjeoVW3hRuvg9g9iDkq893SNncyokG7pe/C/mZ6neERG9Gjnp6oMPxViFUo8CYCsyPzgxuiaZwoIinm/3c2YYuotqJvl3Kpj6HVx+5j3Pr06PWMTj20Zt8I2j/UP4UIDZB7aDU/D3jlHHJbZlSI0YEQH23I18wzEDy/+16eI6xUkuy/M+exhwMbjQi3Plc6TgZNsQU0lZ9g8VUiQ0ZeIPP2CdlsU18PPKGZc2lrXNqCl65Nejbp28QrAbU7JRrVxtpv1aLkbzaHfrujzVtyJe9S6d8hUufpjCQ113CzlEvj8axz0O2lZEW1L3AFTXbSbBWS0VCb0IxqJZ1o7c1wZrSIx1KwVJG7ICGEV5/mrBnPaaimeWin+57QLDcX26YzFQl9ElyVNJx8FVwy8xFv5Spjk/m4z0WuK8a6m3vGPGLVary0UqUBe1dvCn17jbdJMXWGsEA46LijHhp5PThEw1NvNHghUjSqkNoXLya6bh8I7sFCtlrn7qZ1jpOguiPtwc2OB3YgGva9nnvqeuj0tK8fvP0fBX8vM6pjzTFe6RkLWCv6ard1TASprO6grVQSGr2zcAWnGWUUJ4vdbH0rwopkVcBwb4TajwiOEHDzVDT2qBralZVqX+rtZCZUU+R4pivYTij/hIOHKBEpD9e3ob1MHR3atpqhjYVgBFeO6NNSrn0hXtv4mwAVe+0hV18wJcHDWGQre9XzPobKagVcG6H25XbDCnj5LNf3uZODm0Kbu7mtPig2BCh1BXRrP27qLn9JdfEfUEsHCHwZzHbqBAAA8SUAAFBLAwQUAAgICAANWpNRAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZjNbts4EMfP7VMQvFciZUmJgiiF0T3sAm2Qope9MtLYZlciVZKOrbxa36HP1BGpOHI3CRojCdCiPmT4NUPy9x9RYk7fbtuGXIGxUquS8ohRAqrStVTLkq7d4s0xfXv2+nQJegmXRpCFNq1wJc2GkTs/rEV5woY20XUlrRphrawo6RrhBpeS6sWikQooIVsrT5Q+Fy3YTlTwqVpBK97rSjgfa+VcdxLHm80mupk10mYZY2Abb20dL5cuQksJLl3Zko6FE4y7572Zeb+EMR7/++F9mOeNVNYJVeFCcFs1LMS6cRaL0EALyhHXd4Ab0EpWM5yjEZfQlPQf5XCvUA1LJNXaXKH/6FzSGc8YPXv96tSu9Iboy884rqTOrGHn7yvxMAa73+lGG2JKmnBKEDNnaC/RFgnya7qVKCmLOAs/nhaM85wnwb8RPRhyJTAoCy1i7XTlQ/rWhWgs3IzFyT/oGkJPOo5XsvWsiXWAYuHktgOofSlsn3nlep8E03go4CfXN0DcSlb/KbCIP5s4DYW/ZV3DkEvBB+QS1BUS0cai9szP0jM//JqNKbflvt5z33vNQ7P3x6UauSXz4DEPA+dJMLNg0mCyHRL4osI67fC3pJ0wmG4YqBr6T+NR7P/JLrbSzv7aqTYfqxOl2ewgpZkXmnmZ2a3IzyUpZs/zino/XzKWAXf97evDuP2DVAnjwEqhJo/bu6HjR/L5r0D+ObnfDxLjK5jwu/D1PX54DB7Eryg8wIQXHqG3uzMqeyqMldamtmRb0nNxjgfBaK9HuwnWD12I4eU0zhbxB2CyA2Hqpl9BbbS65TlpukU6G5Ee8gQ9VgaezbwOGf8xk6N0fFFkRc7SPH0yTQ5N7UeRnZtqJVuoQeyjxdfdS6FNeHgNp0ce7WB+D7YXPZ7Est7n+nIp648KXHwRuCa/Tc5eGGnbfar8Banm4UAOVIv8l6SqwO32eT6Up6dq9udUfQzLL2tR+y+vcasfb+pTpvzAC8r9R2OeFsPvKOfZMU8T/lSAnuOScecVY2gM94g+mOtkF/Cxtw4yz4M5CuY4mOLeG4lsu0ZW0j0srV2bBV6R7/pEHrv2VU4PUxn97vxIjo5+Nu1vA7/IZzL/2S+7eHLDj2/+nXD2HVBLBwgHivsrUgMAAPYQAABQSwMEFAAICAgADVqTUQAAAAAAAAAAAAAAABYAAABnZW9nZWJyYV9qYXZhc2NyaXB0LmpzSyvNSy7JzM9TSE9P8s/zzMss0dBUqK4FAFBLBwjWN725GQAAABcAAABQSwMEFAAICAgADVqTUQAAAAAAAAAAAAAAAAwAAABnZW9nZWJyYS54bWzdGNtu2zb0uf2KAz3tktikrlZht0iHYRuQFkXTDcPeKIm2uciSJtKXFP34nUNKspwmWLIUBTYnMkXy8Nxv9PzVYVPCTrZa1dXC4xPmgazyulDVauFtzfJ85r16+Xy+kvVKZq2AZd1uhFl4EUEO53A2iX1Ga6JpFl5eCq1V7kFTCkNHFl69XJaqkh6oYuElaV74YSLPkygOz8MoDc9TsQzPmZwF0ZIxKVLuARy0elHVb8VG6kbk8ipfy424rHNhLNW1Mc2L6XS/3096/iZ1u5oiC3p60MV0tcomOHqAQlZ64XUvLxDvyel9YM/5jPHp728uHZ1zVWkjqhxZJgVs1cvnz+Z7VRX1HvaqMOuFF8YzD9ZSrdaokTD1PZgSUINqaWRu1E5qPDqaWuHNpvEsmKho/5l7g3KQy4NC7VQh24XHJqGfBBE7fgce1K2SlemAeUd02qOb75TcO7z0ZkmGLE3QXEqrrJQLbylKTZaoli3qdphrc1PKTCBZ025xfuSIn9k/BFEfJaFDQztV4B5jZ/Qk+EQRc+yMaEcc9WLqurSYGXwCDhHDB3gKZxAnuOIDjyDElRmuJBDQWsRDCIBAeABhiGNIyzzGHdrGbyQHnOMO+Ax8H3wOfoDTKIIIwRI66yNsnFp8DB+CRo7wCWgtCPCxa0GIj09viChyaJCPKIjtW0TQiD/ySQK7GMwgTJEQLUQJhwB5wHnCADEGhJ5bOUIG9M8hJPR+Av4MEB+KTpiZ/xjDdAu3LNPbJbrLLjE+1mC37BKeWgWNwFC2Mxq4G4jdOHZbzK2xwA2+G0I3RA4mdMdDB+qkZaGDCYOnitkLGTxGyNlISE5CoFGIezsEQHxzyz8NYTeN3dR6G+OsW53RV0oT1Ek8sy9PlCn4VzLxEVUXqI8I5J4iT2cPp/g0Fx2k9Am1EdnCu7j86cfX7y8eIfMTVT2IHY0UHWHCon/7fEYyeJTU9yv64RTjk5D86gJzf/ZlaIazB9NM2J1ZyI28G7+OIebTvnDOO45Arwm2izEjN5p4DFJIAoj9oZDFVGe6apb4kESQxKOadkZVLY6OhY3K2uyksEWz0+oW02JiSyXSo8Lkypwf9pXurKt1nz6rdViawmN1QgYJFQfAamqzVl+mkAt/KFR+RLXKx7yGNdKHmPLkPTULe7paq0G3a1k2gxWsGlXVbM2J6vJN0b+aGqFFaXu1Dr6o8+vXg7I7TFJoM0aL7c2xi3LtzkmT9Wxeikxig7m6Ik8A2ImSYshSWNaVgd4LfM+is/3cXG7zUhVKVL+h6fve6e12k8kW7GtNQlokdBzubvyC1IHkdd0WVzcaPQUOf8gWD/sxn6SjzwyT4U23FfgTNvpwjH6dC3LyMD05lOLOTbcVsZNDLIgdbbm7ksag/BrEQepe36tWFeP3X/TruiwGzTa1qswPojHb1jb8yF1LQl1Uq1JaTVojYz+cX2f14cql8djh+nDTUOly9LPVD3VZt4AR6EcRAnRj5kYLQ4wNUMzCMAvR2YmQDvuc2ulVN2ZutFB0i3BGdoLyXkrWU1Ea3PzEC62DUHO9rZS57CdG5ddHQQnemb/X4ClK/oVQzqe3PG9+LdtKls6LKrTjtt5q58TOVJaPrZbvhFlfVMV7ucIIfCcoCRpE7UCPHBcyVxs86NY7zQmy6q/Iqlst5KqVvYQuJJ1eu9gB3bRSFHotpRm063x8DOaiw4gWvQZpUmY45WY+7YWbY/EvpU3+G4X54xxNuxEH22Bg1DRdsM113qqGnBkyTOTX8uiwhdKEohiphRSmkVZuKRtlSPGYXMTWrOvW3qaEwSV759rX7bUV6IM8GBBZvcOdYokeJkuy62plUcpSbvCKBca6eLXdyJZus529hUWFMm47JZzzSdDFAZkb6uxPzEy3vORoHNy+JwxAlM1a0LWPD1khZZzHvHd+cUOpaaR5i/1NXXSs9NmqpPtjp+Wo0zKOItN1uTV4lUbTV8ertOO0y262TztQV4p5h1KOB0t1GFkB9ao+opsOVrZefuF8aCzpMVbNGqMCL6gUsFTzrWK7l59VUchq4F0MboQJXrqoG+Ab1IBNVaNQcsb6R7Nlt82Gl+v/r9XS/47VDphnNP2Q1Csd4xEXF94NLOAbAd/B4Vv4HrIeofsd6fM4desDjgcYFuSOLsIPte8Drdm3HaT924nZ5k9NdrI5gyyFivqI9j564536j+5VP9SNyJUhTMms6wb+qhwC7eoQarNUCHNb9dNx7rRtUfc72su/AVBLBwhclqmpmwYAABkUAABQSwECFAAUAAgICAANWpNRfBnMduoEAADxJQAAFwAAAAAAAAAAAAAAAAAAAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWxQSwECFAAUAAgICAANWpNRB4r7K1IDAAD2EAAAFwAAAAAAAAAAAAAAAAAvBQAAZ2VvZ2VicmFfZGVmYXVsdHMzZC54bWxQSwECFAAUAAgICAANWpNR1je9uRkAAAAXAAAAFgAAAAAAAAAAAAAAAADGCAAAZ2VvZ2VicmFfamF2YXNjcmlwdC5qc1BLAQIUABQACAgIAA1ak1FclqmpmwYAABkUAAAMAAAAAAAAAAAAAAAAACMJAABnZW9nZWJyYS54bWxQSwUGAAAAAAQABAAIAQAA+A8AAAAA"};
var applet = new GGBApplet(parameters, '5.0');
applet.setHTML5Codebase('/js/5.0/web3d/');
window.onload = function() {applet.inject('ggbApplet')};
</script>
<div id="ggbApplet" style='margin:0 auto'></div>

<h4 id="本地js解析ggb文件信息"><a href="#本地js解析ggb文件信息" class="headerlink" title="本地js解析ggb文件信息"></a>本地js解析ggb文件信息</h4><ul>
<li>与官网解析ggb文件一样，首先获取<code>ggb文件</code>，将文件上传，获取链接</li>
<li>将上文的<code>ggbBase64</code>替换为<code>filename</code>，附上链接，向网页黏贴代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;deployggb.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var parameters &#x3D; &#123;</span><br><span class="line">&quot;id&quot;: &quot;ggbApplet&quot;,</span><br><span class="line">&quot;width&quot;:500,</span><br><span class="line">&quot;height&quot;:500,</span><br><span class="line">&quot;borderColor&quot;:&quot;white&quot;,</span><br><span class="line">&quot;language&quot;:&quot;en&quot;,</span><br><span class="line">&quot;filename&quot;:&quot;https:&#x2F;&#x2F;photos.zywvvd.com&#x2F;images_matrixtime&#x2F;20201219164932.ggb&quot;&#125;;</span><br><span class="line">var applet &#x3D; new GGBApplet(parameters, &#39;5.0&#39;);</span><br><span class="line">applet.setHTML5Codebase(&#39;5.0&#x2F;web3d&#x2F;&#39;);</span><br><span class="line">window.onload &#x3D; function() &#123;applet.inject(&#39;ggbApplet&#39;)&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;ggbApplet&quot;&gt;&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="js解析ggb信息过程中的参数设置"><a href="#js解析ggb信息过程中的参数设置" class="headerlink" title="js解析ggb信息过程中的参数设置"></a>js解析ggb信息过程中的参数设置</h4><ul>
<li>参考：<a href="https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters" target="_blank" rel="noopener">https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters</a></li>
<li>可以根据个人需求设置各项参数</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody><tr>
<td>appName</td>
<td>eg <code>&quot;graphing&quot;</code></td>
<td>app name, default: “classic””graphing” … GeoGebra Graphing Calculator “geometry” … GeoGebra Geometry “3d” … GeoGebra 3D Graphing Calculator “classic” … GeoGebra Classic “suite” … GeoGebra Calculator Suite “evaluator” … Equation Editor</td>
<td>6.0</td>
</tr>
<tr>
<td>width</td>
<td>eg <code>800</code></td>
<td>Applet width (<strong>compulsory field</strong>)</td>
<td></td>
</tr>
<tr>
<td>height</td>
<td>eg <code>600</code></td>
<td>Applet height (<strong>compulsory field</strong>)</td>
<td></td>
</tr>
<tr>
<td>material_id</td>
<td>eg <code>&quot;RHYH3UQ8&quot;</code></td>
<td>GeoGebra Materials id to load See first applet here: <a href="https://dev.geogebra.org/examples/html/example-multiple.html" target="_blank" rel="noopener">https://dev.geogebra.org/examples/html/example-multiple.html</a></td>
<td>5.0</td>
</tr>
<tr>
<td>filename</td>
<td>eg <code>&quot;myFile.ggb&quot;</code></td>
<td>URL of file to load See second applet here: <a href="https://dev.geogebra.org/examples/html/example-multiple.html" target="_blank" rel="noopener">https://dev.geogebra.org/examples/html/example-multiple.html</a></td>
<td>4.0</td>
</tr>
<tr>
<td>ggbBase64</td>
<td>base64 encoded .ggb file</td>
<td>Encoded file to load. See the applet here: <a href="https://dev.geogebra.org/examples/html/example-single.html" target="_blank" rel="noopener">https://dev.geogebra.org/examples/html/example-single.html</a></td>
<td>4.0</td>
</tr>
<tr>
<td>borderColor</td>
<td>e.g. <code>#FFFFFF</code> for white</td>
<td>Color of the border line drawn around the applet panel (as hex rgb string). Default: gray</td>
<td>3.0</td>
</tr>
<tr>
<td>enableRightClick</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether right clicks should be handled by the applet. Setting this parameter to “false” disables context menus, properties dialogs and right-click-zooming. Default: true. NB also enables/disables some keyboard shortcuts eg Delete and Ctrl + R (recompute all objects). Default: true</td>
<td>3.0</td>
</tr>
<tr>
<td>enableLabelDrags</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether labels can be dragged. Default: true</td>
<td>3.2</td>
</tr>
<tr>
<td>enableShiftDragZoom</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the Graphics View(s) should be moveable using Shift + mouse drag (or. Ctrl + mouse drag) or zoomable using Shift + mouse wheel (or Ctrl + mouse wheel). Setting this parameter to “false” disables moving and zooming of the drawing pad. Default: true</td>
<td>3.0</td>
</tr>
<tr>
<td>showZoomButtons</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the zoom in / zoom out / home buttons should be shown in the Graphics View or not. Default: false</td>
<td>6.0</td>
</tr>
<tr>
<td>errorDialogsActive</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether error dialogs will be shown if an invalid input is entered (using the Input Bar or JavaScript) Default: true</td>
<td>3.2</td>
</tr>
<tr>
<td>showMenuBar</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the menubar of GeoGebra should be shown in the applet. Default: false</td>
<td>2.5</td>
</tr>
<tr>
<td>showToolBar</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the toolbar with the construction mode buttons should be shown in the applet. Default: false</td>
<td>2.5</td>
</tr>
<tr>
<td>showToolBarHelp</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the toolbar help text right to the toolbar buttons should be shown in the applet</td>
<td>3.0</td>
</tr>
<tr>
<td>customToolBar</td>
<td>e.g. <code>0 1 2 3 , 4 5 6 7</code></td>
<td>Sets the toolbar according to a custom toolbar string where the int values are <a href="https://wiki.geogebra.org/en/Reference:Toolbar" target="_blank" rel="noopener">Toolbar Mode Values</a>, <code>,</code> adds a separator within a menu, `</td>
<td><code>starts a new menu and</code></td>
</tr>
<tr>
<td>showAlgebraInput</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether the algebra input line (with input field, greek letters and command list) should be shown in the applet. Default: false</td>
<td>2.5</td>
</tr>
<tr>
<td>showResetIcon</td>
<td><code>true</code> or <code>false</code></td>
<td>States whether a small icon (GeoGebra ellipse) should be shown in the upper right corner of the applet. Clicking on this icon resets the applet (i.e. it reloads the file given in the filename parameter). Default: false</td>
<td>2.5</td>
</tr>
<tr>
<td>language</td>
<td><a href="http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank" rel="noopener">iso language string</a></td>
<td>GeoGebra tries to set your local language automatically (if it is available among the supported languages, of course). The default language for unsupported languages is English. If you want to specify a certain language manually, please use this parameter.</td>
<td>2.5</td>
</tr>
<tr>
<td>country</td>
<td>iso country string, e.g. <code>AT</code> for Austria</td>
<td>This parameter only makes sense if you use it together with the language parameter.</td>
<td>2.5</td>
</tr>
<tr>
<td>id</td>
<td>eg <code>applet2</code></td>
<td>This parameter allows you to specify the argument passed to the JavaScript function ggbOnInit(), which is called once the applet is fully initialised. This is useful when you have multiple applets on a page - see <a href="http://dev.geogebra.org/examples/html/example-api-sync.html" target="_blank" rel="noopener">this example</a> (will have no effect in earlier versions)</td>
<td>3.2</td>
</tr>
<tr>
<td>allowStyleBar</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: false Determines whether the Style Bar can be shown (or will be shown if just Graphics View 1 is showing)</td>
<td>4.0</td>
</tr>
<tr>
<td>appletOnLoad</td>
<td>eg <code>function(api){ api.evalCommand(&#39;Segment((1,2),(3,4))&#39;); }</code></td>
<td>JavaScript method to run when the activity is initialized (and file loaded if applicable)</td>
<td>5.0</td>
</tr>
<tr>
<td>useBrowserForJS</td>
<td><code>true</code> or <code>false</code></td>
<td>When true, GeoGebraruns ggbOnInit from HTMLignores ggbOnInit from fileignores JS update scripts of objects in fileWhen false, GeoGebra:ignores ggbOnInit from HTML (use appletOnLoad parameter of GGBApplet instead)runs ggbOnInit from fileruns JS update scripts of objects in file<strong>Default: false</strong></td>
<td>4.0</td>
</tr>
<tr>
<td>showLogging</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: false Determines whether logging is shown in the Browser’s console</td>
<td>4.2</td>
</tr>
<tr>
<td>capturingThreshold</td>
<td>integer</td>
<td>Default: 3 Determines the sensitivity of object selection. The default value of 3 is usually fine to select and drag objects both with the mouse and touch. Use larger values (e.g. 4 or 5) to make it easier to select and drag objects.</td>
<td>4.4</td>
</tr>
<tr>
<td>enableFileFeatures</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: true Determines whether file saving, file loading, sign in and Options &gt; Save settings are enabled. This argument is ignored when menubar is not showing.</td>
<td>5.0</td>
</tr>
<tr>
<td>perspective</td>
<td>string</td>
<td>For values see <a href="https://wiki.geogebra.org/en/SetPerspective_Command" target="_blank" rel="noopener">SetPerspective_Command</a>. Just for a blank start ie shouldn’t be used with <em>material_id</em>, <em>filename</em> or <em>ggbBase64</em> parameters</td>
<td>5.0</td>
</tr>
<tr>
<td>enable3d</td>
<td><code>true</code> or <code>false</code> or none</td>
<td>Whether 3D should be enabled (for exam mode). When neither true nor false are entered, user can decide in a dialog.</td>
<td>5.0</td>
</tr>
<tr>
<td>enableCAS</td>
<td><code>true</code> or <code>false</code> or none</td>
<td>Whether CAS should be enabled (for exam mode). When neither true nor false are entered, user can decide in a dialog.</td>
<td>5.0</td>
</tr>
<tr>
<td>algebraInputPosition</td>
<td><code>algebra</code>, <code>top</code> or <code>bottom</code></td>
<td>Default: empty Determines whether input bar should be shown in algebra, on top of the applet or under the applet. When left empty, the position depends on file.</td>
<td>5.0</td>
</tr>
<tr>
<td>preventFocus</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: false. When set to true, this prevents the applet from getting focus automatically at the start.</td>
<td>5.0</td>
</tr>
<tr>
<td>scaleContainerClass</td>
<td>String</td>
<td>Name of CSS class that is used as container; applet will scale to fit into the container.</td>
<td>5.0</td>
</tr>
<tr>
<td>autoHeight</td>
<td>boolean</td>
<td>• <code>true</code> to restrict the width of the applet and compute height automatically, add <code>autoHeight:true</code> • <code>false</code>if you want the applet to be restricted by both width and height of the container</td>
<td>5.0</td>
</tr>
<tr>
<td>allowUpscale</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: false Determines whether automatic scaling may scale the applet up</td>
<td>5.0</td>
</tr>
<tr>
<td>playButton</td>
<td><code>true</code> or <code>false</code></td>
<td>Default: false Determines whether a preview image and a play button should be rendered in place of the applet. Pushing the play button initializes the applet.</td>
<td>5.0</td>
</tr>
<tr>
<td>scale</td>
<td>number</td>
<td>Ratio by which the applet should be scaled (eg. 2 makes the applet 2 times bigger, including all texts and UI elements). Default: 1</td>
<td>5.0</td>
</tr>
<tr>
<td>showAnimationButton</td>
<td><code>true</code> or <code>false</code></td>
<td>Whether animation button should be visible</td>
<td>5.0</td>
</tr>
<tr>
<td>showFullscreenButton</td>
<td><code>true</code> or <code>false</code></td>
<td>Whether fullscreen button should be visible</td>
<td>6.0</td>
</tr>
<tr>
<td>showSuggestionButtons</td>
<td><code>true</code> or <code>false</code></td>
<td>Whether suggestion buttons (special points, solve) in Algebra View should be visible</td>
<td>6.0</td>
</tr>
<tr>
<td>showStartTooltip</td>
<td><code>true</code> or <code>false</code></td>
<td>Whether “Welcome” tooltip should be shown</td>
<td>5.0</td>
</tr>
<tr>
<td>rounding</td>
<td>string</td>
<td>String composed of number of decimal places and flags – valid flags are “s” for significant digits and “r” for rational numbers. Hence “10” means 10 decimal places, “10s” stands for 10 significant digits.</td>
<td>6.0</td>
</tr>
<tr>
<td>buttonShadows</td>
<td><code>true</code> or <code>false</code></td>
<td>Whether buttons should have shadow</td>
<td>6.0</td>
</tr>
<tr>
<td>buttonRounding</td>
<td>Number (0 - 0.9)</td>
<td>Relative radius of button’s rounded border. The border radius in pixels is <code>buttonRounding * height /2</code>, where <code>height</code> is the height of the button. Default 0.2.</td>
<td>6.0</td>
</tr>
<tr>
<td>buttonBorderColor</td>
<td>Hex color (<code>#RGB</code>, <code>#RGBA</code>, <code>#RRGGBB</code> or <code>#RRGGBBAA</code>)</td>
<td>Border color of buttons on the graphics view. Default is black, if the button background is white, otherwise one shade darker than the background color</td>
<td>6.0</td>
</tr>
<tr>
<td>editorBackgroundColor</td>
<td>Hex color</td>
<td>Background color of the evaluator app</td>
<td>6.0</td>
</tr>
<tr>
<td>editorForegroundColor</td>
<td>Hex color</td>
<td>Foreground (text) color of the equation editor (appname = “evaluator”)</td>
<td>6.0</td>
</tr>
<tr>
<td>textmode</td>
<td>false], default false</td>
<td>whether editor is in text mode or not (appname = “evaluator”)</td>
<td>6.0</td>
</tr>
<tr>
<td>keyboardType</td>
<td>“normal”|”notes”]</td>
<td>Which keyboard is shown for equation editor (appname = “evaluator”)</td>
<td>6.0</td>
</tr>
</tbody></table>
<h3 id="Hexo-稳妥嵌入-geogebra-最佳实践"><a href="#Hexo-稳妥嵌入-geogebra-最佳实践" class="headerlink" title="Hexo 稳妥嵌入 geogebra 最佳实践"></a>Hexo 稳妥嵌入 geogebra 最佳实践</h3><ul>
<li>个人偏好的最佳实践路径：</li>
</ul>
<pre class="mermaid">graph TD
    A[搭建本地geogebra渲染环境] --> B
    B[绘制geogebra图形] -->C{分享方式}
    C --  ggb文件 -->D[获取上传ggb文件链接] --> F[使用filename方式嵌入markdown] 
    C --  ggbBase64代码  -->E[ctrl+shift+B获取代码] --> G[使用ggbBase64方式嵌入markdown]</pre>

<ul>
<li>优点：</li>
<li><input checked="" disabled="" type="checkbox"> 自己提供服务，不受官网束缚</li>
<li><input checked="" disabled="" type="checkbox"> 使用图形源文件提供展示，安全可靠</li>
<li><input checked="" disabled="" type="checkbox"> 可互动，有滑块，可以满足绝大多数展示需求</li>
<li><input checked="" disabled="" type="checkbox"> 流程相对简单清晰</li>
<li><input checked="" disabled="" type="checkbox"> 加载速度可以接受</li>
<li><input checked="" disabled="" type="checkbox"> 手机端可以显示同样效果</li>
<li><input checked="" disabled="" type="checkbox"> 环境配好后无缝融入hexo博客环境</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.geogebra.org/" target="_blank" rel="noopener">https://www.geogebra.org/</a></li>
<li><a href="https://blog.csdn.net/fatty_zhu/article/details/77411254" target="_blank" rel="noopener">https://blog.csdn.net/fatty_zhu/article/details/77411254</a></li>
<li><a href="https://www.bilibili.com/video/av80321187/" target="_blank" rel="noopener">https://www.bilibili.com/video/av80321187/</a></li>
<li><a href="https://kz16.top/" target="_blank" rel="noopener">https://kz16.top/</a></li>
<li><a href="https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters" target="_blank" rel="noopener">https://wiki.geogebra.org/en/Reference:GeoGebra_App_Parameters</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>tools</category>
        <category>geogebra</category>
      </categories>
      <tags>
        <tag>tools</tag>
        <tag>geogebra</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux 获取cpu信息</title>
    <url>/2020/12/18/linux/get-cpu-info/get-cpu-info/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Linux系统获取CPU信息方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="命令-1"><a href="#命令-1" class="headerlink" title="命令 1"></a>命令 1</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /proc/cpuinfo</span><br></pre></td></tr></table></figure>

<blockquote>
<p>得到输出信息：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">processor	: 0</span><br><span class="line">vendor_id	: GenuineIntel</span><br><span class="line">cpu family	: 6</span><br><span class="line">model		: 63</span><br><span class="line">model name	: Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz</span><br><span class="line">stepping	: 2</span><br><span class="line">microcode	: 0x43</span><br><span class="line">cpu MHz		: 1200.000</span><br><span class="line">cache size	: 30720 KB</span><br><span class="line">physical id	: 0</span><br><span class="line">siblings	: 24</span><br><span class="line">core id		: 0</span><br><span class="line">cpu cores	: 12</span><br><span class="line">apicid		: 0</span><br><span class="line">initial apicid	: 0</span><br><span class="line">fpu		: yes</span><br><span class="line">fpu_exception	: yes</span><br><span class="line">cpuid level	: 15</span><br><span class="line">wp		: yes</span><br><span class="line">flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm epb invpcid_single ssbd ibrs ibpb stibp kaiser tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm xsaveopt cqm_llc cqm_occup_llc dtherm ida arat pln pts flush_l1d</span><br><span class="line">bugs		: cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf</span><br><span class="line">bogomips	: 4997.11</span><br><span class="line">clflush size	: 64</span><br><span class="line">cache_alignment	: 64</span><br><span class="line">address sizes	: 46 bits physical, 48 bits virtual</span><br><span class="line">power management:</span><br></pre></td></tr></table></figure>
<blockquote>
<p>主要内容含义：</p>
</blockquote>
<table>
<thead>
<tr>
<th>条目</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>processor</td>
<td>条目包括这一逻辑处理器的唯一标识符</td>
</tr>
<tr>
<td>physical id</td>
<td>条目包括每个物理封装的唯一标识符</td>
</tr>
<tr>
<td>core id</td>
<td>条目保存每个内核的唯一标识符</td>
</tr>
<tr>
<td>siblings</td>
<td>条目列出了位于相同物理封装中的逻辑处理器的数量</td>
</tr>
<tr>
<td>cpu cores</td>
<td>条目包含位于相同物理封装中的内核数量</td>
</tr>
<tr>
<td>英特尔处理器</td>
<td>vendor id 条目中的字符串是 GenuineIntel</td>
</tr>
</tbody></table>
<h3 id="命令-2"><a href="#命令-2" class="headerlink" title="命令 2"></a>命令 2</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lscpu</span><br></pre></td></tr></table></figure>

<blockquote>
<p>得到输出信息：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Architecture:          x86_64</span><br><span class="line">CPU op-mode(s):        32-bit, 64-bit</span><br><span class="line">Byte Order:            Little Endian</span><br><span class="line">CPU(s):                24</span><br><span class="line">On-line CPU(s) list:   0-23</span><br><span class="line">Thread(s) per core:    2</span><br><span class="line">Core(s) per socket:    12</span><br><span class="line">Socket(s):             1</span><br><span class="line">NUMA node(s):          1</span><br><span class="line">Vendor ID:             GenuineIntel</span><br><span class="line">CPU family:            6</span><br><span class="line">Model:                 63</span><br><span class="line">Model name:            Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz</span><br><span class="line">Stepping:              2</span><br><span class="line">CPU MHz:               2500.000</span><br><span class="line">CPU max MHz:           3300.0000</span><br><span class="line">CPU min MHz:           1200.0000</span><br><span class="line">BogoMIPS:              4997.11</span><br><span class="line">Virtualization:        VT-x</span><br><span class="line">L1d cache:             32K</span><br><span class="line">L1i cache:             32K</span><br><span class="line">L2 cache:              256K</span><br><span class="line">L3 cache:              30720K</span><br><span class="line">NUMA node0 CPU(s):     0-23</span><br><span class="line">Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm epb invpcid_single ssbd ibrs ibpb stibp kaiser tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm xsaveopt cqm_llc cqm_occup_llc dtherm ida arat pln pts flush_l1d</span><br></pre></td></tr></table></figure>

<blockquote>
<p>主要内容含义：</p>
</blockquote>
<table>
<thead>
<tr>
<th>条目</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>socket</td>
<td>物理CPU的插槽</td>
</tr>
<tr>
<td>Core per Socket</td>
<td>每一个插槽对应的物理CPU上有多少个核</td>
</tr>
<tr>
<td>Thread per Core</td>
<td>每个核上有多少个线程</td>
</tr>
</tbody></table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/andyzhaojianhui/article/details/79864906" target="_blank" rel="noopener">https://blog.csdn.net/andyzhaojianhui/article/details/79864906</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>DVC 使用手册</title>
    <url>/2020/12/17/dvc/dvc/</url>
    <content><![CDATA[<blockquote>
<p>dvc是将大文件以类似git的形式进行管理的工具，结合git可以做到无痛管理项目文件，虽然眼下开发还不够成熟，不过已经为开发带来了很大方便。本文介绍dvc常用命令的使用方法。</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>本手册提供基本的DVC使用方法。<br>更详细的DVC使用方法请参考<a href="https://www.dvc.org/doc/" target="_blank" rel="noopener">DVC官方文档</a>。</p>
</blockquote>
<h2 id="1-DVC基本用法"><a href="#1-DVC基本用法" class="headerlink" title="1. DVC基本用法"></a>1. DVC基本用法</h2><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>使用<code>dvc init</code>命令初始化一个项目。注意，初始化DVC之前需要先初始化Git。<br>example:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir example-get-started</span><br><span class="line">cd example-get-started</span><br><span class="line">git init</span><br><span class="line">dvc init</span><br></pre></td></tr></table></figure>

<p><code>dvc init</code>命令会自动创建<code>.dvc</code>目录。</p>
<h3 id="Track文件或目录"><a href="#Track文件或目录" class="headerlink" title="Track文件或目录"></a>Track文件或目录</h3><p>使用<code>dvc add</code>命令track文件或目录。</p>
<p>example:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc add data.xml</span><br></pre></td></tr></table></figure>

<p>DVC将文件或目录的信息存储在<code>.dvc</code>文件中，如<code>data.xml.dvc</code>。DVC还会自动修改.gitignore文件。需要在Git中add这两个文件并提交。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add data.xml.dvc .gitignore</span><br><span class="line">git commit -m "Add xml data"</span><br></pre></td></tr></table></figure>

<h3 id="设置remote-storage"><a href="#设置remote-storage" class="headerlink" title="设置remote storage"></a>设置remote storage</h3><p>使用<code>dvc remote add</code>命令可以设置DVC的remote。DI使用兼容亚马逊S3 API的对象存储做为DVC的remote storage。</p>
<p>设置方法如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dvc remote add -d myremote s3:&#x2F;&#x2F;dvc</span><br><span class="line">dvc remote modify myremote endpointurl http:&#x2F;&#x2F;ceph01</span><br></pre></td></tr></table></figure>

<p>其中myremote是DVC remote的名字，<code>s3://dvc</code>是bucket的位置，<code>http://ceph01</code>是对象存储的endpoint。</p>
<p>同时还需要配置如下环境变量：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export AWS_ACCESS_KEY_ID="&lt;my-access-key&gt;"</span><br><span class="line">export AWS_SECRET_ACCESS_KEY="&lt;my-secret-key&gt;"</span><br></pre></td></tr></table></figure>

<p>AWS_ACCESS_KEY_ID和AWS_SECRET_ACCESS_KEY无效时，请联系管理员获取新的key。</p>
<h3 id="推送到remote"><a href="#推送到remote" class="headerlink" title="推送到remote"></a>推送到remote</h3><p>设置remote storage之后，可以使用<code>dvc push</code>命令推送数据到remote。</p>
<p>example:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc push</span><br></pre></td></tr></table></figure>

<h3 id="拉取数据"><a href="#拉取数据" class="headerlink" title="拉取数据"></a>拉取数据</h3><p>DVC-tracked data被存储到remote之后，可以通过<code>dvc pull</code>拉取远端的数据到本地。通常，在<code>git clone</code>和<code>git pull</code>之后运行<code>dvc pull</code>。</p>
<p>example：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc pull</span><br></pre></td></tr></table></figure>

<p>&nbsp;</p>
<hr>
<h2 id="2-创建基于DVC的Git项目"><a href="#2-创建基于DVC的Git项目" class="headerlink" title="2. 创建基于DVC的Git项目"></a>2. 创建基于DVC的Git项目</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ul>
<li><p>安装dvc</p>
<p><code>pip install dvc</code></p>
</li>
<li><p>ceph对象存储服务配置</p>
<p>设置环境变量</p>
<p><code>export AWS_ACCESS_KEY_ID=18M4BI7CGWKWSYELOXC3</code></p>
<p>配置hosts文件，在hosts文件中增加以下内容<br><code>192.168.10.91 ceph01</code></p>
</li>
</ul>
<h3 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h3><p>   假设项目名称为demo，数据位于demo/data目录。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd demo</span><br><span class="line">git init</span><br><span class="line">dvc init</span><br></pre></td></tr></table></figure>

<h3 id="设置DVC的remote"><a href="#设置DVC的remote" class="headerlink" title="设置DVC的remote"></a>设置DVC的remote</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc remote add -d myremote s3://dvc</span><br><span class="line">dvc remote modify myremote endpointurl http://ceph01</span><br></pre></td></tr></table></figure>

<h3 id="track-data"><a href="#track-data" class="headerlink" title="track data"></a>track data</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc add data</span><br><span class="line">dvc push</span><br></pre></td></tr></table></figure>

<h3 id="提交Git"><a href="#提交Git" class="headerlink" title="提交Git"></a>提交Git</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m "track data"</span><br></pre></td></tr></table></figure>

<p>&nbsp;</p>
<hr>
<h2 id="3-Data-Registry"><a href="#3-Data-Registry" class="headerlink" title="3. Data Registry"></a>3. Data Registry</h2><p>data registry用于数据和代码相分离的情况，即代码和数据不在同一目录。同时，data registry使得数据和模型可以在不同的项目间共享。DVC提供了<code>dvc import</code>和<code>dvc get</code>命令来拉取data registry中的数据。</p>
<h3 id="构建registry"><a href="#构建registry" class="headerlink" title="构建registry"></a>构建registry</h3><p>与一般DVC项目一样，data registry使用<code>git init</code>和<code>dvc init</code>进行初始化。<br>将数据集添加到data registry中很简单，只需要将相关数据放置在workspace中，然后用<code>dvc add</code>track它们。例如：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir -p music/songs</span><br><span class="line">cp ~/Downloads/millionsongsubset_full music/songs</span><br><span class="line">dvc add music/songs/</span><br></pre></td></tr></table></figure>
<p>然后使用常规的Git workflow管理产生的<code>.dvc</code>文件。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add music/songs.dvc music/.gitignore</span><br><span class="line">git commit -m "Track 1.8 GB 10,000 song dataset in music/"</span><br></pre></td></tr></table></figure>
<p>实际的数据存储在项目的cache中，可以通过<code>dvc push</code>推送到remote storage以便其人能够访问。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc remote add -d myremote s3://dvc</span><br><span class="line">dvc push</span><br></pre></td></tr></table></figure>

<h3 id="使用registry"><a href="#使用registry" class="headerlink" title="使用registry"></a>使用registry</h3><h5 id="列出数据"><a href="#列出数据" class="headerlink" title="列出数据"></a>列出数据</h5><p>使用<code>dvc list</code>命令可以列出registry中的内容：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc list -R https://github.com/iterative/dataset-registry</span><br></pre></td></tr></table></figure>
<h5 id="直接下载"><a href="#直接下载" class="headerlink" title="直接下载"></a>直接下载</h5><p>从registry中直接下载数据可以使用<code>dvc get</code>命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc get https://github.com/example/registry music/songs</span><br></pre></td></tr></table></figure>
<h5 id="import-workflow"><a href="#import-workflow" class="headerlink" title="import workflow"></a>import workflow</h5><p><code>dvc import</code>命令可以下载registry中的数据，同时会创建对应的<code>.dvc</code>文件，该文件包含了元数据。注意，<code>dvc import</code>必须在初始化过的dvc workspace中才能运行。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc import https://github.com/example/registry music/songs</span><br></pre></td></tr></table></figure>

<h5 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h5><p>若项目引用的registry中的数据发送了更新，可以使用<code>dvc update</code>同步此数据：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dvc update dataset.dvc</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>dvc</category>
      </categories>
      <tags>
        <tag>dvc</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 5 - 最速下降法</title>
    <url>/2020/12/16/machine_learning/conjugate-gradient-algorithm/steepest-descent-method/steepest-descent-method/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍优化二次型的常用迭代方法——最速下降法。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><blockquote>
<p>重述我们需要优化的问题：</p>
</blockquote>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{x^TAx} } - { {\bf{b} }^{\bf{T} } }{\bf{x} } + {\bf{c} } \tag{1} \label{1}<br>$$</p>
<ul>
<li>矩阵$\bf{A}$正定对称</li>
<li>目标为优化$\bf{x}$，使得$f(\bf{x})$取得最小值</li>
</ul>
<h3 id="最速下降法"><a href="#最速下降法" class="headerlink" title="最速下降法"></a>最速下降法</h3><blockquote>
<p>当有一天大神们厌倦了代数法解决优化问题时，提出了迭代计算，逐步接近最优解的优化方法，方法的思想也是朴素直观的。</p>
</blockquote>
<h4 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h4><ul>
<li>我们的目标是找到函数的最小值，而且我已经知道了这个函数就那么一个极小值点，相当于找到一个曲面的最低点，最速下降法的流程图：</li>
</ul>
<pre class="mermaid">graph LR

    A[寻找函数最小值]-->B[计算当前梯度方向]
    B --> C[计算前进距离]
    C --> D{精度是否满足要求}
    D -- 否 --> B
    D -- 是 --> E[输出当前位置]</pre>

<h4 id="计算流程"><a href="#计算流程" class="headerlink" title="计算流程"></a>计算流程</h4><h5 id="初始位置：-bf-x-0"><a href="#初始位置：-bf-x-0" class="headerlink" title="初始位置： $\bf{x}_0$"></a>初始位置： $\bf{x}_0$</h5><h5 id="计算梯度-bf-g"><a href="#计算梯度-bf-g" class="headerlink" title="计算梯度$\bf{g}$"></a>计算梯度$\bf{g}$</h5><ul>
<li>沿用之前的<a href="https://www.zywvvd.com/2020/12/12/machine_learning/conjugate-gradient-algorithm/quadratic_cofficient/quadratic_cofficient/#%E4%B8%BA%E4%BD%95%E5%A6%82%E6%AD%A4">计算结论</a>：</li>
</ul>
<p>$$<br>\bf{g} = f’(\bf{x}) = A\bf{x}-\bf{b} \tag{2}<br>$$</p>
<ul>
<li>那么关于 $\bf{x}_0$为了寻找最小值，需要向梯度的反方向前进，但为了保证推导过程顺遂，前进距离系数不管符号，设第$i$步需要前进的距离为${\alpha}_i$,那么对于第$i$个$\bf{x}_i$，有：</li>
</ul>
<p>$$<br>{\bf{x}_{i + 1} } = {\bf{x}_i} + \alpha_i {\bf{g}_i} \tag{3} \label{3}<br>$$</p>
<h5 id="系数-alpha-i-求解"><a href="#系数-alpha-i-求解" class="headerlink" title="系数${\alpha}_i$求解"></a>系数${\alpha}_i$求解</h5><h6 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h6><blockquote>
<p>行动前后两个位置的梯度方向需要正交，不然当前行动的位置还可以取到更低的值：</p>
<p>即：</p>
</blockquote>

$$
{\bf{g}}_i^T {{\bf{g}}_{i + 1}}=0 \tag{4}
$$



其中：
$$
{ {\bf{g} }_i}{\bf{ = A} }{ {\bf{x} }_i}{\bf{ - b} } \tag{5}
$$

$$
{ {\bf{x} }_{i + 1} } = { {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i} = {\bf{x}_i} + {\alpha _i}({\bf{A} }{ {\bf{x} }_i} - {\bf{b} }) \tag{6}
$$

$$
\begin{array}{l}
{ {\bf{g} }_{i + 1} } &= {\bf{A} }{ {\bf{x} }_{i + 1} } - {\bf{b} }\\
 &= {\bf{A} }({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i}) - {\bf{b} } \tag{7}
\end{array}
$$

那么有：
$$
{\bf{g} }_i^T{ {\bf{g} }_{i + 1} } = {\bf{g} }_i^T{\bf{A} }({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i}) - {\bf{g} }_i^T{\bf{b} } = 0
$$

$$
{\bf{g} }_i^T{\bf{A} }{ {\bf{x} }_i} + {\alpha _i}{\bf{g} }_i^T{\bf{A} }{ {\bf{g} }_i} - {\bf{g} }_i^T{\bf{b} } = 0
$$

$$
{\alpha _i}{\bf{g} }_i^T{\bf{A} }{ {\bf{g} }_i} + {\bf{g} }_i^T{ {\bf{g} }_i} = 0
$$

$$
{\alpha _i} =  - \frac{ { {\bf{g} }_i^T{ {\bf{g} }_i} } }{ { {\bf{g} }_i^T{\bf{A} }{ {\bf{g} }_i} } } \tag{8}
$$



<h6 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h6><blockquote>
<p>确定梯度方向$\bf{g}$后求解$\alpha$，由于最速下降法确定的是每一步方向上的局部最优解，也就是沿着这个方向运动得到最小值的位置，那么可以对$\alpha$求导，使得导数为0：</p>
</blockquote>
<ul>
<li>由$\eqref{1}$和$\eqref{3}$，有：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{({\bf{x} } + \alpha {\bf{g} })^T}{\bf{A} }({\bf{x} } + \alpha {\bf{g} }) - { {\bf{b} }^{\bf{T} } }({\bf{x} } + \alpha {\bf{g} }) + {\bf{c} } \tag{9}<br>$$</p>
<ul>
<li>对于已经确定的当前位置$\bf{x}_i$，当前可以看成是关于$\bf{x}_i$，$\alpha_i$的函数：</li>
</ul>
<p>$$<br>f(\bf{x}_{i+1}) =f(\bf{x}_i,{\alpha _i}) = \frac{1}{2}{({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i})^T}{\bf{A} }({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i}) - { {\bf{b} }^{\bf{T} } }({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i}) + {\bf{c} } \tag{10}<br>$$</p>
<ul>
<li>对$\alpha_i$求偏导：</li>
</ul>

$$
\begin{array}{l}
\frac{ {\partial f({ {\bf{x} }_{i + 1} })} }{ {\partial {\alpha _i} } } &= \frac{ {\partial f({ {\bf{x} }_{i + 1} })} }{ {\partial { {\bf{x} }_{i + 1} } } }\frac{ {\partial { {\bf{x} }_{i + 1} } } }{ {\partial {\alpha _i} } }\\
 &= {({\bf{A} }{ {\bf{x} }_{i + 1} } - {\bf{b} })^T}{ {\bf{g} }_i}\\
 &= {({\bf{A} }({ {\bf{x} }_i} + {\alpha _i}{ {\bf{g} }_i}) - {\bf{b} })^T}{ {\bf{g} }_i}\\
 &= {({\bf{A} }{ {\bf{x} }_i} - {\bf{b} } + {\alpha _i}{\bf{A} }{ {\bf{g} }_i})^T}{ {\bf{g} }_i}\\
 &= ({\bf{g} }_i^T + {\alpha _i}{\bf{g} }_i^T{\bf{A} }){ {\bf{g} }_i}\\
 &= {\bf{g} }_i^T{ {\bf{g} }_i} + {\alpha _i}{\bf{g} }_i^T{\bf{A} }{ {\bf{g} }_i} =0
\end{array} \tag{11}
$$



<ul>
<li>得到：</li>
</ul>
<p>$$<br>{\alpha _i} =  - \frac{ { {\bf{g} }_i^T{ {\bf{g} }_i} } }{ { {\bf{g} }_i^T{\bf{A} }{ {\bf{g} }_i} } } \tag{12}<br>$$</p>
<h5 id="下一个位置"><a href="#下一个位置" class="headerlink" title="下一个位置"></a>下一个位置</h5><ul>
<li>按照公式$\eqref{3}$，获取下一个获取的位置$\bf{x}_{i+1}$</li>
<li>检测当前梯度大小，如果梯度小于一定阈值$\varepsilon$即认为已经达到了极小值：</li>
</ul>
<p>$$<br>\varepsilon  \ge \left| { { {\bf{g} }_{i+1} } } \right| \tag{13}<br>$$</p>
<ul>
<li>否则再向前走下一步</li>
</ul>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ul>
<li><p>最速下降法是一种简单拟合当前问题的贪心优化方法，通过一步步计算局部最优解来逼近全局最优解，其本质为：</p>
<ul>
<li>将当前的二次型拟合成高维球形</li>
<li>运动到拟合球形的中心</li>
<li>计算误差，测量精度</li>
<li>若精度不够则，根据误差拟合下一个高维球</li>
</ul>
</li>
<li><p>首先，要声明的是，该方法是收敛的，也就是在我们定义的问题下，是可以逐步收敛到最优解的，证明比较复杂，参考<a href="https://zhuanlan.zhihu.com/p/23799012" target="_blank" rel="noopener">番外篇(2)——无聊的最速下降法推导</a></p>
</li>
<li><p>该方法也存在一定问题，由于建模过于简单，导致其计算出的最优值结果与真实最小值不断遗漏下偏差，带来的结果就是需要往复迭代才能接近最优值</p>
</li>
</ul>
<h3 id="共轭梯度法的由来"><a href="#共轭梯度法的由来" class="headerlink" title="共轭梯度法的由来"></a>共轭梯度法的由来</h3><ul>
<li>最速下降法拟合的方案过于简单，导致了该方法注定无法轻易得到全局最优解</li>
<li>如果可以有正确拟合真实二次型的迭代优化方法，那么如果找到了这个模型下的最优值，岂不就迭代得到了全局最优解</li>
<li>带着这个初衷，大神们提出了共轭梯度法</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>python opencv 显示多窗口图像并获取点击处像素点坐标</title>
    <url>/2020/12/16/image_processing/cv-image-event/cv-image-event/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍使用python 的 opencv 库显示多个图片窗口，并获取点击点像素位置的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="opencv-显示图像"><a href="#opencv-显示图像" class="headerlink" title="opencv 显示图像"></a>opencv 显示图像</h3><blockquote>
<p>显示图像主要通过<code>namedWindow</code>方法定义窗口，和<code>imshow</code>方法刷新窗口内容实现的，需要停止时按<code>Esc</code>键退出并销毁窗口：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">image = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv2.namedWindow(<span class="string">'image'</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    cv2.imshow(<span class="string">'image'</span>, image)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">20</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示多幅图像就使用不同的窗口名称建立窗口即可：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">image_1 = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv2.namedWindow(<span class="string">'image_1'</span>)</span><br><span class="line">image_2 = np.zeros((<span class="number">512</span>,<span class="number">512</span>,<span class="number">3</span>), np.uint8)</span><br><span class="line">cv2.namedWindow(<span class="string">'image_1'</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    cv2.imshow(<span class="string">'image_1'</span>, image_1)</span><br><span class="line">    cv2.imshow(<span class="string">'image_2'</span>, image_2)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">20</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h3 id="获取鼠标单击事件信息"><a href="#获取鼠标单击事件信息" class="headerlink" title="获取鼠标单击事件信息"></a>获取鼠标单击事件信息</h3><blockquote>
<p>本质上是cv库中的事件绑定、触发、捕获信息的流程，就用简单的示例抛砖引玉了。</p>
</blockquote>
<ul>
<li>定义事件函数：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_point</span><span class="params">(event, x, y, flags, param)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> event == cv2.EVENT_LBUTTONDOWN:</span><br><span class="line">        print(<span class="string">'clicking: '</span>, x, y)</span><br></pre></td></tr></table></figure>

<ul>
<li>绑定事件：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cv2.setMouseCallback(<span class="string">'image_1'</span>, get_point, param)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以向事件中传入参数，放在<code>param</code>位置。</p>
</blockquote>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_point</span><span class="params">(event, x, y, flags, param)</span>:</span></span><br><span class="line">    <span class="comment"># 鼠标单击事件</span></span><br><span class="line">    <span class="keyword">if</span> event == cv2.EVENT_LBUTTONDOWN:</span><br><span class="line">        <span class="comment"># 输出坐标</span></span><br><span class="line">        print(<span class="string">'clicking: '</span>, x, y)</span><br><span class="line">        <span class="comment"># 在传入参数图像上画出该点</span></span><br><span class="line">        cv2.circle(param, (x, y), <span class="number">1</span>, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>), thickness=<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># 定义两幅图像</span></span><br><span class="line">    image_1 = np.zeros((<span class="number">200</span>, <span class="number">200</span>, <span class="number">3</span>), dtype=<span class="string">'uint8'</span>)</span><br><span class="line">    image_2 = np.zeros((<span class="number">200</span>, <span class="number">200</span>, <span class="number">3</span>), dtype=<span class="string">'uint8'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义两个窗口 并绑定事件 传入各自对应的参数</span></span><br><span class="line">    cv2.namedWindow(<span class="string">'image_1'</span>)</span><br><span class="line">    cv2.setMouseCallback(<span class="string">'image_1'</span>, get_point, image_1)</span><br><span class="line"></span><br><span class="line">    cv2.namedWindow(<span class="string">'image_2'</span>)</span><br><span class="line">    cv2.setMouseCallback(<span class="string">'image_2'</span>, get_point, image_2)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示图像</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        cv2.imshow(<span class="string">'image_1'</span>, image_1)</span><br><span class="line">        cv2.imshow(<span class="string">'image_2'</span>, image_2)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">20</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 销毁窗口</span></span><br><span class="line">    cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20201216144831.png"></p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p><a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">https://github.com/zywvvd/Python_Practise</a></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/qq_41360787/article/details/103258773" target="_blank" rel="noopener">https://blog.csdn.net/qq_41360787/article/details/103258773</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>opencv</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>opencv</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 4 - 二次型优化方法</title>
    <url>/2020/12/15/machine_learning/conjugate-gradient-algorithm/ways-to-optimize/ways-to-optimize/</url>
    <content><![CDATA[<blockquote>
<p>在确定了可优化二次型的类型后，本文讨论二次型的优化方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="当前问题"><a href="#当前问题" class="headerlink" title="当前问题"></a>当前问题</h3><ul>
<li><p>解方程$\bf{Ax}=\bf{b}$</p>
</li>
<li><p>其中$\bf{A}$为半正定矩阵</p>
</li>
<li><p>$\bf{A}$的秩与其增广矩阵$\bf{Ab}$的秩相等</p>
</li>
</ul>
<h2 id="优化方法"><a href="#优化方法" class="headerlink" title="优化方法"></a>优化方法</h2><h3 id="代数法"><a href="#代数法" class="headerlink" title="代数法"></a>代数法</h3><h4 id="高斯消元法"><a href="#高斯消元法" class="headerlink" title="高斯消元法"></a>高斯消元法</h4><ul>
<li>在$\bf{A}$的行列式不为0时，可以逐项消除半边系数，得到三角阵，计算得到$x_n$再逐步带入计算出其他未知数，得到计算结果。</li>
</ul>
<p>$$<br>\begin{equation}<br>\begin{split}<br>{a_{11}}{x_1} + {a_{12}}{x_2} +  \cdots {a_{1n}}{x_n} = {b_1}\\<br>{a_{22}}{x_2} +  \cdots {a_{2n}}{x_n} = {b_2}\\<br> \vdots \\<br>{a_{nn}}{x_n} = {b_n}<br>\end{split}<br>\end{equation}<br>$$</p>
<ul>
<li>其他代数方法在高斯消元法基础上进行改进</li>
</ul>
<h4 id="高斯主元素消元法"><a href="#高斯主元素消元法" class="headerlink" title="高斯主元素消元法"></a>高斯主元素消元法</h4><ul>
<li>为解决无法面对主元素为0或主元素绝对值过小带来的精度不够的问题，提出了主元素消元</li>
<li>核心思想是选择系数绝对值最大的行作为基准进行消元，可以有效缓解上述问题</li>
</ul>
<h4 id="矩阵求逆"><a href="#矩阵求逆" class="headerlink" title="矩阵求逆"></a>矩阵求逆</h4><ul>
<li>对于矩阵$\bf{A}$可逆的情况，可以直接求出$\bf{A}$的逆矩阵，则：</li>
</ul>
<p>$$<br>{\bf{x}} = {\bf{A^{-1}}}{\bf{b}}<br>$$</p>
<h3 id="迭代法"><a href="#迭代法" class="headerlink" title="迭代法"></a>迭代法</h3><blockquote>
<p>代数法的时间复杂度都在 $O(n^3)$的数量级上，在实践中难以接受；</p>
<p>迭代法的思想是可以每次贪心地计算局部最优解，逐步向全局最优解逼近</p>
</blockquote>
<h4 id="最速下降法-梯度法"><a href="#最速下降法-梯度法" class="headerlink" title="最速下降法/梯度法"></a>最速下降法/梯度法</h4><ul>
<li>沿着当前梯度的反方向前进至方向梯度为0，重新计算当前位置的梯度，重新出发</li>
<li>不断重复该过程，直到精度满足要求</li>
</ul>
<h4 id="共轭梯度法"><a href="#共轭梯度法" class="headerlink" title="共轭梯度法"></a>共轭梯度法</h4><ul>
<li>沿着共轭梯度方向前进该共轭基的分量大小的距离</li>
<li>在所有共轭基上重复上述操作，即可达到全局最优解</li>
</ul>
<blockquote>
<p>随后我们重点介绍迭代法相关内容</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 3 - 导数与极值点</title>
    <url>/2020/12/13/machine_learning/conjugate-gradient-algorithm/gradient-related/gradient-related/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍在已经<a href="https://www.zywvvd.com/2020/11/16/machine_learning/conjugate-gradient-algorithm/conjugate-gradient/conjugate-gradient/">定义好的问题</a>下，二次型导数与极值点相关内容。</p>
</blockquote>
<a id="more"></a>

<h3 id="导数为0的点是否存在"><a href="#导数为0的点是否存在" class="headerlink" title="导数为0的点是否存在"></a>导数为0的点是否存在</h3><ul>
<li>对于一般的二次型：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{x^TAx} } - { {\bf{b} }^{\bf{T} } }{\bf{x} } + {\bf{c} } \tag{1} \label{1}<br>$$</p>
<ul>
<li>导数为：</li>
</ul>
<p>$$<br>f’({\bf{x}}) = {\bf{Ax}} - {\bf{b}} \tag{2} \label{2}<br>$$</p>
<ul>
<li>导数为0的点是否存在与方程$\bf{Ax}=\bf{b}$是否有解等价</li>
<li>设${r_A} = r(A)$为$\bf{A}$的秩</li>
<li>$\bf{Ab}$为增广矩阵，${r_{Ab}} = r(\bf{Ab})$为增广矩阵的秩，有：</li>
</ul>
<table>
<thead>
<tr>
<th>条件</th>
<th>结论</th>
</tr>
</thead>
<tbody><tr>
<td>$r_{A}&lt;r_{Ab}$</td>
<td>方程组无解，二次型不存在导数为0的点</td>
</tr>
<tr>
<td>$r_{A}=r_{Ab}=n$</td>
<td>方程组有唯一解，二次型有唯一导数为0的点</td>
</tr>
<tr>
<td>$r_{A}=r_{Ab}&lt;n$</td>
<td>方程组有无数组解，二次型有无数个导数为0的点</td>
</tr>
<tr>
<td>$r_{A}&gt;r_{Ab}$</td>
<td>不可能，增广矩阵的秩不会变小</td>
</tr>
</tbody></table>
<h3 id="极值点是否存在"><a href="#极值点是否存在" class="headerlink" title="极值点是否存在"></a>极值点是否存在</h3><ul>
<li><p>当导数为零的点不存在时，即$\eqref{2}$方程组无解时，极值点不存在</p>
</li>
<li><p>当导数为0的点存在时：</p>
<ul>
<li>若$\bf{A}$为正定矩阵，则式$\eqref{1}$有极小值，就是最小值</li>
<li>若$\bf{A}$为负定矩阵，则式$\eqref{1}$有极大值，就是最大值</li>
<li>若$\bf{A}$为半正定矩阵，且存在特征值为0，由于前提是方程组有解，则增广矩阵的秩和矩阵$\bf{A}$的秩相等，那么$\bf{b}$中对应的值为0，方程组有无限多组解，但需要满足某种条件，在这组条件下，方程组都是极小值，也就是说若$\bf{A}$为半正定矩阵则$\eqref{1}$有极小值，同时就是最小值</li>
<li>同理若$\bf{A}$为半负定矩阵，则$\eqref{1}$有极大值，也即最大值</li>
<li>若$\bf{A}$的特征值有正有负，则$\eqref{1}$有极小/大值，但不是最小/大值，此时$\eqref{1}$没有最小/大值</li>
</ul>
</li>
<li><p>为使得讨论有意义，我们之后讨论的$\eqref{1}$的优化均在$\bf{A}$为半正定矩阵的条件下，来寻找其极小值，也就是最小值</p>
</li>
</ul>
<script src="/js/deployggb.js"></script>
<script>
var parameters = {
"id": "ggbApplet",
"width":888,
"height":694,
"showMenuBar":false,
"showAlgebraInput":false,
"showToolBar":false,
"customToolBar":"0 73 62 | 1 501 67 , 5 19 , 72 75 76 | 2 15 45 , 18 65 , 7 37 | 4 3 8 9 , 13 44 , 58 , 47 | 16 51 64 , 70 | 10 34 53 11 , 24  20 22 , 21 23 | 55 56 57 , 12 | 36 46 , 38 49  50 , 71  14  68 | 30 29 54 32 31 33 | 25 17 26 60 52 61 | 40 41 42 , 27 28 35 , 6",
"showToolBarHelp":true,
"showResetIcon":true,
"enableLabelDrags":false,
"enableShiftDragZoom":true,
"enableRightClick":false,
"errorDialogsActive":false,
"useBrowserForJS":false,
"allowStyleBar":false,
"preventFocus":false,
"showZoomButtons":true,
"capturingThreshold":3,
// add code here to run when the applet starts
"appletOnLoad":function(api){ /* api.evalCommand('Segment((1,2),(3,4))');*/ },
"showFullscreenButton":true,
"scale":1,
"disableAutoScale":false,
"allowUpscale":false,
"clickToLoad":false,
"appName":"classic",
"showSuggestionButtons":true,
"buttonRounding":0.7,
"buttonShadows":false,
"language":"zh",
// use this instead of ggbBase64 to load a material from geogebra.org
// "material_id":"RHYH3UQ8",
// use this instead of ggbBase64 to load a .ggb file
// "filename":"myfile.ggb",
"ggbBase64":"UEsDBBQACAgIAKBzKVIAAAAAAAAAAAAAAAAXAAAAZ2VvZ2VicmFfZGVmYXVsdHMyZC54bWztmltz4yYUgJ+7v4LhqX2IDbJkO5koO9md6TQzSTbTZDp9xRKSaWRQBUrk/PoikCV5bWfjS9b2bvMQdBA3fedwOIDPPxaTBDzRTDLBfYg7CALKAxEyHvswV9HJEH68+HAeUxHTUUZAJLIJUT70ypJ1PS11+g4q80ia+jBIiJQsgCBNiCqr+FBEUcI4hQAUkp1xcUsmVKYkoPfBmE7ItQiIMm2NlUrPut3n5+fOrNeOyOKublh2Cxl241h1dAqBHjqXPqweznS7c7Wfe6aegxDu/n1zbfs5YVwqwgM9EP1ZIY1IniipH2lCJ5QroKYp9WEqGFcQJGREEx/elRL4Ncoo/Q2CqpKmheDFh1/O5Vg8AzH6hwY6T2U5resZoVuW0a8/i0RkIPPhYABBbJORDx3P09CSdEx8iGzhhExpBp5IUueQXInA1De5EUkknZXVPd2IkNo3blWes4nBCaSiWh+ogyGQKaWhHjWsvhEb9UyNplstBkJkoQSFD2/JLQTTKn2xqSli6Nyzl6pTr52rpgltjf28W4F9G+KQppSHutAcZ7wR5/7QcC6TkU2OG7P73pj7R4J5D5Dx+pS/8DZbZyO22PEMXJN+L2dxFK7iiv9JYz3mNuPe/4x3ynjegt2N6CLDFh3tUmeKWIqy/K9jGzFJE1rsEL2NiyqM10aosTubxRht7GhP0NHG0EsgFp8as+CRUylLtk275cMfLNQrmOlP6DiSKd0SHgxtC/RfPqc0pnXGdJnXFRHlPFDGqVRwP+fZU1sbPRftQx9Nmxt7lxXK2Jb0apaSxqVUc7mfyY1pbxbW/eymLXKVlD1fcaW3X9QYrFz4uEdK0wfd1Bf+kBEuyz3YvC2t1lxGpq9pzTsGrf1sOpt5Lv5EsloTba1tFhutXL07jrdv1a3hxtsgtg9jDsp817TNrYyov9nUd5C7nF5ncMBG9KQ/TzQY/qrEJhQ4isDswPzgkmiaZIpKRvi3difJNG7N6LuZXOtjYPWx/RjX3j96PaNTDy/YN0b2D7unCOM+dvat5tcBz+1D7uqMBjHeE+KDDflW8wwEL8+/Z/sIK9Uk3R/Meexgw8Ziyq3PlQAUyBSbIlP5BVU3EwU28hSbty/YZpv6euAZK8ClrXFpC146NunZxLWJVwPabJdoVJtqv9WKkr9aHNzNtjbH5Ep+SKV/h0id5xOatVzD7UyujcezzkG3l9M51b7BFayyk9VWIRMWahOaMK2kE629CSmMFslIiiRX9D7IKOXN9Zw142cWqnEZ2um+I1aU5mLbBGORsRfBVU0DlLPgMjEXeXNHGcvMx3ktcp0z1u3cM+Fx0szGSys1GrCn9abQ18d4yxTTZogqhP2OM+zhoddDAzw49Yb9NyLFwwapffFmoov2gdEOLGStee4sm+ckC5oz0h5a7nhQB+GB6/WcU8fDp6eufvB2vxX8vc5otjWHeKRnLGCh6Lud1iUiyGVzBm2lmtDwKMKVdU7qSF6whJFsup21r8VY0aIJGR6M0PopwUEijrTbAVKvT1HtevQ8vimXYNc+610BnK2k37jm0NqKm++5slLrkt8SiJhGz8lEV7BjYPwTCR7jTOQ8XFy9dsIL7zuYWg1tJERCSeO/Ps3k1tXyQrywClC1RO/TooIxDR5Hophb4l53TUw20+baCK0r3yXT5u1fubg8nrybKazjndY/1FvrJnJFZNNWQbf1y6ju7GdYF/8BUEsHCI//M80IBQAALiYAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAAFwAAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1s7ZjdbtMwFMev4Sks39PYaZIt0zJUwQVIgIZ2w62XnLaGxA62uzZ7Nd6BZ+LEzroUVsSqbRKIXvT46xzbv79zGvf05aapyRUYK7UqKJ8wSkCVupJqUdCVm784pi/Pnp8uQC/g0ggy16YRrqBpP3Lrh7VJFrO+TbRtQctaWCtLStpauN6loHo+r6UCSsjGyhOlP4gGbCtKuCiX0Ih3uhTOx1o6155E0Xq9ntzMOtFmEWFgG21sFS0WboKWEly6sgUdCicYd8d7PfV+MWM8+vT+XZjnhVTWCVXiQnBbFczFqnYWi1BDA8oR17WAG9BKllOcoxaXUBf0rXK4Vyj7JZJyZa7Qf3Au6JSnjJ49f3Zql3pN9OVnHFdQZ1aw9feVqB+D3a90rQ0xBY05JYiZM7SXaPMY+dXtUhSUTTgLH57kjPOMx8G/Fh0YciUwKAstYuV06UP61rmoLdyMxcnf6wpCTzKMV7LxrIl1gGLh5LYFqHwpbJ955Tp/CMbxUMAL19VA3FKWXxRYxJ+OnPrCG1lV0J+l4ANyAeoKiWhjUXvmZ+mYH37NhiO34b7ecd97zUOz98elGrkhs+AxCwNncTDTYJJg0i0S+KrCOm3/XdBWGDxuGKjs+0+jQexfZBcbaaevt6rNhupIaTY9SGnmhWZeZnYr8mNJiqfncUXdz5cMZcBdf//2e9z+QSqFcWClUKPH7VXf8TP57G8g/5jc94PE+ApG/M59fYcfpsGD+OW5Bxjz3CP0dpuj0ofCWGptKks2IQ2E5OC/19uQc9H/KA2z7M2Od0FlB0LVdbeEymh1y3XUdIt2OqA95Em6rxw8nXo9Uv7ziZ4kA5I0z1iSJQ+mzaFH/F5kZ6ZcygYqELtoUdinQhvz8HOcHHm0vfk32J53mJFltcv16Y6sTxm4+Dxwjf+ZM3tupG12qfInpJqFxByo5tlfSVWB2+7zQ18eZ9X0f1a9D8uvK1H5N7Bhqx9v6mOm/MCLyv7UmCV5/znKeHrMk5g/FKDHuGzcedXoG8N9ogvmOt4GvO/tg8yyYI6COQ4m33szkU1by1K630trV2aOV+W7XpWHrl2Vk8NURr87X5YnR3967G8DP9FFhf/pu100uutHN38snP0AUEsHCArjiZZLAwAAABEAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAAFgAAAGdlb2dlYnJhX2phdmFzY3JpcHQuanNLK81LLsnMz1NIT0/yz/PMyyzR0FSorgUAUEsHCNY3vbkZAAAAFwAAAFBLAwQUAAgICACgcylSAAAAAAAAAAAAAAAADAAAAGdlb2dlYnJhLnhtbO1b7Y/cxBn/DH/FyJVQUrK7nvE77AXtXdKClKQRl1aID1Re27fnxmsvtvdu95QPtKKCkFAqoUJAES8ilFA1CLU0DSjwgT8F3d6ln/gX+jwzttfe3cvt3h0QaE+3N563Z2Z+zzO/55lZX/OJQTcgG16c+FG4JNG6LBEvdCLXDztLUj9dq5nSEycfbna8qOO1Y5usRXHXTpckDVsW/SBX15mMZXavtyQ5gZ0kviORXmCn2GVJitbWAj/0JOK7S9KyohsrmrpSU1ZWaE21WqzWOtVSakz5xTI9faqltuRTEiGDxH8sjM7ZXS/p2Y636qx7XftM5NgpH3U9TXuPNRqbm5v1fH71KO40YApJY5C4jU6nXYdUIrDIMFmSsofHQG6l96bC+zFZpo1nzp4R49T8MEnt0IEpIwB9/+TDDzU3/dCNNsmm76brABdTDImse35nHSAxmC6RBrbqAS49z0n9DS+BvqUsX33a7Um8mR1i/UPiiQTFwiTi+hu+68VLklxnFtNVRbWYwmTKLFUiUex7YZq1pdmYjVxac8P3NoVYfOIjQqc0ioK2jRLJpUuEyUwmJzChImGiVBZZWREJE4kqEk20UUVPVTRVRRtVtFEVsAo/8duBtySt2UGCCg/XYlBhkU/SYeDxqWQF44XTE7CcxN+CxooMxiTghnJZPoEfHT4qVjSq6zNL66O4iEuE4ux5ohCcN+Xzx0TNsrrIGjyhclZqilILs/ohF6McaDGqbBmLDJzG/b1AVOmMcQ34aNr0uLQ0qJC5wGLHS9XZ/EtlhwK4GJOh6NRuL0mtM788vfx0a3oGTJs9A3pIHc/UMIzFf/lnakhloVVPafcAI+qV/X80C9b2Mml9FsrMPJpRVXPuRRvyTNITKc3So1GFNb8qNMqq0yKUaEBYGqEWMKiObMQI1YgKJSaUGETBMo2qRCHYhCqEk63KiUuHGqyGv7CnCUVShoURIHRYJEMe1zSiQTMD+yIl6haXJ8MHW8OM4KNgmaLAh5cpKnyQ2TUQpAkxMA9N0fmTxv8iVWowioawEl4FZaoFw2GBZlCiwEwgb8gE5Co4COWrAR+Cv5QI92EQZhIulcuX2WGoaLxDmLEPFTUbubNsZjohyTq2zgZNvW6CWjIUorNCVzpCmSnMYMTQiKGX1HYCFadrY92h5syK7jSzqkAdCw1uDYAUYi80ydRcmScydV6aUifgro6hhwmiKEoIGAzRUUWZDmAWrNAC01ARTCegKY0RHW1oD4VAEBclfgHtuhf0CtA5hn7Y66cV3Jyumz+mEbS2Ax6cZe3dyLm4XCCdSfLsJC2LhXhmHDWJ+KYSVD3UDOy2BxFlZxUtgZANO0CPwEdYi8KUZEYABM/LnChMzsdRuhIF/W6YEOJEgVxMOApo6ZkVM4GMUqpQyxVaqUIvPRt5o8q4EdSQfuLB+FGcFHJs130Km4wNG1D5VRgMl2PPvtiL/DBNSvKaDR6INr2+E/iub4e/AfvNg75z/W7biwl/jFBZfAIIA8kjVu6d84BVN1g+xyh2V4cJmDsZPOvF0JnVIdY0dNjelqrLCt+SQ1GlmUqdGha1TMMygRE0mLRj41ZVlbpqapasWVTWmaFh1XB2HbgkPrS3seqlKagxIfbAG8PQiZEtS5mnkuUoGBdxZFbsXtqP+VEFYoEYV9UKO4HHTYJ7OojknYvtaLAq4gRdyLow7HmFsbQ7XCUEqIRpMOFOlrZFytvg1IpWMm8j8xayqEehRT21GG/B07ZIeSs8/whrFUul+TLlfBQ/ISJf3Rzc1PFY0A/99EyeSX3nYrZSKjoIA0gyW6zKpEcls9mYML65jJHNMEatbIymfB9jtGhhfaoFh83SDx1bn1W3yj+mPrY+Td7D3MSu/V+wNnlfa8vim6M0tkOKnLa1Xhy17bYf+OlwxQ6cfmCnUcy9ip+ksd/uo6MiKYccFuYnK/0uNgKvMdamjaFEykeCoEDKvBgUgBMh3cgVfQNcQA1dHqg6o9NmgufuBKaOGgrQHcFwMCnHc/sx9Hv27OnWud9eOL16QSJdzwafec4+B6tzs4e8wIn6YZo9YztWNMyfiiLetCjtB8GTw16WC7wNxFKuWxoegHx47oeutwaqd8G3OJVlI8KnB+hCPbdSeMpfW6sUPB1tnvdixwvTSjGseLLYEd4UNph0sgkV8VA4Yo7V//M/bL4xy1hPQiQ1ew81szAtZ3HcCEIazZk5COxe4rmiVBaDVHo1L3px6AXYGmKdRDklmo4pAmIdoN9+1E9ETSlSgg7n7XS9FbpPex2Y6flim04KcT3H70JHUZ7xnY1c/GsgGFHqep3Yy3lJTFGwYRYokqQHEZabrHteWnCi8D3jZtkS80U1UxuOJPws1/VhJ9eAcrv2gN9jgL/qFSThxH4PvQxpw7HkYmm7AUuhCLcc0lUoTjm1hw+syRB0GYqhQfRELVnRLVUtnCJU6rKhUAisTMVSDVUH2trK6midalTTmMosxTRkwyo8pq7VFUuHOE5VoVo3odOAuzRYCAjfyp5ruvl9eM8pX/lj8FAlkezIROKtuVcJ1+aOHcCUej20PNhNFfIeZ8SxKBspjn6XObHcZ067XbRJfo6BGWZt/RRXAC6mn65HMb+xhilDivYceF2gokxg2O96MX4VkOFh86tv2F39bI+p9cy6cJYkauN8JjAcIwPVe0RGxA566zb6QppHhqolU6rTPB6yhxiPFts6O0GenWS5JMCb93yDy/kOxxHaCbi71Ft1gFnC8fcQYq5ZUMvvIgcYz8LuBKF437PmD0ocAID5W0CDBadx/bQER5UXO47g0nUwm9BL8NCA11p5eIMPT/qu64XF9O0QqJErCU7LnrD0oj0Y1pBvwdKBMlPXvoprTypOq7OfsuIM5SeiOGdScTX209ScYXLNMUX/8WhuAFFIgl+i5sCvSQQKl6QtskSO2eTnZPDcMXb8OHmUHGtDbljkjjlYeRzLjufjPd+3Xa76xpRVFFXFOHMYAPE28MvDKTtglHJLUA1uCpgUtqCr/PRt6FQzqcronKaQlXK9TcZ7M7Wi3V8pnt/xwg1YVwTxIxnIODVDNwwNNjbYqKkxA6+0ZDFl2YCgSbGYqkEbkLwlc7kDKmKraj3GXXS2vC0q+jGeDEWyxfg369WfbIuA4cT+gLRgvBp6QtLCIZFaSUv0bikiUVEIwN7SRF4XiSESUyQWTisLBbznQwFaIuINiAji/e0v9QYpy2zwkef7Ufr49hdXd/7+/uidK7vvfvyfa//69u7bolyaNjLsLFUl3d/K8ttfNDN5br5ZzKRmcwgShqJwwlAUeT5clAou4i9uRYc0CMNNKYq+fo/w36JBu6jKkJuxP6egUx5o6OBIIbAz6f7YdTLcOseAr4DWjg1IjdhIXfypDYRWIw4yGwCpzkJnrR/yyFMai5xCp3qxeV/+EuBQ+ZDwHAVZkahnO3ASx4jDnM8M6WwztKcMsGyDk0a6gCXS+S3R/AEMkWWbeA5DXM+QG4IVFk6dv5Y0DYN4W6noeHhz+y6MjV8UJIhDFrWCtxnLOaQlzudCnKjbtUOXhPzr2afwGjUBgKTxV4O2zCnAplwBNit8dNRP8/qWEJsJm1IGv0IowG4dShu6ydWBSVskB1PIGHulbprU0nWIA5gmU1njusAwG1+M0mXVgmKFKl4NXzfZGp++cVX4ZUF2Ei6XTl1CHQ5xNoX48iKILz9giOt1CLlkRbFM01At0/qOEZ/Nw+oe4cDgWOv4gYhWfbCJVkRLqqLOB4+2JzzLB4NHe5DhYVTO4FHmg0evwDP68KXR3T+MXrg7f2ytP9ABoqJlcMzhlnE1RgWOlSh0+Tsn5/rd+RExfhSImPsR+toEk4PIjFMe6cAWElnYQ4Lgi1pB9OPaScLv3p/wJ6+NupPXRtOce7j7oQMh8M3lGwcGIFwMgHASgGk3f3QAzN4U5h4U2oVYPjwQh5oP9BZhNNsjhj4fQFaVRL98ffvOje07fyvYdPTnqzu3Pth58/a3d6+K6wvIjj55G7I71y/vXH9h9OlrSLo/G9iPOznnkFC8u3Lv9itQDX+377wqJPJ2Qs7u2y9i9xsfjV67Nrr6xu6fXhLNeRN8/OTznWuvb9/FytFXb45e/rQYbTyXFz6699lNaLx7858wqfmJzlpci+PV8TfMsl64bwSrLKBs4g5hn/pOXM50yhnRwUFBq/ifG0fJoiq3EE2dM0hDt7yfidz77N2yiUC2YiKg4z1MZA8L2VP9XNLh1Q9rmvvydh/1L4P6g8XUP6lIekBF0gUVSScVKVAsFInagr1+/fKEOnf+8T5WvfP7haIrusCtx/1B5s4J7+p53PtDoc0ytOe9Y6reAX/93taSTQbPsUfbZAh/HTIgwwXA/J7uge8Ljp+csS94z0xeofCXhRPw/GuVr8jPll4kl6X8AmT/U5IqjgHMmhNnZfZd+84bn+/evLLQXTv9nm6MD7ff1XmBUSe3+5ixb10bXb8piz0+RqzqjbfvfLHz5nu7H/+bM/LOrRvQ/N6VD0d/vL395Vu7lz8ffYV8gK1ufQBiRi+/Bc+jV18R8YFgDt61NMBlkLjzl0/Be5R9+ei1V7c/v7L9xV93X7y9gLYWOOwvwi/fXH73O6OXJLXj9DxelvAbx7ohwzFA1gxNN5hmUaFg/L6M6oZuWYahyAwCZmV8A1PWe6P8Sgl/tT37J86T/wVQSwcI1k8N1cYNAACWOgAAUEsBAhQAFAAICAgAoHMpUo//M80IBQAALiYAABcAAAAAAAAAAAAAAAAAAAAAAGdlb2dlYnJhX2RlZmF1bHRzMmQueG1sUEsBAhQAFAAICAgAoHMpUgrjiZZLAwAAABEAABcAAAAAAAAAAAAAAAAATQUAAGdlb2dlYnJhX2RlZmF1bHRzM2QueG1sUEsBAhQAFAAICAgAoHMpUtY3vbkZAAAAFwAAABYAAAAAAAAAAAAAAAAA3QgAAGdlb2dlYnJhX2phdmFzY3JpcHQuanNQSwECFAAUAAgICACgcylS1k8N1cYNAACWOgAADAAAAAAAAAAAAAAAAAA6CQAAZ2VvZ2VicmEueG1sUEsFBgAAAAAEAAQACAEAADoXAAAAAA==",    
};
// is3D=is 3D applet using 3D view, AV=Algebra View, SV=Spreadsheet View, CV=CAS View, EV2=Graphics View 2, CP=Construction Protocol, PC=Probability Calculator DA=Data Analysis, FI=Function Inspector, macro=Macros
var views = {'is3D': 1,'AV': 0,'SV': 0,'CV': 0,'EV2': 0,'CP': 0,'PC': 0,'DA': 0,'FI': 0,'macro': 0};
var applet = new GGBApplet(parameters, '5.0', views);
window.onload = function() {applet.inject('ggbApplet')};
applet.setPreviewImage('data:image/gif;base64,R0lGODlhAQABAAAAADs=','https://www.geogebra.org/images/GeoGebra_loading.png','https://www.geogebra.org/images/applet_play.png');
</script>



<div id="ggbApplet"></div>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 2 - 二次型参数确定</title>
    <url>/2020/12/12/machine_learning/conjugate-gradient-algorithm/quadratic_cofficient/quadratic_cofficient/</url>
    <content><![CDATA[<blockquote>
<p>本文属于二次型优化问题系列文章，主要介绍二次型参数的定义由来。</p>
</blockquote>
<a id="more"></a>

<h3 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h3><ul>
<li>需要优化的函数二次型的形式：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{x^TAx} } - { {\bf{b} }^{\bf{T} } }{\bf{x} } + {\bf{c} } \tag{1} \label{eq1}<br>$$</p>
<ul>
<li>而原始n元多项式为：</li>
</ul>
<p>$$<br>f({x_1},{x_2},{x_3},…,{x_n}) = {a_{1,1}}x_1^2 + {a_{1,2}}{x_1}{x_2} + {a_{1,3}}{x_1}{x_3} +  \cdots  + {a_{1,n}}{x_1}{x_n} + {a_{2,1}}x_2{x_1} + {a_{2,2}}{x_2^2} + {a_{2,3}}{x_2}{x_3} +  \cdots  + {a_{2,n}}{x_2}{x_n} +  \cdots  + {a_{n,n}}x_n^2+{b_1}x_1+{b_2}x_2+\cdots+{b_n}x_n+c<br>$$</p>
<ul>
<li>其中，表示$\bf{A}$：</li>
</ul>
<p>$$<br>A = \left[ {\begin{array}{*{20}{c}}<br>{a_{1,1}^ \bullet }&amp; \cdots &amp;{a_{n,n}^ \bullet }<br>\end{array}} \right] \tag{3} \label{eq3}<br>$$</p>
<ul>
<li>将$\bf{A}$与多项式系数对应：</li>
</ul>
<p>$$<br>a_{i,i}^ \bullet  = {a_{i,i}},1 \le i \le n\ \tag{4}<br>$$</p>
<p>$$<br>a_{i,j}^ \bullet  + a_{j,i}^ \bullet  = {a_{i,j}},1 \le i &lt; j \le n\ \tag{5} \label{eq5}<br>$$</p>
<p>$$<br>{a_{i,j}} = 0,1 \le j &lt; i \le n \tag{6}<br>$$</p>
<ul>
<li>那么对应$\bf{A}$中非对角线的元素，仅需要保证公式$\eqref{eq5}$成立即可，那么对于不相等的$i,j$，可以有无数种$a_{i,j}^ \bullet  + a_{j,i}^ \bullet$的组合满足条件，$\bf{A}$该如何确定？</li>
</ul>
<h3 id="二次型矩阵"><a href="#二次型矩阵" class="headerlink" title="二次型矩阵"></a>二次型矩阵</h3><ul>
<li>在定义实数空间内的二次型时，二次型矩阵被要求为对称的，也就是要求：</li>
</ul>
<p>$$<br>a_{i,j}^ \bullet  = a_{j,i}^ \bullet  = \frac{1}{2}{a_{i,j}},1 \le i &lt; j \le n \tag{7}<br>$$</p>
<ul>
<li>也就确定了唯一的$\bf{A}$，来表示一个确定的多元二次函数。</li>
</ul>
<h3 id="为何如此"><a href="#为何如此" class="headerlink" title="为何如此"></a>为何如此</h3><ul>
<li>定义的用处就是来确定问题，这种定义可以唯一确定二次函数，没有任何歧义和变化，用于统一数学术语</li>
<li>我觉得很关键的问题是如此定义$\bf{A}$会给求导带来很大方便</li>
<li>我们略去一次项与常数项，得到纯粹的二次型：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{xAx} } \tag{8} \label{eqq8}<br>$$</p>
<ul>
<li>即：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}\sum\limits_{i,j = 1}^n {a_{i,j}^ \bullet } {x_i}{x_j} \tag{9}<br>$$</p>
<ul>
<li>仍用$\eqref{eq3}$表示$\bf{A}$，对$\eqref{eqq8}$中的向量$\bf{x}$求导：</li>
</ul>
<p>$$<br>f’({x_i}) = \frac{1}{2}[\sum\limits_{j = 1,j \ne i}^n {(a_{i,j}^ \bullet  + a_{j,i}^ \bullet )} {x_j} + 2a_{i,i}^ \bullet {x_i}] \tag{10}<br>$$</p>
<ul>
<li>如果$\bf{A}$是对称阵，那么$a_{i,j}^ \bullet  = a_{j,i}^ \bullet $，有：</li>
</ul>
<p>$$<br>f’({x_i}) = \frac{1}{2}\sum\limits_{j = 1}^n {a_{i,j}^ \bullet } {x_j} \tag{11}<br>$$</p>
<p>$$<br>f’(\bf{x}) = \bf{Ax} \tag{12}<br>$$</p>
<ul>
<li>也就是说定义$\bf{A}$为对称阵可以唯一确定二次型矩阵，也可以方便地对二次型进行求导。</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 添加开机启动应用</title>
    <url>/2020/12/12/windows/win-add-startup/win-add-startup/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Windows添加开启启动项的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="打开配置"><a href="#打开配置" class="headerlink" title="打开配置"></a>打开配置</h3><ul>
<li>按下 <code>win + R</code> 调出运行命令，在运行中输入 <code>shell:startup</code></li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20201212112610.png"></p>
<ul>
<li>按下<code>确定</code>后进入<code>启动文件夹</code></li>
</ul>
<h3 id="添加应用"><a href="#添加应用" class="headerlink" title="添加应用"></a>添加应用</h3><ul>
<li>将需要开机启动的应用快捷方式放入到<code>启动文件夹</code>中：</li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20201212113054.png"></p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><ul>
<li>可以重启电脑查看是否应用已经重启</li>
</ul>
<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><ul>
<li>打开任务管理器，进入<code>启动</code>选项卡，查看我们刚刚加入的应用是否在项目中：</li>
</ul>
<p><img src="https://photos.zywvvd.com/icey-mate-book/20201212113357.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>科学上网初级教程</title>
    <url>/2020/12/04/internet/scientific-online/</url>
    <content><![CDATA[<blockquote>
<p>本文记录初次科学上网的服务器搭建过程。</p>
</blockquote>
<a id="more"></a>

<h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><pre class="mermaid">graph LR

    subgraph 本地 
    链接并配置远程服务器-->下载客户端-->按照当前客户端类型配置本地客户端-->填入配置信息-->开启科学上网服务
    end
    subgraph 服务器
    购买服务器-->登录服务器-->安装V2Ray-->获取配置信息-->开启v2ray服务
    end</pre>

<h3 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h3><h4 id="购买服务器"><a href="#购买服务器" class="headerlink" title="购买服务器"></a>购买服务器</h4><blockquote>
<p>参考：<a href="https://tlanyan.me/vps-merchant-collection/" target="_blank" rel="noopener">https://tlanyan.me/vps-merchant-collection/</a></p>
<p>列出推荐的几个：</p>
</blockquote>
<table>
<thead>
<tr>
<th>链接</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://bwh88.net/aff.php?aff=55490&gid=1" target="_blank" rel="noopener"><strong>BandwagonHost</strong></a></td>
<td>俗称<strong>搬瓦工</strong>，可能是最广为人知的境外**<del>廉价</del>VPS<strong>服务商。VPS线路针对中国网络特别优化，网速很给力，</strong>支持支付宝**。</td>
</tr>
<tr>
<td><a href="https://www.akkocloud.com/aff.php?aff=122&gid=7" target="_blank" rel="noopener"><strong>AkkoCloud</strong></a></td>
<td>国人稳定vps商家，服务类型众多，包括国内NAT/VDS/独服、美西、德国CN2 GIA VPS，MC面板等。速度很给力，价格也实惠</td>
</tr>
<tr>
<td><a href="https://www.vultr.com/?ref=8375822-6G" target="_blank" rel="noopener"><strong>Vultr</strong></a></td>
<td><a href="https://bwh88.net/aff.php?aff=55490&gid=1" target="_blank" rel="noopener">搬瓦工</a> 和 <a href="https://manage.hostdare.com/aff.php?aff=2122" target="_blank" rel="noopener">HostDare</a> 是典型的包年包月类型，无法做到按需付费，并且更换ip需要付费。Vultr是灵活计费vps的代表，全球十多个数据中心，<strong>VPS按小时计费，可随时销毁停止计费、免费更换ip和机房，支持支付宝</strong>。官网：<a href="https://www.vultr.com/?ref=8375822-6G" target="_blank" rel="noopener">https://www.vultr.com</a></td>
</tr>
<tr>
<td><a href="https://www.linode.com/?r=4459a4f56be13978ca0d156d0d0eaf6d9bc82853" target="_blank" rel="noopener"><strong>Linode</strong></a></td>
<td>老牌美国云计算商家，VPS按小时计费，随时可以删除主机退回账户。自有面板，以高品质、稳定深受中国站长推崇。最低月费用5美元，<strong>必须绑定信用</strong>才能完成账号注册。官网：<a href="https://www.linode.com/?r=4459a4f56be13978ca0d156d0d0eaf6d9bc82853" target="_blank" rel="noopener">https://www.linode.com</a>。</td>
</tr>
</tbody></table>
<blockquote>
<p>我使用的时 Vultr 在芝加哥的 ubuntu 18.04 服务器，价格合理，灵活消费，速度也可以接受。</p>
</blockquote>
<h4 id="链接服务器"><a href="#链接服务器" class="headerlink" title="链接服务器"></a>链接服务器</h4><blockquote>
<p>随便打开一个终端使用ssh链接，在服务器管理界面中获取ip与密码：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201204204502.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh root@your_ip</span><br><span class="line">-&gt;</span><br><span class="line">enter password</span><br></pre></td></tr></table></figure>

<h4 id="安装V2Ray并获取配置信息"><a href="#安装V2Ray并获取配置信息" class="headerlink" title="安装V2Ray并获取配置信息"></a>安装V2Ray并获取配置信息</h4><blockquote>
<p>参考：<a href="https://tlanyan.me/v2ray-tutorial/" target="_blank" rel="noopener">https://tlanyan.me/v2ray-tutorial/</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash &lt;(curl -sL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;hijkpw&#x2F;scripts&#x2F;master&#x2F;goV2.sh)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装完成后，配置文件为<code>/etc/v2ray/config.json</code>，cat命令可查看内容：<code>cat /etc/v2ray/config.json</code>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;inbounds&quot;: [&#123;</span><br><span class="line">    &quot;port&quot;: 23581,</span><br><span class="line">    &quot;protocol&quot;: &quot;vmess&quot;,</span><br><span class="line">    &quot;settings&quot;: &#123;</span><br><span class="line">      &quot;clients&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;id&quot;: &quot;ceb793e6-49cf-25d8-e4de-ae542e62748e&quot;,</span><br><span class="line">          &quot;level&quot;: 1,</span><br><span class="line">          &quot;alterId&quot;: 64</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;],</span><br><span class="line">  &quot;outbounds&quot;: [&#123;</span><br><span class="line">    &quot;protocol&quot;: &quot;freedom&quot;,</span><br><span class="line">    &quot;settings&quot;: &#123;&#125;</span><br><span class="line">  &#125;,&#123;</span><br><span class="line">    &quot;protocol&quot;: &quot;blackhole&quot;,</span><br><span class="line">    &quot;settings&quot;: &#123;&#125;,</span><br><span class="line">    &quot;tag&quot;: &quot;blocked&quot;</span><br><span class="line">  &#125;],</span><br><span class="line">  &quot;routing&quot;: &#123;</span><br><span class="line">    &quot;rules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">        &quot;ip&quot;: [&quot;geoip:private&quot;],</span><br><span class="line">        &quot;outboundTag&quot;: &quot;blocked&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>记录：port（<code>端口</code>）和clients中的id（<code>用户id</code>）</p>
</blockquote>
<h4 id="开启v2ray服务"><a href="#开启v2ray服务" class="headerlink" title="开启v2ray服务"></a>开启v2ray服务</h4><blockquote>
<p>配置文件无需任何改动即可正常使用。接下来防火墙放行监听的端口，设置开机启动并运行<code>V2Ray</code>：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># firewalld放行端口（适用于CentOS7&#x2F;8）</span><br><span class="line">firewall-cmd --permanent --add-port&#x3D;23581&#x2F;tcp # 23581改成你配置文件中的端口号</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"># ufw放行端口（适用于ubuntu）</span><br><span class="line">ufw allow 23581&#x2F;tcp # 23581改成你的端口号</span><br><span class="line"># iptables 放行端口（适用于CentOS 6&#x2F;7）</span><br><span class="line">iptables -I INPUT -p tcp --dport 23581 -j ACCEPT</span><br><span class="line"># 设置开机启动</span><br><span class="line">systemctl enable v2ray</span><br><span class="line"># 运行v2ray</span><br><span class="line">systemctl start v2ray</span><br></pre></td></tr></table></figure>

<p><code>ss -ntlp | grep v2ray</code> 命令可以查看v2ray是否正在运行。如果输出为空，大概率是被selinux限制了，解决办法如下：</p>
<ol>
<li><p>禁用selinux：<code>setenforce 0</code>;</p>
</li>
<li><p>重启v2ray：<code>systemctl restart v2ray</code></p>
</li>
</ol>
<blockquote>
<p>服务端配置完成。</p>
</blockquote>
<h3 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h3><h4 id="下载客户端"><a href="#下载客户端" class="headerlink" title="下载客户端"></a>下载客户端</h4><ul>
<li>客户端下载的选择有很多，可以选择合适自己的版本 <a href="https://tlanyan.me/v2ray-clients-download/" target="_blank" rel="noopener">https://tlanyan.me/v2ray-clients-download/</a></li>
<li>我使用了 <a href="https://tlanyan.me/download.php?filename=/v2/windows/v2rayN-v3.28.zip" target="_blank" rel="noopener">v2rayN-v3.28.zip</a></li>
</ul>
<h4 id="按照当前客户端类型配置本地客户端"><a href="#按照当前客户端类型配置本地客户端" class="headerlink" title="按照当前客户端类型配置本地客户端"></a>按照当前客户端类型配置本地客户端</h4><ul>
<li>根据自己的客户端类型配置，这里给出V2rayN的配置方法</li>
</ul>
<blockquote>
<p>参考：<a href="https://v2xtls.org/v2rayn%e9%85%8d%e7%bd%ae%e6%95%99%e7%a8%8b/" target="_blank" rel="noopener">https://v2xtls.org/v2rayn%e9%85%8d%e7%bd%ae%e6%95%99%e7%a8%8b/</a></p>
</blockquote>
<ul>
<li><p>安装客户端：找到下载的安装程序，找一个合适的目录<strong>解压</strong>（<strong>不要</strong>放在C盘的”Program Files”目录下，会有权限问题），<strong>不要双击压缩文件中的v2rayN.exe直接打开！</strong></p>
</li>
<li><p>进入V2rayN-Core目录，双击“V2RayN.exe”，程序启动后<strong>托盘</strong>上会出现一个V图标（托盘就是桌面右下角，显示时间输入法那块）。如果程序没有反应，或提示“V2rayN已停止工作”，请先更新系统并安装 <a href="https://dotnet.microsoft.com/download/dotnet-framework/net472" target="_blank" rel="noopener">.NET Framework 4.7.2</a> 和 <a href="https://www.microsoft.com/en-us/download/details.aspx?id=53840" target="_blank" rel="noopener">Microsoft Visual C++ 2015 Redistributable (x86)</a> 再重新打开；</p>
</li>
<li><p>点击系统托盘的<code>V2RayN</code>图标，弹出程序主界面，选择服务器<code>添加Vmess服务器</code>选项</p>
</li>
</ul>
<h4 id="填入配置信息"><a href="#填入配置信息" class="headerlink" title="填入配置信息"></a>填入配置信息</h4><p><img src="https://photos.zywvvd.com/images_matrixtime/20201204205457.png"></p>
<ul>
<li><p>填入ip 端口 和id（都是刚刚记录过的）</p>
</li>
<li><p>有需求的话可以加入<a href="https://tlanyan.me/v2ray-traffic-mask/" target="_blank" rel="noopener">伪装域名</a></p>
</li>
<li><p>服务器信息配置好后，主界面下方会出现日志信息</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">配置成功</span><br><span class="line">[Vmess] (149***12:xxxxx)</span><br><span class="line">启动服务(2020&#x2F;12&#x2F;4 19:46:18)...</span><br><span class="line">V2Ray 4.31.0 (V2Fly, a community-driven edition of V2Ray.) Custom (go1.15.2 windows&#x2F;386)</span><br><span class="line">A unified platform for anti-censorship.</span><br><span class="line">2020&#x2F;12&#x2F;04 19:46:18 [Info] v2ray.com&#x2F;core&#x2F;common&#x2F;platform&#x2F;ctlcmd: &lt;v2ctl message&gt; </span><br><span class="line">v2ctl&gt; Read config:  E:\Program_Files\v2rayN-Core\config.json</span><br><span class="line">2020&#x2F;12&#x2F;04 19:46:18 [Warning] v2ray.com&#x2F;core: V2Ray 4.31.0 started</span><br></pre></td></tr></table></figure>

<h4 id="测试服务器延迟"><a href="#测试服务器延迟" class="headerlink" title="测试服务器延迟"></a>测试服务器延迟</h4><blockquote>
<p>服务器延迟不是 -1 或 <code>timeout</code> 即说明连接成功</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201204205924.png"></p>
<h4 id="开启科学上网"><a href="#开启科学上网" class="headerlink" title="开启科学上网"></a>开启科学上网</h4><p><img src="https://photos.zywvvd.com/images_matrixtime/20201204210018.png"></p>
<ul>
<li>开启http代理或PAC，随后就是见证奇迹的时刻了</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201204210141.png"></p>
<ul>
<li>have fun ~</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>internet</category>
      </categories>
      <tags>
        <tag>internet</tag>
      </tags>
  </entry>
  <entry>
    <title>Python ImportError libGL.so.1 cannot open shared object file No such file or directory 解决方案</title>
    <url>/2020/12/04/python/import-error/import-error-0/</url>
    <content><![CDATA[<blockquote>
<p>刚装的 linux 环境中使用 python 导入包时可能会报 <code> libGL.so.1: cannot open shared object file</code> 的错误，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><blockquote>
<p>我是在导入 opencv 包时遇到的错误：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> cv2</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"/root/anaconda3/envs/vvd_env/lib/python3.7/site-packages/cv2/__init__.py"</span>, line <span class="number">5</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">from</span> .cv2 <span class="keyword">import</span> *</span><br><span class="line">ImportError: libGL.so<span class="number">.1</span>: cannot open shared object file: No such file <span class="keyword">or</span> directory</span><br></pre></td></tr></table></figure>

<h3 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h3><ul>
<li>缺少 <code>libGL.so.1</code> 库</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>把这个库装上：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install libgl1-mesa-glx</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://stackoverflow.com/questions/63544251/import-cv2-in-sagemaker-studio-jupyter-notebook-throws-importerror-libgl-so-1" target="_blank" rel="noopener">https://stackoverflow.com/questions/63544251/import-cv2-in-sagemaker-studio-jupyter-notebook-throws-importerror-libgl-so-1</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Nvidia docker 安装与使用</title>
    <url>/2020/12/03/docker/nvidia-docker-install/</url>
    <content><![CDATA[<blockquote>
<p>Nvidia docker 是nvidia显卡在docker基础上进行封装得到的docker工具，需要电脑中安装Nvidia显卡驱动与docker，配置好Nvidia docker后docker可以使用GPU。本文记录Nvidia docker的安装与使用方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul>
<li>Linux 16.04 64位操作系统</li>
<li>显卡驱动 450.80.02</li>
<li>CUDA 版本 11.0</li>
<li>docker 安装版本 19.03.4</li>
</ul>
<h4 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h4><ul>
<li>加入包仓库</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -s -L https:&#x2F;&#x2F;nvidia.github.io&#x2F;nvidia-docker&#x2F;gpgkey | \</span><br><span class="line">  sudo apt-key add -</span><br><span class="line">distribution&#x3D;$(. &#x2F;etc&#x2F;os-release;echo $ID$VERSION_ID)</span><br><span class="line">curl -s -L https:&#x2F;&#x2F;nvidia.github.io&#x2F;nvidia-docker&#x2F;$distribution&#x2F;nvidia-docker.list | \</span><br><span class="line">  sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;nvidia-docker.list</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>

<ul>
<li>安装nvidia-docker2 载入docker 配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get install -y nvidia-docker2</span><br><span class="line">sudo pkill -SIGHUP dockerd</span><br></pre></td></tr></table></figure>

<ul>
<li>下载官方测试镜像</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker run --runtime&#x3D;nvidia --rm nvidia&#x2F;cuda:11.0-base nvidia-smi</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时会显示出显卡信息，说明nvidia docker成功创建并在内部正确执行了 <code>nvidia-smi</code> 命令。</p>
</blockquote>
<ul>
<li>查看nvidia-docker安装情况</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt show nvidia-docker2</span></span><br><span class="line"><span class="meta">-&gt;</span></span><br><span class="line">Package: nvidia-docker2</span><br><span class="line">Version: 2.5.0-1</span><br><span class="line">Priority: optional</span><br><span class="line">Section: utils</span><br><span class="line">Maintainer: NVIDIA CORPORATION &lt;cudatools@nvidia.com&gt;</span><br><span class="line">Installed-Size: 27.6 kB</span><br><span class="line">Depends: nvidia-container-runtime (&gt;= 3.4.0), docker-ce (&gt;= 18.06.0~ce~3-0~ubuntu) | docker-ee (&gt;= 18.06.0~ce~3-0~ubuntu) | docker.io (&gt;= 18.06.0)</span><br><span class="line">Breaks: nvidia-docker (&lt;&lt; 2.0.0)</span><br><span class="line">Replaces: nvidia-docker (&lt;&lt; 2.0.0)</span><br><span class="line">Homepage: https://github.com/NVIDIA/nvidia-docker/wiki</span><br><span class="line">Download-Size: 5,840 B</span><br><span class="line">APT-Manual-Installed: yes</span><br><span class="line">APT-Sources: https://nvidia.github.io/nvidia-docker/ubuntu16.04/amd64  Packages</span><br><span class="line">Description: nvidia-docker CLI wrapper</span><br><span class="line"> Replaces nvidia-docker with a new implementation based on</span><br><span class="line"> nvidia-container-runtime</span><br><span class="line"></span><br><span class="line">N: There are 50 additional records. Please use the '-a' switch to see them.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>出现类似信息说明安装成功</p>
</blockquote>
<h3 id="使用nvidia-docker镜像"><a href="#使用nvidia-docker镜像" class="headerlink" title="使用nvidia docker镜像"></a>使用nvidia docker镜像</h3><ul>
<li>之前不是同一个驱动版本下创建的镜像在新驱动下的nvidia docker中可能找不到nvidia-smi命令</li>
<li>为了在新的docker下使用gpu，我迂回地使用测试镜像作为初始镜像</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvidia-docker run -it --name first_container nvidia&#x2F;cuda:11.0-base &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这样便将测试镜像创建出了可以随时访问修改的容器，在该容器基础上保存镜像即可。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker commit -m &quot;nvidia docker image init&quot; first_container my_image:1.0</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://www.cnblogs.com/llfctt/p/10642100.html" target="_blank" rel="noopener">https://www.cnblogs.com/llfctt/p/10642100.html</a></p>
</li>
<li><p><a href="https://www.cnblogs.com/wuchangsoft/p/9767074.html" target="_blank" rel="noopener">https://www.cnblogs.com/wuchangsoft/p/9767074.html</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
        <category>docker</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>在Linux服务器上更换Nvidia驱动</title>
    <url>/2020/12/03/linux/driver/nvidia-driver-install-linux/</url>
    <content><![CDATA[<blockquote>
<p>本文记录在Linux服务器更换Nvidia驱动的流程。</p>
</blockquote>
<a id="more"></a>

<h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><blockquote>
<p>Linux 服务器上的 1080Ti 显卡驱动为387， CUDA 9，比较老旧，需要更换成可以运行pytorch 1.6的环境。</p>
</blockquote>
<h3 id="确定当前显卡型号-操作系统版本-目标环境"><a href="#确定当前显卡型号-操作系统版本-目标环境" class="headerlink" title="确定当前显卡型号\操作系统版本\目标环境"></a>确定当前显卡型号\操作系统版本\目标环境</h3><ul>
<li>查看显卡信息，确定自己的显卡型号：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nvidia-smi</span></span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> lspci  | grep -i vga</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>输出的设备信息并不是我们熟悉的型号，比如我的输出为：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">02:00.0 VGA compatible controller: NVIDIA Corporation Device 1b06 (rev a1)</span><br><span class="line">04:00.0 VGA compatible controller: NVIDIA Corporation Device 1b06 (rev a1)</span><br><span class="line">09:00.0 VGA compatible controller: Matrox Electronics Systems Ltd. G200eR2 (rev 01)</span><br><span class="line">83:00.0 VGA compatible controller: NVIDIA Corporation Device 1b06 (rev a1)</span><br><span class="line">84:00.0 VGA compatible controller: NVIDIA Corporation Device 1b06 (rev a1)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中 <code>Device 1b06</code> 即为 1080Ti</p>
<p>可以进一步查看左边编号下的显卡信息</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> lspci -v -s 02:00.0</span></span><br><span class="line"><span class="meta">-&gt;</span></span><br><span class="line">02:00.0 VGA compatible controller: NVIDIA Corporation Device 1b06 (rev a1) (prog-if 00 [VGA controller])</span><br><span class="line">	Subsystem: Gigabyte Technology Co., Ltd Device 376b</span><br><span class="line">	Flags: bus master, fast devsel, latency 0, IRQ 83</span><br><span class="line">	Memory at 91000000 (32-bit, non-prefetchable) [size=16M]</span><br><span class="line">	Memory at 3bfe0000000 (64-bit, prefetchable) [size=256M]</span><br><span class="line">	Memory at 3bff0000000 (64-bit, prefetchable) [size=32M]</span><br><span class="line">	I/O ports at 2000 [size=128]</span><br><span class="line">	[virtual] Expansion ROM at 92080000 [disabled] [size=512K]</span><br><span class="line">	Capabilities: &lt;access denied&gt;</span><br><span class="line">	Kernel driver in use: nvidia</span><br><span class="line">	Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia</span><br></pre></td></tr></table></figure>

<ul>
<li>查看系统信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> lsb_release -a</span></span><br><span class="line"><span class="meta">-&gt;</span></span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID:	Ubuntu</span><br><span class="line">Description:	Ubuntu 16.04.5 LTS</span><br><span class="line">Release:	16.04</span><br><span class="line">Codename:	xenial</span><br></pre></td></tr></table></figure>

<ul>
<li>查看系统位数</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> file /bin/ls</span></span><br><span class="line"><span class="meta">-&gt;</span></span><br><span class="line">/bin/ls: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=d0bc0fb9b3f60f72bbad3c5a1d24c9e2a1fde775, stripped</span><br></pre></td></tr></table></figure>

<ul>
<li>确定需求的Cuda版本</li>
</ul>
<blockquote>
<p>比如 tensorflow-gpu 的各个版本对Cuda 和 cuDNN 都有自己的要求：</p>
<p><a href="https://tensorflow.google.cn/install/source#linux" target="_blank" rel="noopener">https://tensorflow.google.cn/install/source#linux</a></p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">Version</th>
<th align="left">Python version</th>
<th align="left">Compiler</th>
<th align="left">Build tools</th>
<th align="left">cuDNN</th>
<th align="left">CUDA</th>
</tr>
</thead>
<tbody><tr>
<td align="left">tensorflow-2.3.0</td>
<td align="left">3.5-3.8</td>
<td align="left">GCC 7.3.1</td>
<td align="left">Bazel 3.1.0</td>
<td align="left">7.6</td>
<td align="left">10.1</td>
</tr>
<tr>
<td align="left">tensorflow-2.2.0</td>
<td align="left">3.5-3.8</td>
<td align="left">GCC 7.3.1</td>
<td align="left">Bazel 2.0.0</td>
<td align="left">7.6</td>
<td align="left">10.1</td>
</tr>
<tr>
<td align="left">tensorflow-2.1.0</td>
<td align="left">2.7, 3.5-3.7</td>
<td align="left">GCC 7.3.1</td>
<td align="left">Bazel 0.27.1</td>
<td align="left">7.6</td>
<td align="left">10.1</td>
</tr>
<tr>
<td align="left">tensorflow-2.0.0</td>
<td align="left">2.7, 3.3-3.7</td>
<td align="left">GCC 7.3.1</td>
<td align="left">Bazel 0.26.1</td>
<td align="left">7.4</td>
<td align="left">10.0</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.15.0</td>
<td align="left">2.7, 3.3-3.7</td>
<td align="left">GCC 7.3.1</td>
<td align="left">Bazel 0.26.1</td>
<td align="left">7.4</td>
<td align="left">10.0</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.14.0</td>
<td align="left">2.7, 3.3-3.7</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.24.1</td>
<td align="left">7.4</td>
<td align="left">10.0</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.13.1</td>
<td align="left">2.7, 3.3-3.7</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.19.2</td>
<td align="left">7.4</td>
<td align="left">10.0</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.12.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.15.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.11.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.15.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.10.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.15.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.9.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.11.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.8.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.10.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.7.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.9.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.6.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.9.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.5.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.8.0</td>
<td align="left">7</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.4.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.5.4</td>
<td align="left">6</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.3.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.4.5</td>
<td align="left">6</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.2.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.4.5</td>
<td align="left">5.1</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.1.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.4.2</td>
<td align="left">5.1</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">tensorflow_gpu-1.0.0</td>
<td align="left">2.7, 3.3-3.6</td>
<td align="left">GCC 4.8</td>
<td align="left">Bazel 0.4.2</td>
<td align="left">5.1</td>
<td align="left">8</td>
</tr>
</tbody></table>
<blockquote>
<p>pytorch 同样有各个版本对Cuda的要求:</p>
<p><a href="https://pytorch.org/get-started/previous-versions/" target="_blank" rel="noopener">https://pytorch.org/get-started/previous-versions/</a></p>
</blockquote>
<ul>
<li>我们需要安装pytorch1.6的环境,因此需要10.2 以上的Cuda版本.</li>
<li>确定安装的驱动版本:</li>
</ul>
<blockquote>
<p><a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html#cuda-major-component-versions" target="_blank" rel="noopener">https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html#cuda-major-component-versions</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>CUDA Toolkit</th>
<th>Linux x86_64 Driver Version</th>
<th>Windows x86_64 Driver Version</th>
</tr>
</thead>
<tbody><tr>
<td>CUDA 11.1.1 Update 1</td>
<td>&gt;=455.32</td>
<td>&gt;=456.81</td>
</tr>
<tr>
<td>CUDA 11.1 GA</td>
<td>&gt;=455.23</td>
<td>&gt;=456.38</td>
</tr>
<tr>
<td>CUDA 11.0.3 Update 1</td>
<td>&gt;= 450.51.06</td>
<td>&gt;= 451.82</td>
</tr>
<tr>
<td>CUDA 11.0.2 GA</td>
<td>&gt;= 450.51.05</td>
<td>&gt;= 451.48</td>
</tr>
<tr>
<td>CUDA 11.0.1 RC</td>
<td>&gt;= 450.36.06</td>
<td>&gt;= 451.22</td>
</tr>
<tr>
<td>CUDA 10.2.89</td>
<td>&gt;= 440.33</td>
<td>&gt;= 441.22</td>
</tr>
<tr>
<td>CUDA 10.1 (10.1.105 general release, and updates)</td>
<td>&gt;= 418.39</td>
<td>&gt;= 418.96</td>
</tr>
<tr>
<td>CUDA 10.0.130</td>
<td>&gt;= 410.48</td>
<td>&gt;= 411.31</td>
</tr>
<tr>
<td>CUDA 9.2 (9.2.148 Update 1)</td>
<td>&gt;= 396.37</td>
<td>&gt;= 398.26</td>
</tr>
<tr>
<td>CUDA 9.2 (9.2.88)</td>
<td>&gt;= 396.26</td>
<td>&gt;= 397.44</td>
</tr>
<tr>
<td>CUDA 9.1 (9.1.85)</td>
<td>&gt;= 390.46</td>
<td>&gt;= 391.29</td>
</tr>
<tr>
<td>CUDA 9.0 (9.0.76)</td>
<td>&gt;= 384.81</td>
<td>&gt;= 385.54</td>
</tr>
<tr>
<td>CUDA 8.0 (8.0.61 GA2)</td>
<td>&gt;= 375.26</td>
<td>&gt;= 376.51</td>
</tr>
<tr>
<td>CUDA 8.0 (8.0.44)</td>
<td>&gt;= 367.48</td>
<td>&gt;= 369.30</td>
</tr>
<tr>
<td>CUDA 7.5 (7.5.16)</td>
<td>&gt;= 352.31</td>
<td>&gt;= 353.66</td>
</tr>
<tr>
<td>CUDA 7.0 (7.0.28)</td>
<td>&gt;= 346.46</td>
<td>&gt;= 347.62</td>
</tr>
</tbody></table>
<blockquote>
<p>此时我们已经确定了当前环境为 64位 Ubuntu 16.04，显卡 1080Ti</p>
<p>目标 Cuda 10.2 以上,因此需要驱动版本 &gt;= 440.33</p>
</blockquote>
<h3 id="下载驱动"><a href="#下载驱动" class="headerlink" title="下载驱动"></a>下载驱动</h3><ul>
<li>官网下载 <a href="https://www.nvidia.cn/geforce/drivers/" target="_blank" rel="noopener">https://www.nvidia.cn/geforce/drivers/</a></li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201203201343.png"></p>
<ul>
<li>在搜索列表中选择合适自己目标的驱动版本(也不建议选择最新的,应用开发有可能跟不上,够用就好)</li>
<li>我下载了 <code>NVIDIA-Linux-x86_64-450.80.02.run</code></li>
</ul>
<h3 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h3><blockquote>
<p>需要强调的是我现在的安装环境是Linux服务器,没有图形界面,使用图形界面的同志不要按照此方案安装.</p>
</blockquote>
<ul>
<li>卸载已有的驱动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo &#x2F;usr&#x2F;bin&#x2F;nvidia-uninstall</span><br><span class="line">sudo apt-get --purge remove nvidia-*</span><br></pre></td></tr></table></figure>

<ul>
<li>安装新驱动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo chmod a+x NVIDIA-Linux-x86_64-450.80.02.run</span><br><span class="line">sudo .&#x2F;NVIDIA-Linux-x86_64-450.80.02.run -no-x-check -no-nouveau-check -no-opengl-files</span><br></pre></td></tr></table></figure>

<blockquote>
<p>–no-opengl-files 只安装驱动文件,不安装OpenGL文件</p>
<p>–no-x-check 安装驱动时不检查X服务</p>
<p>–no-nouveau-check 安装驱动时不检查nouveau</p>
</blockquote>
<h3 id="查看驱动更新结果"><a href="#查看驱动更新结果" class="headerlink" title="查看驱动更新结果"></a>查看驱动更新结果</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nvidia-smi</span></span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20201203202133.png"></p>
<ul>
<li>更新成功。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/qq_30163461/article/details/80314630?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control" target="_blank" rel="noopener">https://blog.csdn.net/qq_30163461/article/details/80314630?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control</a></li>
<li><a href="https://www.cnblogs.com/haiyang21/p/12699593.html" target="_blank" rel="noopener">https://www.cnblogs.com/haiyang21/p/12699593.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Pytorch dataloader 错误 “DataLoader worker (pid xxx) is killed by signal” 解决方法</title>
    <url>/2020/12/03/deep_learning/pytorch/dataloader_segmentation_fault/dataloader_segmentation_fault/</url>
    <content><![CDATA[<blockquote>
<p>在使用 pytorch dataloader 时，出现了当把num_workers 设置不为0即报错的问题，本文记录两种此类错误的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="Dataloader-num-workers"><a href="#Dataloader-num-workers" class="headerlink" title="Dataloader - num_workers"></a>Dataloader - num_workers</h3><ul>
<li><p>Pytorch 中加载数据的模块<code>Dataloader</code>有个参数<code>num_workers</code>，该参数表示使用<code>dataloader</code>时加载数据的进程数量，可以理解为为网络搬运数据的工人数量；</p>
</li>
<li><p>所以如果<code>dataloader</code>比较复杂，工人多的时候自然可以节省大量数据加载时间，他们可以在网络训练时同时进行数据加载工作，等网络训练结束直接从内存中取走加载完成的数据，因此当<code>num_worker</code>大于1时可以对数据加载进行加速，当数量多到网络不需要加载数据的时间时就是工人们为加速训练做工作的极限收益了；</p>
</li>
<li><p>使用大于1的工人会占用更多的内存和cpu，同时也会占用更多的共享内存(share memory)；</p>
</li>
<li><p>使用大于1的工人会调用多线程。</p>
</li>
</ul>
<h3 id="问题说明"><a href="#问题说明" class="headerlink" title="问题说明"></a>问题说明</h3><blockquote>
<p>根据<code>num_worker</code>的工作思路，可能会在工作中出现两种错误（我遇到的两种）：</p>
</blockquote>
<ul>
<li>共享内存不足：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RuntimeError: DataLoader worker (pid XXX) is killed by signal: Bus error</span><br></pre></td></tr></table></figure>

<ul>
<li>多线程出现段错误导致死锁，进而导致程序卡住，线程阻塞：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ERROR: Unexpected segmentation fault encountered in worker.</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RuntimeError: DataLoader worker (pid 4499) is killed by signal: Segmentation fault.</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RuntimeError: DataLoader worker (pid(s) ****) exited unexpectedly</span><br></pre></td></tr></table></figure>

<blockquote>
<p>下面给出两种问题的解决方案。</p>
</blockquote>
<h3 id="问题1-RuntimeError-DataLoader-worker-pid-XXX-is-killed-by-signal-Bus-error"><a href="#问题1-RuntimeError-DataLoader-worker-pid-XXX-is-killed-by-signal-Bus-error" class="headerlink" title="问题1 RuntimeError: DataLoader worker (pid XXX) is killed by signal: Bus error"></a>问题1 RuntimeError: DataLoader worker (pid XXX) is killed by signal: Bus error</h3><h4 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h4><ul>
<li>一般这种问题发生在docker中，由于docker默认的共享内存为64M，导致工人数量多时空间不够用，发生错误。</li>
</ul>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><h5 id="1-自废武功"><a href="#1-自废武功" class="headerlink" title="1 自废武功"></a>1 自废武功</h5><ul>
<li>将<code>num_workers</code>设置为0</li>
</ul>
<h5 id="2-解决问题"><a href="#2-解决问题" class="headerlink" title="2 解决问题"></a>2 解决问题</h5><ul>
<li>在<a href="https://www.zywvvd.com/2020/05/06/docker/docker_usage/">创建docker</a>时配置较大的共享内存，加入参数<code>--shm-size=&quot;15g&quot;</code>，设置15g（根据实际情况酌量设置）的共享内存：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvidia-docker run -it --name [container_name] --shm-size&#x3D;&quot;15g&quot; ...</span><br></pre></td></tr></table></figure>

<ul>
<li>通过 <code>df -h</code>查看</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># df -h</span><br><span class="line">Filesystem                                          Size  Used Avail Use% Mounted on</span><br><span class="line">overlay                                             3.6T  3.1T  317G  91% &#x2F;</span><br><span class="line">tmpfs                                                64M     0   64M   0% &#x2F;dev</span><br><span class="line">tmpfs                                                63G     0   63G   0% &#x2F;sys&#x2F;fs&#x2F;cgroup</span><br><span class="line">&#x2F;dev&#x2F;sdb1                                           3.6T  3.1T  317G  91% &#x2F;workspace&#x2F;tmp</span><br><span class="line">shm                                                  15G  8.1G  7.0G  54% &#x2F;dev&#x2F;shm</span><br><span class="line">tmpfs                                                63G   12K   63G   1% &#x2F;proc&#x2F;driver&#x2F;nvidia</span><br><span class="line">&#x2F;dev&#x2F;sda1                                           219G  170G   39G  82% &#x2F;usr&#x2F;bin&#x2F;nvidia-smi</span><br><span class="line">udev                                                 63G     0   63G   0% &#x2F;dev&#x2F;nvidia3</span><br><span class="line">tmpfs                                                63G     0   63G   0% &#x2F;proc&#x2F;acpi</span><br><span class="line">tmpfs                                                63G     0   63G   0% &#x2F;proc&#x2F;scsi</span><br><span class="line">tmpfs                                                63G     0   63G   0% &#x2F;sys&#x2F;firmware</span><br></pre></td></tr></table></figure>

<ul>
<li>其中shm即为共享内存空间</li>
</ul>
<h3 id="问题2-RuntimeError-DataLoader-worker-pid-s-exited-unexpectedly"><a href="#问题2-RuntimeError-DataLoader-worker-pid-s-exited-unexpectedly" class="headerlink" title="问题2 RuntimeError: DataLoader worker (pid(s) ****) exited unexpectedly"></a>问题2 RuntimeError: DataLoader worker (pid(s) ****) exited unexpectedly</h3><h4 id="问题原因-1"><a href="#问题原因-1" class="headerlink" title="问题原因"></a>问题原因</h4><ul>
<li>由于<code>dataloader</code>使用了多线程操作，如果程序中存在其他有些问题的多线程操作时就有可能导致线程套线程，容易出现死锁的情况</li>
<li>具体的情况可能会根据具体环境不同，我的是由于opencv中的多线程与<code>dataloader</code>的杂糅出现了问题；</li>
<li>此时cv版本 3.4.2，相同的代码在 4.2.0.34 的cv中没有出现问题。</li>
</ul>
<h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><h5 id="1-自废武功-1"><a href="#1-自废武功-1" class="headerlink" title="1 自废武功"></a>1 自废武功</h5><ul>
<li>将<code>num_workers</code>设置为0</li>
</ul>
<h5 id="2-解决问题-1"><a href="#2-解决问题-1" class="headerlink" title="2 解决问题"></a>2 解决问题</h5><ul>
<li>在dataloader 的 <code>__getitem__</code> 方法中禁用opencv的多线程：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, idx)</span>:</span></span><br><span class="line">	<span class="keyword">import</span> cv2</span><br><span class="line">	cv2.setNumThreads(<span class="number">0</span>)</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://blog.csdn.net/willen_/article/details/103489485?utm_medium=distribute.pc_relevant.none-task-blog-title-6&amp;spm=1001.2101.3001.4242" target="_blank" rel="noopener">https://blog.csdn.net/willen_/article/details/103489485?utm_medium=distribute.pc_relevant.none-task-blog-title-6&amp;spm=1001.2101.3001.4242</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/133707658" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/133707658</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>python</category>
        <category>pytorch</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>pytorch</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 umount 命令卸载 CIFS 时卡死的问题</title>
    <url>/2020/12/02/linux/mount/busy_umount_cifs/busy_umount_cifs/</url>
    <content><![CDATA[<blockquote>
<p>在Linux系统使用 mount 命令挂载Windows CIFS 磁盘后，如果Windows系统重启，则可能会导致Linux挂载该磁盘出错，无法访问，也无法直接用umount命令卸载，重启虽然可以解决问题，但是代价太大。</p>
<p>本文记录问题无痛解决方法。</p>
</blockquote>
<a id="more"></a>


<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><ul>
<li>在Linux卸载Windows CIFS共享磁盘时卡死 ：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo umount cifs_dir</span><br></pre></td></tr></table></figure>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>由于Windows 重启，导致磁盘失去连接</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo umount -f -a -t cifs -l cifs_dir</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>解决mount 命令挂载CIFS时出现 “Operation now in progress” 的问题</title>
    <url>/2020/12/02/linux/mount/operation_now_in_progress/operation_now_in_progress/</url>
    <content><![CDATA[<blockquote>
<p>在Linux系统使用 mount 命令挂载Windows CIFS 磁盘时报错  “Operation now in progress”，本文记录问题解决方法。</p>
</blockquote>
<a id="more"></a>


<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><ul>
<li>在Linux挂载Windows CIFS共享磁盘时报错 ：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mount: mount ... failed: Operation now in progress</span><br></pre></td></tr></table></figure>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>由于Windows 防火墙没有关闭</li>
</ul>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>关闭Windows防火墙：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201116143452.png"></p>
<ul>
<li>问题解决，可以正常mount windows 磁盘</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -14- 利用 Markdown 语法画 mermaid 流程图</title>
    <url>/2020/11/24/hexo/14_mermaid/mermaid/</url>
    <content><![CDATA[<blockquote>
<p>hexo默认不支持流程图，<a href="https://www.zywvvd.com/2020/11/23/hexo/13_flowchart/flowchart/">flowchart</a>是一种简便好用的解决方案，但由于其语法过于简单，导致其在应付稍复杂一些的流程图时捉襟见肘，本文记录在hexo中添加Mermaid流程图的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="添加支持"><a href="#添加支持" class="headerlink" title="添加支持"></a>添加支持</h3><h4 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-filter-mermaid-diagrams</span><br></pre></td></tr></table></figure>

<h4 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h4><ul>
<li>在主题配置文件中找到<code>mermaid</code>选项，将<code>enable</code>设置为<code>true</code>。</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201123235944.png"></p>
<h3 id="加入mermaid代码块"><a href="#加入mermaid代码块" class="headerlink" title="加入mermaid代码块"></a>加入mermaid代码块</h3><blockquote>
<p>官网有最全的说明文档 <a href="https://mermaidjs.github.io/" target="_blank" rel="noopener">https://mermaidjs.github.io/</a> ，此处记录常用使用方法。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    B((开始)) --&gt;C&#123;判断&#125;</span><br><span class="line">    C --  a&#x3D;1 --&gt;D[执行语句1]</span><br><span class="line">    C --  a&#x3D;2  --&gt;E[执行语句2]</span><br><span class="line">    C --  a&#x3D;3 --&gt;F[执行语句3]</span><br><span class="line">    C -- a&#x3D;4  --&gt;G[执行语句4]</span><br><span class="line">    D--&gt; AA((结束))</span><br><span class="line">    E--&gt; AA</span><br><span class="line">    F--&gt; AA</span><br><span class="line">   G--&gt; AA</span><br></pre></td></tr></table></figure>



<pre class="mermaid">graph TD
    B((开始)) -->C{判断}
    C --  a=1 -->D[执行语句1]
    C --  a=2  -->E[执行语句2]
    C --  a=3 -->F[执行语句3]
    C -- a=4  -->G[执行语句4]
    D--> AA((结束))
    E--> AA
    F--> AA
   G--> AA</pre>

<h3 id="流程图语法"><a href="#流程图语法" class="headerlink" title="流程图语法"></a>流程图语法</h3><h4 id="方向"><a href="#方向" class="headerlink" title="方向"></a>方向</h4><table>
<thead>
<tr>
<th>方向</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>TB</td>
<td>从上到下</td>
</tr>
<tr>
<td>BT</td>
<td>从下到上</td>
</tr>
<tr>
<td>RL</td>
<td>从右到左</td>
</tr>
<tr>
<td>LR</td>
<td>从左到右</td>
</tr>
<tr>
<td>TD</td>
<td>与TB相同</td>
</tr>
</tbody></table>
<h4 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h4><p>语法结构如下：<code>A[名称] --&gt; B(名称)</code><br>其中，A、B均代表形状名称，<code> --&gt;</code>表示箭头指向，形状样式用后面的括号来表示，括号里面的内容是形状中要显示的文本内容。其中有以下几种形状：</p>
<table>
<thead>
<tr>
<th>括号形式</th>
<th>形状样式</th>
</tr>
</thead>
<tbody><tr>
<td>[ ]</td>
<td>矩形框</td>
</tr>
<tr>
<td>( )</td>
<td>圆角矩形框</td>
</tr>
<tr>
<td>{ }</td>
<td>菱形</td>
</tr>
<tr>
<td>(( ))</td>
<td>圆形</td>
</tr>
</tbody></table>
<h4 id="连接线"><a href="#连接线" class="headerlink" title="连接线"></a>连接线</h4><table>
<thead>
<tr>
<th>符号</th>
<th>箭头</th>
</tr>
</thead>
<tbody><tr>
<td>–&gt;</td>
<td>箭头</td>
</tr>
<tr>
<td>—</td>
<td>没有箭头</td>
</tr>
<tr>
<td>– 文字 — /  — |文字|</td>
<td>带文字的连接线</td>
</tr>
<tr>
<td>–&gt;|文字| / – 文字 –&gt;</td>
<td>带箭头和文字的连接</td>
</tr>
<tr>
<td>-.-&gt;</td>
<td>虚线</td>
</tr>
<tr>
<td>-. 文字 .-&gt;</td>
<td>带文字的虚线连接</td>
</tr>
<tr>
<td>==&gt;</td>
<td>粗连接线</td>
</tr>
<tr>
<td>== 文本 ==&gt;</td>
<td>带文本的粗连接</td>
</tr>
</tbody></table>
<h4 id="子图"><a href="#子图" class="headerlink" title="子图"></a>子图</h4><p>语法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">subgraph title</span><br><span class="line">    graph definition</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    c1--&gt;a2</span><br><span class="line">    subgraph one</span><br><span class="line">    a1--&gt;a2</span><br><span class="line">    end</span><br><span class="line">    subgraph two</span><br><span class="line">    b1--&gt;b2</span><br><span class="line">    end</span><br><span class="line">    subgraph three</span><br><span class="line">    c1--&gt;c2</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>



<pre class="mermaid">graph TB
    c1-->a2
    subgraph one
    a1-->a2
    end
    subgraph two
    b1-->b2
    end
    subgraph three
    c1-->c2
    end</pre>

<h4 id="样式链接"><a href="#样式链接" class="headerlink" title="样式链接"></a>样式链接</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph LR</span><br><span class="line">    id1(Start)--&gt;id2(Stop)</span><br><span class="line">    style id1 fill:#f9f,stroke:#333,stroke-width:4px</span><br><span class="line">    style id2 fill:#ccf,stroke:#f66,stroke-width:2px,stroke-dasharray: 5, 5</span><br></pre></td></tr></table></figure>

<pre class="mermaid">graph LR
    id1(Start)-->id2(Stop)
    style id1 fill:#f9f,stroke:#333,stroke-width:4px
    style id2 fill:#ccf,stroke:#f66,stroke-width:2px,stroke-dasharray: 5, 5</pre>

<h4 id="综合应用"><a href="#综合应用" class="headerlink" title="综合应用"></a>综合应用</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    id1(圆角矩形)--普通线--&gt;id2[矩形]</span><br><span class="line">    subgraph 子图表</span><br><span class="line">        id2&#x3D;&#x3D;粗线&#x3D;&#x3D;&gt;id3&#123;菱形&#125;</span><br><span class="line">        id3-.虚线.-&gt;id4&gt;右向旗帜]</span><br><span class="line">        id3--无箭头---id5((圆形))</span><br><span class="line">    end</span><br><span class="line">    style id1 fill:#f9f,stroke:#333,stroke-width:4px</span><br></pre></td></tr></table></figure>

<pre class="mermaid">graph TB
    id1(圆角矩形)--普通线-->id2[矩形]
    subgraph 子图表
        id2==粗线==>id3{菱形}
        id3-.虚线.->id4>右向旗帜]
        id3--无箭头---id5((圆形))
    end
    style id1 fill:#f9f,stroke:#333,stroke-width:4px</pre>

<h3 id="序列图语法"><a href="#序列图语法" class="headerlink" title="序列图语法"></a>序列图语法</h3><p>使用以下语法开始序列图</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    [参与者1][消息线][参与者2]:消息体</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h4 id="参与者"><a href="#参与者" class="headerlink" title="参与者"></a>参与者</h4><p>定义参与者</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant 参与者 1</span><br><span class="line">    participant 参与者 2</span><br><span class="line">    ...</span><br><span class="line">    participant 简称 as 参与者 3 #该语法可以在接下来的描述中使用简称来代替参与者 312345</span><br></pre></td></tr></table></figure>

<h4 id="消息线"><a href="#消息线" class="headerlink" title="消息线"></a>消息线</h4><p>|类型|描述|<br>|<code>-&gt;</code>|无箭头的实线|<br>|<code>--&gt;</code>|无箭头的虚线|<br>|<code>-&gt;&gt;</code>|有箭头的实线|<br>|<code>--&gt;&gt;</code>|有箭头的虚线|<br>|<code>-x</code>|末端为叉的实线（表示异步）|<br>|<code>--x</code>|末端为叉的虚线（表示异步）|</p>
<h4 id="处理中"><a href="#处理中" class="headerlink" title="处理中"></a>处理中</h4><p>在消息线末尾增加 <code>+</code> ，则消息接收者进入当前消息的“处理中”状态；<br>在消息线末尾增加 <code>-</code> ，则消息接收者离开当前消息的“处理中”状态。</p>
<p>或者使用以下语法直接说明某个参与者进入“处理中”状态</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">activate 参与者1</span><br></pre></td></tr></table></figure>

<h4 id="标注"><a href="#标注" class="headerlink" title="标注"></a>标注</h4><p>语法如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Note 位置表述 参与者: 标注文字1</span><br></pre></td></tr></table></figure>

<p>其中位置表述可以为</p>
<table>
<thead>
<tr>
<th>表述</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>right of</td>
<td>右侧</td>
</tr>
<tr>
<td>left of</td>
<td>左侧</td>
</tr>
<tr>
<td>over</td>
<td>在当中，可以横跨多个参与者</td>
</tr>
</tbody></table>
<h4 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h4><p>语法如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">loop 循环的条件</span><br><span class="line">    循环体描述语句</span><br><span class="line">end123</span><br></pre></td></tr></table></figure>

<h4 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alt 条件 1 描述</span><br><span class="line">    分支 1 描述语句</span><br><span class="line">else 条件 2 描述 # else 分支可选</span><br><span class="line">    分支 2 描述语句</span><br><span class="line">else ...</span><br><span class="line">    ...</span><br><span class="line">end1234567</span><br></pre></td></tr></table></figure>

<p>如果遇到可选的情况，即没有 else 分支的情况，使用如下语法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opt 条件描述</span><br><span class="line">    分支描述语句</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<h4 id="综合应用-1"><a href="#综合应用-1" class="headerlink" title="综合应用"></a>综合应用</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant z as 张三</span><br><span class="line">    participant l as 李四</span><br><span class="line">    loop 日复一日</span><br><span class="line">        z-&gt;&gt;l: 吃了吗您呐？</span><br><span class="line">        l--&gt;&gt;z: 吃了，您呢？</span><br><span class="line">        activate z</span><br><span class="line">        Note left of z: 想了一下</span><br><span class="line">        alt 还没吃</span><br><span class="line">            z-xl: 还没呢，正准备回去吃</span><br><span class="line">        else 已经吃了</span><br><span class="line">            z-xl: 我也吃过了，哈哈</span><br><span class="line">        end</span><br><span class="line">        opt 大过年的</span><br><span class="line">            l--&gt;z: 祝您新年好啊</span><br><span class="line">        end</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<pre class="mermaid">sequenceDiagram
    participant z as 张三
    participant l as 李四
    loop 日复一日
        z->>l: 吃了吗您呐？
        l-->>z: 吃了，您呢？
        activate z
        Note left of z: 想了一下
        alt 还没吃
            z-xl: 还没呢，正准备回去吃
        else 已经吃了
            z-xl: 我也吃过了，哈哈
        end
        opt 大过年的
            l-->z: 祝您新年好啊
        end
    end</pre>



<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://mermaidjs.github.io/" target="_blank" rel="noopener">https://mermaidjs.github.io</a></p>
</li>
<li><p><a href="https://www.jianshu.com/p/af48cc77b57a" target="_blank" rel="noopener">https://www.jianshu.com/p/af48cc77b57a</a></p>
</li>
<li><p><a href="https://baijiahao.baidu.com/s?id=1641809867954032650&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1641809867954032650&amp;wfr=spider&amp;for=pc</a></p>
</li>
<li><p><a href="https://blog.csdn.net/fenghuizhidao/article/details/79440583" target="_blank" rel="noopener">https://blog.csdn.net/fenghuizhidao/article/details/79440583</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -13- 利用 Markdown 语法画 flowchart 流程图</title>
    <url>/2020/11/23/hexo/13_flowchart/flowchart/</url>
    <content><![CDATA[<blockquote>
<p>hexo默认不支持流程图，flowchart 简便易食，可以瞬间使 hexo 流程图无中生有。本文记录在hexo中添加Markdown flowchart流程图的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="添加支持"><a href="#添加支持" class="headerlink" title="添加支持"></a>添加支持</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-filter-flowchart</span><br></pre></td></tr></table></figure>

<h3 id="添加Flow代码"><a href="#添加Flow代码" class="headerlink" title="添加Flow代码"></a>添加Flow代码</h3><ul>
<li>需要在代码块(ctrl + shift + k)中，选择语言为<code>flow</code>。</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201123232520.png"></p>
<ul>
<li>添加flow代码：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">st&#x3D;&gt;start: 开始节点</span><br><span class="line">in&#x3D;&gt;inputoutput: 输入</span><br><span class="line">e&#x3D;&gt;end: 结束节点</span><br><span class="line">op&#x3D;&gt;operation: 操作节点</span><br><span class="line">cond&#x3D;&gt;condition: 条件节点</span><br><span class="line">sub&#x3D;&gt;subroutine: 子例程</span><br><span class="line">out&#x3D;&gt;inputoutput: 输出</span><br><span class="line">st(right)-&gt;in-&gt;op-&gt;cond</span><br><span class="line">cond(yes,right)-&gt;out-&gt;e</span><br><span class="line">cond(no)-&gt;sub</span><br></pre></td></tr></table></figure>

<div id="flowchart-0" class="flow-chart"></div>

<h3 id="Flow-语法结构"><a href="#Flow-语法结构" class="headerlink" title="Flow 语法结构"></a>Flow 语法结构</h3><ul>
<li>语法概述</li>
</ul>
<blockquote>
<p>flow 语法其实是直截了当的，分为节点定义和节点连接两部分</p>
</blockquote>
<h4 id="节点定义"><a href="#节点定义" class="headerlink" title="节点定义"></a>节点定义</h4><ul>
<li>语法结构如下：<code>X=&gt;Y: Z</code><br>其中，X是变量名， Y是指操作模块名，冒号后面的Z是具体显示的文字内容。需要注意的是，冒号后要加空格才能识别，而<code>X</code>，<code>Y</code>与<code>=&gt;</code>之间不允许有空格。<br>其中，变量名X和文字内容Z可以比较随意设置，但是Y是有固定的内容，主要有以下几种：</li>
</ul>
<table>
<thead>
<tr>
<th>操作模块名</th>
<th>表示含义说明</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>开始</td>
</tr>
<tr>
<td>end</td>
<td>结束</td>
</tr>
<tr>
<td>operation</td>
<td>普通操作块</td>
</tr>
<tr>
<td>subroutine</td>
<td>子任务块</td>
</tr>
<tr>
<td>condition</td>
<td>判断块</td>
</tr>
<tr>
<td>inputoutput</td>
<td>输入输出块</td>
</tr>
</tbody></table>
<h4 id="节点连接"><a href="#节点连接" class="headerlink" title="节点连接"></a>节点连接</h4><ul>
<li>定义语法节点后，需要理顺节点之间的关系，才能建立正确的流程图；</li>
<li>在flow中使用<code>-&gt;</code>符号连接两个前后的变量；</li>
<li>如： <code>a-&gt;b-&gt;c</code>，表示节点<code>a</code>转到<code>b</code>又到<code>c</code>节点；</li>
<li>上述转接也可以写成：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a-&gt;b</span><br><span class="line">b-&gt;c</span><br></pre></td></tr></table></figure>

<ul>
<li>condition是判断，可以取yes和no两种结果，对于不同结果可以有不同走向。如：<br><code>cond(yes)-&gt;out </code>表示condition成立时转向out执行；<br><code>cond(no)-&gt;op</code>表示condition不成立时转向op执行；</li>
</ul>
<h4 id="连接方向"><a href="#连接方向" class="headerlink" title="连接方向"></a>连接方向</h4><ul>
<li>连接线有上下左右四个方向，如果需要指定连接线连接到某一特定方向，在连接线开始的元素后面添加方向即可，方向包括：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(top)</span><br><span class="line">(bottom)</span><br><span class="line">(left)</span><br><span class="line">(right)</span><br></pre></td></tr></table></figure>

<ul>
<li>如果要设置条件框连接线方向，在括号中添加即可。条件框只有两个方向可供选择：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># yes向下，no向右（默认）</span><br><span class="line"># yes向右，no向下。</span><br><span class="line">cond(yes,right)</span><br><span class="line">cond(no,bottom)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>只需要指定其中一条分支的方向即可。</p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="https://blog.csdn.net/wzh0709zml/article/details/103310405" target="_blank" rel="noopener">https://blog.csdn.net/wzh0709zml/article/details/103310405</a></p>
</li>
<li><p><a href="http://www.zhaojun.im/hexo-flowchart/" target="_blank" rel="noopener">http://www.zhaojun.im/hexo-flowchart/</a></p>
</li>
<li><p><a href="https://www.jianshu.com/p/f28c94cf1204" target="_blank" rel="noopener">https://www.jianshu.com/p/f28c94cf1204</a><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: 开始节点
in=>inputoutput: 输入
e=>end: 结束节点
op=>operation: 操作节点
cond=>condition: 条件节点
sub=>subroutine: 子例程
out=>inputoutput: 输出
st(right)->in->op->cond
cond(yes,right)->out->e
cond(no)->sub</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - Matplotlib 关于 agg 相关错误的解决方法</title>
    <url>/2020/11/19/python/matplotlib_agg/matplotlib_agg/</url>
    <content><![CDATA[<blockquote>
<p>Python使用matplotlib时有时会报出和 agg相关的错误，本文记录两种常见错误的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h3><h4 id="UserWarning-Matplotlib-is-currently-using-agg-which-is-a-non-GUI-backend"><a href="#UserWarning-Matplotlib-is-currently-using-agg-which-is-a-non-GUI-backend" class="headerlink" title="UserWarning: Matplotlib is currently using agg, which is a non-GUI backend"></a>UserWarning: Matplotlib is currently using agg, which is a non-GUI backend</h4><ul>
<li>agg是一个没有图形显示界面的终端，常用的有图形界面显示的终端有TkAgg等，将终端更换一下就好了。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import matplotlib </span><br><span class="line">matplotlib.use(&#39;TkAgg&#39;)</span><br></pre></td></tr></table></figure>

<h3 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h3><h4 id="TclError-no-display-name-and-no-DISPLAY-environment-variable-Backend-TkAgg-is-interactive-backend-Turning-interactive-mode-on"><a href="#TclError-no-display-name-and-no-DISPLAY-environment-variable-Backend-TkAgg-is-interactive-backend-Turning-interactive-mode-on" class="headerlink" title="TclError: no display name and no $DISPLAY environment variable Backend TkAgg is interactive backend. Turning interactive mode on."></a>TclError: no display name and no $DISPLAY environment variable Backend TkAgg is interactive backend. Turning interactive mode on.</h4><ul>
<li>这是由于在没有图形终端的场景下使用了TkAgg，换成没有图形的就好了。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import matplotlib</span><br><span class="line">matplotlib.use(&#39;Agg&#39;)</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>pytorch pth 模型转 onnx模型，并验证结果正确性</title>
    <url>/2020/11/19/deep_learning/pytorch/covert_pt_to_onnx/covert_pt_to_onnx/</url>
    <content><![CDATA[<blockquote>
<p>pytorch 模型部署很重要的一步是转存pth模型为ONNX，本文记录方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="转存-onnx"><a href="#转存-onnx" class="headerlink" title="转存 onnx"></a>转存 onnx</h3><ul>
<li>建立自己的pytorch模型，并加载权重</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = create_model(num_classes=<span class="number">2</span>)</span><br><span class="line">model.load_state_dict(load(model_path, map_location=<span class="string">'cpu'</span>)[<span class="string">"model"</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>转存onnx文件</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">dummy_input = torch.randn(<span class="number">1</span>, <span class="number">3</span>, <span class="number">256</span>, <span class="number">256</span>, device=<span class="string">'cpu'</span>)</span><br><span class="line">torch.onnx._export(model, dummy_input, <span class="string">"faster_rcnn.onnx"</span>, verbose=<span class="literal">True</span>, opset_version=<span class="number">11</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将模型保存在了当前目录的 <code>faster_rcnn.onnx</code>文件内</p>
</blockquote>
<h4 id="验证-onnx-有效性"><a href="#验证-onnx-有效性" class="headerlink" title="验证 onnx 有效性"></a>验证 onnx 有效性</h4><ul>
<li>安装 <code>onnxruntime</code> 库</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install onnxruntime</span><br></pre></td></tr></table></figure>

<ul>
<li>加载onnx模型并测试</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> onnxruntime</span><br><span class="line"><span class="keyword">from</span> onnxruntime.datasets <span class="keyword">import</span> get_example</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_numpy</span><span class="params">(tensor)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> tensor.detach().cpu().numpy() <span class="keyword">if</span> tensor.requires_grad <span class="keyword">else</span> tensor.cpu().numpy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试数据</span></span><br><span class="line">dummy_input = torch.randn(<span class="number">1</span>, <span class="number">3</span>, <span class="number">256</span>, <span class="number">256</span>, device=<span class="string">'cpu'</span>)</span><br><span class="line"></span><br><span class="line">example_model = get_example(&lt;absolute_root_to_your_onnx_model_file&gt;)</span><br><span class="line"><span class="comment"># netron.start(example_model) 使用 netron python 包可视化网络</span></span><br><span class="line">sess = onnxruntime.InferenceSession(example_model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># onnx 网络输出</span></span><br><span class="line">onnx_out = sess.run(<span class="literal">None</span>, &#123;&lt;input_layer_name_of_your_network&gt;: to_numpy(dummy_input)&#125;)</span><br><span class="line">print(onnx_out)</span><br><span class="line"></span><br><span class="line">model.eval()</span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="comment"># pytorch model 网络输出</span></span><br><span class="line">    torch_out = model(dummy_input)</span><br><span class="line">	print(torch_out)</span><br></pre></td></tr></table></figure>

<ul>
<li>输出：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">onnx_out</span><br><span class="line">[array([[  0.       ,  93.246    , 228.95842  , 256.       ],</span><br><span class="line">       [  0.       ,   2.6370468, 209.39705  , 148.17822  ]],</span><br><span class="line">      dtype&#x3D;float32), array([1, 1], dtype&#x3D;int64), array([0.1501071 , 0.07568519], dtype&#x3D;float32)]</span><br><span class="line"></span><br><span class="line">torch_out</span><br><span class="line">[&#123;&#39;boxes&#39;: tensor([[  0.0000,  93.2459, 228.9584, 256.0000],</span><br><span class="line">        [  0.0000,   2.6370, 209.3971, 148.1782]]), &#39;labels&#39;: tensor([1, 1]), &#39;scores&#39;: tensor([0.1501, 0.0757])&#125;]</span><br></pre></td></tr></table></figure>

<h4 id="获取自己网络输入层名称"><a href="#获取自己网络输入层名称" class="headerlink" title="获取自己网络输入层名称"></a>获取自己网络输入层名称</h4><ul>
<li>有时对网络不熟悉的情况下不清楚模型输入层的名称，可以使用Netron可视化自己的网络，获取输入层名称，喂入onnx的sess中。</li>
</ul>
<h2 id="注意-！！！"><a href="#注意-！！！" class="headerlink" title="注意 ！！！"></a><font color=red size=6 face='微软雅黑'>注意 ！！！</font></h2><ul>
<li><p>pytorch 模型在转 ONNX 模型的过程中，使用的导出器是一个基于轨迹的导出器,这意味着它执行时需要运行一次模型,然后导出实际参与运算的运算符. 这也意味着, 如果你的模型是动态的,例如,改变一些依赖于输入数据的操作,这时的导出结果是不准确的.同样,一 个轨迹可能只对一个具体的输入尺寸有效 (这是为什么我们在轨迹中需要有明确的输入的原因之一.) 我们建议检查 模型的轨迹,确保被追踪的运算符是合理的.   ———  <a href="https://pytorch.apachecn.org/docs/0.3/onnx.html" target="_blank" rel="noopener">pytorch 文档</a></p>
</li>
<li><p>也就是说，如果网络模块中存在 if.. else.. 类似的分支，在生成ONNX模型时会依据所使用的初始数据来选择其中某一个分支，这样所生成的ONNX模型仅会保留这一个分支的结构，在原始pytorch模型中的其他逻辑能力在该模型中不复存在。</p>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://pytorch.apachecn.org/docs/0.3/onnx.html" target="_blank" rel="noopener">https://pytorch.apachecn.org/docs/0.3/onnx.html</a></li>
<li><a href="https://www.jianshu.com/p/5a0a09fbdeba" target="_blank" rel="noopener">https://www.jianshu.com/p/5a0a09fbdeba</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>pytorch</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>Netron 可视化网络结构</title>
    <url>/2020/11/19/deep_learning/pytorch/netron_visualize_model/netron_visualize_model/</url>
    <content><![CDATA[<blockquote>
<p>pytorch模型可视化网络结构不是特别方便，需要借助Netron工具，本文记录可视化方法。</p>
</blockquote>
<a id="more"></a>

<p><a href="https://github.com/lutzroeder/netron" target="_blank" rel="noopener">Github 官网链接</a></p>
<h3 id="支持的网络格式"><a href="#支持的网络格式" class="headerlink" title="支持的网络格式"></a>支持的网络格式</h3><blockquote>
<p>Netron supports <strong>ONNX</strong> (<code>.onnx</code>, <code>.pb</code>, <code>.pbtxt</code>), <strong>Keras</strong> (<code>.h5</code>, <code>.keras</code>), <strong>Core ML</strong> (<code>.mlmodel</code>), <strong>Caffe</strong> (<code>.caffemodel</code>, <code>.prototxt</code>), <strong>Caffe2</strong> (<code>predict_net.pb</code>), <strong>Darknet</strong> (<code>.cfg</code>), <strong>MXNet</strong> (<code>.model</code>, <code>-symbol.json</code>), <strong>Barracuda</strong> (<code>.nn</code>), <strong>ncnn</strong> (<code>.param</code>), <strong>Tengine</strong> (<code>.tmfile</code>), <strong>TNN</strong> (<code>.tnnproto</code>), <strong>UFF</strong> (<code>.uff</code>) and <strong>TensorFlow Lite</strong> (<code>.tflite</code>).</p>
<p>Netron has experimental support for <strong>TorchScript</strong> (<code>.pt</code>, <code>.pth</code>), <strong>PyTorch</strong> (<code>.pt</code>, <code>.pth</code>), <strong>Torch</strong> (<code>.t7</code>), <strong>Arm NN</strong> (<code>.armnn</code>), <strong>BigDL</strong> (<code>.bigdl</code>, <code>.model</code>), <strong>Chainer</strong> (<code>.npz</code>, <code>.h5</code>), <strong>CNTK</strong> (<code>.model</code>, <code>.cntk</code>), <strong>Deeplearning4j</strong> (<code>.zip</code>), <strong>MediaPipe</strong> (<code>.pbtxt</code>), <strong>ML.NET</strong> (<code>.zip</code>), <strong>MNN</strong> (<code>.mnn</code>), <strong>PaddlePaddle</strong> (<code>.zip</code>, <code>__model__</code>), <strong>OpenVINO</strong> (<code>.xml</code>), <strong>scikit-learn</strong> (<code>.pkl</code>), <strong>TensorFlow.js</strong> (<code>model.json</code>, <code>.pb</code>) and <strong>TensorFlow</strong> (<code>.pb</code>, <code>.meta</code>, <code>.pbtxt</code>, <code>.ckpt</code>, <code>.index</code>).</p>
</blockquote>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="安装app"><a href="#安装app" class="headerlink" title="安装app"></a>安装app</h4><ul>
<li>进入<a href="https://github.com/lutzroeder/netron" target="_blank" rel="noopener">Releases</a>下载自己操作系统需要的安装包文件，运行安装即可：</li>
</ul>
<blockquote>
<p><strong>macOS</strong>:  <code>.dmg</code></p>
<p><strong>Linux</strong>: <code>.AppImage</code></p>
<p><strong>Windows</strong>: <code>.exe</code></p>
</blockquote>
<h4 id="可视化网络"><a href="#可视化网络" class="headerlink" title="可视化网络"></a>可视化网络</h4><ul>
<li>运行程序</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201113152042.png"></p>
<ul>
<li>打开模型文件，可以看到模型的网络结构：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201113152349.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>pytorch</category>
        <category>可视化</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>pytorch</tag>
        <tag>可视化</tag>
      </tags>
  </entry>
  <entry>
    <title>二次型优化问题 - 1 - 问题描述</title>
    <url>/2020/11/16/machine_learning/conjugate-gradient-algorithm/conjugate-gradient/conjugate-gradient/</url>
    <content><![CDATA[<blockquote>
<p>在各种场景可能都会遇到需要求解多元二次函数极值的问题，本系列文章介绍相关的计算方法，核心内容为共轭梯度法。</p>
<p>本文介绍问题定义。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题定义"><a href="#问题定义" class="headerlink" title="问题定义"></a>问题定义</h3><ul>
<li>多元二次多项式，维度为$n$，那么可以用以下公式描述该函数：</li>
</ul>
<p>$$<br>f({x_1},{x_2},{x_3},…,{x_n}) = {a_{1,1}}x_1^2 + {a_{1,2}}{x_1}{x_2} + {a_{1,3}}{x_1}{x_3} +  \cdots  + {a_{1,n}}{x_1}{x_n} + {a_{2,1}}x_2{x_1} + {a_{2,2}}{x_2^2} + {a_{2,3}}{x_2}{x_3} +  \cdots  + {a_{2,n}}{x_2}{x_n} +  \cdots  + {a_{n,n}}x_n^2+{b_1}x_1+{b_2}x_2+\cdots+{b_n}x_n+c<br>$$</p>
<blockquote>
<p>其中$a_{i,j}$为二次项系数，共有$n^2$项，$1 \le i,j \le n$，且所有的$a$不全为0，即$\exists a_{i,j} \ne 0$;</p>
<p>$b_k$为一次项系数，共$n$项，$1 \le k \le n$;</p>
<p>$c$为常数项。</p>
</blockquote>
<ul>
<li>记 $f({\bf{x}}) = {[{x_1},{x_2}, \cdots ,{x_n}]^T}$ ，则上述函数可以写作二次型的形式：</li>
</ul>
<p>$$<br>f({x_1},{x_2},{x_3},…,{ x_n}) = f({\bf{x}}) = {\bf{x^T} }\bf{A}{\bf{x} } + { {\bf{b} }^T}{\bf{x} } + c<br>$$</p>
<blockquote>
<p>转化过程中$\bf{A},\bf{b}$满足：</p>
<p>${\bf{A} }$ 为$n$阶对称方阵，${ { \bf { A } } _ { i , j } } = { a _ { i , j } }$</p>
<p>因为$\exists a_{i,j} \ne 0$，$\bf{A}$不为零矩阵</p>
<p>$\bf{b}_i=b_i$</p>
</blockquote>
<ul>
<li>为了后续计算简便，我们将二次型稍作改动：</li>
</ul>
<p>$$<br>f({\bf{x} }) = \frac{1}{2}{\bf{x^TAx} } - { {\bf{b} }^{\bf{T} } }{\bf{x} } + {\bf{c} }<br>$$</p>
<ul>
<li>我们的目标就是寻找该函数的极值点的坐标，我们把该目标称为$\bf{x^*}$。</li>
</ul>
<h3 id="简要分析"><a href="#简要分析" class="headerlink" title="简要分析"></a>简要分析</h3><ul>
<li>当前问题其实就是多元二次方程极值求解的问题</li>
<li>此类函数在函数定义域内处处连续可导</li>
<li>极值点必然处于导数为0的位置</li>
</ul>
<h3 id="需要解决的问题"><a href="#需要解决的问题" class="headerlink" title="需要解决的问题"></a>需要解决的问题</h3><ul>
<li>同一个多元二次方程表示成二次型的参数$\bf{A},\bf{b},\bf{c}$是否唯一，如果不唯一该如何设置，为什么如此设置</li>
<li>该问题是否存在导数为0的点</li>
<li>导数为0的点如何求解</li>
<li>导数为0的点是否就是极值点</li>
<li>对于给定的二次型如何判断是否可优化</li>
<li>对于可优化的二次型都有什么方法寻找极值点</li>
<li>寻找极值点的方法们都有哪些优缺点，为什么需要提出共轭梯度法</li>
<li>代数解法，梯度下降法介绍与分析</li>
<li>共轭梯度法介绍与分析</li>
<li>共轭梯度法的相关证明</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>优化方法</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>优化方法</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 将matplotlib图像转换为numpy.array 或 PIL.Image</title>
    <url>/2020/11/06/python/convert_matplotlib_figure_to_array/convert_matplotlib_figure_to_array/</url>
    <content><![CDATA[<blockquote>
<p>matplotlib是python图像处理中让人又爱又恨的库。最近遇到了需要获取plt图像数据的需求，本文记录了将matplotlib图像转换为numpy.array 或 PIL.Image的方法。</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>众所周知，这个库处理图像会出现内存泄漏的问题，原想着将plt的图转出来用opencv存就好了，然而并没有，牢骚完毕。</p>
</blockquote>
<h3 id="转换思路"><a href="#转换思路" class="headerlink" title="转换思路"></a>转换思路</h3><blockquote>
<p>总体分为两步完成目标：</p>
</blockquote>
<ul>
<li>将plt或fig对象转为argb string的对象</li>
<li>将argb string对象图像转为array 或 Image</li>
</ul>
<h3 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h3><blockquote>
<p>区分对象为plt和fig的情况，具体使用哪种根据对象类型确定</p>
</blockquote>
<h4 id="转换plt对象为argb-string编码对象"><a href="#转换plt对象为argb-string编码对象" class="headerlink" title="转换plt对象为argb string编码对象"></a>转换plt对象为argb string编码对象</h4><blockquote>
<p>代码在plt对象中构建了图像内容，生成了plt图像，但还没有savefig 和 show：</p>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure()</span><br><span class="line">plt.imshow(img)</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 引入 FigureCanvasAgg</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.backends.backend_agg <span class="keyword">import</span> FigureCanvasAgg</span><br><span class="line"><span class="comment"># 引入 Image</span></span><br><span class="line"><span class="keyword">import</span> PIL.Image <span class="keyword">as</span> Image</span><br><span class="line"><span class="comment"># 将plt转化为numpy数据</span></span><br><span class="line">canvas = FigureCanvasAgg(plt.gcf())</span><br><span class="line"><span class="comment"># 绘制图像</span></span><br><span class="line">canvas.draw()</span><br><span class="line"><span class="comment"># 获取图像尺寸</span></span><br><span class="line">w, h = canvas.get_width_height()</span><br><span class="line"><span class="comment"># 解码string 得到argb图像</span></span><br><span class="line">buf = np.fromstring(canvas.tostring_argb(), dtype=np.uint8)</span><br></pre></td></tr></table></figure>

<h4 id="转换fig对象为argb-string编码对象"><a href="#转换fig对象为argb-string编码对象" class="headerlink" title="转换fig对象为argb string编码对象"></a>转换fig对象为argb string编码对象</h4><blockquote>
<p>以 matplotlab 的 fig 对象为目标，获取 argb string编码图像</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 引入 Image</span></span><br><span class="line"><span class="keyword">import</span> PIL.Image <span class="keyword">as</span> Image</span><br><span class="line"><span class="comment"># 绘制图像</span></span><br><span class="line">fig.canvas.draw()</span><br><span class="line"><span class="comment"># 获取图像尺寸</span></span><br><span class="line">w, h = fig.canvas.get_width_height()</span><br><span class="line"><span class="comment"># 获取 argb 图像</span></span><br><span class="line">buf = np.fromstring(fig.canvas.tostring_argb(), dtype=np.uint8)</span><br></pre></td></tr></table></figure>

<h3 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h3><h4 id="转换argb-string编码对象为PIL-Image或numpy-array图像"><a href="#转换argb-string编码对象为PIL-Image或numpy-array图像" class="headerlink" title="转换argb string编码对象为PIL.Image或numpy.array图像"></a>转换argb string编码对象为PIL.Image或numpy.array图像</h4><blockquote>
<p>此时的argb string不是我们常见的uint8 w h rgb的图像，还需要进一步转化</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重构成w h 4(argb)图像</span></span><br><span class="line">buf.shape = (w, h, <span class="number">4</span>)</span><br><span class="line"><span class="comment"># 转换为 RGBA</span></span><br><span class="line">buf = np.roll(buf, <span class="number">3</span>, axis=<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 得到 Image RGBA图像对象 (需要Image对象的同学到此为止就可以了)</span></span><br><span class="line">image = Image.frombytes(<span class="string">"RGBA"</span>, (w, h), buf.tostring())</span><br><span class="line"><span class="comment"># 转换为numpy array rgba四通道数组</span></span><br><span class="line">image = np.asarray(image)</span><br><span class="line"><span class="comment"># 转换为rgb图像</span></span><br><span class="line">rgb_image = image[:, :, :<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/aa846555831/article/details/52372884" target="_blank" rel="noopener">https://blog.csdn.net/aa846555831/article/details/52372884</a></li>
<li><a href="https://blog.csdn.net/jpc20144055069/article/details/106628889" target="_blank" rel="noopener">https://blog.csdn.net/jpc20144055069/article/details/106628889</a></li>
<li><a href="https://blog.csdn.net/aa846555831/article/details/52372884" target="_blank" rel="noopener">https://blog.csdn.net/aa846555831/article/details/52372884</a></li>
<li><a href="https://blog.csdn.net/jpc20144055069/article/details/106628889" target="_blank" rel="noopener">https://blog.csdn.net/jpc20144055069/article/details/106628889</a></li>
<li><a href="https://blog.csdn.net/guyuealian/article/details/104179723" target="_blank" rel="noopener">https://blog.csdn.net/guyuealian/article/details/104179723</a></li>
<li><a href="https://blog.csdn.net/qq_33883462/article/details/81050795" target="_blank" rel="noopener">https://blog.csdn.net/qq_33883462/article/details/81050795</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 pynvml 报错 NVML Shared Library Not Found / WinError 126</title>
    <url>/2020/11/06/deep_learning/pynvml_model_not_found/pynvml_model_not_found/</url>
    <content><![CDATA[<blockquote>
<p>pynvml包直接在Windows系统上安装可能会报出模块找不到的错误，本文记录解决方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><blockquote>
<p>在Windows中调用 <code>pynvml.nvmlInit()</code>时出错：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201106155637.png"></p>
<blockquote>
<p>错误信息：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> File <span class="string">"E:\Program_Files\Annoconda\lib\site-packages\pynvml\nvml.py"</span>, line <span class="number">731</span>, <span class="keyword">in</span> _load_nvml_library</span><br><span class="line">    nvml_lib = CDLL(os.path.join(os.getenv(<span class="string">"ProgramFiles"</span>, <span class="string">"C:/Program Files"</span>), <span class="string">"NVIDIA Corporation/NVSMI/nvml.dll"</span>))</span><br><span class="line">  File <span class="string">"E:\Program_Files\Annoconda\lib\ctypes\__init__.py"</span>, line <span class="number">356</span>, <span class="keyword">in</span> __init__</span><br><span class="line">    self._handle = _dlopen(self._name, mode)</span><br><span class="line">OSError: [WinError <span class="number">126</span>] 找不到指定的模块。</span><br></pre></td></tr></table></figure>

<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>在源代码文件 numl.py 中 731 行附近：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (sys.platform[:<span class="number">3</span>] == <span class="string">"win"</span>):</span><br><span class="line">    <span class="comment"># cdecl calling convention</span></span><br><span class="line">    <span class="comment"># load nvml.dll from %ProgramFiles%/NVIDIA Corporation/NVSMI/nvml.dll</span></span><br><span class="line">    nvml_lib = CDLL(os.path.join(os.getenv(<span class="string">"ProgramFiles"</span>, <span class="string">"C:/Program Files"</span>), <span class="string">"NVIDIA Corporation/NVSMI/nvml.dll"</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># assume linux</span></span><br><span class="line">    nvml_lib = CDLL(<span class="string">"libnvidia-ml.so.1"</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以看到模块在尝试寻找 <code>C:/Program Files/NVIDIA Corporation/NVSMI/nvml.dll</code> 文件，如果你的<code>nvml.dll</code>文件不在这就会报错。</p>
</blockquote>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><blockquote>
<p>知道问题的原因，排除故障有两种方案，但都需要知道当前的<code>nvml.dll</code>文件在哪。</p>
</blockquote>
<h5 id="确定-nvidia-smi-exe-位置"><a href="#确定-nvidia-smi-exe-位置" class="headerlink" title="确定 nvidia-smi.exe 位置"></a>确定 nvidia-smi.exe 位置</h5><ul>
<li>打开cmd，输入命令：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">where nvidia-smi</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会返回当前系统的 nvidia-smi.exe的位置 （前提是当前cuda安装正常，可以使用nvidia-smi）</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201106161405.png"></p>
<ul>
<li>去相应位置查看，发现<code>nvml.dll</code>文件和他在一起，所以只要将代码中路径指向它就行了。</li>
</ul>
<h4 id="方案1：-修改源码："><a href="#方案1：-修改源码：" class="headerlink" title="方案1： 修改源码："></a>方案1： 修改源码：</h4><ul>
<li>修改<code>numl.py</code> 中第 731 行代码：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvml_lib &#x3D; CDLL(os.path.join(os.getenv(&quot;ProgramFiles&quot;, &quot;C:&#x2F;Program Files&quot;), &quot;NVIDIA Corporation&#x2F;NVSMI&#x2F;nvml.dll&quot;))</span><br></pre></td></tr></table></figure>

<p>改为你自己的路径：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvml_lib &#x3D; CDLL(r&quot;C:\Windows\System32\nvml.dll&quot;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意反斜杠路径需要在前面加 <code>r</code></p>
</blockquote>
<h4 id="方案2：-为源码创建运行环境"><a href="#方案2：-为源码创建运行环境" class="headerlink" title="方案2： 为源码创建运行环境"></a>方案2： 为源码创建运行环境</h4><ul>
<li><p>源码不会出错，错的是我们自己的环境，改过来就是了。</p>
</li>
<li><p>创建文件夹<code>C:\Program Files\NVIDIA Corporation\NVSMI</code></p>
</li>
<li><p>将<code>nvml.dll</code>文件放在文件夹里</p>
</li>
</ul>
<h4 id="运行示例"><a href="#运行示例" class="headerlink" title="运行示例"></a>运行示例</h4><p><img src="https://photos.zywvvd.com/images_matrixtime/20201106162159.png"></p>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ul>
<li><a href="https://blog.csdn.net/com_fang_bean/article/details/107988018" target="_blank" rel="noopener">https://blog.csdn.net/com_fang_bean/article/details/107988018</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>GPU</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>深度学习</tag>
        <tag>GPU</tag>
      </tags>
  </entry>
  <entry>
    <title>python 使用 pynvml 工具获取GPU工作状态</title>
    <url>/2020/11/06/deep_learning/pynvml_gpu_info_get/pynvml_gpu_info_get/</url>
    <content><![CDATA[<blockquote>
<p>深度学习过程中经常需要和GPU打交道，需要在训练之前确定GPU工作状态。本文介绍python中的pynvml包的使用方法，用来获取上述信息。</p>
</blockquote>
<a id="more"></a>

<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><blockquote>
<p>直接通过pip安装：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install nvidia-ml-py</span><br></pre></td></tr></table></figure>

<blockquote>
<p>或者根据所使用的python版本安装对应包：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install nvidia-ml-py2  # python2</span><br><span class="line">pip install nvidia-ml-py3  # python3</span><br></pre></td></tr></table></figure>

<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line"><span class="keyword">import</span> pynvml </span><br><span class="line"><span class="comment"># 每MB包含的字节数</span></span><br><span class="line">NUM_EXPAND = <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">pynvml.nvmlInit()</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#GPU驱动信息</span></span><br><span class="line">pynvml.nvmlSystemGetDriverVersion()</span><br><span class="line">-&gt; b'441.22'</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取Nvidia GPU块数</span></span><br><span class="line">pynvml.nvmlDeviceGetCount()</span><br><span class="line">-&gt; 1</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取GPU 0 的handle</span></span><br><span class="line">handle = pynvml.nvmlDeviceGetHandleByIndex(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 设备名称</span></span><br><span class="line">pynvml.nvmlDeviceGetName(handle)</span><br><span class="line">-&gt; b'GeForce GTX 1660'</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#通过handle获取GPU 0 的信息</span></span><br><span class="line">info = pynvml.nvmlDeviceGetMemoryInfo(handle)</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#GPU 0 的总显存</span></span><br><span class="line">info.total </span><br><span class="line">-&gt; 6442450944</span><br><span class="line">info.total / NUM_EXPAND</span><br><span class="line">-&gt; 6144.0</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#GPU 0 使用的显存</span></span><br><span class="line">info.used</span><br><span class="line">-&gt; 383299584</span><br><span class="line">info.used / NUM_EXPAND</span><br><span class="line">-&gt; 365.54296875</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#关闭 pynvml</span></span><br><span class="line">pynvml.nvmlShutdown()</span><br></pre></td></tr></table></figure>

<h3 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h3><ul>
<li>报错 ： pynvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found</li>
</ul>
<blockquote>
<p>坑已填：<a href="https://www.zywvvd.com/2020/11/06/deep_learning/pynvml_model_not_found/pynvml_model_not_found/">解决 pynvml 报错 NVML Shared Library Not Found / WinError 126</a></p>
</blockquote>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://www.ngui.cc/51cto/show-33630.html" target="_blank" rel="noopener">http://www.ngui.cc/51cto/show-33630.html</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>GPU</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>GPU</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 VS code 不报错不输出的问题</title>
    <url>/2020/11/02/software/ide/vs_code_no_print_content/vs_code_no_print_content/</url>
    <content><![CDATA[<blockquote>
<p>VS code 是微软的轻量级但功能强大的IDE，刚刚配置好anaconda python环境时可能出现不打印print内容的问题，本文记录该问题解决方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><ul>
<li>刚刚安装好VS code 与 Anaconda时，hello world程序不在终端显示打印内容：</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201102234922.png"></p>
<blockquote>
<p>不显示打印内容。</p>
</blockquote>
<h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><ul>
<li>故障原因在于命令中默认使用的是 anaconda 的<code>pythonw.exe</code>命令，将其换为<code>python.exe即可。</code></li>
</ul>
<h3 id="修改方法"><a href="#修改方法" class="headerlink" title="修改方法"></a>修改方法</h3><ul>
<li>文件-首选项-设置-打开设置：</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201102235621.png"></p>
<ul>
<li>修改”python.pythonPath”：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;python.pythonPath&quot;: &quot;E:\\ProgramData\\Anaconda3\\pythonw.exe&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;python.pythonPath&quot;: &quot;E:\\ProgramData\\Anaconda3\\python.exe&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h3><ul>
<li>程序运行时调用<code>python.exe</code>，而且输出正常。</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20201102235748.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>Python 补全利器 Kite 安装</title>
    <url>/2020/11/02/software/ide/vs_code_kite_install/kite_install/</url>
    <content><![CDATA[<blockquote>
<p>Kite 是针对 Python 的代码补全工具 ，由于其快速智能（AI学习）被圈内广泛使用，本文介绍Kite在Windows 与 Linux环境下与VS code结合使用的方法。</p>
</blockquote>
<a id="more"></a>

<p>官网：<a href="https://www.kite.com/" target="_blank" rel="noopener">https://www.kite.com/</a></p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><ul>
<li><a href="https://www.kite.com/download/" target="_blank" rel="noopener">https://www.kite.com/download/</a></li>
</ul>
<blockquote>
<p>直接安装下载的 KiteSetup.exe 即可。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029095905.png"></p>
<h4 id="在-VS-code-中使用-kite"><a href="#在-VS-code-中使用-kite" class="headerlink" title="在 VS code 中使用 kite"></a>在 VS code 中使用 kite</h4><blockquote>
<p>安装插件 Kite AI Code AutoComplete</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029100241.png"></p>
<blockquote>
<p>随后可以跟着自动弹出的教程学习使用方法。</p>
</blockquote>
<blockquote>
<p>事实上写代码时仅需关注右下角是否开启了Kite即可：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029100608.png"></p>
<blockquote>
<p>此时写Python代码会有kite 的自动补全：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029101019.png"></p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><ul>
<li><a href="https://www.kite.com/download/?loc=top_nav#" target="_blank" rel="noopener">https://www.kite.com/download/?loc=top_nav#</a></li>
</ul>
<p>运行命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash -c &quot;$(wget -q -O - https:&#x2F;&#x2F;linux.kite.com&#x2F;dls&#x2F;linux&#x2F;current)&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>网上有教程说不能使用root用户安装，我在docker中的情况时只能使用root用户安装。</p>
<p>随后VS code 远程调试代码时即可使用kite自动补全。</p>
</blockquote>
<h3 id="吐槽"><a href="#吐槽" class="headerlink" title="吐槽"></a>吐槽</h3><ul>
<li>得说明的是现在的Kite已经收费了</li>
<li>不交费的话每日有使用上限，反正我大概打开IDE一两分钟就会用完</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>VS code 远程调试配置</title>
    <url>/2020/11/02/software/ide/vs_code_remote_debugging/vs_code_remote_debugging/</url>
    <content><![CDATA[<blockquote>
<p>VS code 是微软的轻量级但功能强大的IDE，可扩展的插件众多，基本可以满足所有开发需求。本文介绍使用VS code进行远程调试代码的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul>
<li>Win 10 x64 操作系统</li>
<li>安装 VS code</li>
<li>远程 Linux 服务器</li>
<li><a href="https://www.zywvvd.com/2020/11/02/windows/win_ssh_linux_docker/win_ssh_linux_docker/">成功配置ssh登录服务器（或docker容器）</a></li>
</ul>
<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul>
<li><p>安装 Remote Development 插件</p>
<blockquote>
<p>会自动安装 Remote-WSL / Containers / SSH 等插件。</p>
</blockquote>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201028143530.png"></p>
<h3 id="配置主机信息"><a href="#配置主机信息" class="headerlink" title="配置主机信息"></a>配置主机信息</h3><blockquote>
<p>ctrl + shift + p</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201028174129.png"></p>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201028175152.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Host alias</span><br><span class="line">    HostName 192.168.10.12</span><br><span class="line">    Port 3721</span><br><span class="line">    User root</span><br><span class="line">    IdentityFile ~\.ssh\id_rsa</span><br><span class="line">    IdentitiesOnly yes</span><br></pre></td></tr></table></figure>

<h3 id="vs-code-连接远程主机"><a href="#vs-code-连接远程主机" class="headerlink" title="vs code 连接远程主机"></a>vs code 连接远程主机</h3><p><img src="https://photos.zywvvd.com/images_matrixtime/20201028175324.png"></p>
<blockquote>
<p>之后选择目标主机的操作系统。</p>
</blockquote>
<ul>
<li>成功连接到远程主机：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102202219.png"></p>
<ul>
<li>打开文件夹运行程序时，选择使用的Python环境：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102202420.png"></p>
<ul>
<li>插入断点调试程序，与本机无异：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102202548.png"></p>
<h3 id="填坑"><a href="#填坑" class="headerlink" title="填坑"></a>填坑</h3><h4 id="如果报错：Bad-owner-or-permissions-on-C-Users-Admin-ssh-config"><a href="#如果报错：Bad-owner-or-permissions-on-C-Users-Admin-ssh-config" class="headerlink" title="如果报错：Bad owner or permissions on C:\Users\Admin/.ssh/config"></a>如果报错：Bad owner or permissions on C:\Users\Admin/.ssh/config</h4><blockquote>
<p>解决方案参考： <a href="https://zixizixi.cn/windows_vscode_ssh_error_bad-owner-or-permissions" target="_blank" rel="noopener">https://zixizixi.cn/windows_vscode_ssh_error_bad-owner-or-permissions</a></p>
</blockquote>
<p>原因：在 Windows 系统下的 VSCode 安装 Remote - SSH 扩展后，使用扩展配置 SSH 并进行远程连接，可能会发生 Bad owner or permissions on C:\Users\Administrator/.ssh/config 错误，造成无法进行 SSH 远程连接的问题。</p>
<p>原因是由于使用 Remote - SSH 扩展所依赖的 Remote - SSH: Editing Configuration Files 扩展编辑了 C:\Users\Administrator.ssh\config 文件后，此文件的权限发生了改变。</p>
<p>这之后不但在 VSCode 中由于配置文件权限问题而无法进行 SSH 远程连接，就连使用系统的 PowerShell 进行 SSH 连接时也会报此错误，而把此配置文件删除后，使用  PowerShell 即可正常进行远程连接。但 VSCode 的 SSH 连接又依赖此配置文件，所以就产生了冲突，要么只有 PowerShell 能用，要么就都不能用。</p>
<h4 id="解决方案-一"><a href="#解决方案-一" class="headerlink" title="解决方案 一"></a>解决方案 一</h4><ul>
<li><p>下载 openssh-portable项目：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;PowerShell&#x2F;openssh-portable.git</span><br></pre></td></tr></table></figure>

<p>加速链接：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone git@git.zhlh6.cn:PowerShell&#x2F;openssh-portable.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入项目中的 <code>contrib\win32\openssh</code> 目录中，在该目录使用<strong>管理员权限</strong>打开powershell窗口,执行:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.\FixUserFilePermissions.ps1 -Confirm:$false</span><br></pre></td></tr></table></figure>

<p>执行此命令时若提示 无法加载文件 FixUserFil ePermissions.ps1，因为在此系统上禁止运行脚本 错误，则先执行以下命令，然后输入 Y 回车确认后再重新执行（执行完毕后可以再执行以下命令输入 N 恢复默认配置）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Set-ExecutionPolicy RemoteSigned</span><br></pre></td></tr></table></figure>
</li>
<li><p>随后在powershell与vs code远程过程中都不会再出现上述错误.</p>
</li>
</ul>
<h4 id="解决方案-二"><a href="#解决方案-二" class="headerlink" title="解决方案 二"></a>解决方案 二</h4><blockquote>
<p>将config绝对路径填在SSH设置里：</p>
</blockquote>
<ul>
<li><img src="https://photos.zywvvd.com/images_matrixtime/20201028180850.png"></li>
</ul>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ul>
<li><p><a href="https://www.jb51.net/article/184071.htm" target="_blank" rel="noopener">https://www.jb51.net/article/184071.htm</a></p>
</li>
<li><p><a href="https://segmentfault.com/a/1190000019550872" target="_blank" rel="noopener">https://segmentfault.com/a/1190000019550872</a></p>
</li>
<li><p><a href="https://blog.csdn.net/u011436427/article/details/102981641" target="_blank" rel="noopener">https://blog.csdn.net/u011436427/article/details/102981641</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 远程登录 Linux 服务器 docker 容器</title>
    <url>/2020/11/02/windows/win_ssh_linux_docker/win_ssh_linux_docker/</url>
    <content><![CDATA[<blockquote>
<p> ssh是较可靠，专为远程登录会话和其他网络服务提供安全性的协议，广泛用于远程登录的场景，也是远程调试代码的神兵利器。在开发中经常会在服务器启动自己的 docker 容器进行开发，又需要调试代码，vim的调试环境配置起来门槛又太高。于是就有了使用Windows直接ssh打通docker进行调试的需求。本文记录Windows远程登录Linux服务器docker容器的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><ul>
<li>登录主机操作系统 Win 10</li>
<li>被登录主机操作系统 docker container in Linux</li>
<li>主机与被登录主机（此处指服务器，不是docker）网络联通，IP在同一网段</li>
<li>服务器与docker的IP在同一网段</li>
</ul>
<h2 id="配置方法"><a href="#配置方法" class="headerlink" title="配置方法"></a>配置方法</h2><h3 id="建立docker与Linux服务器的端口映射"><a href="#建立docker与Linux服务器的端口映射" class="headerlink" title="建立docker与Linux服务器的端口映射"></a>建立docker与Linux服务器的端口映射</h3><blockquote>
<p>ssh协议链接时默认使用22端口，Windows与docker的端口往往不能直接进行映射（很可能不在一个网段），因此需要将docker的22端口映射到Linux服务器的某个端口，此时需要在建立docker容器时进行<a href="https://www.zywvvd.com/2020/05/14/coding/environment/wingide-remote-docker/wingide-remote-docker/#docker%E9%85%8D%E7%BD%AE">配置</a>：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker run -it --name vvd -p 3721:22 -v /root/tmp:/root/tmp my_docker bash</span></span><br></pre></td></tr></table></figure>

<ul>
<li>其中 <code>-p</code> 的部分表示将本机（服务器）的3721端口映射到容器的22端口。</li>
</ul>
<h3 id="容器内部安装ssh服务"><a href="#容器内部安装ssh服务" class="headerlink" title="容器内部安装ssh服务"></a>容器内部安装ssh服务</h3><blockquote>
<p>需要在被登录的容器内部建立并启动ssh服务。</p>
</blockquote>
<ul>
<li>首先需要安装：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install openssh-server</span><br><span class="line">apt-get install openssh-client</span><br></pre></td></tr></table></figure>

<ul>
<li>安装完成后需要容器每次启动时自动运行相关服务，可以在 <code>~/.bashrc</code>中加入：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;etc&#x2F;init.d&#x2F;ssh start</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这样就保证了docker容器自动启动该服务。</p>
</blockquote>
<h3 id="修改容器内root用户登录设置"><a href="#修改容器内root用户登录设置" class="headerlink" title="修改容器内root用户登录设置"></a>修改容器内root用户登录设置</h3><blockquote>
<p>有的容器默认不支持root用户远程使用ssh协议进行密码登录的，此时需要更改设置。</p>
</blockquote>
<ul>
<li>打开 <code>/etc/ssh/sshd_config</code>文件：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># PermitRootLogin prohibit-password # 默认打开 禁止root用户使用密码登陆，需要将其注释</span><br><span class="line">RSAAuthentication yes #启用 RSA 认证</span><br><span class="line">PubkeyAuthentication yes #启用公钥私钥配对认证方式</span><br><span class="line">PermitRootLogin yes #允许root用户使用ssh登录</span><br></pre></td></tr></table></figure>

<ul>
<li>将 <code>PermitRootLogin</code> 设置为 yes</li>
</ul>
<h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><blockquote>
<p>远程登录时需要使用系统的用户密码，我们就直接使用root用户登录好了，需要设置新建容器的密码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">passwd root</span><br></pre></td></tr></table></figure>

<h3 id="设置SSH"><a href="#设置SSH" class="headerlink" title="设置SSH"></a>设置SSH</h3><ul>
<li><p><a href="https://www.zywvvd.com/2020/02/23/git/link_github/Git-connect-remote-pos/#%E5%88%9B%E5%BB%BASSH%E5%AF%86%E9%92%A5">本地生成ssh key</a></p>
</li>
<li><p>将.pub 内容复制粘贴加入到远程 ~/.ssh/authorized_keys</p>
</li>
</ul>
<h3 id="SSH连接服务器"><a href="#SSH连接服务器" class="headerlink" title="SSH连接服务器"></a>SSH连接服务器</h3><blockquote>
<p>需要用户名（被登录端用户）与被登录的主机ip和端口号</p>
<p>例如： 用户名- root   ip：192.168.10.12  端口映射为 3721</p>
</blockquote>
<ul>
<li>linux</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh root@192.168.10.12:3721</span><br></pre></td></tr></table></figure>

<ul>
<li>Windows</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh -p 3721 root@192.168.10.12</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102200256.png"></p>
<ul>
<li>如果不清楚Linux系统端口映射配置情况：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">iptables -t nat -L -n</span><br></pre></td></tr></table></figure>

<h3 id="X-shell配置"><a href="#X-shell配置" class="headerlink" title="X-shell配置"></a>X-shell配置</h3><blockquote>
<p>命令行ssh登录成功后就可以在X-shell中建立配置信息方便地连接了。</p>
</blockquote>
<ul>
<li>新建会话，填写名称、IP、端口号（我们刚刚配置过的）：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102200522.png"></p>
<ul>
<li>用户身份认证，填入用户名密码（刚刚配置过的）：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102200640.png"></p>
<ul>
<li>随后就可以使用该会话直接登录docker容器了，为远程调试打下了坚实的基础：</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201102200804.png"></p>
<h3 id="填坑"><a href="#填坑" class="headerlink" title="填坑"></a>填坑</h3><ul>
<li><p>ssh: Could not resolve hostname 192.168.10.12:3721: Name or service not known</p>
<blockquote>
<p>这是在Windows中使用了Linux格式的SSH登录命令导致的解析错误</p>
<p>将命令语法更换为Windows的格式即可</p>
</blockquote>
</li>
<li><p>root 用户无论如何密码不被接受</p>
<blockquote>
<p>需要在被登录主机 /etc/ssh/sshd_config 中设置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># PermitRootLogin prohibit-password # 默认打开 禁止root用户使用密码登陆，需要将其注释</span><br><span class="line">RSAAuthentication yes #启用 RSA 认证</span><br><span class="line">PubkeyAuthentication yes #启用公钥私钥配对认证方式</span><br><span class="line">PermitRootLogin yes #允许root用户使用ssh登录</span><br></pre></td></tr></table></figure>

<ul>
<li>重点：<strong>PermitRootLogin yes</strong></li>
</ul>
</blockquote>
</li>
<li><p>Connection to 192.168.10.12 closed. </p>
</li>
<li><p>或</p>
</li>
<li><p>Connection closed by foreign host.</p>
<blockquote>
<p>意思是 断开主机链接了，出现这种问题，跟你的IPTABLES，防火墙什么的都没关系。</p>
<p>造成这个原 因是因为原来连接到SSHD服务器进程的22端口，当你的客户端突然断开时，服务器端的TCP连接就处于一个半打开状态。当下一次同一客户机再次建立 TCP连接时，服务器检测到这个半打开的TCP连接，并向客户机回传一个置位RST的TCP报文，客户机就会显示connection closed by foreign host。<br>这是TCP协议本身的一个保护措施，并不是什么错误，你只要再重新连接服务器就能连上。</p>
<p>———   <a href="http://www.pooy.net/connection-closed-foreign-host.html" target="_blank" rel="noopener">http://www.pooy.net/connection-closed-foreign-host.html</a></p>
<p>总结一下解决方案： <strong>关机重启</strong></p>
</blockquote>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://blog.csdn.net/hanchaobiao/article/details/84069299" target="_blank" rel="noopener">https://blog.csdn.net/hanchaobiao/article/details/84069299</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>Windows 10</category>
      </categories>
      <tags>
        <tag>软件</tag>
        <tag>Windows 10</tag>
      </tags>
  </entry>
  <entry>
    <title>Git - 解决Github连接失败的问题</title>
    <url>/2020/10/31/git/github_Broken_pipe/github_broken_pipe/</url>
    <content><![CDATA[<blockquote>
<p>Github有时会出现突然连接失败的问题，有部分情况是地址解析错误导致的，本文介绍此类问题的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h3><blockquote>
<p>Github本来好好的，说不定啥时候就会报错，报错信息如下：</p>
</blockquote>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line">Connection to XXXXX port 22: Software caused connection abort</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此问题也会导致 Hexo 在 hexo d 过程中报错：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh_dispatch_run_fatal: Connection to 13.250.177.223 port 22: Broken pipe</span><br><span class="line">fatal: sha1 file &#39;&lt;stdout&gt;&#39; write error: Broken pipeiB&#x2F;s</span><br><span class="line">fatal: the remote end hung up unexpectedly</span><br><span class="line">fatal: the remote end hung up unexpectedly</span><br></pre></td></tr></table></figure>



<h3 id="错误原因"><a href="#错误原因" class="headerlink" title="错误原因"></a>错误原因</h3><ul>
<li>网络不通</li>
<li>本地DNS无法正确解析地址</li>
</ul>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><blockquote>
<p>打开<code>C:\Windows\System32\drivers\etc\hosts</code>文件：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Copyright (c) 1993-2009 Microsoft Corp.</span><br><span class="line">#</span><br><span class="line"># This is a sample HOSTS file used by Microsoft TCP&#x2F;IP for Windows.</span><br><span class="line">#</span><br><span class="line"># This file contains the mappings of IP addresses to host names. Each</span><br><span class="line"># entry should be kept on an individual line. The IP address should</span><br><span class="line"># be placed in the first column followed by the corresponding host name.</span><br><span class="line"># The IP address and the host name should be separated by at least one</span><br><span class="line"># space.</span><br><span class="line">#</span><br><span class="line"># Additionally, comments (such as these) may be inserted on individual</span><br><span class="line"># lines or following the machine name denoted by a &#39;#&#39; symbol.</span><br><span class="line">#</span><br><span class="line"># For example:</span><br><span class="line">#</span><br><span class="line">#      102.54.94.97     rhino.acme.com          # source server</span><br><span class="line">#       38.25.63.10     x.acme.com              # x client host</span><br><span class="line"></span><br><span class="line"># localhost name resolution is handled within DNS itself.</span><br><span class="line">#   127.0.0.1       localhost</span><br><span class="line">#   ::1             localhost</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在最后加入内容：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.30.255.112  github.com git </span><br><span class="line">185.31.16.184 github.global.ssl.fastly.net  12</span><br></pre></td></tr></table></figure>

<ul>
<li>至此问题解决，github可以正常访问。</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Git - 解决Github仓库下载缓慢的问题</title>
    <url>/2020/10/29/git/github_download/github_download/</url>
    <content><![CDATA[<blockquote>
<p>Github仓库在国内下载慢，而且经常失败。该问题有几种解决方案：1、科学上网 2、使用镜像。 科学上网暂且不谈，镜像加速可以使用码云的github代码转存功能，但是该方法比较麻烦，还得转存一次。本文介绍使用Chrome浏览器插件进行加速的镜像方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li><p>使用 google 浏览器 chrome</p>
</li>
<li><p>进入chrome应用商店</p>
<p><a href="https://chrome.google.com/webstore" target="_blank" rel="noopener">https://chrome.google.com/webstore</a></p>
</li>
<li><p>搜索 <code>gitHub 加速</code>：</p>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201028171530.png"></p>
</li>
<li><p>安装 github 加速插件</p>
</li>
<li><p>此时重新打开之前下不来的GitHub页面：</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201028171703.png"></p>
<ul>
<li>可以使用镜像地址下载仓库，速度与之前不可同日而语。</li>
</ul>
<blockquote>
<p>终于痛快了 。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Git - reset, checkout, revert 总结</title>
    <url>/2020/10/17/git/git_get_back/git-get-back/</url>
    <content><![CDATA[<blockquote>
<p>在git版本管理中，经常有将其他提交与当前代码环境内容交互的需求，其中<code>git reset</code>、<code>git checkout</code>和<code>git revert</code>是与此类需求有关的一些命令，它们可以用来调整代码仓库中的某些更改；而且<code>git reset</code>和<code>git checkout</code>两个命令不仅可以作用于提交，还可以作用于特定文件，本文介绍上述三个命令的区别与工作原理。</p>
</blockquote>
<a id="more"></a>

<h2 id="git-基础内容"><a href="#git-基础内容" class="headerlink" title="git 基础内容"></a>git 基础内容</h2><blockquote>
<p>git 相关基础概念与常用命令使用方法在 <a href="https://www.zywvvd.com/2020/05/06/git/git_usage/git-usage/">Git - 使用教程</a> 中有介绍，本文在此基础上进行展开。</p>
</blockquote>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>这三个命令可以作用于<strong>提交</strong>和<strong>文件</strong>：</p>
<table>
<thead>
<tr>
<th align="center">命令</th>
<th align="center">可用于提交</th>
<th align="center">可用于文件</th>
</tr>
</thead>
<tbody><tr>
<td align="center">git reset</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">git checkout</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">git revert</td>
<td align="center">√</td>
<td align="center">×</td>
</tr>
</tbody></table>
<blockquote>
<p>下面从这两个作用域的角度分别介绍相关命令的功能。</p>
</blockquote>
<h3 id="作用于提交"><a href="#作用于提交" class="headerlink" title="作用于提交"></a>作用于提交</h3><blockquote>
<p>三个命令常用的用法均为回退，但是三个命令的实现细节事实上有很大的区别。</p>
</blockquote>
<h4 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h4><ul>
<li><p>工作原理：</p>
<p>当 reset 的作用对象为提交时，reset将一个分支的末端指向另一个提交。</p>
<ul>
<li><p>通过传入这些标记来修改你的缓存区或工作目录：</p>
<p>–soft – 缓存区和工作目录都不会被改变</p>
<p>–mixed (默认选项) 缓存区和你指定的提交同步，但工作目录不受影响</p>
<p>–hard – 缓存区和工作目录都同步到你指定的提交</p>
</li>
</ul>
</li>
<li><p>实例应用：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset HEAD~2</span><br></pre></td></tr></table></figure>

<p>  把当前分支reset到HEAD~2。</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset --mixed HEAD</span><br></pre></td></tr></table></figure>

<p>  将当前的改动从缓存区中移除，但是这些改动还留在工作目录中。</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset --hard HEAD</span><br></pre></td></tr></table></figure>

<p>  完全舍弃还没有提交的改动</p>
</li>
</ul>
<h4 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h4><ul>
<li><p>工作原理：</p>
<p>checkout命令以提交为参数时，将当前工作区、暂存区、仓库均切换到目标提交时的状态。</p>
</li>
<li><p>实例应用：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout &lt;branch&gt;</span><br></pre></td></tr></table></figure>

<p>  切换到指定分支</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout &lt;commit&gt;</span><br></pre></td></tr></table></figure>

<p>  切换到指定提交</p>
</li>
</ul>
<h4 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h4><ul>
<li><p>工作原理：</p>
<p>通过创建一次新的 <code>commit</code> 来撤销一次 <code>commit</code> 所做出的修改。这种撤销的方式是安全的，因为它并不修改 <code>commitm history</code>。</p>
</li>
<li><p>实例应用：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git revert HEAD~2</span><br></pre></td></tr></table></figure>

<p>  将会查出倒数第二次（即当前commit的往前一次）提交的修改，并创建一个新的提交，用于撤销当前提交的上一次 <code>commit</code>。</p>
</li>
</ul>
<h3 id="作用于文件"><a href="#作用于文件" class="headerlink" title="作用于文件"></a>作用于文件</h3><h4 id="git-reset-1"><a href="#git-reset-1" class="headerlink" title="git reset"></a>git reset</h4><ul>
<li><p>工作原理：</p>
<p>当检测到文件路径时，<code>git reset</code> 将缓存区同步到指定的提交。</p>
</li>
<li><p>实例应用：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset HEAD~2 foo.py</span><br></pre></td></tr></table></figure>

<p>  将文件 foo.py 在缓冲区的状态更改为HEAD之前2个的提交。</p>
</li>
</ul>
<blockquote>
<p>注: –soft、–mixed和–hard对文件层面的<code>git reset</code>毫无作用，缓存区中的文件一定会变化，而工作目录中的文件一定不变。</p>
</blockquote>
<h4 id="checkout-1"><a href="#checkout-1" class="headerlink" title="checkout"></a>checkout</h4><ul>
<li><p>工作原理：</p>
<p>提取某个已经缓存的文件状态（缓存区、提交）用于覆盖当前工作区的文件。</p>
<p><strong>与reset作用于文件相比，不同的是checkout更改的文件位置为工作区，reset为暂存区</strong>。</p>
</li>
<li><p>实例应用：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout HEAD~2 foo.py</span><br></pre></td></tr></table></figure>

<p>  将工作目录中的foo.py同步到了倒数第二个提交中的foo.py。</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout -- foo.py</span><br></pre></td></tr></table></figure>

<p>  当不指定特定提交时，checkout 优先从暂存区中提取文件副本覆盖工作区文件；当文件没有在暂存区提交过（没有add过）时，从仓库中（当前提交）提取文件副本覆盖工作区文件。</p>
<p>  也就是说，该命令会提取最近的一次保存的副本覆盖当前工作区的文件。</p>
</li>
</ul>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ul>
<li><a href="https://www.cnblogs.com/houpeiyong/p/5890748.html" target="_blank" rel="noopener">https://www.cnblogs.com/houpeiyong/p/5890748.html</a></li>
<li><a href="https://www.jianshu.com/p/285302d1eb73" target="_blank" rel="noopener">https://www.jianshu.com/p/285302d1eb73</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Typora 常用快捷键</title>
    <url>/2020/10/16/software/typora-usage/typora-usage/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Typora常用快捷键。</p>
</blockquote>
<a id="more"></a>

<h3 id="快捷键-（for-Windows）"><a href="#快捷键-（for-Windows）" class="headerlink" title="快捷键 （for Windows）"></a>快捷键 （for Windows）</h3><h4 id="文本编辑快捷键"><a href="#文本编辑快捷键" class="headerlink" title="文本编辑快捷键"></a>文本编辑快捷键</h4><ul>
<li>无序列表：输入-之后输入空格 / ctrl + shift + ] (对选中行可用)</li>
<li>有序列表：输入数字 + “.”之后输入空格 / ctrl + shift + [ (对选中行可用)</li>
<li>引用内容：&gt; + 空格 / ctrl + shift + q (对选中内容可用)</li>
<li>任务列表：-[空格]空格 文字</li>
<li>标题：ctrl + 数字</li>
<li>表格：ctrl + t</li>
<li>目录：[TOC]</li>
<li>任务列表：- [ ] 文字（注意 “-” 后与 “[]“ 中间都有空格）</li>
<li>选中一整行：ctrl + l (字母L)</li>
<li>选中单词：ctrl + d</li>
<li>选中相同格式的文字：ctrl + e</li>
<li>跳转到文章开头：ctrl + home</li>
<li>跳转到文章结尾：ctrl + end</li>
<li>搜索：ctrl + f</li>
<li>替换：ctrl + h</li>
<li>引用：输入&gt;之后输入空格</li>
<li>代码块： ctrl + shift + k</li>
<li>行内代码：ctrl + shift + ` (对选中行可用)</li>
<li>加粗：ctrl + b</li>
<li>倾斜：ctrl + i</li>
<li>下划线：ctrl + u</li>
<li>删除线：alt + shift + 5</li>
<li>插入链接：ctrl + k</li>
<li>插入公式：ctrl + shift + m</li>
<li>插入图片：ctrl + shift + i</li>
<li>保存：ctrl + s</li>
<li>另存为：ctrl + shift + s</li>
</ul>
<h4 id="编辑模式快捷键"><a href="#编辑模式快捷键" class="headerlink" title="编辑模式快捷键"></a>编辑模式快捷键</h4><ul>
<li>源码模式编辑切换：ctrl + /</li>
<li>打字机模式切换：F9</li>
<li>专注模式切换：F8</li>
<li>全屏模式切换：F11</li>
<li>Typora内部窗口焦点切换：ctrl  + tab</li>
<li>侧边栏显示/隐藏切换：ctrl + shift + L</li>
</ul>
<h3 id="快捷键自定义配置"><a href="#快捷键自定义配置" class="headerlink" title="快捷键自定义配置"></a>快捷键自定义配置</h3><blockquote>
<p>偏好设置 -&gt; 打开高级设置-&gt;conf.user.json文件</p>
<p>keyBinding 即为快捷键配置：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;keyBinding&quot;: &#123;</span><br><span class="line">  &#x2F;&#x2F; for example: </span><br><span class="line">  &quot;Always on Top&quot;: &quot;Ctrl + Shift + P&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="表情"><a href="#表情" class="headerlink" title="表情"></a>表情</h3><ul>
<li>:表情: </li>
</ul>
<blockquote>
<p>例如：输入: + smile + :，注意两边都有:</p>
<p>:smile:</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>Software</tag>
        <tag>Typora</tag>
      </tags>
  </entry>
  <entry>
    <title>Python 使用 ipdb 调试程序</title>
    <url>/2020/10/16/python/ipdb-usage/ipdb-usage/</url>
    <content><![CDATA[<blockquote>
<p>python 中有在文本环境中为编程者提供的调试工具包ipdb，本文介绍基本使用方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install ipdb</span><br></pre></td></tr></table></figure>

<h3 id="设置断点"><a href="#设置断点" class="headerlink" title="设置断点"></a>设置断点</h3><ul>
<li>引用包：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ipdb</span><br></pre></td></tr></table></figure>

<ul>
<li>插入断点：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ipdb.set_trace()</span><br></pre></td></tr></table></figure>

<ul>
<li>程序运行到断点处会自动停下，为调试提供信息：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">info_to_dict.py(88)&lt;module&gt;()</span><br><span class="line">     87 </span><br><span class="line">---&gt; 88     step_length &#x3D; int(np.ceil(len(record_items_list) &#x2F; task_num))</span><br><span class="line">     89     current_record_items_list &#x3D; record_items_list[index * step_length: (index + 1) * step_length]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此为某次我的程序调试的信息，</p>
<p>—&gt; 表示当前程序运行到此处 （第88行）</p>
</blockquote>
<h3 id="调试程序"><a href="#调试程序" class="headerlink" title="调试程序"></a>调试程序</h3><blockquote>
<p>程序运行到断点后，ipdb提供了和ide一样的调试功能，包括变量查看、终端执行命令、步过、步入、继续运行等等。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">按键 (可以全名， 也可以缩写)</th>
<th align="center">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ENTER</td>
<td align="center">重复上次命令</td>
</tr>
<tr>
<td align="center">c (cont) (continue)</td>
<td align="center">继续</td>
</tr>
<tr>
<td align="center">l (list)</td>
<td align="center">可以列出当前将要运行的代码块</td>
</tr>
<tr>
<td align="center">s (step)</td>
<td align="center">步入</td>
</tr>
<tr>
<td align="center">n (next)</td>
<td align="center">步过</td>
</tr>
<tr>
<td align="center">r (return)</td>
<td align="center">运行到程序结束</td>
</tr>
<tr>
<td align="center">!&lt;python 命令&gt;</td>
<td align="center">执行命令</td>
</tr>
<tr>
<td align="center">h (help)</td>
<td align="center">帮助</td>
</tr>
<tr>
<td align="center">h + 指令</td>
<td align="center">显示指令帮助内容</td>
</tr>
<tr>
<td align="center">a (args)</td>
<td align="center">打印当前函数的参数</td>
</tr>
<tr>
<td align="center">j + 行数</td>
<td align="center">跳转到指定的行数</td>
</tr>
<tr>
<td align="center">p (print)</td>
<td align="center">打印变量</td>
</tr>
<tr>
<td align="center">q (quit)</td>
<td align="center">退出调试</td>
</tr>
</tbody></table>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>调试</tag>
      </tags>
  </entry>
  <entry>
    <title>Parallel 简易安装使用指南</title>
    <url>/2020/09/04/linux/parallel/usage_of_parallel/</url>
    <content><![CDATA[<blockquote>
<p>GNU Parallel 是一个shell工具，可以在一台或多台计算机上并行执行计算任务。本文介绍Parallel的安装和使用其运行文件中多条指令的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;ftp.gnu.org&#x2F;gnu&#x2F;parallel&#x2F;parallel-20190122.tar.bz2</span><br><span class="line">tar jxvf parallel-20190122.tar.bz2</span><br><span class="line">cd parallel-20190122</span><br><span class="line">.&#x2F;configure</span><br><span class="line">make -j 4</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<h2 id="执行指令"><a href="#执行指令" class="headerlink" title="执行指令"></a>执行指令</h2><h3 id="指令文件用例"><a href="#指令文件用例" class="headerlink" title="指令文件用例"></a>指令文件用例</h3><blockquote>
<p>test.txt</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo ABC</span><br><span class="line">echo ABC</span><br><span class="line">echo ABC</span><br><span class="line">echo ABC</span><br><span class="line">echo ABC</span><br></pre></td></tr></table></figure>

<h3 id="并行执行"><a href="#并行执行" class="headerlink" title="并行执行"></a>并行执行</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parallel -u &lt; test.txt</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>修改 VS code 中 flake8 单行最长字符数量限制</title>
    <url>/2020/08/11/software/ide/flake8-max-size/flake8-max-size/</url>
    <content><![CDATA[<blockquote>
<p>VS code 带有强大的插件功能，其中有一个叫做flake8的插件可以规范代码，帮助养成良好的编码习惯，但是该规范规定单行最长字符个数76完全不够用，网上的方案统统不灵，为了不被逼疯，记录如下解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="添加配置"><a href="#添加配置" class="headerlink" title="添加配置"></a>添加配置</h3><blockquote>
<p>网上流行的方案是在VS code配置页中加入flake8的配置信息：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;python.linting.flake8Args&quot;: [&quot;--max-line-length&#x3D;248&quot;]&#96;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在我的环境里是不灵的。</p>
</blockquote>
<h3 id="修改源码"><a href="#修改源码" class="headerlink" title="修改源码"></a>修改源码</h3><p><strong>找到<code>flake8</code>python包的位置，打开 <code>Annoconda\Lib\site-packages\flake8</code>文件夹中的文件：<code>defaults.py</code>，修改：</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MAX_LINE_LENGTH &#x3D; 248</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重启VS code 即可</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>IDE</category>
        <category>VS code</category>
      </categories>
      <tags>
        <tag>IDE</tag>
        <tag>VS code</tag>
      </tags>
  </entry>
  <entry>
    <title>mount 命令(三) —— Linux 挂载 Windows 共享目录</title>
    <url>/2020/08/09/linux/mount/mount-win-disk/mount-win-disk/</url>
    <content><![CDATA[<blockquote>
<p>在工程中遇到了Linux系统需要挂载Windows目录的需求，本文记录实现方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="Windows-系统设置"><a href="#Windows-系统设置" class="headerlink" title="Windows 系统设置"></a>Windows 系统设置</h2><h3 id="打开SMB服务"><a href="#打开SMB服务" class="headerlink" title="打开SMB服务"></a>打开SMB服务</h3><blockquote>
<p>打开 <strong>控制面板</strong> -&gt; <strong>程序和功能 -</strong>&gt; <strong>启动SMB 1.0/CIFS文件共享支持</strong> -&gt; <strong>重启计算机</strong></p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20200730104725.png"></p>
<h3 id="设置共享文件夹"><a href="#设置共享文件夹" class="headerlink" title="设置共享文件夹"></a>设置共享文件夹</h3><blockquote>
<p><strong>需要共享的文件夹</strong> -&gt; <strong>右键 属性</strong> -&gt; <strong>共享</strong> -&gt; <strong>共享设置</strong> -&gt;<strong>添加Everyone用户</strong> -&gt; <strong>设置需要为该用户开放的权限</strong></p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20200810000517.png"></p>
<blockquote>
<p>配置完共享设置后可以在<code>网络</code>中看到自己共享的目录:</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20200810001648.png"></p>
<blockquote>
<p>此时在你的windows系统中，该目录网络路径为 <code>\\计算机名\路径名</code>，其他网络中的用户也可以使用该地址访问你共享的内容:</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20200810001842.png"></p>
<h3 id="设置共享是否需要密码"><a href="#设置共享是否需要密码" class="headerlink" title="设置共享是否需要密码"></a>设置共享是否需要密码</h3><blockquote>
<p>打开 <strong>控制面板</strong> -&gt; <strong>网络和共享中心 -</strong>&gt; <strong>高级共享设置</strong> -&gt; <strong>所有网络</strong> -&gt; <strong>配置密码保护的共享</strong> 即可</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20200810001014.png"></p>
<h3 id="防火墙设置"><a href="#防火墙设置" class="headerlink" title="防火墙设置"></a>防火墙设置</h3><blockquote>
<p>在可以为可用性牺牲安全性的场景中可以关闭防火墙</p>
</blockquote>
<h2 id="Linux-设置"><a href="#Linux-设置" class="headerlink" title="Linux 设置"></a>Linux 设置</h2><h3 id="安装相关包"><a href="#安装相关包" class="headerlink" title="安装相关包"></a>安装相关包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nfs-common</span><br><span class="line">sudo apt-get install smbfs</span><br><span class="line">sudo apt-get install cifs-utils</span><br></pre></td></tr></table></figure>

<h3 id="执行-mount-命令"><a href="#执行-mount-命令" class="headerlink" title="执行 mount 命令"></a>执行 mount 命令</h3><blockquote>
<p>mount 前需要手动建立文件夹，命令不会自动创建</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo mount -t cifs -o username=Everyone //10.0.2.19/temp win_disk/</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：在Windows的<code>\\计算机名\路径名</code>地址在Linux挂载中不好用，需要将计算机名换为Windows计算机的IP地址。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 解决 conda activate 报错的问题</title>
    <url>/2020/07/27/python/conda-activate-error/conda_activate_error/</url>
    <content><![CDATA[<blockquote>
<p>有时<code>conda</code>环境路径配置出问题会使<code>conda activate</code>命令失效，只能使用<code>source</code>执行环境激活相关操作，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><blockquote>
<p>此时可以使用<code>conda init</code>命令进行复位修复：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda init</span><br><span class="line">source ~/anaconda3/etc/profile.d/conda.sh  # 此处使用自己的 anaconda 安装目录</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时会在 ~/.bashrc 文件中加入</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;</span></span><br><span class="line"><span class="comment"># !! Contents within this block are managed by 'conda init' !!</span></span><br><span class="line">__conda_setup=<span class="string">"<span class="variable">$('/workspace/nfs/anaconda3/bin/conda' 'shell.bash' 'hook' 2&gt; /dev/null)</span>"</span></span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">eval</span> <span class="string">"<span class="variable">$__conda_setup</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">"/workspace/nfs/anaconda3/etc/profile.d/conda.sh"</span> ]; <span class="keyword">then</span></span><br><span class="line">        . <span class="string">"/workspace/nfs/anaconda3/etc/profile.d/conda.sh"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">export</span> PATH=<span class="string">"/workspace/nfs/anaconda3/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后<code>conda activate</code>等相关命令就能用了。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>mount 命令(二) —— mount 命令介绍</title>
    <url>/2020/07/25/linux/mount/mount-disk/mount-disk/</url>
    <content><![CDATA[<blockquote>
<p>磁盘挂载可以有效解决数据同步与磁盘空间浪费的问题，而且支持不同操作系统之间挂载操作，核心命令为<code>mount</code>，本文介绍该命令。    </p>
</blockquote>
<a id="more"></a>

<h3 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h3><blockquote>
<p>挂载常用的命令为<code>mount</code>，其命令格式为：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mount [args] device dir</span><br></pre></td></tr></table></figure>

<blockquote>
<p>args表示配置参数，其中最常用的为 <code>-t</code>和<code>-o</code>参数：</p>
</blockquote>
<p><strong>-t</strong> </p>
<p>指定文件系统的类型，通常不必指定，mount 会自动选择正确的类型，常用类型有:</p>
<p><code>iso9660</code>: 光盘或光盘镜像<br><code>msdos</code>: DOS fat16文件系统<br><code>vfat</code>: Windows 9x fat32文件系统<br><code>ntfs</code>: Windows NT ntfs文件系统<br><code>smbfs</code>: Mount Windows文件网络共享<br><code>nfs</code>: UNIX(LINUX) 文件网络共享<br><code>ext2</code>: linux目前常用的文件系统<br><code>auto</code>: 自动检测文件系统<br><code>cifs</code>: 通用Internet文件系统，广泛用于Windows系统文件交互</p>
<p><strong>-o</strong> </p>
<p>主要用来描述设备或档案的挂接方式，常用的参数有:</p>
<p><code>defaults:</code> 使用所有选项的默认值（<code>auto</code>、<code>nouser</code>、<code>rw</code>、<code>suid</code>）<br><code>auto/noauto</code>: 允许/不允许以 –a选项进行安装<br><code>dev/nodev</code>: 对/不对文件系统上的特殊设备进行解释<br><code>exec/noexec:</code> 允许/不允许执行二进制代码<br><code>suid/nosuid</code>: 确认/不确认suid和sgid位<br><code>user /nouser:</code> 允许/不允许一般用户挂载<br><code>codepage=XXX</code>: 代码页<br><code>remount</code>: 重新安装已经安装了的文件系统<br><code>loop</code>: 用来把一个文件当成硬盘分区挂接上系统<br><code>ro</code>: 采用只读方式挂接设备<br><code>rw</code>: 采用读写方式挂接设备<br><code>iocharset</code>: 指定访问文件系统所用字符集</p>
<blockquote>
<p>此外<code>mount</code>命令还有其他可选参数：</p>
</blockquote>
<p><strong>-a</strong> </p>
<p>安装在/etc/fstab文件中类出的所有文件系统。</p>
<p><strong>-f</strong> </p>
<p>伪装mount，作出检查设备和目录的样子，但并不真正挂载文件系统。</p>
<p><strong>-n</strong> </p>
<p>不把安装记录在/etc/mtab 文件中。</p>
<p><strong>-r</strong> </p>
<p>讲文件系统安装为只读。</p>
<p><strong>-v</strong> </p>
<p>详细显示安装信息。</p>
<p><strong>-w</strong> </p>
<p>将文件系统安装为可写，为命令默认情况。</p>
<blockquote>
<ul>
<li>需要注意的是，挂载点必须是一个已经存在的目录，这个目录可以不为空，但挂载后这个目录下以前的内容将不可用，umount以后会恢复正常。使用多个-o参数的时候，-o 只用一次，参数之间用半角逗号隔开。</li>
<li>经常需要root权限才能执行该命令</li>
</ul>
</blockquote>
<blockquote>
<p>其余的参数为需要挂载的设备和挂载点</p>
</blockquote>
<p><strong>device</strong> </p>
<p>要挂接(mount)的设备。</p>
<p><strong>dir</strong></p>
<p>设备在系统上的挂接点(mount point)。</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><blockquote>
<p>假设我们需要将一个镜像文件(*.iso)挂载到某个目录，需要执行以下操作：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">mkdir mnt </span></span><br><span class="line"><span class="meta">$</span><span class="bash">mount -o loop -t iso9660 my.iso ~/mnt</span></span><br></pre></td></tr></table></figure>

<h3 id="查看挂载情况"><a href="#查看挂载情况" class="headerlink" title="查看挂载情况"></a>查看挂载情况</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">df -h</span></span><br></pre></td></tr></table></figure>

<h3 id="查看某主机提供的nfs服务"><a href="#查看某主机提供的nfs服务" class="headerlink" title="查看某主机提供的nfs服务"></a>查看某主机提供的nfs服务</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">showmount  -e 192.168.1.1(ip)</span></span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">nc  -v -w 2  192.168.1.2 -z 2049</span></span><br></pre></td></tr></table></figure>

<h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><blockquote>
<p>卸载使用<code>umount</code>命令</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">umount dir</span></span><br><span class="line"><span class="meta">$</span><span class="bash">umount device</span></span><br><span class="line"><span class="meta">$</span><span class="bash">umount device dir</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上三个命令都可以。</p>
</blockquote>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ul>
<li><p>在挂载点<code>mnt</code>路径下卸载会失败，提示<code>Dev is busy</code></p>
<ul>
<li><p>解决方案：</p>
<p>退出挂载点进行卸载操作</p>
</li>
</ul>
</li>
<li><p>其他程序访问挂载文件也会提示卸载失败</p>
<ul>
<li><p>解决方案：</p>
<ol>
<li><p><code>lsof mnt</code>  查看是哪个进程占用了 <code>mnt</code></p>
</li>
<li><p><code>kill -9 $pid</code>  </p>
</li>
<li><p>重试卸载</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p>有没有‘咔嚓’卸载掉的方法</p>
<ul>
<li><p>解决方案：</p>
<p><code>umount -l mnt</code></p>
<p>其中 <code>-l</code> 的作用是卸载前检查占用该挂载文件的程序并迅速kill掉，以达到快速卸载的目的</p>
</li>
</ul>
</li>
<li><p>Win 中如何挂载</p>
<ul>
<li><p>解决方案：</p>
<p>可以在<code>资源管理器-主页-轻松访问-映射为驱动器</code>中挂载</p>
<p>地址格式： <code>\\192.168.1.2\disk\balabala</code></p>
<p>也可以在cmd中使用<code>mount</code>命令</p>
<p><code>mount \\192.168.1.2\disk\balabala V:\</code></p>
</li>
</ul>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>vim 学习笔记（二）—— 基本导航命令</title>
    <url>/2020/07/22/words/vim/vim-nootbook-2/</url>
    <content><![CDATA[<blockquote>
<p>课程链接：<a href="https://www.bilibili.com/video/BV1Cb411u7L9?p=7" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Cb411u7L9?p=7</a></p>
<p>本节课介绍基本的文本导航命令。</p>
</blockquote>
<a id="more"></a>

<h3 id="导航命令"><a href="#导航命令" class="headerlink" title="导航命令"></a>导航命令</h3><blockquote>
<p>命令模式下：</p>
</blockquote>
<h4 id="移动光标"><a href="#移动光标" class="headerlink" title="移动光标"></a>移动光标</h4><ul>
<li><code>j</code>: 下移一行</li>
<li><code>k</code>: 上移一行</li>
<li><code>l</code>: 右移一列</li>
<li><code>h</code>: 左移一列</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200722223706.png"></p>
<ul>
<li><code>Ctrl+f</code>: 下翻页</li>
<li><code>Ctrl+f</code>: 上翻页</li>
</ul>
<h4 id="单词切换"><a href="#单词切换" class="headerlink" title="单词切换"></a>单词切换</h4><ul>
<li><code>w</code>:  下一个单词，分辨标点</li>
<li><code>W</code>:  下一个单词，只识别空格</li>
<li><code>b</code>: 上一个单词，分辨标点</li>
<li><code>B</code>: 上一个单词，只识别空格</li>
</ul>
<h4 id="光标复位"><a href="#光标复位" class="headerlink" title="光标复位"></a>光标复位</h4><ul>
<li><code>z - Enter</code>: 将光标所在位置复位至中上部</li>
</ul>
<h4 id="行间切换"><a href="#行间切换" class="headerlink" title="行间切换"></a>行间切换</h4><ul>
<li><code>0</code>: 光标移至行首</li>
<li><code>^</code>: 光标移至行内第一个单词</li>
<li><code>$</code>: 光标移至行尾</li>
<li><code>num - gg</code>: 移动至<code>num</code>行第一个单词</li>
<li><code>num - G</code>: 移动至<code>num</code>行第一个单词</li>
<li> <code>:num - Enter</code>: 移动至<code>num</code>行第一个单词</li>
<li> <code>:$ - Enter</code>: 移动至<code>num</code>行第一个单词</li>
<li><code>gg</code>: 返回文件首部第一个单词</li>
<li><code>G</code>: 到文件最末行第一个单词</li>
</ul>
<h4 id="工作状态"><a href="#工作状态" class="headerlink" title="工作状态"></a>工作状态</h4><ul>
<li><code>Ctrl+g</code>: 显示文件名 工作状态 当前行数</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200722232829.png"></p>
<ul>
<li><code>g - Ctrl+g</code>: 显示当前行列详细信息</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200722233132.png"></p>
<ul>
<li><code>:set ruler</code>: 开启标尺信息</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200722233404.png"></p>
<blockquote>
<p>开启标尺后，<code>Ctrl+g</code>不再显示重复信息</p>
</blockquote>
<ul>
<li><code>:set noruler</code>: 关闭标尺信息</li>
<li><code>:set ruler!</code>: 对当前ruler设置取反（如果关闭则打开，如果打开则关闭）</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>文字编码</category>
        <category>vim</category>
      </categories>
      <tags>
        <tag>文字编码</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>vim 学习笔记（一）—— vim模式与创建、编辑文件</title>
    <url>/2020/07/21/words/vim/vim-nootbook-1/</url>
    <content><![CDATA[<blockquote>
<ul>
<li><p>vim 是源于linux的一款文本编辑器，在vi基础上开发，具有强大的文本编辑能力，且具有跨平台、几乎所有工具支持的普适性的特点。据说大神级的vim使用者可以在键盘上按照思想的速度操作文本，因此慕名而来，跟风学习一波。</p>
</li>
<li><p>教师是B站搬运来的生肉教程<a href="https://www.bilibili.com/video/BV1Cb411u7L9/" target="_blank" rel="noopener">【公开课】完美的Vim课程【生肉】</a>，事实上vim教程很多，该生肉教程旨在讲解思想和精髓，没有拘泥于具体命令的介绍，有利于建立完整的思维体系。至于细节命令就是知识性内容的学习与熟能生巧的问题了。</p>
</li>
<li><p>该系列笔记为我随学随记的内容，作为个人的学习记录，也作为资料供大家参考。</p>
</li>
</ul>
</blockquote>
<a id="more"></a>

<h3 id="vim-模式"><a href="#vim-模式" class="headerlink" title="vim 模式"></a>vim 模式</h3><blockquote>
<p>vim 共分为三种模式，分别是<strong>命令模式（Command mode）</strong>，<strong>输入模式（Insert mode）</strong>和<strong>底线命令模式（Last line mode）</strong>。</p>
</blockquote>
<h4 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h4><p>用户刚刚启动 vi/vim，便进入了命令模式。</p>
<p>此状态下敲击键盘动作会被Vim识别为命令，而非输入字符。比如我们此时按下i，并不会输入一个字符，i被当作了一个命令。</p>
<p>以下是常用的几个命令：</p>
<ul>
<li><strong>i</strong> 切换到输入模式，以输入字符。</li>
<li><strong>x</strong> 删除当前光标所在处的字符。</li>
<li><strong>:</strong> 切换到底线命令模式，以在最底一行输入命令。</li>
</ul>
<h4 id="输入模式"><a href="#输入模式" class="headerlink" title="输入模式"></a>输入模式</h4><p>在命令模式下按下i就进入了输入模式。</p>
<p>该模式下字符都会变成内容输入在文本编辑器中，与我们平时使用编辑器功能基本相同。</p>
<p><strong>ESC</strong>，退出输入模式，切换到命令模式</p>
<h4 id="底线命令模式"><a href="#底线命令模式" class="headerlink" title="底线命令模式"></a>底线命令模式</h4><p>在命令模式下按下:（英文冒号）就进入了底线命令模式。</p>
<p>底线命令模式可以输入单个或多个字符的命令。</p>
<p><img src="https://photos.zywvvd.com/image_canglan/20200721001354.png"></p>
<blockquote>
<p>参考：<a href="https://www.runoob.com/linux/linux-vim.html" target="_blank" rel="noopener">https://www.runoob.com/linux/linux-vim.html</a></p>
</blockquote>
<h3 id="使用vim创建与编辑文件"><a href="#使用vim创建与编辑文件" class="headerlink" title="使用vim创建与编辑文件"></a>使用vim创建与编辑文件</h3><blockquote>
<p>课程链接：<a href="https://www.bilibili.com/video/BV1Cb411u7L9?p=6" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Cb411u7L9?p=6</a></p>
</blockquote>
<ul>
<li>创建文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim test.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/image_canglan/20200721002209.png"></p>
<blockquote>
<p>此时默认是命令模式，编辑文件需要进入编辑模式。</p>
</blockquote>
<ul>
<li>编辑模式</li>
</ul>
<p>按下 <code>i</code>键进入编辑模式， 输入文本内容。</p>
<p><img src="https://photos.zywvvd.com/image_canglan/20200721002108.png"></p>
<blockquote>
<p>输入结束后按下<code>esc</code>键返回命令模式，保存文件需要在单行模式下进行。</p>
</blockquote>
<ul>
<li>保存文件</li>
</ul>
<p>在命令模式中按下<code>:</code>键进入单行模式，输入wq按下回车，表示<code>写入-退出</code>当前文件。</p>
<p><img src="https://photos.zywvvd.com/image_canglan/20200721002558.png"></p>
<p>可以看到我们成功使用vim建立了文件并保存。</p>
<p><img src="https://photos.zywvvd.com/image_canglan/20200721002732.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>文字编码</category>
        <category>vim</category>
      </categories>
      <tags>
        <tag>文字编码</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 Github 无法登录的问题</title>
    <url>/2020/07/08/troubleshooting/github_cannot_log_in/github_cannot_log_in/</url>
    <content><![CDATA[<blockquote>
<p> 不知怎的，GitHub突然无法登录，本文记录解决方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h3><blockquote>
<p>不管你能不能访问，github就在那里，是因为我们网络在dns上找不到当前github 的地址导致的无法登录。</p>
<p>解决思路是手动找到github网站IP，填入到host中，这样我们在访问时会直接从host中读取IP并访问。</p>
</blockquote>
<h3 id="查找github-IP地址"><a href="#查找github-IP地址" class="headerlink" title="查找github IP地址"></a>查找github IP地址</h3><blockquote>
<p><strong>IP查询网站：</strong> <a href="https://www.ipaddress.com/" target="_blank" rel="noopener">https://www.ipaddress.com/</a></p>
</blockquote>
<ul>
<li>查询 <strong>github.com</strong></li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200708003724.png"></p>
<ul>
<li>保存结果</li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200708003825.png"></p>
<ul>
<li>查询 <strong>github.global.ssl.fastly.net</strong></li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200708003914.png"></p>
<ul>
<li>保存结果 </li>
</ul>
<p><img src="https://photos.zywvvd.com/image_canglan/20200708003950.png"></p>
<h3 id="写入host文件"><a href="#写入host文件" class="headerlink" title="写入host文件"></a>写入host文件</h3><ul>
<li>Windows </li>
</ul>
<blockquote>
<p>打开 <code>C:\Windows\System32\drivers\etc</code> 路径下的 <code>hosts</code>文件，加入上述结果：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># github</span><br><span class="line">140.82.112.4 github.com</span><br><span class="line">199.232.69.194 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># github</span><br><span class="line">192.30.253.112 github.com </span><br><span class="line">151.101.185.194 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure>



<ul>
<li>Linux</li>
</ul>
<blockquote>
<p>打开<code>\etc\hosts</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># github </span><br><span class="line">140.82.112.4 github.com</span><br><span class="line">199.232.69.194 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># github</span><br><span class="line">192.30.253.112 github.com </span><br><span class="line">151.101.185.194 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure>



<h3 id="刷新DNS"><a href="#刷新DNS" class="headerlink" title="刷新DNS"></a>刷新DNS</h3><ul>
<li>Windows </li>
</ul>
<blockquote>
<p>打开命令提示符， 输入指令：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ipconfig &#x2F;flushdns</span><br></pre></td></tr></table></figure>

<ul>
<li>Linux</li>
</ul>
<blockquote>
<p>在终端中输入：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo rcnscd restart</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重启浏览器即可访问 github</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image_canglan/20200708005147.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - conda 常用命令介绍</title>
    <url>/2020/06/20/python/conda-env-operation/conda-env-operation/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍使用conda管理anaconda Python环境的相关命令。</p>
</blockquote>
<a id="more"></a>

<h2 id="conda-环境相关命令"><a href="#conda-环境相关命令" class="headerlink" title="conda 环境相关命令"></a>conda 环境相关命令</h2><h3 id="创建环境"><a href="#创建环境" class="headerlink" title="创建环境"></a>创建环境</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda create -n env_name python=3.7 --clone another_env</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-n：name 表示新环境名称</p>
<p>python：使用python版本</p>
<p>–clone：从现有环境复制而来</p>
</blockquote>
<h3 id="删除环境"><a href="#删除环境" class="headerlink" title="删除环境"></a>删除环境</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda remove -n env_name --all</span><br></pre></td></tr></table></figure>

<h3 id="查看环境"><a href="#查看环境" class="headerlink" title="查看环境"></a>查看环境</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda info -e</span><br></pre></td></tr></table></figure>

<h3 id="激活环境"><a href="#激活环境" class="headerlink" title="激活环境"></a>激活环境</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda activate env_name</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source activate env_name</span><br></pre></td></tr></table></figure>

<h3 id="退出环境"><a href="#退出环境" class="headerlink" title="退出环境"></a>退出环境</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source deactivate</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会回到<code>base</code>环境</p>
</blockquote>
<h2 id="conda-包相关命令"><a href="#conda-包相关命令" class="headerlink" title="conda 包相关命令"></a>conda 包相关命令</h2><h3 id="查看当前环境下conda管理的python包列表"><a href="#查看当前环境下conda管理的python包列表" class="headerlink" title="查看当前环境下conda管理的python包列表"></a>查看当前环境下conda管理的python包列表</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda list</span><br></pre></td></tr></table></figure>

<h3 id="安装python包"><a href="#安装python包" class="headerlink" title="安装python包"></a>安装python包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda install package_name #安装包</span><br><span class="line">conda install package_name_1 package_name_2 package_name_3 ... #一次安装多个包</span><br><span class="line">conda install package_name=1.1.0 #安装指定版本的包</span><br></pre></td></tr></table></figure>

<h3 id="更新包"><a href="#更新包" class="headerlink" title="更新包"></a>更新包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda update package_name # 更新包</span><br><span class="line">conda upgrade --all #更新所有包</span><br></pre></td></tr></table></figure>

<h3 id="卸载包"><a href="#卸载包" class="headerlink" title="卸载包"></a>卸载包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda remove package_name</span><br></pre></td></tr></table></figure>

<h3 id="搜索不清楚名称的包"><a href="#搜索不清楚名称的包" class="headerlink" title="搜索不清楚名称的包"></a>搜索不清楚名称的包</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda search search_term</span><br></pre></td></tr></table></figure>

<h2 id="conda-重现环境"><a href="#conda-重现环境" class="headerlink" title="conda 重现环境"></a>conda 重现环境</h2><blockquote>
<p>使用conda管理python一个重要的考量就是可迁移性，conda 提供了几种方法用于重现某个conda 环境。</p>
</blockquote>
<h3 id="Clone"><a href="#Clone" class="headerlink" title="Clone"></a>Clone</h3><blockquote>
<p>上文介绍过这个命令，用于本地重现某个环境</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda create --name new_env --clone old_env</span><br></pre></td></tr></table></figure>

<h3 id="Spec-List"><a href="#Spec-List" class="headerlink" title="Spec List"></a>Spec List</h3><blockquote>
<p>相同操作系统的计算机之间复制环境，可以生成 <code>spec list</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 生成 spec list 文件</span></span><br><span class="line">conda list --explicit &gt; spec-list.txt </span><br><span class="line"><span class="meta">#</span><span class="bash">重现环境：</span></span><br><span class="line">conda create --name python-course --file spec-list.txt</span><br></pre></td></tr></table></figure>

<h3 id="Environment-yml"><a href="#Environment-yml" class="headerlink" title="Environment.yml"></a>Environment.yml</h3><blockquote>
<p>使用 -export 选项生成一个 <code>environment.yml</code> 文件，以在不同的平台和操作系统之间复现项目环境。 </p>
<p>spec list 文件和 <code>environment.yml</code> 文件之间的区别在于： <code>environment.yml</code> 文件不针对特定操作系统，并且使用YAML格式。<code>environment.yml</code> 仅列出了软件包名称，由 conda 基于软件包的名称构建环境。 另一个区别是 -export 还包括使用pip安装的软件包，而 <code>spec list</code> 则没有。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">导出 environment.yml 文件：</span></span><br><span class="line">conda env export &gt; environment.yml</span><br><span class="line"><span class="meta">#</span><span class="bash">重现环境：</span></span><br><span class="line">conda env create -f environment.yml</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：如果当前路径已经有了 environment.yml 文件，conda 会重写这个文件</p>
</blockquote>
<h3 id="Conda-Pack"><a href="#Conda-Pack" class="headerlink" title="Conda Pack"></a>Conda Pack</h3><blockquote>
<p>上述两种重现的方法都基于记录当前环境包信息，到新机器重建的思路。而Conda Pack用的是将当前环境的文件直接打包，带到新机器拆包使用的思路。</p>
<p><strong>conda-pack 指定平台和操作系统，目标计算机必须具有与源计算机相同的平台和操作系统。</strong></p>
</blockquote>
<h4 id="安装-conda-pack"><a href="#安装-conda-pack" class="headerlink" title="安装 conda pack"></a>安装 conda pack</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> from conda</span></span><br><span class="line">conda install -c conda-forge conda-pack</span><br><span class="line"><span class="meta">#</span><span class="bash"> from pip</span></span><br><span class="line">pip install conda-pack</span><br></pre></td></tr></table></figure>

<h4 id="打包环境"><a href="#打包环境" class="headerlink" title="打包环境"></a>打包环境</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda pack -n my_env</span><br><span class="line">conda pack -n my_env -o out_name.tar.gz</span><br></pre></td></tr></table></figure>

<h4 id="重现环境"><a href="#重现环境" class="headerlink" title="重现环境"></a>重现环境</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir -p path_to_my_new_env # 建议放在anaconda的envs文件夹中</span><br><span class="line">tar -xzf my_env.tar.gz -C path_to_my_new_env # 解压包中文件</span><br><span class="line">source path_to_my_new_env/bin/activate # 激活该环境</span><br><span class="line">(my_env) $ python # 进入一下该环境下的 python 随后退出</span><br><span class="line">(my_env) $ conda-unpack # 十分重要，请不要忽略</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
        <category>运行环境</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>运行环境</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 类中的对象与属性</title>
    <url>/2020/06/20/python/python-class-var/python-class-var/</url>
    <content><![CDATA[<blockquote>
<p>本文整理类中对象与属性（变量）相关知识。</p>
</blockquote>
<a id="more"></a>

<h2 id="类对象与实例对象"><a href="#类对象与实例对象" class="headerlink" title="类对象与实例对象"></a>类对象与实例对象</h2><blockquote>
<p>建立测试类：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line">    var_of_class = <span class="string">'Class Var'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.var_of_instance = <span class="string">'Instance Var'</span></span><br></pre></td></tr></table></figure>

<h3 id="类对象"><a href="#类对象" class="headerlink" title="类对象"></a>类对象</h3><blockquote>
<p>建立类进行编译后则形成了类对象，类对象仅支持两个操作：</p>
</blockquote>
<ul>
<li>实例化：使用<code>instance_name = class_name()</code>的方式实例化，实例化操作创建该类的实例。</li>
<li>属性引用：使用<code>class_name.attr_name</code>的方式引用类属性。</li>
</ul>
<h3 id="实例对象"><a href="#实例对象" class="headerlink" title="实例对象"></a>实例对象</h3><blockquote>
<p>类对象实例化得到实例对象，实例对象仅支持一个操作：</p>
</blockquote>
<ul>
<li>属性引用；与类对象属性引用的方式相同，使用<code>instance_name.attr_name</code>的方式</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 类对象</span></span><br><span class="line">print(Test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实例对象</span></span><br><span class="line">class_instance = Test()</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">__main__</span>.<span class="title">Test</span>'&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">__main__</span>.<span class="title">Test</span> <span class="title">object</span> <span class="title">at</span> 0<span class="title">x00000127715B4128</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="类变量与实例变量"><a href="#类变量与实例变量" class="headerlink" title="类变量与实例变量"></a>类变量与实例变量</h2><blockquote>
<p>建立测试类：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line">    var_of_class = <span class="string">'Class Var'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.var_of_instance = <span class="string">'Instance Var'</span></span><br></pre></td></tr></table></figure>

<h3 id="类变量"><a href="#类变量" class="headerlink" title="类变量"></a>类变量</h3><blockquote>
<p>可由类对象引用</p>
<p>由所有实例共享</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 类对象引用类变量</span></span><br><span class="line">print(<span class="string">f'类对象引用类变量 ：<span class="subst">&#123;Test.var_of_class&#125;</span>'</span>)</span><br><span class="line">class_instance_1 = Test()</span><br><span class="line">class_instance_2 = Test()</span><br><span class="line"><span class="comment"># 实例对象引用类变量</span></span><br><span class="line">print(<span class="string">f'实例对象1引用类变量 ：<span class="subst">&#123;class_instance_1.var_of_class&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'实例对象2引用类变量 ：<span class="subst">&#123;class_instance_2.var_of_class&#125;</span>'</span>)</span><br><span class="line"><span class="comment"># 修改类变量实例对象共享修改</span></span><br><span class="line">Test.var_of_class = <span class="string">'Changed Class Var'</span></span><br><span class="line">print(<span class="string">f'实例对象1引用类变量 ：<span class="subst">&#123;class_instance_1.var_of_class&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'实例对象2引用类变量 ：<span class="subst">&#123;class_instance_2.var_of_class&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">类对象引用类变量 ：Class Var</span><br><span class="line">实例对象<span class="number">1</span>引用类变量 ：Class Var</span><br><span class="line">实例对象<span class="number">2</span>引用类变量 ：Class Var</span><br><span class="line">实例对象<span class="number">1</span>引用类变量 ：Changed Class Var</span><br><span class="line">实例对象<span class="number">2</span>引用类变量 ：Changed Class Var</span><br></pre></td></tr></table></figure>

<h3 id="实例变量"><a href="#实例变量" class="headerlink" title="实例变量"></a>实例变量</h3><blockquote>
<p>由实例对象引用</p>
<p>仅在当前实例保存</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 实例变量</span></span><br><span class="line">class_instance_1 = Test()</span><br><span class="line">class_instance_2 = Test()</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'实例对象1实例变量 ：<span class="subst">&#123;class_instance_1.var_of_instance&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'实例对象2实例变量 ：<span class="subst">&#123;class_instance_2.var_of_instance&#125;</span>'</span>)</span><br><span class="line">class_instance_1.var_of_instance = <span class="string">'changed instance var'</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">f'修改实例对象1后实例对象1实例变量 ：<span class="subst">&#123;class_instance_1.var_of_instance&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'修改实例对象1后实例对象2实例变量 ：<span class="subst">&#123;class_instance_2.var_of_instance&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">实例对象<span class="number">1</span>实例变量 ：Instance Var</span><br><span class="line">实例对象<span class="number">2</span>实例变量 ：Instance Var</span><br><span class="line">修改实例对象<span class="number">1</span>后实例对象<span class="number">1</span>实例变量 ：changed instance var</span><br><span class="line">修改实例对象<span class="number">1</span>后实例对象<span class="number">2</span>实例变量 ：Instance Var</span><br></pre></td></tr></table></figure>

<blockquote>
<p>类对象不能引用实例变量：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 类对象不能引用实例变量</span></span><br><span class="line">print(Test.var_of_instance)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>报错！</span><br><span class="line">type object <span class="string">'Test'</span> has no attribute <span class="string">'var_of_instance'</span></span><br></pre></td></tr></table></figure>

<h2 id="属性绑定"><a href="#属性绑定" class="headerlink" title="属性绑定"></a>属性绑定</h2><blockquote>
<p>建立测试类：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span><span class="params">()</span>:</span></span><br><span class="line">    var_of_class = <span class="string">'Class Var'</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.var_of_instance = <span class="string">'Instance Var'</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在定义、使用类、实例对象属性过程中，其实涉及两个过程：</p>
</blockquote>
<ul>
<li>类属性绑定</li>
<li>实例属性绑定</li>
</ul>
<blockquote>
<p>使用<code>绑定</code>一词事实上更加确切，可以理解为属性并不是属于类或实例的，Python中一切皆对象，每个属性也都是一个个现货鲜活的对象，之所以这些对象被称之为、用作于属性，是因为我们将这部分对象绑在了类对象可使用的属性名称上；</p>
<p>换一种说法，<strong>对象就是对象，而世上本没有属性，当对象被绑定在类/实例上，对象也就成了类/实例的属性</strong>。</p>
<p>因此绑定属性，首先需要有一个对象才行。</p>
</blockquote>
<h3 id="类属性绑定"><a href="#类属性绑定" class="headerlink" title="类属性绑定"></a>类属性绑定</h3><blockquote>
<p>Python作为动态语言，类对象和实例对象都可以在运行时绑定任意属性，因此类属性绑定有两种时机：</p>
</blockquote>
<ul>
<li>编译类时（写在类中的类属性）</li>
<li>运行时</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 定义时绑定类属性</span></span><br><span class="line">print(<span class="string">f'定义时绑定类属性：<span class="subst">&#123;Test.var_of_class&#125;</span>'</span>)</span><br><span class="line"><span class="comment"># 运行时绑定类属性</span></span><br><span class="line">Test.var_of_class_defined_during_running = <span class="string">'a long var of class'</span></span><br><span class="line">print(<span class="string">f'运行时绑定类属性：<span class="subst">&#123;Test.var_of_class_defined_during_running&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">定义时绑定类属性：Changed Class Var</span><br><span class="line">运行时绑定类属性：a long var of <span class="class"><span class="keyword">class</span></span></span><br></pre></td></tr></table></figure>

<h3 id="实例属性绑定"><a href="#实例属性绑定" class="headerlink" title="实例属性绑定"></a>实例属性绑定</h3><blockquote>
<p>实例属性绑定也发生在两个时机：</p>
</blockquote>
<ul>
<li>实例生成时</li>
<li>运行时</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">class_instance = Test()</span><br><span class="line"><span class="comment"># 实例生成时绑定的实例属性</span></span><br><span class="line">print(<span class="string">f'实例生成时绑定的实例属性：<span class="subst">&#123;class_instance.var_of_instance&#125;</span>'</span>)</span><br><span class="line"><span class="comment"># 实例运行时绑定的实例属性</span></span><br><span class="line">class_instance.var_of_instance = <span class="string">'defined during running'</span></span><br><span class="line">print(<span class="string">f'实例运行时绑定的实例属性<span class="subst">&#123;class_instance.var_of_instance&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">实例生成时绑定的实例属性：Instance Var</span><br><span class="line">实例运行时绑定的实例属性: defined during running</span><br></pre></td></tr></table></figure>

<h2 id="属性引用"><a href="#属性引用" class="headerlink" title="属性引用"></a>属性引用</h2><blockquote>
<p>上文中对属性的使用事实上都是在引用类对象或实例对象中的属性。</p>
<p>需要特别说明的是实例对象的属性引用冲突的问题，当类中存在同名的实例属性与类属性时：</p>
</blockquote>
<ul>
<li>由于类对象无法访问实例属性，因此对类对象的属性引用没有影响</li>
<li>实例属性有权访问二者，实现上会优先引用实例级的属性，即同名的类属性会被覆盖</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">class_instance = Test()</span><br><span class="line">class_instance.var_of_class = <span class="string">'instance var with a same name of a class var'</span></span><br><span class="line">print(<span class="string">f'类对象引用冲突属性：<span class="subst">&#123;Test.var_of_class&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'实例对象引用冲突属性：<span class="subst">&#123;class_instance.var_of_class&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">类对象引用冲突属性：Changed Class Var</span><br><span class="line">实例对象引用冲突属性：instance var <span class="keyword">with</span> a same name of a <span class="class"><span class="keyword">class</span> <span class="title">var</span></span></span><br></pre></td></tr></table></figure>

<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux 软链接的增、删、改、查</title>
    <url>/2020/06/19/linux/soft-link/soft-link/</url>
    <content><![CDATA[<blockquote>
<p>Linux的软链接类似Windows的快捷方式，又不尽相同，本文对相关知识进行梳理总结 。</p>
</blockquote>
<a id="more"></a>

<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote>
<p>软链接是将磁盘中的真实地址增加一个虚拟映射，使得用户访问该映射与访问真实磁盘地址完全相同，是Linux系统中灵巧编程的神兵利器。</p>
</blockquote>
<h2 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h2><h3 id="示例用例"><a href="#示例用例" class="headerlink" title="示例用例"></a>示例用例</h3><blockquote>
<p>测试在文件夹~/test 中进行</p>
<p>文件夹中包含tar_dir文件夹</p>
<p>test 文件夹中包含test_file.txt 文件</p>
<p>test_file.txt 文件内容为 Test_File_Data</p>
<p>tar_dir文件夹包含second_test_file.txt文件</p>
<p>second_test_file.txt文件内容为Second_Test_File_Data</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> :~# mkdir test</span><br><span class="line"> :~# cd test/</span><br><span class="line"> :~/test# ls</span><br><span class="line"> :~/test# mkdir tar_dir</span><br><span class="line"> :~/test# echo Test_File_Data&gt;&gt;test_file.txt</span><br><span class="line"> :~/test# cat test_file.txt </span><br><span class="line">Test_File_Data</span><br><span class="line">:~/test#echo Second_Test_File_Data&gt;&gt;tar_dir/second_test_file.txt</span><br><span class="line">:~/test# cat tar_dir/second_test_file.txt </span><br><span class="line">Second_Test_File_Data</span><br><span class="line"> :~/test# ls</span><br><span class="line">tar_dir  test_file.txt</span><br><span class="line"> :~/test# </span><br><span class="line">:~/test# ls tar_dir/</span><br><span class="line">second_test_file.txt</span><br></pre></td></tr></table></figure>



<h3 id="创建软链接"><a href="#创建软链接" class="headerlink" title="创建软链接"></a>创建软链接</h3><blockquote>
<p>命令 <code>ln</code>，软链接参数 <code>-s</code>:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -s [目标地址] [软链接地址]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>目标地址：需要链接到的目标路径；</p>
<p>软链接地址：需要建立软链接的文件路径</p>
</blockquote>
<ul>
<li>建立指向文件<code>test_file.txt</code>的软链接</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -s test_file.txt file_link</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时可以通过<code>file_link</code>访问文件<code>test_file.txt</code>：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">:~/test# cat file_link </span><br><span class="line">Test_File_Data</span><br></pre></td></tr></table></figure>

<ul>
<li>建立指向目录的软链接</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -s tar_dir/ dir_link</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时可以通过<code>dir_link</code>访问目录<code>tar_dir</code>：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">:~/test# ls dir_link</span><br><span class="line">second_test_file.txt</span><br><span class="line">:~/test# cat dir_link/second_test_file.txt </span><br><span class="line">Second_Test_File_Data</span><br></pre></td></tr></table></figure>

<h3 id="删除软链接"><a href="#删除软链接" class="headerlink" title="删除软链接"></a>删除软链接</h3><blockquote>
<p>软链接本质是文件，可以直接用<code>rm</code>命令删除：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">:~/test# rm file_link </span><br><span class="line">:~/test# rm dir_link</span><br><span class="line">:~/test# ls</span><br><span class="line">tar_dir  test_file.txt</span><br></pre></td></tr></table></figure>

<h3 id="查看软链接"><a href="#查看软链接" class="headerlink" title="查看软链接"></a>查看软链接</h3><blockquote>
<p>可以通过<code>ls -al</code>命令看到软链接指向：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">:~/test# ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x 3 root root 4096 Jun 19 13:04 .</span><br><span class="line">drwx------ 1 root root 4096 Jun 19 13:06 ..</span><br><span class="line">lrwxrwxrwx 1 root root    8 Jun 19 13:04 dir_link -&gt; tar_dir/</span><br><span class="line">lrwxrwxrwx 1 root root   13 Jun 19 13:04 file_link -&gt; test_file.txt</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jun 19 12:55 tar_dir</span><br><span class="line">-rw-r--r-- 1 root root   15 Jun 19 12:52 test_file.txt</span><br></pre></td></tr></table></figure>

<h3 id="修改软链接"><a href="#修改软链接" class="headerlink" title="修改软链接"></a>修改软链接</h3><blockquote>
<p>修改软链接的参数是 <code>-snf</code>：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -snf [新目标地址] [软链接地址]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>尝试修改软链接：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">:~/test# ln -snf tar_dir/second_test_file.txt file_link </span><br><span class="line">:~/test# cat file_link </span><br><span class="line">Second_Test_File_Data</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>解决运行文件消失、C盘空间不断缩小而且找不到文件位置的问题</title>
    <url>/2020/06/19/software/debug/missing-running-files/missing-running-files/</url>
    <content><![CDATA[<blockquote>
<p>在Windows 10 系统下回退CUDA版本的过程中，运行CUDA的安装文件时文件会自动消失，随后没有任何反应，同时C盘空间会减少一个安装文件大小，安装一次消失一次、C盘空间缩水一次，然而C盘中总文件大小并没有改变。本文记录该问题解决方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h2><blockquote>
<p>系统处于某种特殊异常状态运行某个程序，同时系统运行了<code>360安全卫士</code>，此时安全卫士会删除该运行的程序并将该程序放入C盘的隔离区，导致程序运行失败、磁盘空间变小。</p>
<p>隔离区是一个叫做<code>$360Section</code>的系统级隐藏文件夹，常规查看文件大小并不统计该文件夹中的文件。</p>
</blockquote>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="针对程序不能正常运行"><a href="#针对程序不能正常运行" class="headerlink" title="针对程序不能正常运行"></a>针对程序不能正常运行</h3><ul>
<li>退出360安全卫士</li>
<li>运行程序</li>
</ul>
<h3 id="针对C盘空间变小"><a href="#针对C盘空间变小" class="headerlink" title="针对C盘空间变小"></a>针对C盘空间变小</h3><ul>
<li><p>进入C盘根目录</p>
</li>
<li><p><img src="https://photos.zywvvd.com/matrixtime/20200619195812.png"></p>
</li>
<li><p>删除<code>$360Section</code>即可</p>
</li>
<li><p><img src="https://photos.zywvvd.com/matrixtime/20200619200324.png"></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>软件</tag>
      </tags>
  </entry>
  <entry>
    <title>错误 Could not load dynamic library&#39;libnvinfer.so.6&#39; 解决方法</title>
    <url>/2020/06/19/software/debug/libnvinfer-so-6-error/libnvinfer-so-6-error/</url>
    <content><![CDATA[<blockquote>
<p>在测试TensorFlow可用性时(tf.test.is_gpu_available())出现错误<code>Could not load dynamic library&#39;libnvinfer.so.6&#39;</code>，本文记录解决方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="错误原因"><a href="#错误原因" class="headerlink" title="错误原因"></a>错误原因</h2><blockquote>
<p>没有安装 TensorRT</p>
</blockquote>
<ul>
<li>关于NVIDIA TensorRT:</li>
</ul>
<blockquote>
<p>NVIDIA TensorRT是一种高性能神经网络推理(Inference)引擎，用于在生产环境中部署深度学习应用程序，应用有图像分类、分割和目标检测等，可提供最大的推理吞吐量和效率。TensorRT是第一款可编程推理加速器，能加速现有和未来的网络架构。TensorRT需要CUDA的支持。TensorRT包含一个为优化生产环境中部署的深度学习模型而创建的库，可获取经过训练的神经网络(通常使用32位或16位数据)，并针对降低精度的INT8运算来优化这些网络。借助CUDA的可编程性，TensorRT将能够加速助推深度神经网络日益多样化、复杂的增长趋势。通过TensorRT的大幅度加速，服务提供商能够以经济实惠的成本部署这些计算密集型人工智能工作负载。</p>
</blockquote>
<ul>
<li>错误形式</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Could <span class="keyword">not</span> load dynamic library<span class="string">'libnvinfer.so.6'</span>; dlerror: libnvinfer.so<span class="number">.6</span>: cannot open shared object file: No such file <span class="keyword">or</span> directory; LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/cuda/lib64/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>实际上这只是个警告信息，而不是错误。<code>libnvinfer.so.6</code>和<code>libnvinfer_plugin.so.6</code>只在使用<code>NVIDIA TensorRT</code>的时候才是必须的。没有这两个库也可以运行tensorflow。</p>
<p>——引自 - <a href="https://blog.csdn.net/toopoo/article/details/104506143" target="_blank" rel="noopener">https://blog.csdn.net/toopoo/article/details/104506143</a></p>
</blockquote>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><blockquote>
<p>安装 TensorRT</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Install TensorRT.</span></span><br><span class="line">sudo apt-get install -y --no-install-recommends libnvinfer6=6.0.1-1+cuda10.1 \</span><br><span class="line">    libnvinfer-dev=6.0.1-1+cuda10.1 \</span><br><span class="line">    libnvinfer-plugin6=6.0.1-1+cuda10.1</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Tensorflow</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>深度学习</tag>
        <tag>Tensorflow</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux &amp; Windows TensorFlow 1.14 升级 2.2</title>
    <url>/2020/06/18/software/install/Linux-tensorflow-2-2-install/Linux-tensorflow-2-2-install/</url>
    <content><![CDATA[<blockquote>
<p>准备尝试升级TensorFlow 1.14 到2.2，需要同时升级本地和服务器的环境，本文记录主要过程。</p>
</blockquote>
<a id="more"></a>

<h2 id="环境需求"><a href="#环境需求" class="headerlink" title="环境需求"></a>环境需求</h2><blockquote>
<p>当前TensorFlow最高版本 2.2.+ ，需要CUDA 10.1，cudnn 7.6</p>
<p>官网下载 ：<a href="https://developer.nvidia.com/" target="_blank" rel="noopener">https://developer.nvidia.com/</a></p>
<p>显卡驱动需要满足CUDA版本要求</p>
<p>CUDA与显卡驱动：<a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html" target="_blank" rel="noopener">https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html</a></p>
<p>TensorFlow-GPU与CUDA cudnn Python版本关系：<a href="https://tensorflow.google.cn/install/source_windows?hl=en#gpu" target="_blank" rel="noopener">https://tensorflow.google.cn/install/source_windows?hl=en#gpu</a></p>
</blockquote>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><ul>
<li>下载  cuda_10.1.243_418.87.00_linux.run 并安装（之前装过并运行过TensorFlow，相关库不过时的话可以不特意去装 cudnn）</li>
</ul>
<blockquote>
<p>过程中不需要安装驱动</p>
<p>将 /usr/local/cuda 软链接 指向 cuda-10.1</p>
<p>在 ~/.bashrc 中添加环境变量：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export PATH="$PATH:/usr/local/cuda/bin"</span><br><span class="line">export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/usr/local/cuda/lib64/"</span><br><span class="line">export LIBRARY_PATH="$LIBRARY_PATH:/usr/local/cuda/lib64"</span><br></pre></td></tr></table></figure>

<ul>
<li>下载 TensorFlow ：tensorflow_gpu-2.2.0-cp37-cp37m-manylinux2010_x86_64.whl</li>
</ul>
<blockquote>
<p>或使用pip安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install tensorflow-gpu</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会自动安装最新版 2.2.0 版本tf</p>
</blockquote>
<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><ul>
<li>下载 cuda_10.1.243_426.00_win10.exe 并安装（之前装过并运行过TensorFlow，相关库不过时的话可以不特意去装 cudnn）</li>
</ul>
<blockquote>
<p>我之前安装了CUDA10.0，不需要卸载原始版本，直接使用默认配置安装新版CUDA即可</p>
</blockquote>
<ul>
<li>下载 TensorFlow ：tensorflow_gpu-2.2.0-cp37-cp37m-win_amd64.whl</li>
</ul>
<blockquote>
<p>或使用pip安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install tensorflow-gpu</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会自动安装最新版 2.2.0 版本tf</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li>python 环境下测试</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.__version__</span><br><span class="line"><span class="string">'2.2.0'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.test.is_gpu_available()</span><br><span class="line">WARNING:tensorflow:From &lt;stdin&gt;:<span class="number">1</span>: is_gpu_available (<span class="keyword">from</span> tensorflow.python.framework.test_util) <span class="keyword">is</span> deprecated <span class="keyword">and</span> will be removed <span class="keyword">in</span> a future version.</span><br><span class="line">Instructions <span class="keyword">for</span> updating:</span><br><span class="line">Use `tf.config.list_physical_devices(<span class="string">'GPU'</span>)` instead.</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.406300</span>: I tensorflow/core/platform/cpu_feature_guard.cc:<span class="number">143</span>] Your CPU supports instructions that this TensorFlow binary was <span class="keyword">not</span> compiled to use: AVX2 FMA</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.416107</span>: I tensorflow/core/platform/profile_utils/cpu_utils.cc:<span class="number">102</span>] CPU Frequency: <span class="number">2498530000</span> Hz</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.417069</span>: I tensorflow/compiler/xla/service/service.cc:<span class="number">168</span>] XLA service <span class="number">0x55e39cc09290</span> initialized <span class="keyword">for</span> platform Host (this does <span class="keyword">not</span> guarantee that XLA will be used). Devices:</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.417085</span>: I tensorflow/compiler/xla/service/service.cc:<span class="number">176</span>]   StreamExecutor device (<span class="number">0</span>): Host, Default Version</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.420284</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcuda.so<span class="number">.1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.593401</span>: I tensorflow/compiler/xla/service/service.cc:<span class="number">168</span>] XLA service <span class="number">0x55e39ccc83a0</span> initialized <span class="keyword">for</span> platform CUDA (this does <span class="keyword">not</span> guarantee that XLA will be used). Devices:</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.593427</span>: I tensorflow/compiler/xla/service/service.cc:<span class="number">176</span>]   StreamExecutor device (<span class="number">0</span>): GeForce RTX <span class="number">2080</span> Ti, Compute Capability <span class="number">7.5</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.594463</span>: I tensorflow/core/common_runtime/gpu/gpu_device.cc:<span class="number">1561</span>] Found device <span class="number">0</span> <span class="keyword">with</span> properties: </span><br><span class="line">pciBusID: <span class="number">0000</span>:<span class="number">0</span>a:<span class="number">00.0</span> name: GeForce RTX <span class="number">2080</span> Ti computeCapability: <span class="number">7.5</span></span><br><span class="line">coreClock: <span class="number">1.545</span>GHz coreCount: <span class="number">68</span> deviceMemorySize: <span class="number">10.76</span>GiB deviceMemoryBandwidth: <span class="number">573.69</span>GiB/s</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.594765</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcudart.so<span class="number">.10</span><span class="number">.1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.596879</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcublas.so<span class="number">.10</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.598737</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcufft.so<span class="number">.10</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.599064</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcurand.so<span class="number">.10</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.601174</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcusolver.so<span class="number">.10</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.602319</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcusparse.so<span class="number">.10</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.606633</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcudnn.so<span class="number">.7</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.608814</span>: I tensorflow/core/common_runtime/gpu/gpu_device.cc:<span class="number">1703</span>] Adding visible gpu devices: <span class="number">0</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.608929</span>: I tensorflow/stream_executor/platform/default/dso_loader.cc:<span class="number">44</span>] Successfully opened dynamic library libcudart.so<span class="number">.10</span><span class="number">.1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.610584</span>: I tensorflow/core/common_runtime/gpu/gpu_device.cc:<span class="number">1102</span>] Device interconnect StreamExecutor <span class="keyword">with</span> strength <span class="number">1</span> edge matrix:</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.610608</span>: I tensorflow/core/common_runtime/gpu/gpu_device.cc:<span class="number">1108</span>]      <span class="number">0</span> </span><br><span class="line"><span class="number">2020</span><span class="number">-06</span><span class="number">-18</span> <span class="number">04</span>:<span class="number">15</span>:<span class="number">11.610618</span>: I tensorflow/core/common_runtime/gpu/gpu_device.cc:<span class="number">1121</span>] <span class="number">0</span>:   N </span><br><span class="line">2020-06-18 04:15:11.612706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/device:GPU:0 with 1958 MB memory) -&gt; physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:0a:00.0, compute capability: 7.5)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>当最后一行输出True表示GPU可用，如果是False请查看错误信息。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>软件安装</category>
      </categories>
      <tags>
        <tag>软件</tag>
        <tag>软件安装</tag>
      </tags>
  </entry>
  <entry>
    <title>Keras 在fit-generator中获取验证数据的y_true和y_preds</title>
    <url>/2020/06/10/deep_learning/keras/get-gts-and-preds-from-evaluator/get-gts-and-preds-from-evaluator/</url>
    <content><![CDATA[<blockquote>
<p>在Keras网络训练过程中，<code>fit-generator</code>为我们提供了很多便利。调用<code>fit-generator</code>时，每个epoch训练结束后会使用验证数据检测模型性能，Keras使用<code>model.evaluate_generator</code>提供该功能。然而我遇到了需要提取验证集y_pred的需求，在网上没有找到现有的功能实现方法，于是自己对源码进行了微调，实现了可配置提取验证集模型预测结果的功能，记录如下。</p>
</blockquote>
<a id="more"></a>

<h2 id="原理简介"><a href="#原理简介" class="headerlink" title="原理简介"></a>原理简介</h2><blockquote>
<p>通过查看源代码，发现Keras调用了<code>model.evaluate_generator</code>验证数据，该函数最终调用的是TensorFlow（我用的后端是tf）的<code>TF_SessionRunCallable</code>函数，封装得很死，功能是以数据为输入，输出模型预测的结果并与真实标签比较并计算评价函数得到结果。</p>
<p>过程中不保存、不返回预测结果，这部分没有办法修改，但可以<strong>在评价数据的同时对数据进行预测，得到结果并记录下来，传入到<code>epoch_logs</code>中，随后在回调函数的<code>on_epoch_end</code>中尽情使用</strong>。</p>
</blockquote>
<h2 id="代码修改"><a href="#代码修改" class="headerlink" title="代码修改"></a>代码修改</h2><ul>
<li>Keras版本 2.2.4 其他版本不保证一定使用相同的方法，但大体思路不变</li>
</ul>
<h3 id="model-fit-generator"><a href="#model-fit-generator" class="headerlink" title="model.fit_generator"></a>model.fit_generator</h3><p><img src="https://photos.zywvvd.com/matrixtime/20200610154931.png"></p>
<blockquote>
<p>找到<code>fit_generator</code>函数定义位置，加入控制参数<code>get_predict</code>：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_generator</span><span class="params">(self, generator,</span></span></span><br><span class="line"><span class="function"><span class="params">                      steps_per_epoch=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                      epochs=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      verbose=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      callbacks=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                      validation_data=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                      validation_steps=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                      class_weight=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                      max_queue_size=<span class="number">10</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      workers=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      use_multiprocessing=False,</span></span></span><br><span class="line"><span class="function"><span class="params">                      shuffle=True,</span></span></span><br><span class="line"><span class="function"><span class="params">                      initial_epoch=<span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      get_predict = False)</span>:</span>    <span class="comment"># 加入 get_predict</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> training_generator.fit_generator(</span><br><span class="line">            self, generator,</span><br><span class="line">            steps_per_epoch=steps_per_epoch,</span><br><span class="line">            epochs=epochs,</span><br><span class="line">            verbose=verbose,</span><br><span class="line">            callbacks=callbacks,</span><br><span class="line">            validation_data=validation_data,</span><br><span class="line">            validation_steps=validation_steps,</span><br><span class="line">            class_weight=class_weight,</span><br><span class="line">            max_queue_size=max_queue_size,</span><br><span class="line">            workers=workers,</span><br><span class="line">            use_multiprocessing=use_multiprocessing,</span><br><span class="line">            shuffle=shuffle,</span><br><span class="line">            initial_epoch=initial_epoch,</span><br><span class="line">            get_predict = get_predict) <span class="comment"># 加入 get_predict</span></span><br></pre></td></tr></table></figure>

<h3 id="training-generator-fit-generator"><a href="#training-generator-fit-generator" class="headerlink" title="training_generator.fit_generator"></a>training_generator.fit_generator</h3><p><img src="https://photos.zywvvd.com/matrixtime/20200610155253.png"></p>
<blockquote>
<p>找到<code>training_generator.fit_generator</code>定义位置，加入<code>get_predict</code>:</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_generator</span><span class="params">(model,</span></span></span><br><span class="line"><span class="function"><span class="params">                  generator,</span></span></span><br><span class="line"><span class="function"><span class="params">                  steps_per_epoch=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                  epochs=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                  verbose=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                  callbacks=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                  validation_data=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                  validation_steps=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                  class_weight=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                  max_queue_size=<span class="number">10</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                  workers=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                  use_multiprocessing=False,</span></span></span><br><span class="line"><span class="function"><span class="params">                  shuffle=True,</span></span></span><br><span class="line"><span class="function"><span class="params">                  initial_epoch=<span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                  get_predict = False)</span>:</span> <span class="comment"># 加入 get_predict</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改 # Epoch finished. 注释后的模块，可以看到Keras中<code>fit_generator</code>就是用<code>model.evaluate_generator</code>对验证集评估的：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Epoch finished.</span></span><br><span class="line"><span class="keyword">if</span> steps_done &gt;= steps_per_epoch <span class="keyword">and</span> do_validation:</span><br><span class="line">    <span class="keyword">if</span> val_gen:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> get_predict:</span><br><span class="line">            <span class="comment">## 如果启动获取预测结果功能，那么将get_predict设置为True</span></span><br><span class="line">            <span class="comment">## 返回值会包括 gts_and_preds </span></span><br><span class="line">            val_outs, gts_and_preds = model.evaluate_generator(</span><br><span class="line">                val_enqueuer_gen,</span><br><span class="line">                validation_steps,</span><br><span class="line">                workers=<span class="number">0</span>,</span><br><span class="line">                get_predict=get_predict)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            val_outs = model.evaluate_generator(</span><br><span class="line">                val_enqueuer_gen,</span><br><span class="line">                validation_steps,</span><br><span class="line">                workers=<span class="number">0</span>)                            </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># No need for try/except because</span></span><br><span class="line">        <span class="comment"># data has already been validated.</span></span><br><span class="line">        val_outs = model.evaluate(</span><br><span class="line">            val_x, val_y,</span><br><span class="line">            batch_size=batch_size,</span><br><span class="line">            sample_weight=val_sample_weights,</span><br><span class="line">            verbose=<span class="number">0</span>)</span><br><span class="line">    val_outs = to_list(val_outs)</span><br><span class="line">    <span class="comment"># Same labels assumed.</span></span><br><span class="line">    <span class="keyword">for</span> l, o <span class="keyword">in</span> zip(out_labels, val_outs):</span><br><span class="line">        epoch_logs[<span class="string">'val_'</span> + l] = o</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 将返回值 gts_and_preds 保存到 log 中</span></span><br><span class="line">    <span class="keyword">if</span> get_predict:</span><br><span class="line">        epoch_logs[<span class="string">'val_gts_and_preds'</span>] = gts_and_preds</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> callback_model.stop_training:</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h3 id="model-evaluate-generator"><a href="#model-evaluate-generator" class="headerlink" title="model.evaluate_generator"></a>model.evaluate_generator</h3><p><img src="https://photos.zywvvd.com/matrixtime/20200610155915.png"></p>
<blockquote>
<p>进入<code>model.evaluate_generator</code>函数，加入<code>get_predict</code>变量：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate_generator</span><span class="params">(self, generator,</span></span></span><br><span class="line"><span class="function"><span class="params">                       steps=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                       max_queue_size=<span class="number">10</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       workers=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       use_multiprocessing=False,</span></span></span><br><span class="line"><span class="function"><span class="params">                       verbose=<span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       get_predict=False)</span>:</span> <span class="comment"># 加入get_predict变量</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> training_generator.evaluate_generator(</span><br><span class="line">            self, generator,</span><br><span class="line">            steps=steps,</span><br><span class="line">            max_queue_size=max_queue_size,</span><br><span class="line">            workers=workers,</span><br><span class="line">            use_multiprocessing=use_multiprocessing,</span><br><span class="line">            verbose=verbose,</span><br><span class="line">            get_predict=get_predict) <span class="comment"># 加入get_predict变量</span></span><br></pre></td></tr></table></figure>



<h3 id="training-generator-evaluate-generator"><a href="#training-generator-evaluate-generator" class="headerlink" title="training_generator.evaluate_generator"></a>training_generator.evaluate_generator</h3><p><img src="https://photos.zywvvd.com/matrixtime/20200610163145.png"></p>
<blockquote>
<p>进入<code>training_generator.evaluate_generator</code>，添加<code>get_predict</code>变量，新建三个变量：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate_generator</span><span class="params">(model, generator,</span></span></span><br><span class="line"><span class="function"><span class="params">                       steps=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                       max_queue_size=<span class="number">10</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       workers=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       use_multiprocessing=False,</span></span></span><br><span class="line"><span class="function"><span class="params">                       verbose=<span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                       get_predict=False)</span>:</span>  <span class="comment"># 加入get_predict变量</span></span><br><span class="line">    <span class="string">"""See docstring for `Model.evaluate_generator`."""</span></span><br><span class="line">    model._make_test_function()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hasattr(model, <span class="string">'metrics'</span>):</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> model.stateful_metric_functions:</span><br><span class="line">            m.reset_states()</span><br><span class="line">        stateful_metric_indices = [</span><br><span class="line">            i <span class="keyword">for</span> i, name <span class="keyword">in</span> enumerate(model.metrics_names)</span><br><span class="line">            <span class="keyword">if</span> str(name) <span class="keyword">in</span> model.stateful_metric_names]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        stateful_metric_indices = []</span><br><span class="line"></span><br><span class="line">    steps_done = <span class="number">0</span></span><br><span class="line">    wait_time = <span class="number">0.01</span></span><br><span class="line">    outs_per_batch = []</span><br><span class="line">    batch_sizes = []</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">if</span> get_predict:</span><br><span class="line">        preds_dict=&#123;&#125; <span class="comment"># 新建保存结果的dict</span></span><br><span class="line">        gt_per_batch = [] <span class="comment"># 新建 y_true 的 list</span></span><br><span class="line">        pr_per_batch = [] <span class="comment"># 新建 y_pred 的 list</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在核心循环<code>while steps_done &lt; steps:</code>中加入预测变量的内容：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> steps_done &lt; steps:</span><br><span class="line">            generator_output = next(output_generator)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> hasattr(generator_output, <span class="string">'__len__'</span>):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">'Output of generator should be a tuple '</span></span><br><span class="line">                                 <span class="string">'(x, y, sample_weight) '</span></span><br><span class="line">                                 <span class="string">'or (x, y). Found: '</span> +</span><br><span class="line">                                 str(generator_output))</span><br><span class="line">            <span class="keyword">if</span> len(generator_output) == <span class="number">2</span>:</span><br><span class="line">                x, y = generator_output</span><br><span class="line">                sample_weight = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">elif</span> len(generator_output) == <span class="number">3</span>:</span><br><span class="line">                x, y, sample_weight = generator_output</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">'Output of generator should be a tuple '</span></span><br><span class="line">                                 <span class="string">'(x, y, sample_weight) '</span></span><br><span class="line">                                 <span class="string">'or (x, y). Found: '</span> +</span><br><span class="line">                                 str(generator_output))</span><br><span class="line">            outs = model.test_on_batch(x, y, sample_weight=sample_weight)</span><br><span class="line">            outs = to_list(outs)</span><br><span class="line">            outs_per_batch.append(outs)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">## 加入预测功能，保存preds和y_true</span></span><br><span class="line">            <span class="keyword">if</span> get_predict:</span><br><span class="line">                preds = model.predict_on_batch(x)</span><br><span class="line">                gt_per_batch.append(y.tolist())</span><br><span class="line">                pr_per_batch.append(preds.tolist())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> len(x) == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># Handle data tensors support when no input given</span></span><br><span class="line">                <span class="comment"># step-size = 1 for data tensors</span></span><br><span class="line">                batch_size = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> isinstance(x, list):</span><br><span class="line">                batch_size = x[<span class="number">0</span>].shape[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">elif</span> isinstance(x, dict):</span><br><span class="line">                batch_size = list(x.values())[<span class="number">0</span>].shape[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                batch_size = x.shape[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> batch_size == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">'Received an empty batch. '</span></span><br><span class="line">                                 <span class="string">'Batches should contain '</span></span><br><span class="line">                                 <span class="string">'at least one item.'</span>)</span><br><span class="line">            steps_done += <span class="number">1</span></span><br><span class="line">            batch_sizes.append(batch_size)</span><br><span class="line">            <span class="keyword">if</span> verbose == <span class="number">1</span>:</span><br><span class="line">                progbar.update(steps_done)</span><br><span class="line">        <span class="comment">## 将结果保存到dict中</span></span><br><span class="line">        <span class="keyword">if</span> get_predict:</span><br><span class="line">            preds_dict[<span class="string">'y_true'</span>] = gt_per_batch</span><br><span class="line">            preds_dict[<span class="string">'y_pred'</span>] = pr_per_batch</span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改返回值：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> get_predict:</span><br><span class="line">    <span class="keyword">return</span> unpack_singleton(averages), preds_dict</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> unpack_singleton(averages)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>至此核心的功能已经实现，但还有一个小问题。</p>
</blockquote>
<h3 id="keras-callbacks-TensorBoard-write-logs"><a href="#keras-callbacks-TensorBoard-write-logs" class="headerlink" title="keras.callbacks.TensorBoard._write_logs"></a>keras.callbacks.TensorBoard._write_logs</h3><p><img src="https://photos.zywvvd.com/matrixtime/20200610163226.png"></p>
<blockquote>
<p>Keras的Tensorboard会记录logs中的内容，但是他只认识 int, float 等数值格式，我们保存在log中的复杂字典他没办法写入tesnorboard，需要对<code>_write_logs</code>做微小的调整：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_write_logs</span><span class="params">(self, logs, index)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> name, value <span class="keyword">in</span> logs.items():</span><br><span class="line">            <span class="keyword">if</span> name <span class="keyword">in</span> [<span class="string">'batch'</span>, <span class="string">'size'</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            summary = tf.Summary()</span><br><span class="line">            summary_value = summary.value.add()</span><br><span class="line">            <span class="keyword">if</span> isinstance(value, np.ndarray):</span><br><span class="line">                summary_value.simple_value = value.item()</span><br><span class="line">            <span class="comment">## 跳过我们生成的字典</span></span><br><span class="line">            <span class="keyword">elif</span> isinstance(value, dict):</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                summary_value.simple_value = value</span><br><span class="line">            summary_value.tag = name</span><br><span class="line">            self.writer.add_summary(summary, index)</span><br><span class="line">        self.writer.flush()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>大功告成！</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><blockquote>
<p>随便写个带<code>on_epoch_end</code>的回调函数，将<code>get_predict</code>设置为True，测试logs中是否有我们想要的数据：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model.fit_generator(</span><br><span class="line">       generator = train_data_generator,</span><br><span class="line">       steps_per_epoch = <span class="number">10</span>,</span><br><span class="line">       epochs = config.Epochs,</span><br><span class="line">       verbose = <span class="number">1</span>,</span><br><span class="line">       use_multiprocessing=<span class="literal">False</span>,</span><br><span class="line">       validation_data=val_data_generator,</span><br><span class="line">       validation_steps=<span class="number">10</span>,</span><br><span class="line">       callbacks = callbacks,</span><br><span class="line">       get_predict= <span class="literal">True</span></span><br><span class="line">   )</span><br></pre></td></tr></table></figure>

<blockquote>
<p>回调函数设断点，输出logs：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">logs[<span class="string">'val_gts_and_preds'</span>]</span><br><span class="line">&#123;<span class="string">'y_pred'</span>: [[[<span class="number">2.5419962184969336e-05</span>, <span class="number">0.9999746084213257</span>],</span><br><span class="line">             [<span class="number">0.6694663763046265</span>, <span class="number">0.33053362369537354</span>],</span><br><span class="line">             [<span class="number">0.3561754524707794</span>, <span class="number">0.643824577331543</span>]],</span><br><span class="line">            [[<span class="number">5.548826155499231e-12</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">2.701560219975363e-08</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">4.0011427699937485e-06</span>, <span class="number">0.9999959468841553</span>]],</span><br><span class="line">            [[<span class="number">7.97858723533551e-11</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">2.3924835659272503e-06</span>, <span class="number">0.999997615814209</span>],</span><br><span class="line">             [<span class="number">3.359668880875688e-07</span>, <span class="number">0.9999996423721313</span>]],</span><br><span class="line">            [[<span class="number">0.06622887402772903</span>, <span class="number">0.9337711930274963</span>],</span><br><span class="line">             [<span class="number">4.1211248458239425e-07</span>, <span class="number">0.9999996423721313</span>],</span><br><span class="line">             [<span class="number">8.561290087527595e-06</span>, <span class="number">0.9999914169311523</span>]],</span><br><span class="line">            [[<span class="number">9.313887403550325e-07</span>, <span class="number">0.9999990463256836</span>],</span><br><span class="line">             [<span class="number">2.614793537247806e-08</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">8.66139725985704e-06</span>, <span class="number">0.9999912977218628</span>]],</span><br><span class="line">            [[<span class="number">7.047830763440288e-09</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">0.010548637248575687</span>, <span class="number">0.9894513487815857</span>],</span><br><span class="line">             [<span class="number">1.8744471252940542e-10</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">8.760089875714527e-11</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">0.0015734446933493018</span>, <span class="number">0.9984265565872192</span>],</span><br><span class="line">             [<span class="number">1.5642463040421717e-06</span>, <span class="number">0.9999984502792358</span>]],</span><br><span class="line">            [[<span class="number">0.004750440828502178</span>, <span class="number">0.9952495098114014</span>],</span><br><span class="line">             [<span class="number">6.984401466070267e-07</span>, <span class="number">0.9999992847442627</span>],</span><br><span class="line">             [<span class="number">0.00013592069444712251</span>, <span class="number">0.9998641014099121</span>]],</span><br><span class="line">            [[<span class="number">7.22906318140204e-11</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">2.402198795437016e-08</span>, <span class="number">1.0</span>],</span><br><span class="line">             [<span class="number">9.673745138272238e-10</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">3.1848256298872e-07</span>, <span class="number">0.9999996423721313</span>],</span><br><span class="line">             [<span class="number">0.0035940599627792835</span>, <span class="number">0.9964058995246887</span>],</span><br><span class="line">             [<span class="number">1.9458911912351162e-11</span>, <span class="number">1.0</span>]]],</span><br><span class="line"> <span class="string">'y_true'</span>: [[[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]],</span><br><span class="line">            [[<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>], [<span class="number">0.0</span>, <span class="number">1.0</span>]]]&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>之后这些结果任君处置了；</p>
</blockquote>
<h2 id="附"><a href="#附" class="headerlink" title="附"></a>附</h2><blockquote>
<p>将<code>get_predict</code>设为 False 时则屏蔽了我们做出的所有修改，与原始Keras代码完全相同；</p>
<p>目前没有发现其他的问题，有任何不对头可以随时交流。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>mount 命令(一) —— Liunx下设置共享文件夹，用于mount挂载文件</title>
    <url>/2020/06/03/linux/mount/mount-settings/mount-settings/</url>
    <content><![CDATA[<blockquote>
<p>磁盘挂载是同步共享、同步文件的好方法，默认文件夹不具有共享能力，本文记录将Linux中文件夹设置成可mount的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><blockquote>
<p>我们想把192.168.10.80 Linux服务器中的 <code>/disk/zhangyiwei</code>文件夹共享，以便在Windows 10系统中加载。</p>
</blockquote>
<ul>
<li>当前80服务器中没有可见的 <code>/disk/zhangyiwei</code>文件夹可用于挂载</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200603165054.png"></p>
<h2 id="设置共享文件夹"><a href="#设置共享文件夹" class="headerlink" title="设置共享文件夹"></a>设置共享文件夹</h2><blockquote>
<p>共享文件夹在<code>/etc/exports</code>文件中配置，在文件末尾添加：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;root&#x2F;zhangyiwei&#x2F; 192.168.10.219(rw,no_root_squash,no_all_squash,sync)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>/root/zhangyiwei/   为共享的路径</p>
</li>
<li><p>192.168.10.219 为主机名，一般用以下设置</p>
<ul>
<li><p>可以使用ip或网络号：例如 192.168.12.20 或者192.168.12.0/24 或者192.168.100.0/255.255.255.0都可以</p>
</li>
<li><p>可以使用主机名，但是这主机名必须在/etc/hosts内配置</p>
</li>
</ul>
</li>
<li><p>rw/ro</p>
<ul>
<li>rw表示（read-write）可读写，ro表示（read-only）只读</li>
</ul>
</li>
<li><p>sync/async</p>
<ul>
<li><p>sync表示数据同步写入到内存与硬盘中，async表示数据会暂存与内存中，而非直接写入硬盘</p>
</li>
<li><p>no_root_squash/root_squash反正就是客户端访问权限的问题，需要开放no_root_squash</p>
</li>
</ul>
</li>
<li><p>all_squash不论登录NFS的用户身份为何，他的身份都会被压缩成为匿名用户，通常也就是nobody(nfsnobody)</p>
</li>
</ul>
<h2 id="重新加载-etc-exports文件"><a href="#重新加载-etc-exports文件" class="headerlink" title="重新加载/etc/exports文件"></a>重新加载/etc/exports文件</h2><blockquote>
<p>修改完<code>/etc/exports</code>文件后并不能即时生效，需要命令（需要root权限）：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo exportfs -a</span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><blockquote>
<p>使用命令 <code>showmount -e IP</code>可以查看主机中可mount的文件夹</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> showmount -e 192.168.10.80</span></span><br><span class="line">Export list for 192.168.10.80:</span><br><span class="line">/disk/zhangyiwei *</span><br><span class="line">/disk/lujunyi    *</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/matrixtime/20200603171804.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 Windows 10 家庭版没有NFS服务无法挂载磁盘的问题</title>
    <url>/2020/06/02/windows/windows-family-nfs/windows-family-nfs/</url>
    <content><![CDATA[<blockquote>
<p> NFS服务可以方便地将网络磁盘挂载到本地，进行文件同步，但Windows 10 家庭版不支持该功能。本文记录不需要重装系统不用换Linux不装虚拟机的根本性无痛解决方案。</p>
</blockquote>
<a id="more"></a>

<h2 id="升级-Windows-10"><a href="#升级-Windows-10" class="headerlink" title="升级 Windows 10"></a>升级 Windows 10</h2><blockquote>
<p>将家庭版Win10 升级到企业版，系统便会自带NFS服务。</p>
</blockquote>
<h3 id="序列号"><a href="#序列号" class="headerlink" title="序列号"></a>序列号</h3><blockquote>
<p>2020.06.02 亲测有效，感谢：<a href="https://www.jianshu.com/p/3f9e2368e546" target="_blank" rel="noopener">https://www.jianshu.com/p/3f9e2368e546</a> 分享</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">J7QT3-3GCPG-9GVWT-CH2XR-GMRJM</span><br><span class="line">VK7JG-NPHTM-C97JM-9MPGT-3V66T</span><br></pre></td></tr></table></figure>

<h3 id="替换产品序列号"><a href="#替换产品序列号" class="headerlink" title="替换产品序列号"></a>替换产品序列号</h3><ul>
<li>右键 我的电脑 -&gt; 属性 -&gt; 更改产品密钥</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602172554.png"></p>
<ul>
<li>输入企业版密钥，关闭当前工作的程序并保存工作进度，一路下一步即可</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602172926.png"></p>
<h2 id="开启NFS服务"><a href="#开启NFS服务" class="headerlink" title="开启NFS服务"></a>开启NFS服务</h2><ul>
<li>控制面板 -&gt; 程序和功能 -&gt; 勾选NFS服务 -&gt; 确定</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602173153.png"></p>
<ul>
<li>在CMD中测试，输入 mount -h 查看输出</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Admin</span>&gt;<span class="title">mount</span> -<span class="title">h</span></span></span><br><span class="line"><span class="function">用法:  <span class="title">mount</span> [-<span class="title">o</span> <span class="title">options</span>] [-<span class="title">u:username</span>] [-<span class="title">p</span>:&lt;<span class="title">password</span> | *&gt;] &lt;\\<span class="title">computername</span>\<span class="title">sharename</span>&gt; &lt;<span class="title">devicename</span> | *&gt;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">rsize</span>=<span class="title">size</span>               设置读取缓冲区的大小(以 <span class="title">KB</span> 为单位)。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">wsize</span>=<span class="title">size</span>               设置写入缓冲区的大小(以 <span class="title">KB</span> 为单位)。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">timeout</span>=<span class="title">time</span>             设置 <span class="title">RPC</span> 调用的超时值(以秒为单位)。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">retry</span>=<span class="title">number</span>             设置软装载的重试次数。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">mtype</span>=<span class="title">soft</span>|<span class="title">hard</span>          设置装载类型。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">lang</span>=<span class="title">euc</span>-<span class="title">jp</span>|<span class="title">euc</span>-<span class="title">tw</span>|<span class="title">euc</span>-<span class="title">kr</span>|<span class="title">shift</span>-<span class="title">jis</span>|<span class="title">big5</span>|<span class="title">ksc5601</span>|<span class="title">gb2312</span>-80|<span class="title">ansi</span></span></span><br><span class="line"><span class="function">                            指定用于文件和目录名称的编码。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">fileaccess</span>=<span class="title">mode</span>          指定文件的权限模式。</span></span><br><span class="line"><span class="function">                            这些模式用于在 <span class="title">NFS</span> 服务器上创建的</span></span><br><span class="line"><span class="function">                            新文件。使用 <span class="title">UNIX</span> 样式模式位指定。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">anon</span>                     作为匿名用户装载。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">nolock</span>                   禁用锁定。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">casesensitive</span>=<span class="title">yes</span>|<span class="title">no</span>     指定在服务器上执行区分大小写的文件查找。</span></span><br><span class="line"><span class="function">-<span class="title">o</span> <span class="title">sec</span>=<span class="title">sys</span>|<span class="title">krb5</span>|<span class="title">krb5i</span>|<span class="title">krb5p</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>有此类输出表明NFS服务启动成功。</p>
</blockquote>
<h2 id="磁盘挂载"><a href="#磁盘挂载" class="headerlink" title="磁盘挂载"></a>磁盘挂载</h2><ul>
<li>映射磁盘驱动器</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602173956.png"></p>
<ul>
<li>映射网络上的一个地址即可</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602174125.png"></p>
<ul>
<li>映射成功</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200602174202.png"></p>
<h3 id="莫名其妙挂载失败的问题"><a href="#莫名其妙挂载失败的问题" class="headerlink" title="莫名其妙挂载失败的问题"></a>莫名其妙挂载失败的问题</h3><blockquote>
<p>在cmd中输入命令</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">showmount -e &lt;ip 需要挂载远程的地址&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以显示对方可挂载的目录</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">showmount -e 192.168.10.15</span><br><span class="line">导出列表在 192.168.10.15:</span><br><span class="line">/disk/zhangyiwei                   *</span><br></pre></td></tr></table></figure>

<blockquote>
<p>然而挂载时却出现奇怪的错误，诸如：</p>
</blockquote>
<ul>
<li>提示目标地址不存在，提醒检查拼写</li>
<li>出现未知错误</li>
</ul>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><ul>
<li>无脑关闭NFS服务</li>
<li>重启电脑</li>
<li>打开NFS服务</li>
</ul>
<blockquote>
<p>就好了。。。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>Windows 10</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>软件</tag>
        <tag>Windows 10</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows pip upgrade 报错 No module named &#39;pip&#39;</title>
    <url>/2020/05/30/coding/environment/pip-upgrade-error/pip-upgrade-error/</url>
    <content><![CDATA[<blockquote>
<p>windws 10 下升级 pip ，升级时下载安装包，卸载原有pip成功，在安装新pip包时因种种原因安装失败会导致pip被卸载，本文记录修复方法 。</p>
</blockquote>
<a id="more"></a>

<h3 id="常见原因"><a href="#常见原因" class="headerlink" title="常见原因"></a>常见原因</h3><ul>
<li>Windows 中anaconda文件夹没有为users用户开放全部控制权限</li>
<li>在更新pip时命令为（<strong>这是错误的命令</strong>）：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install -U pip</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时pip从服务器下载了最新的pip安装包，卸载了原来的pip，但是没有权限安装新的pip</p>
<p>导致使用此命令更新pip后无pip可用</p>
</blockquote>
<h3 id="正确命令shell"><a href="#正确命令shell" class="headerlink" title="正确命令shell"></a>正确命令shell</h3><ul>
<li>在选项中加入 –user</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install --upgrade pip --user</span><br></pre></td></tr></table></figure>

<h3 id="修复命令"><a href="#修复命令" class="headerlink" title="修复命令"></a>修复命令</h3><ul>
<li>如果不慎中招，可以使用如下命令恢复</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m ensurepip</span><br><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure>

<h3 id="实际效果"><a href="#实际效果" class="headerlink" title="实际效果"></a>实际效果</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> pip list</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "e:\program_files\annoconda\lib\runpy.py", line 193, in _run_module_as_main</span><br><span class="line">    "__main__", mod_spec)</span><br><span class="line">  File "e:\program_files\annoconda\lib\runpy.py", line 85, in _run_code</span><br><span class="line">    exec(code, run_globals)</span><br><span class="line">  File "E:\Program_Files\Annoconda\Scripts\pip.exe\__main__.py", line 4, in &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named 'pip'</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> python -m ensurepip</span></span><br><span class="line">Looking in links: C:\Users\Admin\AppData\Local\Temp\tmp1ggp6o2t</span><br><span class="line">Requirement already satisfied: setuptools in e:\program_files\annoconda\lib\site-packages (45.1.0)</span><br><span class="line">Collecting pip</span><br><span class="line">jupyterlab 2.1.0 has requirement jupyterlab_server&gt;=1.1.0, but you'll have jupyterlab-server 1.0.0 which is incompatible.</span><br><span class="line">jupyterlab-server 1.0.0 has requirement jsonschema&gt;=3.0.1, but you'll have jsonschema 2.6.0 which is incompatible.</span><br><span class="line">imgviz 1.1.0 has requirement Pillow&gt;=5.3.0, but you'll have pillow 5.2.0 which is incompatible.</span><br><span class="line">Installing collected packages: pip</span><br><span class="line">Successfully installed pip-10.0.1</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> python -m pip install --upgrade pip</span></span><br><span class="line">Looking in indexes: https://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">Collecting pip</span><br><span class="line">  Using cached https://mirrors.aliyun.com/pypi/packages/43/84/23ed6a1796480a6f1a2d38f2802901d078266bda38388954d01d3f2e821d/pip-20.1.1-py2.py3-none-any.whl</span><br><span class="line">jupyterlab 2.1.0 has requirement jupyterlab_server&gt;=1.1.0, but you'll have jupyterlab-server 1.0.0 which is incompatible.</span><br><span class="line">jupyterlab-server 1.0.0 has requirement jsonschema&gt;=3.0.1, but you'll have jsonschema 2.6.0 which is incompatible.</span><br><span class="line">imgviz 1.1.0 has requirement Pillow&gt;=5.3.0, but you'll have pillow 5.2.0 which is incompatible.</span><br><span class="line">Installing collected packages: pip</span><br><span class="line">  Found existing installation: pip 10.0.1</span><br><span class="line">    Uninstalling pip-10.0.1:</span><br><span class="line">      Successfully uninstalled pip-10.0.1</span><br><span class="line">Successfully installed pip-20.1.1</span><br><span class="line">You are using pip version 20.1.1, however version 20.2b1 is available.</span><br><span class="line">You should consider upgrading via the 'python -m pip install --upgrade pip' command.</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>Keras 在网络中自定义切割数据层</title>
    <url>/2020/05/25/deep_learning/keras/keras-sclice-data/keras-sclice-data/</url>
    <content><![CDATA[<blockquote>
<p>keras支持Lambda可以实现数据自定义处理操作，本文记录切割、截取网络层数据Lambda层实现方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><blockquote>
<p>需要在网络层中选取某层，截取其中部分特征，用于模型的特征处理。</p>
</blockquote>
<h2 id="切割函数"><a href="#切割函数" class="headerlink" title="切割函数"></a>切割函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cut_map</span><span class="params">(x,index)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x[:, index:-index, index:-index, :]</span><br></pre></td></tr></table></figure>

<h2 id="加入网络层"><a href="#加入网络层" class="headerlink" title="加入网络层"></a>加入网络层</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = Lambda(cut_map, arguments=&#123;<span class="string">'index'</span>:<span class="number">32</span>&#125;, name = <span class="string">'classify_Lambda'</span>)(x)</span><br></pre></td></tr></table></figure>

<h2 id="网络效果"><a href="#网络效果" class="headerlink" title="网络效果"></a>网络效果</h2><p><img src="https://photos.zywvvd.com/matrixtime/20200525210335.png"></p>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ul>
<li>建议该层主要用于训练好的模型的特征处理，直接放入准备训练的模型会造成该层无法传播梯度。</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>Keras 分割网络自定义评估函数 - mean iou</title>
    <url>/2020/05/25/deep_learning/keras/my-mean-iou/my-mean-iou/</url>
    <content><![CDATA[<blockquote>
<p>Keras训练网络过程中需要实时观察性能，mean iou不是keras自带的评估函数，tf的又觉得不好用，自己写了一个，经过测试没有问题，本文记录自定义keras mean iou评估的实现方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="计算-IoU"><a href="#计算-IoU" class="headerlink" title="计算 IoU"></a>计算 IoU</h2><blockquote>
<p>用numpy计算的，作为IoU的ground truth用作测试使用：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">iou_numpy</span><span class="params">(y_true,y_pred)</span>:</span></span><br><span class="line">    </span><br><span class="line">    intersection = np.sum(np.multiply(y_true.astype(<span class="string">'bool'</span>),y_pred == <span class="number">1</span>))</span><br><span class="line">    union = np.sum((y_true.astype(<span class="string">'bool'</span>)+y_pred.astype(<span class="string">'bool'</span>))&gt;<span class="number">0</span>)    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> intersection/union</span><br></pre></td></tr></table></figure>

<blockquote>
<p>keras metric IoU</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">iou_keras</span><span class="params">(y_true, y_pred)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Return the Intersection over Union (IoU).</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        y_true: the expected y values as a one-hot</span></span><br><span class="line"><span class="string">        y_pred: the predicted y values as a one-hot or softmax output</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        the IoU for the given label</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    label = <span class="number">1</span></span><br><span class="line">    <span class="comment"># extract the label values using the argmax operator then</span></span><br><span class="line">    <span class="comment"># calculate equality of the predictions and truths to the label</span></span><br><span class="line">    y_true = K.cast(K.equal(y_true, label), K.floatx())</span><br><span class="line">    y_pred = K.cast(K.equal(y_pred, label), K.floatx())</span><br><span class="line">    <span class="comment"># calculate the |intersection| (AND) of the labels</span></span><br><span class="line">    intersection = K.sum(y_true * y_pred)</span><br><span class="line">    <span class="comment"># calculate the |union| (OR) of the labels</span></span><br><span class="line">    union = K.sum(y_true) + K.sum(y_pred) - intersection</span><br><span class="line">    <span class="comment"># avoid divide by zero - if the union is zero, return 1</span></span><br><span class="line">    <span class="comment"># otherwise, return the intersection over union</span></span><br><span class="line">    <span class="keyword">return</span> K.switch(K.equal(union, <span class="number">0</span>), <span class="number">1.0</span>, intersection / union)</span><br></pre></td></tr></table></figure>



<h2 id="计算-mean-IoU"><a href="#计算-mean-IoU" class="headerlink" title="计算 mean IoU"></a>计算 mean IoU</h2><blockquote>
<p>mean IoU 简便起见，选取 (0,1,0.05) 作为不同的IoU阈值，计算平均IoU</p>
<p>numpy 真实值计算</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mean_iou_numpy</span><span class="params">(y_true,y_pred)</span>:</span></span><br><span class="line">    </span><br><span class="line">    iou_list = []</span><br><span class="line">    <span class="keyword">for</span> thre <span class="keyword">in</span> list(np.arange(<span class="number">0.0000001</span>,<span class="number">0.99</span>,<span class="number">0.05</span>)):</span><br><span class="line">        y_pred_temp = y_pred &gt;= thre</span><br><span class="line">        iou = iou_numpy(y_true, y_pred_temp)</span><br><span class="line">        iou_list.append(iou)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> np.mean(iou_list)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Keras  mean IoU </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mean_iou_keras</span><span class="params">(y_true, y_pred)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Return the mean Intersection over Union (IoU).</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        y_true: the expected y values as a one-hot</span></span><br><span class="line"><span class="string">        y_pred: the predicted y values as a one-hot or softmax output</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        the mean IoU</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    label = <span class="number">1</span></span><br><span class="line">    <span class="comment"># extract the label values using the argmax operator then</span></span><br><span class="line">    <span class="comment"># calculate equality of the predictions and truths to the label</span></span><br><span class="line">    y_true = K.cast(K.equal(y_true, label), K.floatx())</span><br><span class="line">    </span><br><span class="line">    mean_iou = K.variable(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    thre_list = list(np.arange(<span class="number">0.0000001</span>,<span class="number">0.99</span>,<span class="number">0.05</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> thre <span class="keyword">in</span> thre_list:</span><br><span class="line">        </span><br><span class="line">        y_pred_temp = K.cast(y_pred &gt;= thre, K.floatx())</span><br><span class="line">        y_pred_temp = K.cast(K.equal(y_pred_temp, label), K.floatx())</span><br><span class="line">        <span class="comment"># calculate the |intersection| (AND) of the labels</span></span><br><span class="line">        intersection = K.sum(y_true * y_pred_temp)</span><br><span class="line">        <span class="comment"># calculate the |union| (OR) of the labels</span></span><br><span class="line">        union = K.sum(y_true) + K.sum(y_pred_temp) - intersection</span><br><span class="line">        iou = K.switch(K.equal(union, <span class="number">0</span>), <span class="number">1.0</span>, intersection / union)</span><br><span class="line">        mean_iou = mean_iou + iou</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> mean_iou / len(thre_list)</span><br></pre></td></tr></table></figure>



<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 随机生成预测值</span></span><br><span class="line">y_true_np = np.ones([<span class="number">10</span>,<span class="number">10</span>])</span><br><span class="line">y_pred_np = np.random.rand(<span class="number">10</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 真实IoU值</span></span><br><span class="line">print(<span class="string">f' iou : <span class="subst">&#123;iou_numpy(y_true_np, y_pred_np)&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f' mean_iou_numpy : <span class="subst">&#123;mean_iou_numpy(y_true_np, y_pred_np)&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">y_true = tf.Variable(y_true_np)</span><br><span class="line">y_pred = tf.Variable(y_pred_np)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 计算节点</span></span><br><span class="line">iou_res = iou_keras (y_true, y_pred)</span><br><span class="line">m_iou_res = mean_iou_keras (y_true, y_pred)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 变量初始化</span></span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(init_op)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## 由于存在误差，结果在0.0000001范围内即可认为相同</span></span><br><span class="line">    </span><br><span class="line">    result = sess.run(iou_res)</span><br><span class="line">    print(<span class="string">f'result : <span class="subst">&#123;result&#125;</span> \nsame with ground truth: <span class="subst">&#123;abs(iou_numpy(y_true_np, y_pred_np) - result)&lt; <span class="number">0.0000001</span>&#125;</span>'</span>)</span><br><span class="line">    </span><br><span class="line">    result = sess.run(m_iou_res)</span><br><span class="line">    print(<span class="string">f'result : <span class="subst">&#123;result&#125;</span> \nsame with ground truth: <span class="subst">&#123;abs(mean_iou_numpy(y_true_np, y_pred_np) - result) &lt; <span class="number">0.0000001</span>&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>输出：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">iou : <span class="number">0.0</span></span><br><span class="line">mean_iou_numpy : <span class="number">0.5295</span></span><br><span class="line">result : <span class="number">0.0</span> </span><br><span class="line">same <span class="keyword">with</span> ground truth: <span class="literal">True</span></span><br><span class="line">result : <span class="number">0.5295000076293945</span> </span><br><span class="line">same <span class="keyword">with</span> ground truth: <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="源码下载"><a href="#源码下载" class="headerlink" title="源码下载"></a>源码下载</h3><p><a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">https://github.com/zywvvd/Python_Practise</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>Keras 模型多输出 loss weight metrics 设置</title>
    <url>/2020/05/25/deep_learning/keras/keras-multi-metrics/keras-multi-metrics/</url>
    <content><![CDATA[<blockquote>
<p>keras支持模型多输入多输出，本文记录多输出时loss、loss weight和metrics的设置方式。</p>
</blockquote>
<a id="more"></a>

<h2 id="模型输出"><a href="#模型输出" class="headerlink" title="模型输出"></a>模型输出</h2><blockquote>
<p>假设模型具有多个输出</p>
</blockquote>
<ul>
<li>classify： 二维数组，分类softmax输出，需要配置交叉熵损失</li>
<li>segmentation：与输入同尺寸map，sigmoid输出，需要配置二分类损失</li>
<li>others：自定义其他输出，需要自定义损失</li>
</ul>
<h2 id="具体配置"><a href="#具体配置" class="headerlink" title="具体配置"></a>具体配置</h2><h3 id="model"><a href="#model" class="headerlink" title="model"></a>model</h3><ul>
<li>变量均为模型中网络层</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">inputs = [input_1 , input_2]</span><br><span class="line">outputs = [classify, segmentation, others]</span><br><span class="line">model = keras.models.Model(inputs, outputs)</span><br></pre></td></tr></table></figure>

<h3 id="loss"><a href="#loss" class="headerlink" title="loss"></a>loss</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_loss = &#123;</span><br><span class="line">    <span class="string">'classify'</span>: <span class="string">'categorical_crossentropy'</span>,\</span><br><span class="line">    <span class="string">'segmentation'</span>:<span class="string">'binary_crossentropy'</span>,\</span><br><span class="line">    <span class="string">'others'</span>:my_loss_fun&#125;</span><br></pre></td></tr></table></figure>

<h3 id="loss-weight"><a href="#loss-weight" class="headerlink" title="loss weight"></a>loss weight</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_loss_weights = &#123;</span><br><span class="line">    <span class="string">'classify'</span>:<span class="number">1</span>,\</span><br><span class="line">    <span class="string">'segmentation'</span>:<span class="number">1</span>,\</span><br><span class="line">    <span class="string">'others'</span>:<span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="metrics"><a href="#metrics" class="headerlink" title="metrics"></a>metrics</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">my_metrics =&#123;</span><br><span class="line">    <span class="string">'classify'</span>:<span class="string">'acc'</span>,\</span><br><span class="line">    <span class="string">'segmentation'</span>:[mean_iou,<span class="string">'acc'</span>],\</span><br><span class="line">    <span class="string">'others'</span>:[<span class="string">'mse'</span>,<span class="string">'acc'</span>]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model.compile(optimizer=Adam(lr=config.LEARNING_RATE), loss=my_loss, loss_weights= my_loss_weights, metrics= my_metrics)</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>算法学习笔记 —— 链表</title>
    <url>/2020/05/21/algorithm/list/about_list/</url>
    <content><![CDATA[<blockquote>
<p>学而时习，本文记录链表操作相关算法练习笔记。</p>
</blockquote>
<a id="more"></a>

<h3 id="反转链表"><a href="#反转链表" class="headerlink" title="反转链表"></a>反转链表</h3><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><p>输入一个链表，反转链表后，输出新链表的表头。</p>
<h4 id="解题代码"><a href="#解题代码" class="headerlink" title="解题代码"></a>解题代码</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回ListNode</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ReverseList</span><span class="params">(self, pHead)</span>:</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        last_node = <span class="literal">None</span></span><br><span class="line">        current_node = pHead</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> current_node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            next_node = current_node.next</span><br><span class="line">            current_node.next = last_node</span><br><span class="line">            last_node = current_node</span><br><span class="line">            current_node = next_node</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> last_node</span><br></pre></td></tr></table></figure>

<h4 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h4><table>
<thead>
<tr>
<th>时间</th>
<th>空间</th>
</tr>
</thead>
<tbody><tr>
<td>O(n)</td>
<td>O(1)</td>
</tr>
</tbody></table>
<h4 id="解题备注"><a href="#解题备注" class="headerlink" title="解题备注"></a>解题备注</h4><ul>
<li>维护当前节点，顺带考虑前后节点，会比较稳健</li>
<li>设置虚拟前置节点，现场生成后置节点，更加鲁棒，甚至同时囊括了输入为None的情况</li>
<li>需要注意返回前置节点作为新链表头</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>算法</category>
        <category>链表</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>链表</tag>
      </tags>
  </entry>
  <entry>
    <title>算法学习笔记 —— XX</title>
    <url>/2020/05/21/algorithm/example/about_exam/</url>
    <content><![CDATA[<blockquote>
<p>学而时习，本文记录XX操作相关算法练习笔记。</p>
</blockquote>
<a id="more"></a>

<h3 id="XXXXX"><a href="#XXXXX" class="headerlink" title="XXXXX"></a>XXXXX</h3><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><h4 id="测试样例"><a href="#测试样例" class="headerlink" title="测试样例"></a>测试样例</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="解题代码"><a href="#解题代码" class="headerlink" title="解题代码"></a>解题代码</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h4><table>
<thead>
<tr>
<th>时间</th>
<th>空间</th>
</tr>
</thead>
<tbody><tr>
<td>O()</td>
<td>O()</td>
</tr>
</tbody></table>
<h4 id="解题备注"><a href="#解题备注" class="headerlink" title="解题备注"></a>解题备注</h4><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>算法</category>
        <category>XX</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>XX</tag>
      </tags>
  </entry>
  <entry>
    <title>算法学习笔记 —— 排序</title>
    <url>/2020/05/21/algorithm/tree/about_tree/</url>
    <content><![CDATA[<blockquote>
<p>学而时习，本文记录排序操作相关算法练习笔记。</p>
</blockquote>
<a id="more"></a>

<h3 id="寻找第K大"><a href="#寻找第K大" class="headerlink" title="寻找第K大"></a>寻找第K大</h3><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><h4 id="测试样例"><a href="#测试样例" class="headerlink" title="测试样例"></a>测试样例</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="解题代码"><a href="#解题代码" class="headerlink" title="解题代码"></a>解题代码</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h4><table>
<thead>
<tr>
<th>时间</th>
<th>空间</th>
</tr>
</thead>
<tbody><tr>
<td>O()</td>
<td>O()</td>
</tr>
</tbody></table>
<h4 id="解题备注"><a href="#解题备注" class="headerlink" title="解题备注"></a>解题备注</h4><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>算法</category>
        <category>排序</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>算法学习笔记 —— 排序</title>
    <url>/2020/05/21/algorithm/sort/about_sort/</url>
    <content><![CDATA[<blockquote>
<p>学而时习，本文记录排序操作相关算法练习笔记。</p>
</blockquote>
<a id="more"></a>

<h3 id="寻找第K大"><a href="#寻找第K大" class="headerlink" title="寻找第K大"></a>寻找第K大</h3><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><h4 id="测试样例"><a href="#测试样例" class="headerlink" title="测试样例"></a>测试样例</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="解题代码"><a href="#解题代码" class="headerlink" title="解题代码"></a>解题代码</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h4><table>
<thead>
<tr>
<th>时间</th>
<th>空间</th>
</tr>
</thead>
<tbody><tr>
<td>O()</td>
<td>O()</td>
</tr>
</tbody></table>
<h4 id="解题备注"><a href="#解题备注" class="headerlink" title="解题备注"></a>解题备注</h4><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>算法</category>
        <category>排序</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 Windows OSError - pydot failed to call GraphViz.Please install GraphViz 报错</title>
    <url>/2020/05/20/deep_learning/keras/call-GraphViz-failed/call-GraphViz-failed/</url>
    <content><![CDATA[<blockquote>
<p>Windows操作系统下，运行pydot相关程序时（我的是keras.utils.plot_model)报错，提示没有安装GraphViz，事实上并不都是因为GraphViz没有安装，本文记录错误解决方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h2><blockquote>
<p>操作系统：Win10</p>
<p>keras版本：2.2.4</p>
<p>在Win10系统下（Windows系列都可能出这个问题）keras建立简单的模型，执行 plot_model，报错：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> keras </span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Input</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Conv2D</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> GlobalAveragePooling2D</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> plot_model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">"PATH"</span>] += os.pathsep + <span class="string">r'E:\Program Files (x86)\Graphviz2.38\bin'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = Input(shape=(<span class="number">16</span>,<span class="number">16</span>,<span class="number">3</span>))</span><br><span class="line">x = Conv2D(filters=<span class="number">10</span>, kernel_size=(<span class="number">3</span>,<span class="number">3</span>), padding=<span class="string">'same'</span>, activation=<span class="string">'relu'</span>)(A)</span><br><span class="line">x = Conv2D(filters=<span class="number">10</span>, kernel_size=(<span class="number">3</span>,<span class="number">3</span>), padding=<span class="string">'same'</span>, activation=<span class="string">'relu'</span>)(x)</span><br><span class="line">x = GlobalAveragePooling2D()(x)</span><br><span class="line">x = Dense(units = <span class="number">5</span>, activation=<span class="string">'softmax'</span>)(x)</span><br><span class="line"></span><br><span class="line">model = Model(A,x)</span><br><span class="line"></span><br><span class="line">model.summary()</span><br><span class="line"></span><br><span class="line">test_input = np.random.rand(<span class="number">1</span>,<span class="number">16</span>,<span class="number">16</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">results = model.predict(test_input)</span><br><span class="line"></span><br><span class="line">plot_model(model)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>错误信息：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">builtins.OSError: `pydot` failed to call GraphViz.Please install GraphViz (https://www.graphviz.org/) <span class="keyword">and</span> ensure that its executables are <span class="keyword">in</span> the $PATH.</span><br></pre></td></tr></table></figure>

<h2 id="问题原因与解决方案"><a href="#问题原因与解决方案" class="headerlink" title="问题原因与解决方案"></a>问题原因与解决方案</h2><h3 id="情况-1"><a href="#情况-1" class="headerlink" title="情况 1"></a>情况 1</h3><ul>
<li>原因 ：真的没有安装GraphViz</li>
<li>解决方案：<ul>
<li>安装相应模块 </li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install pydot-ng </span><br><span class="line">pip install graphviz </span><br><span class="line">pip install pydot</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果问题没有排除，可能是GraphViz程序没有加入到系统路径，考虑情况2</p>
</blockquote>
<h3 id="情况-2"><a href="#情况-2" class="headerlink" title="情况 2"></a>情况 2</h3><ul>
<li>原因：GraphViz程序没有加入到系统路径</li>
<li>解决方案：<ul>
<li>下载graphviz-2.38.msi ，我是在这里下载的 <a href="https://www.5down.net/soft/graphviz.html" target="_blank" rel="noopener">https://www.5down.net/soft/graphviz.html</a></li>
<li>我安装在了E盘：<code>E:\Program Files (x86)\Graphviz2.38\bin</code></li>
<li>将路径加入到系统变量</li>
<li><img src="https://photos.zywvvd.com/matrixtime/20200520110131.png"></li>
</ul>
</li>
</ul>
<blockquote>
<p>目前为止是网上大多数存在的解决方案，相信大部分的同学到此为止已经解决了问题。</p>
<p>如果错误继续，那么我和你一样，进入情况3。</p>
</blockquote>
<h3 id="情况-3"><a href="#情况-3" class="headerlink" title="情况 3"></a>情况 3</h3><ul>
<li><p>原因：依赖模块已经安装、程序已经加入系统变量，仍然出现上述提示，是因为<code>pydot</code>在建立<code>Dot</code>类时查找的<code>dot</code>程序的名字是 ’dot‘ 而不是我们 Windows 里的可执行程序文件名 ‘dot.exe’</p>
</li>
<li><p>解决方案：改过来就好了，具体方法如下</p>
<ul>
<li><p>在报错的位置找到<code>pydot</code></p>
</li>
<li><p><img src="https://photos.zywvvd.com/matrixtime/20200520110546.png"></p>
</li>
<li><p>找到Dot类</p>
</li>
<li><p><img src="https://photos.zywvvd.com/matrixtime/20200520110627.png"></p>
</li>
<li><p>类的开头代码是这样的：</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dot</span><span class="params">(Graph)</span>:</span></span><br><span class="line">    <span class="string">"""A container for handling a dot language file.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This class implements methods to write and process</span></span><br><span class="line"><span class="string">    a dot language file. It is a derived class of</span></span><br><span class="line"><span class="string">    the base class 'Graph'.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>找到其中的 <code>self.prog = &#39;dot&#39;</code></p>
</li>
<li><p>讲这句话替换为：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line">system = platform.system()</span><br><span class="line">            </span><br><span class="line"><span class="keyword">if</span> system == <span class="string">'Windows'</span>:</span><br><span class="line">    self.prog = <span class="string">'dot.exe'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    self.prog = <span class="string">'dot'</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>保存再次运行程序即可</p>
</li>
<li><p><img src="https://photos.zywvvd.com/matrixtime/20200520110906.png"></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>WingIDE 7.2.0 调试远程服务器中 Docker</title>
    <url>/2020/05/14/coding/environment/wingide-remote-docker/wingide-remote-docker/</url>
    <content><![CDATA[<blockquote>
<p>上回我们说到<a href="https://www.zywvvd.com/2020/05/14/coding/environment/wing-ssh-remote/wing-ssh-remote/">WingIDE 7.2.0 远程调试</a>，但是我们又经常在远程服务器中启用docker运行程序，于是我们又出现了WingIDE远程调试服务器中Docker的需求，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><blockquote>
<p>事实上ssh打通了本地与远程服务器，就可以打通服务器里的docker了。我们在ssh连接服务器时常用的是22端口，我们仅需将docker的22端口映射到服务器的随便哪个端口（例如3722），然后putty保存通过3722端口ssh连接的记录，wingIDE用其连接就是了。</p>
</blockquote>
<h2 id="docker配置"><a href="#docker配置" class="headerlink" title="docker配置"></a>docker配置</h2><blockquote>
<p>需要将docker的端口A映射到服务器的端口B，在建立docker的容器时加入参数 <code>-p</code>即可：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker run -it --name vvd -p 3722:22 -v /root/tmp:/root/tmp my_docker bash</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时docker 容器的22端口被映射到了服务器的3722端口.</p>
</blockquote>
<ul>
<li>随后需要在docker内部重新配置一遍ssh密钥，方法与在服务器内配置相同（参考<a href="https://www.zywvvd.com/2020/05/14/coding/environment/wing-ssh-remote/wing-ssh-remote/">WingIDE 7.2.0 远程调试</a>）</li>
</ul>
<h2 id="putty配置修改"><a href="#putty配置修改" class="headerlink" title="putty配置修改"></a>putty配置修改</h2><blockquote>
<p>将端口号由22修改为3722即可：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514200415.png"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>本质上与直接连接服务器没有区别，只是使用了端口映射，解决了这个问题。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>IDE</tag>
      </tags>
  </entry>
  <entry>
    <title>WingIDE 7.2.0 远程调试</title>
    <url>/2020/05/14/coding/environment/wing-ssh-remote/wing-ssh-remote/</url>
    <content><![CDATA[<blockquote>
<p>大型程序常常会运行在性能强劲的服务器上，但是此时程序的调试又成了难办的事情，于是产生了远程调试的需求，本文介绍WingIDE远程调试配置方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="环境描述"><a href="#环境描述" class="headerlink" title="环境描述"></a>环境描述</h2><ul>
<li><p>WingIDE 版本需求 6.++/ 7.++ ,我的是 7.2.0</p>
</li>
<li><p>本地操作系统 Win10</p>
</li>
<li><p>远程服务器操作系统 Ubuntu 16.04</p>
</li>
<li><p>安装 putty</p>
</li>
<li><p>解决方案：使用ssh协议通信，实现远程调试</p>
</li>
</ul>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="安装SSH服务"><a href="#安装SSH服务" class="headerlink" title="安装SSH服务"></a>安装SSH服务</h3><blockquote>
<p>查看服务是否安装：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ps -e |grep ssh</span><br></pre></td></tr></table></figure>

<blockquote>
<p>返回带有 sshd 的条目即为已经安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ps -e |grep ssh</span></span><br><span class="line">   37 ?        00:00:00 sshd</span><br><span class="line">16013 ?        00:00:00 sshd</span><br><span class="line">16588 ?        00:00:00 sshd</span><br></pre></td></tr></table></figure>

<blockquote>
<p>否则安装SSH服务</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install openssh-server</span><br></pre></td></tr></table></figure>

<h3 id="生成SSH密钥对"><a href="#生成SSH密钥对" class="headerlink" title="生成SSH密钥对"></a>生成SSH密钥对</h3><blockquote>
<p>在本地Win10（运行wingIDE的环境）使用ssh-keygen生成SSH密钥</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh-keygen -t rsa</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时在 C -&gt; Users -&gt; Admin（用户名） -&gt; .ssh 文件夹下会生成 <code>id_rsa</code>和<code>id_rsa.pub</code>两个密钥文件，其中 <code>id_rsa</code>为私钥，无论如何不能交给别人。</p>
</blockquote>
<h3 id="远程主机配置SSH密钥"><a href="#远程主机配置SSH密钥" class="headerlink" title="远程主机配置SSH密钥"></a>远程主机配置SSH密钥</h3><blockquote>
<p>将刚刚生成的公钥文件<code>id_rsa.pub</code>复制到远程主机 <code>~/.ssh</code>文件夹中，并添加到<code>~/.ssh/authorized_keys</code>里。</p>
<p>假设你的<code>id_rsa.pub</code>文件在<code>.ssh</code>文件夹中而且名称为<code>rsa_temp.pub</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat ~/.ssh/rsa_temp.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">rm  ~/.ssh/rsa_temp.pub</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时你的本机Win10系统ssh连接远程主机已经不再需要输入密码进行身份验证。</p>
<p>可以使用ssh命令测试是否配置成功，过程中询问是否继续连接，输入 <code>yes</code>即可：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh -p 3722 root@192.168.10.80 #-p为端口 一般来说ssh常用端口默认是22</span><br><span class="line"></span><br><span class="line"><span class="meta">-----&gt;</span></span><br><span class="line">The authenticity of host '[192.168.10.80]:3722 ([192.168.10.80]:3722)' can't be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:qCIsaqEa6wNy0daSgBxxxxxxxxxxxxxxxxxxxxxx.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added '[192.168.10.80]:3722' (ECDSA) to the list of known hosts.</span><br><span class="line">Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line">Last login: Thu May 14 08:20:47 2020 from 192.168.10.213</span><br><span class="line"> * Starting OpenBSD Secure Shell server sshd                             [ OK ]</span><br><span class="line">root@fc6fa7bb6824:~#</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时我们已经可以用SSH连接两个操作系统，即已经完成了理论层面的配置，接下来进入具体操作阶段。</p>
</blockquote>
<h2 id="远程调试配置"><a href="#远程调试配置" class="headerlink" title="远程调试配置"></a>远程调试配置</h2><blockquote>
<p>此处解释一下，WingIDE在连接远程服务器时需要配置连接信息，而这个信息可以在putty中保存，也就是说，只要putty中保存的参数可以连接成功，那么这套配置就可以用于wingIDE的远程调试。</p>
</blockquote>
<h3 id="私钥文件id-rsa转换成putty的ppk格式"><a href="#私钥文件id-rsa转换成putty的ppk格式" class="headerlink" title="私钥文件id_rsa转换成putty的ppk格式"></a>私钥文件id_rsa转换成putty的ppk格式</h3><blockquote>
<p>putty需要ppk格式的私钥文件，生成方法如下：</p>
</blockquote>
<ul>
<li>运行puttygen （在putty同位置文件夹内）</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514191003.png"></p>
<ul>
<li>选择<code>Conversions</code>菜单项中的<code>Import key</code>选项：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514191136.png"></p>
<ul>
<li>选择生成的id_rsa文件</li>
<li>在puttygen的界面上点击<code>Save private key</code>按钮就可以把私钥转换为ppk的格式了（不要点<code>Generate</code>）</li>
</ul>
<h3 id="在putty配置远程连接信息"><a href="#在putty配置远程连接信息" class="headerlink" title="在putty配置远程连接信息"></a>在putty配置远程连接信息</h3><blockquote>
<p>打开putty</p>
</blockquote>
<ul>
<li>配置 Session ：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514190333.png"></p>
<blockquote>
<p>主要配置IP和端口号，在Saved Sessions里配置可以区分的名字，之后供WingIDE调用</p>
</blockquote>
<ul>
<li>配置 Connection-Data选项卡，在自动登录用户名处填入需要自动登录的用户名（我的是root）</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514192550.png"></p>
<ul>
<li>配置 Connection-SSH-Auth选项卡，浏览选择刚刚生成的私钥ppk文件：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514192014.png"></p>
<ul>
<li>回到Session，点击<code>Save</code>保存当前配置到<code>test_3722</code>中：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514192711.png"></p>
<ul>
<li>此后每次打开putty双击我们的<code>test_3722</code>即可连接到远程服务器：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514193220.png"></p>
<h3 id="配置WingIDE"><a href="#配置WingIDE" class="headerlink" title="配置WingIDE"></a>配置WingIDE</h3><blockquote>
<p>距离成功仅一步之遥。</p>
<p>打开WingIDE， Project -&gt; New Project</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514193933.png"></p>
<blockquote>
<p>其中 Identifier 为该工程的名称， Host Name为我们刚刚保存的Putty名称，点击<code>OK</code>。</p>
</blockquote>
<ul>
<li>此时可以选择保存工程，也可以一会再说</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194133.png"></p>
<ul>
<li>在远程的默认python路径往往不是我们需要的，我的常用python在conda的一个自建的环境中，可以指定其为wingIDE的默认远程python环境：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194516.png"></p>
<ul>
<li>随后一路OK，出现此对话框说明配置成功：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194611.png"></p>
<ul>
<li>重启python shell 可以在本地看到远程的python shell：</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194723.png"></p>
<ul>
<li>可以简单通过操作系统验证是否配置成远程python</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194830.png"></p>
<ul>
<li>在project中可以加入远程的工程</li>
</ul>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514194908.png"></p>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514195000.png"></p>
<blockquote>
<p>可以本地修改远程代码，并运行调试：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/matrixtime/20200514195140.png"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>IDE</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 json.dump 报错：TypeError - Object of type xxx is not JSON serializable</title>
    <url>/2020/05/12/coding/json-bug-fix/json-bug-fix/</url>
    <content><![CDATA[<blockquote>
<p>在python中导入json包可以方便地操作json文件，但是偶尔会遇到 TypeError: Object of type xxx is not JSON serializable 错误，通常报错的位置是很正常的int或float，本文记录该问题解决方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="自定义序列化方法"><a href="#自定义序列化方法" class="headerlink" title="自定义序列化方法"></a>自定义序列化方法</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyEncoder</span><span class="params">(json.JSONEncoder)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default</span><span class="params">(self, obj)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(obj, np.integer):</span><br><span class="line">            <span class="keyword">return</span> int(obj)</span><br><span class="line">        <span class="keyword">elif</span> isinstance(obj, np.floating):</span><br><span class="line">            <span class="keyword">return</span> float(obj)</span><br><span class="line">        <span class="keyword">elif</span> isinstance(obj, np.ndarray):</span><br><span class="line">            <span class="keyword">return</span> obj.tolist()</span><br><span class="line">        <span class="keyword">if</span> isinstance(obj, time):</span><br><span class="line">            <span class="keyword">return</span> obj.__str__()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> super(MyEncoder, self).default(obj)</span><br></pre></td></tr></table></figure>

<h2 id="调用json包写入数据时加入"><a href="#调用json包写入数据时加入" class="headerlink" title="调用json包写入数据时加入"></a>调用json包写入数据时加入</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">json.dump(final_json, fp, indent=<span class="number">3</span>, cls= MyEncoder)</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>Python</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>Python</tag>
        <tag>故障排除</tag>
      </tags>
  </entry>
  <entry>
    <title>Wingide 快捷键</title>
    <url>/2020/05/11/coding/wing-Shortcut/wing-Shortcut/</url>
    <content><![CDATA[<blockquote>
<p> 感觉wingide是比较小众的python ide，但是我就是用着顺手吖，本文记录wing的快捷键。</p>
</blockquote>
<a id="more"></a>

<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><table>
<thead>
<tr>
<th align="center">功能</th>
<th align="center">快捷键</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Ctrl+N</td>
<td align="center">新建文件</td>
</tr>
<tr>
<td align="center">Ctrl+O</td>
<td align="center">打开文件夹</td>
</tr>
<tr>
<td align="center">Ctrl+W</td>
<td align="center">关闭当前文件</td>
</tr>
<tr>
<td align="center">Ctrl+S</td>
<td align="center">保存文件</td>
</tr>
<tr>
<td align="center">Ctrl+shif+S</td>
<td align="center">另存为</td>
</tr>
<tr>
<td align="center">Ctrl+P</td>
<td align="center">打印</td>
</tr>
<tr>
<td align="center">Ctrl+Q</td>
<td align="center">退出</td>
</tr>
<tr>
<td align="center">Ctrl+Z</td>
<td align="center">撤回上一步</td>
</tr>
<tr>
<td align="center">Ctrl+A</td>
<td align="center">全选</td>
</tr>
<tr>
<td align="center">Ctrl+L</td>
<td align="center">跳到指定一行</td>
</tr>
<tr>
<td align="center">Ctrl+U</td>
<td align="center">在本行查找</td>
</tr>
<tr>
<td align="center">Ctrl+B</td>
<td align="center">查找相同变量名</td>
</tr>
<tr>
<td align="center">Ctrl+‘+’</td>
<td align="center">放大</td>
</tr>
<tr>
<td align="center">Ctrl+‘（’</td>
<td align="center">切换文件屏幕</td>
</tr>
<tr>
<td align="center">Ctrl+ALT+V</td>
<td align="center">运行当前文件</td>
</tr>
<tr>
<td align="center">Ctrl+ALT+M</td>
<td align="center">切换window应用界面</td>
</tr>
<tr>
<td align="center">F1</td>
<td align="center">上下框的开合</td>
</tr>
<tr>
<td align="center">F2</td>
<td align="center">左右框的开合</td>
</tr>
<tr>
<td align="center">Shif+F2</td>
<td align="center">编辑窗口最大化</td>
</tr>
<tr>
<td align="center">F5</td>
<td align="center">运行</td>
</tr>
<tr>
<td align="center">F9</td>
<td align="center">添加断点</td>
</tr>
<tr>
<td align="center">Ctrl+Shift+P或F1</td>
<td align="center">查看所有模块</td>
</tr>
<tr>
<td align="center">Alt+Shift+P</td>
<td align="center">新建项目</td>
</tr>
<tr>
<td align="center">Ctrl+Shift+N</td>
<td align="center">打开一个新Egret Wing窗口</td>
</tr>
<tr>
<td align="center">Ctrl+Shift+O</td>
<td align="center">能够打开快速大纲面板，显示当前文件中定义的所有类，方法和变量。</td>
</tr>
<tr>
<td align="center">Shift+F12</td>
<td align="center">查找所有引用</td>
</tr>
<tr>
<td align="center">Alt+Left</td>
<td align="center">切换到上一个编辑位置</td>
</tr>
<tr>
<td align="center">Ctrl+Shift+K</td>
<td align="center">删除当前行</td>
</tr>
<tr>
<td align="center">Ctrl+delete</td>
<td align="center">删除右侧单词</td>
</tr>
<tr>
<td align="center">Ctrl+D</td>
<td align="center">类似于eclipse中Ctrl+K</td>
</tr>
<tr>
<td align="center">Ctrl+home</td>
<td align="center">光标移到文件顶部</td>
</tr>
<tr>
<td align="center">Ctrl+U</td>
<td align="center">返回上一光标</td>
</tr>
<tr>
<td align="center">Ctrl+i</td>
<td align="center">选择当前行</td>
</tr>
<tr>
<td align="center">Alt+Shift+F</td>
<td align="center">格式化代码</td>
</tr>
<tr>
<td align="center">Tab</td>
<td align="center">自动补全</td>
</tr>
<tr>
<td align="center">Alt+Backspace</td>
<td align="center">删除光标所在单词的光标前的部分</td>
</tr>
<tr>
<td align="center">Alt+括号</td>
<td align="center">打印出整个括号</td>
</tr>
<tr>
<td align="center">Alt+↑或者Alt+↓</td>
<td align="center">关闭或者打开光标所在的一个折叠</td>
</tr>
<tr>
<td align="center">Alt+←或者Alt+→</td>
<td align="center">切换光标上一个下一个位置</td>
</tr>
<tr>
<td align="center">Alt+Home</td>
<td align="center">关闭所有折叠</td>
</tr>
<tr>
<td align="center">Alt+End</td>
<td align="center">关闭所有折叠</td>
</tr>
<tr>
<td align="center">Alt+F3</td>
<td align="center">打开搜索模式</td>
</tr>
<tr>
<td align="center">Alt+F5</td>
<td align="center">运行当前的文件</td>
</tr>
<tr>
<td align="center">Alt+1</td>
<td align="center">打开所有折叠</td>
</tr>
<tr>
<td align="center">Alt+2</td>
<td align="center">折叠所有classes</td>
</tr>
<tr>
<td align="center">Alt+3</td>
<td align="center">折叠所有函数和类</td>
</tr>
<tr>
<td align="center">Shift+Enter</td>
<td align="center">向上新建一行</td>
</tr>
<tr>
<td align="center">ctrl+”/“</td>
<td align="center">批量注释</td>
</tr>
<tr>
<td align="center">ctrl+shift+”/“</td>
<td align="center">批量取消注释</td>
</tr>
<tr>
<td align="center">ctrl+”&lt;”</td>
<td align="center">向前缩进</td>
</tr>
<tr>
<td align="center">ctrl+”&gt;”</td>
<td align="center">向后缩进</td>
</tr>
</tbody></table>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>IDE</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 cuDNN launch failure 错误</title>
    <url>/2020/05/09/deep_learning/keras/cudnn-launch-failure-fix/cudnn-launch-failure-fix/</url>
    <content><![CDATA[<blockquote>
<p>在神经网络模型推断过程中，报错<code>Internal: cuDNN launch failure : input shape ([1,3,2048,2048]) node bn_data/FusedBatchNorm </code>，本文记录解决方案。</p>
</blockquote>
<a id="more"></a>

<h2 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h2><blockquote>
<p>网上有怀疑该问题由BN层引起，去掉BN层可以解决问题<a href="https://blog.csdn.net/qq_36588760/article/details/105114185" target="_blank" rel="noopener">TensorFlow实战 InternalError: cuDNN launch failure : input shape（未解决求交流）</a>。</p>
<p>更换cudnn版本也无济于事。</p>
<p>事实上更可能是TensorFlow显存配置的问题（事实上也是缺少证据的，只是按照这个思路可以排除故障，因此该因素应该是最大似然的原因）</p>
</blockquote>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><blockquote>
<p>在代码中加入按需分配显存的配置：</p>
</blockquote>
<h3 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">con &#x3D; tf.ConfigProto()</span><br><span class="line">con.gpu_options.allow_growth &#x3D; True</span><br><span class="line">keras.backend.tensorflow_backend.set_session(tf.Session(config&#x3D;con))</span><br></pre></td></tr></table></figure>

<h3 id="方案2"><a href="#方案2" class="headerlink" title="方案2"></a>方案2</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">os.environ[&#39;TF_FORCE_GPU_ALLOW_GROWTH&#39;] &#x3D; &#39;true&#39;</span><br></pre></td></tr></table></figure>

<p>原理相同，只是不一样的写法。</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>深度学习</category>
        <category>Keras</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>深度学习</tag>
        <tag>Keras</tag>
      </tags>
  </entry>
  <entry>
    <title>docker - 常用命令使用教程</title>
    <url>/2020/05/06/docker/docker_usage/</url>
    <content><![CDATA[<blockquote>
<p>本文简要介绍Docker，记录Docker常用命令使用方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="Docker-简介"><a href="#Docker-简介" class="headerlink" title="Docker 简介"></a>Docker 简介</h3><blockquote>
<p><strong>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。</strong>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。有了 Docker，就不用担心环境问题。</p>
</blockquote>
<h3 id="Docker-使用流程"><a href="#Docker-使用流程" class="headerlink" title="Docker 使用流程"></a>Docker 使用流程</h3><ul>
<li><a href="https://docs.docker.com/desktop/" target="_blank" rel="noopener">安装docker</a></li>
<li>创建Image</li>
<li>从Image创建Container</li>
<li>在Container中工作</li>
<li>将在Container中做的修改提交给Image</li>
<li>销毁Container</li>
</ul>
<h3 id="命令介绍"><a href="#命令介绍" class="headerlink" title="命令介绍"></a>命令介绍</h3><ul>
<li>拉取 image</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker image pull [docker-url]</span><br></pre></td></tr></table></figure>

<ul>
<li>获取docker images 列表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker images</span><br><span class="line">或</span><br><span class="line">docker image ls</span><br></pre></td></tr></table></figure>

<ul>
<li>建立container （nvidia docker)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NV_GPU&#x3D;[gpu_num] nvidia-docker run -it --name [container_name] --shm-size&#x3D;[shm_size] --rm -v [current_dir]:[container_dir] -p [current_port]:[container_port] [image_name]:[image_tag]  [command]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>NV_GPU: container中可见的GPU，如果不设置可见所有GPU</p>
<p>-it: 将容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器</p>
<p>–name: 容器名称，如果不设置会随机分配一个名字</p>
<p>–shm-size: 容器共享内存大小设置。如果不设置默认大小64M，对于需要使用共享内存的情况往往是不够用的，如果设置为10g，这样配置： <code>--ssh-size=&quot;10g&quot;</code> </p>
<p>–rm: 容器关闭后自动删除，如果不设置容器不会自动删除</p>
<p>-v: 驱动器映射，将本机的目录映射到容器的指定文件夹中；需要说明的是，在主机文件夹中的挂载目录在容器中是可见的；需要再说明的是容器启动时主机挂载的目录容器是见不到的；最后说明，容器关闭再打开就可以看到主机挂载的所有文件夹了。</p>
<p>-p: 暴漏容器的端口到本机的端口上，例如用于ssh连接容器时需要将容器的22端口暴露到主机的端口上(比如3721)，则可以设置 <code>-p 3721:22</code></p>
<p>image_name, image_tag: 这是docker镜像的名称与标记，如果使用本机镜像可以在docker images列表中查询到</p>
<p>command: 启动容器后内部执行的第一个命令，一般为 <code>/bin/bash</code></p>
</blockquote>
<ul>
<li>查询container列表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container ls --all</span><br></pre></td></tr></table></figure>

<blockquote>
<p>–all: 加上该参数会显示没有在运行的容器，不加的话仅显示运行中的容器</p>
</blockquote>
<ul>
<li>停止指定的容器运行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container kill [containerID]</span><br><span class="line">docker stop [containerID]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>docker container kill</code>命令终止容器运行，相当于向容器里面的主进程发出 SIGKILL 信号。<code>docker container stop</code>命令相当于向容器里面的主进程发出 SIGTERM 信号，然后过一段时间再发出 SIGKILL 信号。</p>
</blockquote>
<ul>
<li>启动停止的容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker start [containerID]</span><br></pre></td></tr></table></figure>

<ul>
<li>重启运行的容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker restart [containerID]</span><br></pre></td></tr></table></figure>

<ul>
<li>删除指定的容器文件（仅在停止运行时可用）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container rm [containerID]</span><br></pre></td></tr></table></figure>

<ul>
<li>查看容器输出</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container logs [containerID]</span><br></pre></td></tr></table></figure>

<ul>
<li>启动容器的一个终端</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container exec -it [containerID] &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此种方法启动的终端，即使退出也不会关闭容器</p>
<p>相反 - 如果直接通过端口映射连接 docker 建立的ssh链接，窗口退出后该终端的工作也会一同停止</p>
</blockquote>
<ul>
<li>进入容器的主终端</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker attach [containerID]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>连接到容器的主终端，该终端退出后容器关闭。</p>
<p>如果不希望退出后关闭，可以加入选项 <code>--sig-proxy=false</code></p>
</blockquote>
<ul>
<li>退出终端</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctrl p + ctrl q</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以在退出终端的同时保持终端继续工作</p>
</blockquote>
<ul>
<li>退出容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在容器中运行此命令</p>
</blockquote>
<ul>
<li>拷贝容器里的文件到本机</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container cp [containerID]:[&#x2F;path&#x2F;to&#x2F;file]</span><br></pre></td></tr></table></figure>

<ul>
<li>提交容器修改到镜像</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker commit -a [name] -m [comments] -p  [containerID[:TAG]]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-a: 提交的镜像作者</p>
<p>-m: 提交时的说明文字</p>
<p>-p: 在commit时，将容器暂停</p>
</blockquote>
<ul>
<li>删除镜像</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker rmi [image]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>或</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker image rm [image]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>支持的子命令如下：</p>
</blockquote>
<ul>
<li><code>-f, -force</code>: 强制删除镜像，即便有容器引用该镜像；</li>
<li><code>-no-prune</code>: 不要删除未带标签的父镜像；</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html</a></p>
</li>
<li><p><a href="https://www.runoob.com/docker/docker-tutorial.html" target="_blank" rel="noopener">https://www.runoob.com/docker/docker-tutorial.html</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Git - 常用命令使用教程</title>
    <url>/2020/05/06/git/git_usage/git-usage/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍git常用命令的使用方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><blockquote>
<p>译为<code>分布式版本控制系统</code>，是一个开源的分布式版本控制系统，可以有效、高速地处理从很小到非常大的项目版本管理。</p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>Linux</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt install git-all</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo dnf install git-all</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Windows</li>
</ul>
<p>在  <a href="https://git-scm.com/download/win" target="_blank" rel="noopener">https://git-scm.com/download/win</a> 下载 gitbash 并安装即可</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ul>
<li>Linux</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git --version</span></span><br><span class="line"></span><br><span class="line"><span class="meta">-&gt;</span><span class="bash"> git version 2.7.4 <span class="comment"># 出现版本表示安装成功</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>Windows</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git --version</span></span><br><span class="line"></span><br><span class="line"><span class="meta">-&gt;</span><span class="bash"> git version 2.25.0.windows.1 <span class="comment"># 出现版本表示安装成功</span></span></span><br></pre></td></tr></table></figure>

<h1 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h1><blockquote>
<p>译为<code>版本库</code>或<code>仓库</code>，是git的核心概念，用于存放代码与各个版本的补丁信息和用户配置信息等。</p>
</blockquote>
<h2 id="Git-配置"><a href="#Git-配置" class="headerlink" title="Git 配置"></a>Git 配置</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.name <span class="string">"your name"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.email <span class="string">"your_email@youremail.com"</span></span></span><br></pre></td></tr></table></figure>

<h2 id="Git-信息流"><a href="#Git-信息流" class="headerlink" title="Git 信息流"></a>Git 信息流</h2><blockquote>
<p>初次接触git的人需要对git信息流有一个初步的理解，掌握脉络之后就明白各个命令实在干什么了，主要流程如下图：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200506231304.png"></p>
<h3 id="主要概念"><a href="#主要概念" class="headerlink" title="主要概念"></a>主要概念</h3><ul>
<li>workspace（工作区）：当前工作目录，它持有实际文件；</li>
<li>inedex（暂存区）：保存临时改动，workspace的文件改动后通过add命令添加到index；</li>
<li>repository（仓库）：git管理的本地仓库，index中确定需要的更改提交到仓库中，存放提交的修改与历史变动；</li>
<li>HEAD：指向最后一次提交的结果，可以理解为每一次commit提交代码都会在git中产生一个节点，每个节点代表一个代码仓库的历史状态，我们可以在各个节点之间反复横跳，但是一个时刻只能在一个节点上，而标记我们在那个节点的就是HEAD，很像C语言中的指针；</li>
<li>Remote（远程端）：git的真正妙用在于有统一的服务器管理协同工作的多个开发人员的代码，因此我们经常需要把本地仓库的代码推送（push）到远端，或把远端的代码拉取（fetch/pull）或复制（clone）到本地。</li>
</ul>
<h2 id="主要命令"><a href="#主要命令" class="headerlink" title="主要命令"></a>主要命令</h2><h3 id="仓库管理"><a href="#仓库管理" class="headerlink" title="仓库管理"></a>仓库管理</h3><h4 id="git-init"><a href="#git-init" class="headerlink" title="git init"></a>git init</h4><blockquote>
<p>Git 使用 <strong>git init</strong> 命令来初始化一个 Git 仓库，Git 的很多命令都需要在 Git 的仓库中运行，所以 <strong>git init</strong> 是使用 Git 的第一个命令。</p>
<p>在执行完成 <strong>git init</strong> 命令后，Git 仓库会生成一个 .git 目录，该目录包含了资源的所有元数据，其他的项目目录保持不变。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在现有文件夹下使用该命令，会在当前文件夹创建 <code>.git</code>目录，该目录记录git相关管理信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git init test_dir</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会在当前文件夹下创建<code>test_dir</code>文件夹，并在其中创建<code>.git</code>文件夹。</p>
</blockquote>
<h4 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h4><blockquote>
<p><strong>git clone</strong> 从现有 Git 仓库中拷贝项目。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone [-b branch] &lt;repo&gt; [directory]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>repo</code>:  要克隆的远程仓库地址</p>
<p><code>branch</code>: 将要克隆的远程仓库分支名称，如果不设置该项参数则会克隆默认分支</p>
<p><code>directory</code>: 本地仓库文件夹名称，如果不设置该项参数则以仓库名称命名文件夹</p>
</blockquote>
<ul>
<li>协议配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone git@github.com:zywvvd&#x2F;test.git            --SSH协议</span><br><span class="line">git clone git:&#x2F;&#x2F;github.com&#x2F;zywvvd&#x2F;test.git          --GIT协议</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zywvvd&#x2F;test.git        --HTTPS协议</span><br></pre></td></tr></table></figure>

<blockquote>
<p>git clone 时，可以所用不同的协议，包括 ssh, git, https 等，其中最常用的是 ssh，因为速度较快，还可以配置公钥免输入密码。</p>
</blockquote>
<h4 id="git-config"><a href="#git-config" class="headerlink" title="git config"></a>git config</h4><blockquote>
<p>查看和配置git相关信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看git配置信息</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git conifg -e</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编辑配置文件（针对当前仓库）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config -e --global</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编辑配置文件（针对系统上所有仓库）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;vvd&quot;</span><br><span class="line">git config --global user.email vvd@canglan.com</span><br></pre></td></tr></table></figure>

<blockquote>
<p>配置提交代码时的用户信息</p>
</blockquote>
<h3 id="本地信息流管理"><a href="#本地信息流管理" class="headerlink" title="本地信息流管理"></a>本地信息流管理</h3><blockquote>
<p>本地信息流主要涉及<strong>工作区(workspace)**、</strong>暂存区(index)<strong>和</strong>版本库(repository)**</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200527000031.png"></p>
<h4 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h4><blockquote>
<p><strong>git add</strong> 命令可将该文件添加到暂存区。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add [file1] [file2] ...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>添加一个或多个文件到暂存区。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add [dir]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>添加指定目录到暂存区，包括子目录。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>他会监控工作区的状态树，使用它会把工作时的<strong>所有变化提交</strong>到暂存区，包括文件内容修改(modified)以及新文件(new)，<strong>但不包括被删除的文件</strong>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add -u</span><br></pre></td></tr></table></figure>

<blockquote>
<p>git add –update的缩写，他仅监控<strong>已经被add的文件</strong>（即tracked file），他会将被修改的文件提交到暂存区。add -u 不会提交新文件（untracked file）。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add -A</span><br></pre></td></tr></table></figure>

<blockquote>
<p>git add –all的缩写，是上面两个功能的合集。</p>
</blockquote>
<p><strong>注</strong>：个人建议慎用 <code>git add -A</code>，需要明确地知道每步add操作提交了什么，切实管理自己的仓库。</p>
<h4 id="git-rm"><a href="#git-rm" class="headerlink" title="git rm"></a>git rm</h4><blockquote>
<p>git rm 命令用于从暂存区和工作区中删除文件（会删除本地文件）。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rm &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将文件<code>file</code>从暂存区和工作区中删除。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rm -f &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>强制删除选项 <code>-f</code>。</p>
<p>用于删除之前修改过并且已经放到暂存区域的情况。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rm --cached &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--cached</code> 选项，可以把文件从暂存区域移除，但仍然保留在当前工作目录中，即从跟踪清单中删除。</p>
</blockquote>
<h4 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h4><blockquote>
<p>将暂存区中的内容添加到本地仓库中。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit -m &lt;message&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将暂存区的内容提交到本地仓库；</p>
<p>此过程中必须附加<code>message</code>信息，提交后会在git中生成唯一的名称记录这一提交，可以在<code>git log</code>命令中查看。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit [file1] [file2] ... -m &lt;message&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以对部分文件进行提交。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit -a</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>-a</code> 参数设置修改文件后不需要执行 git add 命令，直接来提交。</p>
</blockquote>
<p><strong>注</strong>：首次提交必须设置用户信息的名称和邮箱。</p>
<h4 id="git-checkout"><a href="#git-checkout" class="headerlink" title="git checkout"></a>git checkout</h4><blockquote>
<p>此命令用来放弃掉所有还没有提交（就是 git add 或 git commit）的修改：内容修改与整个文件删除。但是此命令不会删除掉刚新建的文件。因为刚新建的文件还没已有加入到 git 的管理系统中。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout -- &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将缓存区的文件覆盖到工作区中，在文件名与分支名没有歧义时可以省略<code>--</code>。</p>
<p>如果暂存区有该文件的提交，则从暂存区中抓取文件覆盖当前工作区的文件，否则从最近一次commit中抓取该文件并覆盖当前文件。</p>
<p>总之就是把该文件最近一次 add 或 commit 的副本抓来覆盖了工作区的文件。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout .</span><br></pre></td></tr></table></figure>


<blockquote>
<p>这个操作很危险，会清除工作区中未添加到暂存区的改动，放弃所有的工作区文件修改。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout HEAD &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>用 HEAD 指向的 master 分支中的文件替换暂存区和以及工作区中的文件。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout HEAD .</span><br></pre></td></tr></table></figure>

<blockquote>
<p>用 HEAD 指向的 master 分支中的所有文件替换暂存区和以及工作区中的文件。</p>
</blockquote>
<p>注：<code>checkout HEAD</code>是极具危险性的命令，它不但会清除工作区中未提交的改动，也会清除暂存区中未提交的改动。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout --orphan &lt;branch name&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将当前所在Head的工作区状态直接带到开辟的全新分支当中，用于清空之前所有提交记录。</p>
<p>切换到新分支时没有任何提交记录，所有现有工作区的文件都是全新的，在添加到暂存区并提交之后才有了第一次提交。</p>
</blockquote>
<h4 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h4><blockquote>
<p>git reset 命令用于回退版本，可以指定退回某一次提交的版本。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset [--soft | --mixed | --hard] [HEAD] [file]</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><code>--mixed</code> 为默认，可以不用带该参数，用于重置暂存区的文件与上一次的提交(commit)保持一致，工作区文件内容保持不变。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset HEAD  # 取消之前 git add 添加过的缓存。</span><br></pre></td></tr></table></figure>

<p>暂存区的目录树会被重写，被 master 分支指向的目录树所替换，但是工作区不受影响。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git reset HEAD^            # 回退所有内容到上一个版本  </span><br><span class="line">$ git reset HEAD^ hello.php  # 回退 hello.php 文件的版本到上一个版本  </span><br><span class="line">$ git  reset  052e           # 回退到指定版本</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>--soft</code> 参数用于回退到某个版本：</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset --soft HEAD~3  #  回退上上上一个版本</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>--hard</code> 参数撤销工作区中所有未提交的修改内容，将暂存区与工作区都回到上一次版本，并删除之前的所有信息提交：</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset --hard HEAD</span><br></pre></td></tr></table></figure>

<p>  实例：</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git reset –hard HEAD~3  # 回退上上上一个版本  </span><br><span class="line">$ git reset –hard bae128  # 回退到某个版本回退点之前的所有信息。 </span><br><span class="line">$ git reset --hard origin&#x2F;master    # 将本地的状态回退到和远程的一样 </span><br></pre></td></tr></table></figure>

<p>  <strong>注：</strong>谨慎使用 –hard 参数，它会删除回退点之前的所有信息。</p>
</li>
<li><p>HEAD 说明</p>
<ul>
<li>HEAD 表示当前版本</li>
<li>HEAD^ 上一个版本</li>
<li>HEAD^^ 上上一个版本</li>
<li>HEAD^^^ 上上上一个版本</li>
<li>以此类推…</li>
</ul>
<p>可以使用 ～数字表示</p>
<ul>
<li>HEAD~0 表示当前版本</li>
<li>HEAD~1 上一个版本</li>
<li>HEAD^2 上上一个版本</li>
<li>HEAD^3 上上上一个版本</li>
<li>以此类推…</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h4><blockquote>
<p>比较文件在暂存区和工作区的差异，即显示已写入暂存区和已经被修改但尚未写入暂存区文件对区别。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git diff [file]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示暂存区和工作区的差异。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git diff --cached [file]</span><br><span class="line">或</span><br><span class="line">git diff --staged [file]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示暂存区和上一次提交(commit)的差异。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git diff [first-branch]...[second-branch]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示两次提交之间的差异。</p>
</blockquote>
<h4 id="git-mv"><a href="#git-mv" class="headerlink" title="git mv"></a>git mv</h4><blockquote>
<p>用于移动或重命名一个文件、目录或软连接。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git mv [file] [newfile] [-f]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在git中移动文件</p>
<p><code>-f</code>: 强制文件移动(如果已经存在该文件则会覆盖)</p>
</blockquote>
<h4 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h4><blockquote>
<p>查看仓库当前的状态，显示有变更的文件，用于查看在你上次提交之后是否有对文件进行再次修改。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>

<blockquote>
<p>详细显示工作区和暂存区的修改、提交状态。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">On branch master</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        new file:   B</span><br><span class="line">        new file:   C</span><br><span class="line">        new file:   D</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add&#x2F;rm &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        deleted:    C</span><br><span class="line">        modified:   D</span><br><span class="line">        modified:   E</span><br><span class="line"></span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        renamed:    D -&gt; F</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        A</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git status -s</span><br></pre></td></tr></table></figure>

<blockquote>
<p>简略输出状态结果。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">A  B</span><br><span class="line">AD C</span><br><span class="line">AM D</span><br><span class="line"> M E</span><br><span class="line"> D a.txt</span><br><span class="line">R  D -&gt; F</span><br><span class="line">?? A</span><br></pre></td></tr></table></figure>

<ul>
<li>符号说明<ul>
<li><code>A(Added)</code>:  新添加到暂存区的文件</li>
<li><code>M(Modified)</code>:  已经提交过并被修改的文件</li>
<li><code>D(Deleted)</code>:  已经提交过并被直接删除的文件</li>
<li><code>R(Renamed)</code>: 重命名的文件</li>
<li><code>AD</code>: 已经提交到暂存区后被删除</li>
<li><code>AM</code>: 已经提交到暂存区后被修改</li>
<li><code>??(Untracked)</code>: 未追踪的文件</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a>git stash</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将所有未提交的修改（工作区和暂存区）保存至堆栈中，用于后续恢复当前工作目录。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash save</span><br></pre></td></tr></table></figure>

<blockquote>
<p>作用等同于git stash，区别是可以加一些注释:</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash的效果：</span><br><span class="line"></span><br><span class="line">stash@&#123;0&#125;: WIP on master: b2f489c second</span><br><span class="line">1</span><br><span class="line">git stash save “test1”的效果：</span><br><span class="line"></span><br><span class="line">stash@&#123;0&#125;: On master: test1</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash list</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看当前stash中的内容</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash pop</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将当前stash中的内容弹出，并应用到当前分支对应的工作目录上。<br>注：该命令将堆栈中最近保存的内容删除（栈是先进后出）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash apply</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将堆栈中的内容应用到当前目录，不同于git stash pop，该命令不会将内容从堆栈中删除，也就说该命令能够将堆栈的内容多次应用到工作目录中，适应于多个分支的情况。</p>
<p>可以使用git stash apply + stash名字（如stash@{1}）指定恢复哪个stash到当前的工作目录。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash drop + 名字</span><br></pre></td></tr></table></figure>

<blockquote>
<p>从堆栈中移除某个指定的stash</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash clear</span><br></pre></td></tr></table></figure>

<blockquote>
<p>清除堆栈中的所有 内容</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash show</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看堆栈中最新保存的stash和当前目录的差异。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git stash show</span><br><span class="line"> src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;StringTest.java | 2 +-</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br></pre></td></tr></table></figure>

<p><code>git stash show stash@{1}</code>查看指定的stash和当前目录差异。</p>
<p>通过 <code>git stash show -p</code> 查看详细的不同:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git stash show -p</span><br><span class="line">diff --git a&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;CacheTest.java b&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;CacheTest.java</span><br><span class="line">index 6e90837..de0e47b 100644</span><br><span class="line">--- a&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;CacheTest.java</span><br><span class="line">+++ b&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;CacheTest.java</span><br><span class="line">@@ -7,6 +7,6 @@ package com.wy;</span><br><span class="line">  *&#x2F;</span><br><span class="line"> public class CacheTest &#123;</span><br><span class="line">     public static void main(String[] args) &#123;</span><br><span class="line">-        System.out.println(&quot;git stash test&quot;);</span><br><span class="line">+        System.out.println(&quot;git stash test1&quot;);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">diff --git a&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;StringTest.java b&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;StringTest.java</span><br><span class="line">index a7e146c..711d63f 100644</span><br><span class="line">--- a&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;StringTest.java</span><br><span class="line">+++ b&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;wy&#x2F;StringTest.java</span><br><span class="line">@@ -12,7 +12,7 @@ public class StringTest &#123;</span><br><span class="line"></span><br><span class="line">     @Test</span><br><span class="line">     public void test1() &#123;</span><br><span class="line">-        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);</span><br><span class="line">+        System.out.println(&quot;git stash test1&quot;);</span><br><span class="line">         System.out.println(Strings.isNullOrEmpty(&quot;&quot;));&#x2F;&#x2F;true</span><br><span class="line">         System.out.println(Strings.isNullOrEmpty(&quot; &quot;));&#x2F;&#x2F;false</span><br><span class="line">         System.out.println(Strings.nullToEmpty(null));&#x2F;&#x2F;&quot;&quot;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash branch</span><br></pre></td></tr></table></figure>

<blockquote>
<p>从最新的stash创建分支。</p>
</blockquote>
<h4 id="git-revert"><a href="#git-revert" class="headerlink" title="git revert"></a>git revert</h4><blockquote>
<p>通过创建一次新的 <code>commit</code> 来撤销一次 <code>commit</code> 所做出的修改。这种撤销的方式是安全的，因为它并不修改 <code>commitm history</code>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git revert HEAD~2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将会查出倒数第二次（即当前commit的往前一次）提交的修改，并创建一个新的提交，用于撤销当前提交的上一次 <code>commit</code>。</p>
</blockquote>
<h3 id="历史记录管理"><a href="#历史记录管理" class="headerlink" title="历史记录管理"></a>历史记录管理</h3><h4 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a>git log</h4><blockquote>
<p>查看历史提交记录。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log [--oneline]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示提交记录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git log</span><br><span class="line">commit 5ac3ea4f50f0f558d8ba36ef7b713054c4cfee69 (HEAD -&gt; master)</span><br><span class="line">Author: vvd-from-xiaobing&#39;s-notebook &lt;zywvvd@mail.ustc.edu.cn&gt;</span><br><span class="line">Date:   Sat Aug 29 16:11:56 2020 +0800</span><br><span class="line"></span><br><span class="line">    save</span><br><span class="line"></span><br><span class="line">commit 50f554063e4ca3502dfc318817522aee88863d62</span><br><span class="line">Author: vvd-from-xiaobing&#39;s-notebook &lt;zywvvd@mail.ustc.edu.cn&gt;</span><br><span class="line">Date:   Sat Aug 29 15:56:13 2020 +0800</span><br><span class="line"></span><br><span class="line">    add-e</span><br><span class="line"></span><br><span class="line">commit 3de3b277020322cd8f6991987fe38158d3fcdfea</span><br><span class="line">Author: vvd-from-xiaobing&#39;s-notebook &lt;zywvvd@mail.ustc.edu.cn&gt;</span><br><span class="line">Date:   Sat Aug 29 15:36:23 2020 +0800</span><br><span class="line"></span><br><span class="line">    save</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log [--oneline]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--oneline</code>: 简略显示提交记录日志</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git log --oneline</span><br><span class="line">5ac3ea4 (HEAD -&gt; master) save</span><br><span class="line">50f5540 add-e</span><br><span class="line">3de3b27 save</span><br><span class="line">9313997 save</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log [--graph] [--reverse]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--graph</code>:  查看历史中什么时候出现了分支、合并；</p>
<p><code>--reverse</code>: 正常上方显示最新的提交信息，该参数可以反向输出信息；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log [--author] [--since] [--before] [--until] [--after]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--author</code>: 只想查找指定用户的提交日志；</p>
<p><code>--since</code> <code>--until</code> <code>--until</code> <code>--after</code>: 按照时间过滤信息</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log --oneline --before&#x3D;&#123;3.weeks.ago&#125; --after&#x3D;&#123;2010-04-18&#125; --no-merges</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="git-blame"><a href="#git-blame" class="headerlink" title="git blame"></a>git blame</h4><blockquote>
<p>查看指定文件的修改记录。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git blame &lt;file&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看 <code>file</code>文件的修改记录。</p>
</blockquote>
<h3 id="远程信息流管理"><a href="#远程信息流管理" class="headerlink" title="远程信息流管理"></a>远程信息流管理</h3><h4 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h4><blockquote>
<p>用于在远程仓库的操作。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示所有远程仓库。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git clone git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">$ cd Python_Practise</span><br><span class="line">$ git remote -v</span><br><span class="line">origin  git@github.com:zywvvd&#x2F;Python_Practise.git (fetch)</span><br><span class="line">origin  git@github.com:zywvvd&#x2F;Python_Practise.git (push)</span><br></pre></td></tr></table></figure>

<p><strong>origin</strong> 为远程地址的别名。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote show [remote]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显示某个远程仓库的信息。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git remote show git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">* remote git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">  Fetch URL: git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">  Push  URL: git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">  HEAD branch: master</span><br><span class="line">  Local ref configured for &#39;git push&#39;:</span><br><span class="line">    master pushes to master (up to date)</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add [shortname] [url]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>添加远程版本库。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 提交到 Github</span><br><span class="line">$ git remote add origin git@github.com:zywvvd&#x2F;Python_Practise.git</span><br><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote rm name</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除远程仓库。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote rename old_name new_name</span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改仓库名。</p>
</blockquote>
<h4 id="git-fetch"><a href="#git-fetch" class="headerlink" title="git fetch"></a>git fetch</h4><blockquote>
<p>用于从远程获取代码库。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git fetch &lt;remote&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>获取远程<code>remote</code>仓库的信息，取回到本地。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git fetch &lt;remote&gt; &lt;branch&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>取回特定分支的更新，可以指定分支名。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git fetch origin master</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h4><blockquote>
<p>从一个仓库或者本地的分支拉取并且整合代码。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git pull [&lt;options&gt;] [&lt;repository&gt; [&lt;refspec&gt;]]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>git pull</code>相当于 <code>git fetch</code> 跟着一个 <code>git merge FETCH_HEAD</code>。<code>&lt;repository&gt;</code>是仓库的名字，<code>&lt;refspec&gt;</code> 是分支的名字。如果都不写，会有一个默认值。</p>
<p>实例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git pull origin master</span><br></pre></td></tr></table></figure>

<p>拉取远程服务器<code>origin</code>的<code>master</code>分支。</p>
</blockquote>
<p>注：git pull = git fetch + git merge。</p>
<h4 id="git-push"><a href="#git-push" class="headerlink" title="git push"></a>git push</h4><blockquote>
<p>用于将本地分支的更新，推送到远程主机。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>分支推送顺序的写法是&lt;来源地&gt;:&lt;目的地&gt;，所以git pull是&lt;远程分支&gt;:&lt;本地分支&gt;，而git push是&lt;本地分支&gt;:&lt;远程分支&gt;。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin master:master</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将本地的master分支推送到origin主机的master分支，如果后者不存在，则会被新建。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果省略远程分支名，则表示将本地分支推送与之存在”追踪关系”的远程分支(通常两者同名)，如果该远程分支不存在，则会被新建。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果当前分支与远程分支之间存在追踪关系，则本地分支和远程分支都可以省略。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果当前分支只有一个追踪分支，那么主机名都可以省略。</p>
</blockquote>
<p>注：不带任何参数的git push，默认只推送当前分支，这叫做simple方式。此外，还有一种matching方式，会推送所有有对应的远程分支的本地分支。Git 2.0版本之前，默认采用matching方法，现在改为默认采用simple方式。如果要修改这个设置，可以采用git config命令。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global push.default matching</span><br><span class="line">或</span><br><span class="line">git config --global push.default simple</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果当前分支与多个主机存在追踪关系，则可以使用-u选项指定一个默认主机，这样后面就可以不加任何参数使用git push。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push --all origin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将所有本地分支都推送到origin主机。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin :master</span><br><span class="line">或</span><br><span class="line">git push origin --delete master</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果省略本地分支名，则表示删除指定的远程分支，因为这等同于推送一个空的本地分支到远程分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push --force origin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果远程主机的版本比本地版本更新，推送时Git会报错，要求先在本地做git pull合并差异，然后再推送到远程主机。这时，如果你一定要推送，可以使用–force选项。</p>
<p>上面命令使用–force选项，结果导致在远程主机产生一个”非直进式”的合并(non-fast-forward merge)。除非你很确定要这样做，否则应该尽量避免使用–force选项。</p>
</blockquote>
<h3 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h3><h4 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h4><blockquote>
<p>用于分支管理。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>

<blockquote>
<p>列出本地分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -v</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看每一个分支的最后一次提交。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--merged&#96; 与 &#96;--no-merged&#96; 这两个有用的选项可以过滤这个列表中已经合并或尚未合并到当前分支的分支。 如果要查看哪些分支已经合并到当前分支，可以运行 &#96;git branch --merged</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch --remote</span><br><span class="line">或</span><br><span class="line">git branch -r</span><br></pre></td></tr></table></figure>

<blockquote>
<p>列出远程分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch --all</span><br><span class="line">或</span><br><span class="line">git branch -a</span><br></pre></td></tr></table></figure>
<blockquote>
<p>列出本地和远程所有分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>创建分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -d &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除本地分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -d -r &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除远程分支，删除后还需推送到服务器 <code> git push origin:&lt;branchname&gt;</code>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -m &lt;oldbranch&gt; &lt;newbranch&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重命名本地分支。</p>
</blockquote>
<h4 id="git-checkout-1"><a href="#git-checkout-1" class="headerlink" title="git checkout"></a>git checkout</h4><blockquote>
<p>checkout 命令除了放弃掉所有还没有提交的修改外，还有切换分支的功能。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>切换到指定分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout -b &lt;branchname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>创建分支并切换过去。</p>
</blockquote>
<h4 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h4><blockquote>
<p>用于从指定的<strong>commit(s)**合并到</strong>当前分支**的操作，有以下两种用途：</p>
<ol>
<li>用于git-pull中，来整合另一代码仓库中的变化（即：git pull = git fetch + git merge）</li>
<li>用于从一个分支到另一个分支的合并</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge -m &lt;msg&gt; &lt;commit&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将<code>commit</code>合并到当前分支。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --abort</span><br></pre></td></tr></table></figure>

<blockquote>
<p>该命令仅仅在合并后导致冲突时才使用。<code>git merge --abort</code>将会抛弃合并过程并且尝试重建合并前的状态。但是，当合并开始时如果存在未commit的文件，<code>git merge --abort</code>在某些情况下将无法重现合并前的状态（特别是这些未commit的文件在合并的过程中将会被修改时）。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --commit</span><br><span class="line">和</span><br><span class="line">git merge --no-commit</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--commit</code>参数使得合并后产生一个合并结果的commit节点。该参数可以覆盖<code>--no-commit</code>。<br> <code>--no-commit</code>参数使得合并后，为了防止合并失败并不自动提交，能够给使用者一个机会在提交前审视和修改合并结果。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --edit &#x2F; -e</span><br><span class="line">和</span><br><span class="line">git merge --no-edit</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--edit</code>和<code>-e</code>用于在成功合并、提交前调用编辑器来进一步编辑自动生成的合并信息。因此使用者能够进一步解释和判断合并的结果。<br> <code>--no-edit</code>参数能够用于接受自动合并的信息（通常情况下并不鼓励这样做）。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --ff</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--ff</code>是指fast-forward命令。当使用fast-forward模式进行合并时，将不会创造一个新的commit节点。默认情况下，<code>git-merge</code>采用fast-forward模式。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --ff-only</span><br></pre></td></tr></table></figure>

<blockquote>
<p>除非当前HEAD节点已经up-to-date（更新指向到最新节点）或者能够使用fast-forward模式进行合并，否则的话将拒绝合并，并返回一个失败状态。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --log[&#x3D;&lt;n&gt;]</span><br><span class="line">和</span><br><span class="line">git merge --no-log</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--log[=&lt;n&gt;]</code>将在合并提交时，除了含有分支名以外，还将含有最多n个被合并commit节点的日志信息。<br><code>--no-log</code>并不会列出该信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --stat</span><br><span class="line">和</span><br><span class="line">git merge -n &#x2F; --no-stat</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--stat</code>参数将会在合并结果的末端显示文件差异的状态。文件差异的状态也可以在git配置文件中的merge.stat配置。<br>相反，<code>-n</code>, <code>--no-stat</code>参数将不会显示该信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge --squash  </span><br><span class="line">和</span><br><span class="line">git merge --no-squash</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--squash</code> 当一个合并发生时，从当前分支和对方分支的共同祖先节点之后的对方分支节点，一直到对方分支的顶部节点将会压缩在一起，使用者可以经过审视后进行提交，产生一个新的节点。</p>
</blockquote>
<p>注: 该参数和<code>--no-ff</code>冲突</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git merge -q &#x2F; --quiet</span><br><span class="line">和</span><br><span class="line">git merge -v &#x2F; --verbose</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>-q / --quiet</code> : 静默操作，不显示合并进度信息；</p>
<p><code>-v / --verbose</code>: 显示详细的合并结果信息。</p>
</blockquote>
<h4 id="git-rebase"><a href="#git-rebase" class="headerlink" title="git rebase"></a>git rebase</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rebase -i</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将本地的多次提交合并为一个，以简化提交历史。<strong>本地有多个提交时,如果不进行这一步,在git rebase master时会多次解决冲突(最坏情况下,每一个提交都会相应解决一个冲突)</strong></p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout master</span><br><span class="line">git pull</span><br><span class="line">git checkout local</span><br><span class="line">git rebase -i HEAD~2  &#x2F;&#x2F;合并提交 --- 2表示合并两个</span><br><span class="line">git rebase master----&gt;解决冲突---&gt;git rebase --continue</span><br><span class="line">git checkout master</span><br><span class="line">git merge local</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><h4 id="git-tag"><a href="#git-tag" class="headerlink" title="git tag"></a>git tag</h4><blockquote>
<p>给仓库历史中的某一个提交打上标签</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag &lt;name&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>给当前commit打上轻量标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log --oneline</span><br><span class="line">49a021d (HEAD -&gt; master) c</span><br><span class="line">cf68aa3 d</span><br><span class="line">5318a62 (tag: tag-test, dev) b added:</span><br><span class="line">75c5c3e add-a</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -l &lt;re&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>列出仓库中的tag列表</p>
<p>可以使用正则表达式选择感兴趣的标签</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -l &quot;test*&quot;</span><br><span class="line">test-2</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -a &lt;name&gt; -m &lt;comments&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>创建附注标签，通过使用 <code>git show</code> 命令可以看到标签信息和与之对应的提交信息：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git show test-2</span><br><span class="line">commit 49a021da8afad6b33f41a21fce057040c8ae8f80 (HEAD -&gt; master, tag: test-2)</span><br><span class="line">Author: zywvvd &lt;zywvvd@mail.ustc.edu.cn&gt;</span><br><span class="line">Date:   Sat Oct 17 14:22:13 2020 +0800</span><br><span class="line"></span><br><span class="line"> c</span><br><span class="line"></span><br><span class="line">diff --git a&#x2F;c b&#x2F;c</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..e69de29</span><br></pre></td></tr></table></figure>

<p>也可以为某个commit打标签：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -a v1.2 9fceb02</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin &lt;tagname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>推送标签，普通的<code>git push</code>并不会把本地的标签推送到远程，需要手动推送标签。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin --tags</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果想要一次性推送很多标签，也可以使用带有 <code>--tags</code> 选项的 <code>git push</code> 命令。 这将会把所有不在远程仓库服务器上的标签全部传送到那里。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -d &lt;tagname&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除掉你本地仓库上的标签。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout 2.0.0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>检出标签所在的commit，会处于“分离头指针（detached HEAD）”的状态。</p>
</blockquote>
<h4 id="git-选项"><a href="#git-选项" class="headerlink" title="git 选项"></a>git 选项</h4><ul>
<li>-d –delete：删除</li>
<li> -f –force：强制 </li>
<li>-m –move：移动或重命名 </li>
<li>-r –remote：远程 </li>
<li>-a –all：所有</li>
</ul>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ul>
<li><a href="https://www.runoob.com/git/git-basic-operations.html" target="_blank" rel="noopener">https://www.runoob.com/git/git-basic-operations.html</a></li>
<li><a href="https://www.jianshu.com/p/37f3a7e4a193" target="_blank" rel="noopener">https://www.jianshu.com/p/37f3a7e4a193</a></li>
<li><a href="https://blog.csdn.net/chaiyu2002/article/details/82120256" target="_blank" rel="noopener">https://blog.csdn.net/chaiyu2002/article/details/82120256</a></li>
<li><a href="https://www.cnblogs.com/djiankuo/p/6492533.html" target="_blank" rel="noopener">https://www.cnblogs.com/djiankuo/p/6492533.html</a></li>
<li><a href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86" target="_blank" rel="noopener">https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86</a></li>
<li><a href="https://www.jianshu.com/p/58a166f24c81" target="_blank" rel="noopener">https://www.jianshu.com/p/58a166f24c81</a></li>
<li><a href="https://blog.csdn.net/stone_yw/article/details/80795669" target="_blank" rel="noopener">https://blog.csdn.net/stone_yw/article/details/80795669</a></li>
<li><a href="https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE" target="_blank" rel="noopener">https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习-基础知识- 目标检测相关概念解释</title>
    <url>/2020/05/05/machine_learning/basic_knowledge/key_words/key-words-in-machine-lerning/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍机器学习目标检测相关各种基础概念的介绍。</p>
</blockquote>
<a id="more"></a>

<h2 id="目标检测"><a href="#目标检测" class="headerlink" title="目标检测"></a>目标检测</h2><blockquote>
<p>目标检测，也叫目标提取，是一种基于目标几何和统计特征的图像分割，它将目标的分割和识别合二为一，其准确性和实时性是整个系统的一项重要能力。</p>
<p>目标检测是计算机视觉和数字图像处理的一个热门方向，广泛应用于机器人导航、智能视频监控、工业检测、航空航天等诸多领域，通过计算机视觉减少对人力资本的消耗，具有重要的现实意义。因此，目标检测也就成为了近年来理论和应用的研究热点，它是图像处理和计算机视觉学科的重要分支，也是智能监控系统的核心部分，同时目标检测也是泛身份识别领域的一个基础性的算法，对后续的人脸识别、步态识别、人群计数、实例分割等任务起着至关重要的作用。由于深度学习的广泛运用，目标检测算法得到了较为快速的发展。</p>
</blockquote>
<h2 id="Ground-Truth"><a href="#Ground-Truth" class="headerlink" title="Ground Truth"></a>Ground Truth</h2><blockquote>
<p>Ground Truth(GT) 代表通过人工等方式为数据赋予的真实标签，用于训练模型与验证、测试模型性能。</p>
</blockquote>
<h2 id="Bounding-Box-bbox"><a href="#Bounding-Box-bbox" class="headerlink" title="Bounding Box (bbox)"></a>Bounding Box (bbox)</h2><blockquote>
<p>目标检测需要定位图像中的目标位置和类别，反映在数据上的形式就是使用矩形框框出目标区域，并标记类别标签，这就是目标检测的Bounding Box ，标注与算法输出都使用该形式，以便机器学习并对比实验结果。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200505191519.png"></p>
<h2 id="ROI-region-of-interest"><a href="#ROI-region-of-interest" class="headerlink" title="ROI (region of interest)"></a>ROI (region of interest)</h2><blockquote>
<p>感兴趣区域，与bbox概念类似，定义图像中我们感兴趣的部分，交给机器进行学习。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200505192257.png"></p>
<h2 id="IoU-Intersection-over-Union"><a href="#IoU-Intersection-over-Union" class="headerlink" title="IoU (Intersection over Union)"></a>IoU (Intersection over Union)</h2><blockquote>
<p>交集并集比（交并比），在已有的数据库中，我们会用某种方法 标注数据，赋予数据中目标区域与类别，也就是标注ROI，检测算法学习数据后得到检测模型，模型作用于某个图像输出检测结果bbox。</p>
<p>IoU就是用于评价检测模型输出结果的，计算方法就是输出bbox与标记bbox交集面积与并集面积的比值。比值越高表明结果越准，反之亦然。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200505192424.png"></p>
<h2 id="confidence"><a href="#confidence" class="headerlink" title="confidence"></a>confidence</h2><blockquote>
<p>confidence（置信度）表明检测模型对于自己检测出目标的置信程度，值越大表明模型更加笃定自己检测结果的准确性。</p>
</blockquote>
<h2 id="检测判定"><a href="#检测判定" class="headerlink" title="检测判定"></a>检测判定</h2><blockquote>
<p>在分类任务中，分类模型输出的结果作为其分类的类别，将该输出与真实类别标签比较即可确定此次预测是否正确，相应地得可以将此次预测划定到TP、FP、TN、FN中。</p>
<p>而目标检测任务中的输出结果不同于分类，该结果 包含了图像中某位置属于某类别的信息，而且很可能包含多个目标，而事实上，输出结果与标注标签完全一致是不现实的，那么如何判定检测结果是否正确呢。</p>
<p>在目标检测中判定结果正确需要预先设定IoU阈值，然后逐个类别判定检测框：</p>
<ul>
<li>遍历每个类别</li>
<li>将该类别的预测框按confidence降序排列</li>
<li>对于每个预测bbox，找出与其有最大IoU的gt_bbox</li>
<li>如果该gt_bbox之前没有被分配且IoU大于给定的阈值（比如0.5），那将该gt_bbox分配该给预测bbox，设置该预测bbox为TP；否则设置该预测bbox为FP</li>
<li>没有被正确预测到的gt_bbox设置为FN</li>
<li>在检测结果中没有显式的TN</li>
</ul>
</blockquote>
<h2 id="性能评估"><a href="#性能评估" class="headerlink" title="性能评估"></a>性能评估</h2><p>判定出结果后就可以用分类的评价体系计算性能指标了：</p>
<p><a href="https://www.zywvvd.com/2020/02/27/machine_learning/basic_knowledge/performance_evaluation/Performance-evaluation/">机器学习-基础知识 - Precision, Recall, Sensitivity, Specificity, Accuracy, FNR, FPR, TPR, TNR, F1 Score, Balanced F Score</a></p>
<p>也可以绘制ROC、PR曲线：</p>
<p><a href="https://www.zywvvd.com/2020/02/27/machine_learning/basic_knowledge/PR_and_ROC/PR-and-ROC/">机器学习-基础知识 - PR、ROC曲线与AUC</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -24- 添加相册系列 -4- 将本地相册信息部署到hexo</title>
    <url>/2020/04/28/next/24_build_online_albums/build-online-albums/</url>
    <content><![CDATA[<blockquote>
<p> 在之前基础工作完成后，来到了距离我们相册最接近的一步，本文介绍上线相册的一种思路，供大家参考。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li><a href="https://www.zywvvd.com/2020/03/29/next/21_add_photos/add-photos/">Next -21- 添加相册系列 - 1- 框架设置</a></li>
<li><a href="https://www.zywvvd.com/2020/03/31/next/22_qiniuyun_qshell/qiniuyun-qshell/">Next -22- 添加相册系列 -2- 使用七牛云qshell同步图像目录</a></li>
<li><a href="https://www.zywvvd.com/2020/04/22/next/23_get_image_info/get-image-info/">Next -23- 添加相册系列 -3- 获取图像信息、保存为json文件并上传图像</a></li>
</ul>
<h2 id="上线思路"><a href="#上线思路" class="headerlink" title="上线思路"></a>上线思路</h2><blockquote>
<p>现在我们已经有了基础的photos框架，图像文件夹已经整理完毕，提取了信息放在了json文件，并且将图像上传到了七牛云图床，在hexo source文件夹内创建了相册对应index.md 和json文件。仅需要将这些串联起来，部署到hexo即可。</p>
</blockquote>
<ul>
<li>在next主题中存在为二级文件夹配置内容的文件，修改该文件，在具有二级文件夹结构的index.html中加入特定类</li>
<li>建立js文件向类中添加内容</li>
<li>内容为读取json文件得到的相册信息，这样便建立起了逐个页面的相册</li>
<li>同理在photos中加入特定类</li>
<li>建立js文件读取相册json文件并建立链接目录，即完成了整个相册的基础框架</li>
<li>之后的优化、美化便水到渠成了</li>
</ul>
<h2 id="建立相册"><a href="#建立相册" class="headerlink" title="建立相册"></a>建立相册</h2><h3 id="向二级目录的index-html加入类"><a href="#向二级目录的index-html加入类" class="headerlink" title="向二级目录的index.html加入类"></a>向二级目录的index.html加入类</h3><blockquote>
<p>在 Hexo/themes/next/layout/_partials/page文件夹中 修改page-header.swig文件，加入类别为<code>album_image_grid</code>的div，并引用js文件，此时对应的二级文件夹内的index.html中便多了一个空div</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;header class&#x3D;&quot;post-header&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125; class&#x3D;&quot;post-title&quot; itemprop&#x3D;&quot;name headline&quot;&gt;</span><br><span class="line">  &#123;&#123;- page.title &#125;&#125;</span><br><span class="line">  &#123;&#123;- post_edit(page.source) &#125;&#125;</span><br><span class="line">&lt;&#x2F;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class&#x3D;&quot;post-meta&quot;&gt;</span><br><span class="line">  &#123;%- if page.description %&#125;</span><br><span class="line">    &lt;div class&#x3D;&quot;post-description&quot;&gt;&#123;&#123; page.description &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br><span class="line"></span><br><span class="line">	&#123;%- if page.type &#x3D;&#x3D; &#39;photography&#39; %&#125;</span><br><span class="line">	  </span><br><span class="line">	  &lt;div class&#x3D;&quot;album_image_grid&quot;&gt;</span><br><span class="line"></span><br><span class="line">	  &lt;&#x2F;div&gt;</span><br><span class="line">	  &lt;script src&#x3D;&quot;&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;jquery@3&#x2F;dist&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">	  &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;photos&#x2F;album.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">	&#123;%- endif %&#125;</span><br><span class="line">  &#123;% include &#39;_partials&#x2F;page&#x2F;breadcrumb.swig&#39; %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;header&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://photos.zywvvd.com/image/20200428235933.png"></p>
<h3 id="建立album-js文件"><a href="#建立album-js文件" class="headerlink" title="建立album.js文件"></a>建立album.js文件</h3><blockquote>
<p>在Hexo/themes/next/source/photos文件夹内建立相册js文件 <code>album.js</code>，写入如下内容：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'album js Hello World'</span>)</span><br><span class="line"></span><br><span class="line">photo =&#123;</span><br><span class="line">    page: <span class="number">1</span>,</span><br><span class="line">    offset: <span class="number">20</span>,</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">        $.getJSON(<span class="string">"readme.json"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            that.render(that.page, data);</span><br><span class="line">            <span class="comment">//that.scroll(data);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span> (<span class="params">page, data</span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">var</span> year = data[<span class="string">"time"</span>][<span class="string">"year"</span>]</span><br><span class="line">    	<span class="keyword">var</span> month = data[<span class="string">"time"</span>][<span class="string">"month"</span>]</span><br><span class="line">    	<span class="keyword">var</span> day = data[<span class="string">"time"</span>][<span class="string">"day"</span>]</span><br><span class="line">    	<span class="keyword">var</span> type = data[<span class="string">"type"</span>]</span><br><span class="line">    	<span class="keyword">var</span> model = data[<span class="string">"model"</span>]</span><br><span class="line">    	<span class="keyword">var</span> city = data[<span class="string">"position"</span>][<span class="string">'city'</span>]</span><br><span class="line">    	<span class="keyword">var</span> street = data[<span class="string">"position"</span>][<span class="string">'street'</span>]</span><br><span class="line">    	<span class="keyword">var</span> title = data[<span class="string">"title"</span>]</span><br><span class="line">    	<span class="keyword">var</span> balabala = data[<span class="string">"balabala"</span>]</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">var</span> image_info_list = data[<span class="string">"image_info"</span>]</span><br><span class="line">    	<span class="built_in">console</span>.log(image_info_list[<span class="number">0</span>][<span class="string">"Image_Model"</span>])</span><br><span class="line"></span><br><span class="line">    	<span class="built_in">console</span>.log(year)</span><br><span class="line">        <span class="comment">//var begin = (page - 1) * this.offset;</span></span><br><span class="line">        <span class="comment">//var end = page * this.offset;</span></span><br><span class="line">        <span class="comment">//if (begin &gt;= data.length) return;</span></span><br><span class="line">        <span class="keyword">var</span> html, imgNameWithPattern, imgName, imageSize, imageX, imageY, li = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">		$(<span class="string">".album_image_grid"</span>).append(<span class="string">'&lt;br&gt;'</span>);</span><br><span class="line">		$(<span class="string">".album_image_grid"</span>).append(<span class="string">'&lt;br&gt;'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; image_info_list.length ; i++) &#123;</span><br><span class="line">        	sub_image = image_info_list[i]</span><br><span class="line">        	nbsp = <span class="string">"&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp"</span></span><br><span class="line">        	href_str = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">        	image_model = sub_image[<span class="string">"Image_Model"</span>] <span class="comment">//相机型号</span></span><br><span class="line">        	<span class="keyword">if</span> (image_model!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">'相机：'</span>+image_model+nbsp</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line">        	EXIF_fnumber = sub_image[<span class="string">"EXIF_FNumber"</span>] <span class="comment">//光圈	</span></span><br><span class="line">        	<span class="keyword">if</span> (EXIF_fnumber!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">' 光圈：'</span> +EXIF_fnumber +nbsp</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line">        	EXIF_FocalLength = sub_image[<span class="string">"EXIF_FocalLength"</span>] <span class="comment">//焦距</span></span><br><span class="line">        	<span class="keyword">if</span> (EXIF_FocalLength!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">' 焦距：'</span> +EXIF_FocalLength +nbsp</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line">        	EXIF_exposureMode = sub_image[<span class="string">"EXIF_ExposureMode"</span>] <span class="comment">//曝光模式</span></span><br><span class="line">        	<span class="keyword">if</span> (EXIF_exposureMode!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">' 曝光模式：'</span> +EXIF_exposureMode +nbsp</span><br><span class="line">        	&#125;		</span><br><span class="line"></span><br><span class="line">        	EXIF_exposureTime = sub_image[<span class="string">"EXIF_ExposureTime"</span>] <span class="comment">//曝光时间</span></span><br><span class="line">        	<span class="keyword">if</span> (EXIF_exposureTime!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">' 曝光时间：'</span> +EXIF_exposureTime +nbsp</span><br><span class="line">        	&#125;	</span><br><span class="line"></span><br><span class="line">        	EXIF_ISOSpeedRatings = sub_image[<span class="string">"EXIF_ISOSpeedRatings"</span>] <span class="comment">//ISO</span></span><br><span class="line">        	<span class="keyword">if</span> (EXIF_ISOSpeedRatings!=<span class="string">""</span>)</span><br><span class="line">        	&#123;</span><br><span class="line">        		href_str = href_str+<span class="string">' ISO：'</span> +EXIF_ISOSpeedRatings +nbsp</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line">        	image_url = sub_image[<span class="string">"url"</span>]</span><br><span class="line"></span><br><span class="line">            li += <span class="string">'&lt;div class="card" style="width:100%"&gt;'</span> +</span><br><span class="line">                    <span class="string">'&lt;div class="ImageInCard"&gt;'</span> +</span><br><span class="line">                      <span class="string">'&lt;a data-fancybox="gallery" href="'</span> + image_url + <span class="string">'?raw=true" data-caption="'</span> + href_str +<span class="string">'"&gt;'</span> +</span><br><span class="line">                        <span class="string">'&lt;img src="'</span> + image_url + <span class="string">'?raw=true"/&gt;'</span> +</span><br><span class="line">                      <span class="string">'&lt;/a&gt;'</span> + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">                    <span class="string">'&lt;/div&gt;'</span> +</span><br><span class="line">                    <span class="comment">// '&lt;div class="TextInCard"&gt;' + imgName + '&lt;/div&gt;' +</span></span><br><span class="line">                  <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">".album_image_grid"</span>).append(li);</span><br><span class="line">        <span class="comment">//$(".album_image_grid").lazyload();</span></span><br><span class="line">        <span class="comment">//this.minigrid();</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">photo.init();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时访问某个二级目录的地址可以看到图像已经上线</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200429000313.png"></p>
<h2 id="建立相册目录"><a href="#建立相册目录" class="headerlink" title="建立相册目录"></a>建立相册目录</h2><h3 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h3><blockquote>
<p>在Hexo/themes/next/layout文件夹内，修改page.swig，在schedule的elif后面加入内容：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% elif page.type &#x3D;&#x3D;&#x3D; &#39;schedule&#39; %&#125;</span><br><span class="line">          &lt;div class&#x3D;&quot;event-list&quot;&gt;</span><br><span class="line">          &lt;&#x2F;div&gt;</span><br><span class="line">          &#123;% include &#39;_scripts&#x2F;pages&#x2F;schedule.swig&#39; %&#125;</span><br><span class="line">        </span><br><span class="line">        &#123;% elif page.type &#x3D;&#x3D;&#x3D; &#39;photos&#39; %&#125;</span><br><span class="line"></span><br><span class="line">           &lt;div class&#x3D;&quot;album_link_list&quot;&gt;</span><br><span class="line"></span><br><span class="line">           &lt;&#x2F;div&gt;</span><br><span class="line">	   </span><br><span class="line">	   &lt;script src&#x3D;&quot;&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;jquery@3&#x2F;dist&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">	   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;minigrid@3.1.1&#x2F;dist&#x2F;minigrid.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">	   &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;&#x2F;photos&#x2F;photos.css&quot;&gt;</span><br><span class="line">	   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;photos&#x2F;photo.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">          &#123;&#123; page.content &#125;&#125;</span><br><span class="line">        &#123;%- endif %&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在同文件夹内建立文件 photos.swig 写入内容</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% extends &#39;_layout.swig&#39; %&#125;</span><br><span class="line">&#123;% import &#39;_macro&#x2F;post-collapse.swig&#39; as post_template with context %&#125;</span><br><span class="line">&#123;% import &#39;_macro&#x2F;sidebar.swig&#39; as sidebar_template with context %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125;&#123;&#123; __(&#39;title.photos&#39;) &#125;&#125;: &#123;&#123; page.photos &#125;&#125; | &#123;&#123; title &#125;&#125;&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line"></span><br><span class="line">  &#123;#################&#125;</span><br><span class="line">  &#123;### photos BLOCK ###&#125;</span><br><span class="line">  &#123;#################&#125;</span><br><span class="line">  &lt;div class&#x3D;&quot;post-block&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;posts-collapse&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;collection-title&quot;&gt;</span><br><span class="line">        &lt;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125; class&#x3D;&quot;collection-header&quot;&gt;</span><br><span class="line">          &#123;&#123;- page.photos &#125;&#125;</span><br><span class="line">          &lt;small&gt;&#123;&#123; __(&#39;title.photos&#39;) &#125;&#125;&lt;&#x2F;small&gt;</span><br><span class="line">        &lt;&#x2F;&#123;%- if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;%- endif %&#125;&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">      &#123;&#123; post_template.render(page.posts) &#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &#123;#####################&#125;</span><br><span class="line">  &#123;### END photos BLOCK ###&#125;</span><br><span class="line">  &#123;#####################&#125;</span><br><span class="line"></span><br><span class="line">  &#123;% include &#39;_partials&#x2F;pagination.swig&#39; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line">&#123;&#123; page.date &#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block sidebar %&#125;</span><br><span class="line">  &#123;&#123; sidebar_template.render(false) &#125;&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

<h3 id="建立photos-js文件"><a href="#建立photos-js文件" class="headerlink" title="建立photos.js文件"></a>建立photos.js文件</h3><blockquote>
<p>在Hexo/themes/next/source/photos文件夹内建立相册js文件 <code>photos.js</code>，写入如下内容：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'Photos js Hello World'</span>)</span><br><span class="line"></span><br><span class="line">photo =&#123;</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">        $.getJSON(<span class="string">"album.json"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            that.render(that.page, data);</span><br><span class="line">            <span class="comment">//that.scroll(data);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span> (<span class="params">page, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> album_list = data[<span class="string">'album'</span>];</span><br><span class="line">        <span class="keyword">var</span> html, imgNameWithPattern, imgName, imageSize, imageX, imageY, li = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">var</span> link_profix = <span class="string">"/photos/"</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; album_list.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">            album_info = album_list[i]</span><br><span class="line"></span><br><span class="line">            dir_name = album_info[<span class="string">"directory"</span>]</span><br><span class="line"></span><br><span class="line">            title = album_info[<span class="string">"title"</span>]</span><br><span class="line">            <span class="comment">/*console.log(album_info)</span></span><br><span class="line"><span class="comment">            imgNameWithPattern = data[i].split(' ')[1];</span></span><br><span class="line"><span class="comment">            imgName = imgNameWithPattern.split('.')[0]</span></span><br><span class="line"><span class="comment">            imageSize = data[i].split(' ')[0];</span></span><br><span class="line"><span class="comment">            imageX = imageSize.split('.')[0];</span></span><br><span class="line"><span class="comment">            imageY = imageSize.split('.')[1];*/</span></span><br><span class="line">            li += <span class="string">'&lt;div&gt;'</span> +</span><br><span class="line">                      <span class="string">'&lt;a href="'</span> +link_profix + dir_name + <span class="string">'/"&gt;'</span> +</span><br><span class="line">                          title + <span class="string">'&lt;br&gt;'</span> + </span><br><span class="line">                      <span class="string">'&lt;/a&gt;'</span> +</span><br><span class="line">                    <span class="comment">// '&lt;div class="TextInCard"&gt;' + imgName + '&lt;/div&gt;' +</span></span><br><span class="line">                  <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">".album_link_list"</span>).append(li);</span><br><span class="line">        <span class="comment">//$(".ImageGrid").lazyload();</span></span><br><span class="line">        <span class="keyword">this</span>.minigrid();</span><br><span class="line">    &#125;,</span><br><span class="line">    minigrid: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> grid = <span class="keyword">new</span> Minigrid(&#123;</span><br><span class="line">            container: <span class="string">'.ImageGrid'</span>,</span><br><span class="line">            item: <span class="string">'.card'</span>,</span><br><span class="line">            gutter: <span class="number">12</span></span><br><span class="line">        &#125;);</span><br><span class="line">        grid.mount();</span><br><span class="line">        $(<span class="built_in">window</span>).resize(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">           grid.mount();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">photo.init();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时便有了相册目录：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200429001245.png"></p>
<blockquote>
<p>至此我们已经完成了相册的基础框架，美化等工作仅需在此基础上顺水推舟即可。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -23- 添加相册系列 -3- 获取图像信息、保存为json文件并上传图像</title>
    <url>/2020/04/22/next/23_get_image_info/get-image-info/</url>
    <content><![CDATA[<blockquote>
<p>相册需要在本地建立文件夹，为了维护相册，需要自动生成对应图像的json文件，并自动压缩上传，本文分享我的python程序，提供一种解决方案供大家使用参考。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li><p>qshell 上传至七牛云图床 <a href="https://www.zywvvd.com/2020/03/31/next/22_qiniuyun_qshell/qiniuyun-qshell/">Next -22- 添加相册系列 -2- 使用七牛云qshell同步图像目录</a></p>
</li>
<li><p>python 运行环境</p>
</li>
<li><p>准备好的图像文件夹</p>
</li>
</ul>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ul>
<li>自动读取文件夹中的所有图像</li>
<li>压缩到固定尺寸</li>
<li>转存到指定的临时文件夹</li>
<li>自动上传至七牛云</li>
<li>自动提取图像信息并保存到json</li>
<li>整合所有相册信息到json</li>
</ul>
<h2 id="工程代码"><a href="#工程代码" class="headerlink" title="工程代码"></a>工程代码</h2><blockquote>
<p>配置文件</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parameters</span>:</span></span><br><span class="line">    </span><br><span class="line">    Image_Root_Path = <span class="string">r'/media/vvd/新加卷/pic'</span>                                   <span class="comment"># root of source raw images</span></span><br><span class="line">    Hexo_Root_Path =<span class="string">r'/home/vvd/VVD_Work/Hexo/VVD_Hexo'</span>                         <span class="comment"># root of Hexo dir  </span></span><br><span class="line">    Hexo_Sub_Dir_to_Photos = <span class="string">r'source/photos'</span>                                   <span class="comment"># my source dir for album</span></span><br><span class="line">    Uploading_Temp_Image_Path = <span class="string">r'/home/vvd/VVD_Work/Hexo/Album_Temp'</span>           <span class="comment"># root of temp image dir</span></span><br><span class="line">    Album_Ddescription_File_Name = <span class="string">'readme.json'</span>                                <span class="comment"># name of json file in each image dir</span></span><br><span class="line">    Log_File_Name = <span class="string">'Album_Log.log'</span>                                             <span class="comment"># name of log file</span></span><br><span class="line">    Album_Total_Json = <span class="string">'album.json'</span>                                             <span class="comment"># json info of album</span></span><br><span class="line">    Album_Md_File_Name = <span class="string">'index.md'</span>                                             <span class="comment"># name of markdown file of hexo </span></span><br><span class="line">    Qshell_Config_File_Name = <span class="string">'upload.conf'</span>                                     <span class="comment"># qiniu qshell config file name </span></span><br><span class="line">    </span><br><span class="line">    Logging_Object = <span class="literal">None</span>                                                       <span class="comment"># object of logging class</span></span><br><span class="line">    Image_Info_Get_Object = <span class="literal">None</span>                                                <span class="comment"># instance of PhotoExifInfo</span></span><br><span class="line">    </span><br><span class="line">    Image_Extension_List =[<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'jpeg'</span>,<span class="string">'bmp'</span>]                            <span class="comment"># list of common image extensions </span></span><br><span class="line">    Image_Resize_Width = <span class="number">2000</span>                                                   <span class="comment"># image width after resize</span></span><br><span class="line">    Whether_Overwrite_Old_Temp_File = <span class="literal">False</span>                                     <span class="comment"># whether overwrite old file while the program run again</span></span><br><span class="line">    Image_Url_Prefix =<span class="string">r'https://photos.zywvvd.com/vvd_hexo/'</span>                    <span class="comment"># prefix of image url</span></span><br><span class="line">    Force_Upload = <span class="literal">False</span>                                                        <span class="comment"># upload images no matter what happens</span></span><br><span class="line"></span><br><span class="line">    Current_System = platform.system()                                          <span class="comment"># current operating system</span></span><br><span class="line">    <span class="keyword">if</span> Current_System == <span class="string">'Linux'</span>:</span><br><span class="line">        Split_Char =<span class="string">'/'</span>                                                         <span class="comment"># split char of current operating system</span></span><br><span class="line">    <span class="keyword">elif</span> Current_System == <span class="string">'Windows'</span>:</span><br><span class="line">        Split_Char =<span class="string">'\\'</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>图像信息提取</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># getinfo.py</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhotoExifInfo</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">'vvdkey.py'</span>):</span><br><span class="line">            <span class="keyword">from</span> vvdkey <span class="keyword">import</span> baidu_key <span class="comment"># 使用你自己的百度key</span></span><br><span class="line">            self.baidu_map_ak = baidu_key</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment">## set your baidu map key here</span></span><br><span class="line">            self.baidu_map_ak = <span class="string">""</span></span><br><span class="line">            </span><br><span class="line">        self.interested_keys = &#123;</span><br><span class="line">            <span class="comment"># camera Model</span></span><br><span class="line">            <span class="string">'Image Model'</span>:<span class="string">'Image_Model'</span>,<span class="comment">#'相机型号',</span></span><br><span class="line">            <span class="comment"># Aperture 1/value</span></span><br><span class="line">            <span class="string">'EXIF FNumber'</span>:<span class="string">'EXIF_FNumber'</span>,<span class="comment">#'光圈',</span></span><br><span class="line">            <span class="comment"># Focal Length</span></span><br><span class="line">            <span class="string">'EXIF FocalLength'</span>:<span class="string">'EXIF_FocalLength'</span>,<span class="comment">#'焦距',</span></span><br><span class="line">            <span class="comment"># Exposure Mode</span></span><br><span class="line">            <span class="string">'EXIF ExposureMode'</span>:<span class="string">'EXIF_ExposureMode'</span>,<span class="comment">#'曝光模式',</span></span><br><span class="line">            <span class="comment"># ExposureTime in seconds</span></span><br><span class="line">            <span class="string">'EXIF ExposureTime'</span>:<span class="string">'EXIF_ExposureTime'</span>,<span class="comment">#'曝光时间',</span></span><br><span class="line">            <span class="comment"># ISO</span></span><br><span class="line">            <span class="string">'EXIF ISOSpeedRatings'</span>:<span class="string">'EXIF_ISOSpeedRatings'</span>,<span class="comment">#'ISO',</span></span><br><span class="line">            <span class="comment"># date of photo</span></span><br><span class="line">            <span class="string">'Image DateTime'</span>:<span class="string">'Image_DateTime'</span><span class="comment">#'拍摄时间',</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_image_info</span><span class="params">(self,image_path)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取照片信息</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        image_info_dict=&#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> open(image_path, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            tags = exifread.process_file(fp)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> tags:</span><br><span class="line">            print(<span class="string">f"<span class="subst">&#123;j&#125;</span> :<span class="subst">&#123;tags[j]&#125;</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> tuple(self.interested_keys):</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                info = tags[item].printable</span><br><span class="line">                <span class="keyword">if</span> item == <span class="string">'EXIF FNumber'</span>:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> info:</span><br><span class="line">                        A,B = info.split(<span class="string">'/'</span>)</span><br><span class="line">                        info = <span class="string">'f'</span>+format(int(A)/int(B),<span class="string">'.1f'</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        info = <span class="string">'f'</span>+info</span><br><span class="line">                <span class="keyword">if</span> item == <span class="string">'EXIF FocalLength'</span>:</span><br><span class="line">                    info = info+<span class="string">'mm'</span></span><br><span class="line">                <span class="keyword">if</span> item == <span class="string">'EXIF ExposureTime'</span>:</span><br><span class="line">                    info = info+<span class="string">'s'</span></span><br><span class="line">                image_info_dict[self.interested_keys[item]] = info</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                print(<span class="string">f'<span class="subst">&#123;image_path&#125;</span> has no attribute of <span class="subst">&#123;item&#125;</span>'</span>)                </span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            localcation = self._get_city_info(tags)</span><br><span class="line">            <span class="keyword">if</span> localcation != <span class="string">""</span>:</span><br><span class="line">                image_info_dict[<span class="string">'positon'</span>] = localcation</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">f'<span class="subst">&#123;image_path&#125;</span> has no GPS info'</span>)    </span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> image_info_dict</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_lng_lat</span><span class="params">(self, tags)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        经纬度转换</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 纬度</span></span><br><span class="line">            LatRef = tags[<span class="string">"GPS GPSLatitudeRef"</span>].printable</span><br><span class="line">            Lat = tags[<span class="string">"GPS GPSLatitude"</span>].printable[<span class="number">1</span>:<span class="number">-1</span>].replace(<span class="string">" "</span>, <span class="string">""</span>).replace(<span class="string">"/"</span>, <span class="string">","</span>).split(<span class="string">","</span>)</span><br><span class="line">            Lat = float(Lat[<span class="number">0</span>]) + float(Lat[<span class="number">1</span>]) / <span class="number">60</span> + float(Lat[<span class="number">2</span>]) / <span class="number">3600</span></span><br><span class="line">            <span class="keyword">if</span> LatRef != <span class="string">"N"</span>:</span><br><span class="line">                Lat = Lat * (<span class="number">-1</span>)</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># 经度</span></span><br><span class="line">            LonRef = tags[<span class="string">"GPS GPSLongitudeRef"</span>].printable</span><br><span class="line">            Lon = tags[<span class="string">"GPS GPSLongitude"</span>].printable[<span class="number">1</span>:<span class="number">-1</span>].replace(<span class="string">" "</span>, <span class="string">""</span>).replace(<span class="string">"/"</span>, <span class="string">","</span>).split(<span class="string">","</span>)</span><br><span class="line">            Lon = float(Lon[<span class="number">0</span>]) + float(Lon[<span class="number">1</span>]) / <span class="number">60</span> + float(Lon[<span class="number">2</span>]) / <span class="number">3600</span></span><br><span class="line">            <span class="keyword">if</span> LonRef != <span class="string">"E"</span>:</span><br><span class="line">                Lon = Lon * (<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> Lat,Lon</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">'Unable to get'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_city_info</span><span class="params">(self, tags)</span>:</span></span><br><span class="line">        </span><br><span class="line">        result = self._get_lng_lat(tags)</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            Lat, Lon = result</span><br><span class="line">            url = <span class="string">"https://api.map.baidu.com/reverse_geocoding/v3/?ak="</span>+self.baidu_map_ak+<span class="string">"&amp;output=json&amp;coordtype=wgs84ll&amp;location="</span> + str(Lat) + <span class="string">','</span> + str(Lon)</span><br><span class="line">            <span class="comment">#url = "https://api.map.baidu.com/reverse_geocoding/v3/?ak="+self.baidu_map_ak+"&amp;output=json&amp;coordtype=wgs84ll&amp;location=31.225696563611,121.49884033194"</span></span><br><span class="line">            response = requests.get(url).json()</span><br><span class="line">            status = response[<span class="string">'status'</span>]</span><br><span class="line">            <span class="keyword">if</span> status == <span class="number">0</span>:</span><br><span class="line">                address = response[<span class="string">'result'</span>][<span class="string">'formatted_address'</span>]</span><br><span class="line">                <span class="keyword">if</span> address != <span class="string">""</span>:</span><br><span class="line">                    <span class="keyword">return</span>(address)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'baidu_map error'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>主要功能函数</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> getinfo <span class="keyword">import</span> PhotoExifInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_init</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    initialize logging </span></span><br><span class="line"><span class="string">    save the logging object in `config.Parameters.Logging_Object`</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    after this operation,</span></span><br><span class="line"><span class="string">    we could save logs with sample orders such as `logging.debug('test debug')` `logging.info('test info')` </span></span><br><span class="line"><span class="string">    logging level : debug &lt; info &lt; warning &lt;error &lt; critica</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    log_file_path = os.path.join(config.Parameters.Uploading_Temp_Image_Path, config.Parameters.Log_File_Name)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(log_file_path):</span><br><span class="line">        <span class="comment"># open log file as  mode of append</span></span><br><span class="line">        open_type = <span class="string">'a'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># open log file as  mode of write</span></span><br><span class="line">        open_type = <span class="string">'w'</span></span><br><span class="line">        </span><br><span class="line">    logging.basicConfig(</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 日志级别,logging.DEBUG,logging.ERROR</span></span><br><span class="line">        level = logging.INFO,  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 日志格式: 时间、代码所在文件名、代码行号、日志级别名字、日志信息</span></span><br><span class="line">        <span class="comment">#format = '%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)s %(message)s',</span></span><br><span class="line">        format = <span class="string">'%(asctime)s : %(message)s'</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 打印日志的时间</span></span><br><span class="line">        datefmt = <span class="string">'%Y-%m-%d %H:%M:%S'</span>,</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 日志文件存放的目录（目录必须存在）及日志文件名</span></span><br><span class="line">        filename = log_file_path, </span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 打开日志文件的方式</span></span><br><span class="line">        filemode = open_type</span><br><span class="line">    )    </span><br><span class="line">    </span><br><span class="line">    config.Parameters.Logging_Object = logging</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(message)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    print message to console and than save it to log </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    print(message)</span><br><span class="line">    <span class="keyword">if</span> config.Parameters.Logging_Object:</span><br><span class="line">        config.Parameters.Logging_Object.info(message)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">'there is sth wrong with the object of logging in config '</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dir_check</span><span class="params">(dir_path)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    check if `dir_path` is a real directory path</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(dir_path):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            os.makedirs(dir_path) </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            print(<span class="string">f'failed to make dir <span class="subst">&#123;dir_path&#125;</span>, error <span class="subst">&#123;err&#125;</span>'</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            log(<span class="string">f'<span class="subst">&#123;dir_path&#125;</span> does not exist and we have built it for you '</span>)</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">environment_check</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    check album environment, try to fix the matters if sth goes wrong</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## check important dirs</span></span><br><span class="line">    <span class="keyword">assert</span> os.path.isdir(config.Parameters.Image_Root_Path) ,<span class="string">f"image root dir <span class="subst">&#123;config.Parameters.Image_Root_Path&#125;</span> does not exist"</span></span><br><span class="line">    <span class="keyword">assert</span> os.path.isdir(config.Parameters.Hexo_Root_Path) ,<span class="string">f"hexo root dir <span class="subst">&#123;config.Parameters.Hexo_Root_Path&#125;</span> does not exist"</span></span><br><span class="line">    </span><br><span class="line">    dir_check(config.Parameters.Uploading_Temp_Image_Path)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## check image width, I think it shold not &lt; 200</span></span><br><span class="line">    config.Parameters.Image_Resize_Width = max(int(config.Parameters.Image_Resize_Width), <span class="number">200</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## initialize logging</span></span><br><span class="line">    log_init()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## image_info_get object</span></span><br><span class="line">    config.Parameters.Image_Info_Get_Object = PhotoExifInfo()</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_json_create</span><span class="params">(json_path)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    init a json file to `json_path`</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">assert</span> os.path.basename(json_path).split(<span class="string">'.'</span>)[<span class="number">-1</span>]==<span class="string">'json'</span>,<span class="string">f'<span class="subst">&#123;json_path&#125;</span> should be a path of json file '</span></span><br><span class="line">    <span class="keyword">assert</span> os.path.isdir(os.path.split(json_path)[<span class="number">0</span>]), <span class="string">'the folder does not exist'</span></span><br><span class="line">    </span><br><span class="line">    now = time.localtime()</span><br><span class="line">    info_dict=&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## time</span></span><br><span class="line">    my_time=&#123;</span><br><span class="line">        <span class="string">'year'</span>:now.tm_year,\</span><br><span class="line">        <span class="string">'month'</span>:now.tm_mon,\</span><br><span class="line">        <span class="string">'day'</span>:now.tm_mday</span><br><span class="line">          &#125;</span><br><span class="line">    info_dict[<span class="string">'time'</span>] = my_time</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## type</span></span><br><span class="line">    info_dict[<span class="string">'type'</span>] = <span class="string">'album type'</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## model</span></span><br><span class="line">    info_dict[<span class="string">'model'</span>] = <span class="string">''</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## position</span></span><br><span class="line">    position = &#123;</span><br><span class="line">        <span class="string">'city'</span>:<span class="string">'beijing'</span>,\</span><br><span class="line">        <span class="string">'street'</span>:<span class="string">'Tiananmen'</span></span><br><span class="line">    &#125;</span><br><span class="line">    info_dict[<span class="string">'position'</span>] = position</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## title</span></span><br><span class="line">    info_dict[<span class="string">'title'</span>] = <span class="string">'Album title'</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">## balabala</span></span><br><span class="line">    info_dict[<span class="string">'balabala'</span>] = <span class="string">'description of album'</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> open(json_path, mode=<span class="string">'w'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        json.dump(info_dict, fp, indent=<span class="number">3</span>)</span><br><span class="line">        log(<span class="string">f'make initial json file <span class="subst">&#123;json_path&#125;</span>'</span>)</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_compression_and_save</span><span class="params">(src_dir, tar_dir)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    compress and move images from src to tar </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sub_image_dirs = os.listdir(src_dir)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> sub_image_dir <span class="keyword">in</span> sub_image_dirs:</span><br><span class="line">        src_sub_image_path = os.path.join(src_dir, sub_image_dir)</span><br><span class="line">        tar_sub_image_path = os.path.join(tar_dir, sub_image_dir)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">## check tar dir</span></span><br><span class="line">        dir_check(tar_sub_image_path)</span><br><span class="line">        </span><br><span class="line">        file_list = os.listdir(src_sub_image_path)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> file_list:</span><br><span class="line">            extension = item.split(<span class="string">'.'</span>)[<span class="number">-1</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> extension.lower() <span class="keyword">in</span> config.Parameters.Image_Extension_List:</span><br><span class="line">                <span class="comment">## is image file</span></span><br><span class="line">                image_path = os.path.join(src_sub_image_path, item)</span><br><span class="line">                </span><br><span class="line">                tar_image_path = os.path.join(tar_sub_image_path, item)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(tar_image_path) <span class="keyword">or</span> config.Parameters.Whether_Overwrite_Old_Temp_File:</span><br><span class="line">                    <span class="comment">## new file or overwrite</span></span><br><span class="line">                    </span><br><span class="line">                    image = cv2.imread(image_path)</span><br><span class="line">                    image_shape = image.shape</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> image_shape[<span class="number">1</span>] &gt;= config.Parameters.Image_Resize_Width:</span><br><span class="line">                        <span class="comment">## need compression</span></span><br><span class="line">                        new_width = int(config.Parameters.Image_Resize_Width)</span><br><span class="line">                        new_height = int(config.Parameters.Image_Resize_Width/image_shape[<span class="number">1</span>]*image_shape[<span class="number">0</span>])</span><br><span class="line">                        </span><br><span class="line">                        new_image = cv2.resize(image,(new_width, new_height) )</span><br><span class="line">                        cv2.imwrite(tar_image_path, new_image)</span><br><span class="line">                        log(<span class="string">f'image <span class="subst">&#123;os.path.join(sub_image_dir,item)&#125;</span> has been resized to <span class="subst">&#123;(new_width, new_height)&#125;</span> and moved to temp dir'</span>)</span><br><span class="line">                        </span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment">## small image, copy directly</span></span><br><span class="line">                        shutil.copy(image_path, tar_image_path)</span><br><span class="line">                        log(<span class="string">f'image <span class="subst">&#123;os.path.join(sub_image_dir,item)&#125;</span> has been moved to temp dir'</span>)</span><br><span class="line">                           </span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deal_with_sub_json</span><span class="params">(src_dir, tar_dir)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    deal with sub json files in each sub dir</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sub_image_dirs = os.listdir(src_dir)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> sub_image_dir <span class="keyword">in</span> sub_image_dirs:</span><br><span class="line">        </span><br><span class="line">        src_sub_image_path = os.path.join(src_dir, sub_image_dir)</span><br><span class="line">        tar_sub_image_path = os.path.join(tar_dir, sub_image_dir)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">## check tar dir</span></span><br><span class="line">        dir_check(tar_sub_image_path)    </span><br><span class="line">        </span><br><span class="line">        src_info_json_file_path = os.path.join(src_sub_image_path, config.Parameters.Album_Ddescription_File_Name)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(src_info_json_file_path):</span><br><span class="line">            init_json_create(src_info_json_file_path)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">f'<span class="subst">&#123;src_info_json_file_path&#125;</span> found'</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">with</span> open(src_info_json_file_path) <span class="keyword">as</span> fp:</span><br><span class="line">            album_info = json.load(fp)</span><br><span class="line">        </span><br><span class="line">        file_list = os.listdir(src_sub_image_path)</span><br><span class="line">        </span><br><span class="line">        image_info_list = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> file_list:</span><br><span class="line">            extension = item.split(<span class="string">'.'</span>)[<span class="number">-1</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> extension.lower() <span class="keyword">in</span> config.Parameters.Image_Extension_List:</span><br><span class="line">                <span class="comment">## is image file</span></span><br><span class="line">                image_path = os.path.join(src_sub_image_path, item)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">assert</span> <span class="keyword">not</span> config.Parameters.Image_Info_Get_Object <span class="keyword">is</span> <span class="literal">None</span>, <span class="string">"Image_Info_Get_Object should be a instance "</span></span><br><span class="line">                image_info_dict = config.Parameters.Image_Info_Get_Object.get_image_info(image_path)                </span><br><span class="line">                </span><br><span class="line">                image_info_dict[<span class="string">'url'</span>] = config.Parameters.Image_Url_Prefix+sub_image_dir+<span class="string">'/'</span>+item</span><br><span class="line">                </span><br><span class="line">                image_info_list.append(image_info_dict)</span><br><span class="line">                </span><br><span class="line">        album_info[<span class="string">'image_info'</span>] = image_info_list</span><br><span class="line">        album_info[<span class="string">'directory'</span>] = sub_image_dir</span><br><span class="line">        </span><br><span class="line">        tar_info_json_file_path = os.path.join(tar_sub_image_path, config.Parameters.Album_Ddescription_File_Name)      </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> open(tar_info_json_file_path,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            json.dump(album_info, fp, indent=<span class="number">3</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">            log(<span class="string">f'json file of image dir <span class="subst">&#123;sub_image_dir&#125;</span> created'</span>)</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">json_integrate</span><span class="params">(temp_root)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    integrate json files to a single file</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    sub_image_dirs = os.listdir(temp_root)</span><br><span class="line">    </span><br><span class="line">    album_dict = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    album_json_list = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> sub_image_dir <span class="keyword">in</span> sub_image_dirs:  </span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(os.path.join(temp_root,sub_image_dir)):</span><br><span class="line">            json_file_path = os.path.join(temp_root,sub_image_dir, config.Parameters.Album_Ddescription_File_Name)   </span><br><span class="line">            <span class="keyword">assert</span> os.path.exists(json_file_path),<span class="string">f'file <span class="subst">&#123;json_file_path&#125;</span> not flund'</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">with</span> open(json_file_path) <span class="keyword">as</span> fp:</span><br><span class="line">                json_dict = json.load(fp)</span><br><span class="line">            </span><br><span class="line">            album_json_list.append(json_dict)</span><br><span class="line">            </span><br><span class="line">    album_dict[<span class="string">'album'</span>] = album_json_list</span><br><span class="line">    </span><br><span class="line">    integrate_json_path = os.path.join(temp_root, config.Parameters.Album_Total_Json)</span><br><span class="line">    <span class="keyword">with</span> open(integrate_json_path, mode=<span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        json.dump(album_dict, fp, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">3</span>)</span><br><span class="line">        log(<span class="string">f'total json <span class="subst">&#123;integrate_json_path&#125;</span> saved'</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> album_dict</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_dir_json_md_of_album</span><span class="params">(temp_root, hexo_photos_path, album_dict)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    save md files to hexo source/photos dir</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">assert</span> os.path.isdir(hexo_photos_path) ,<span class="string">'hexo photos path &#123;hexo_photos_path&#125; does not exist'</span></span><br><span class="line">    </span><br><span class="line">    src_album_json_path = os.path.join(temp_root, config.Parameters.Album_Total_Json)</span><br><span class="line">    <span class="keyword">assert</span> os.path.exists(src_album_json_path), <span class="string">f'album json file <span class="subst">&#123;src_album_json_path&#125;</span> not found'</span></span><br><span class="line">    tar_album_json_path = os.path.join(hexo_photos_path, config.Parameters.Album_Total_Json)</span><br><span class="line">    </span><br><span class="line">    shutil.copy(src_album_json_path, tar_album_json_path)</span><br><span class="line">    log(<span class="string">f"json file <span class="subst">&#123;config.Parameters.Album_Total_Json&#125;</span> moved to hexo dir"</span>)</span><br><span class="line">    <span class="keyword">for</span> sub_image_dict <span class="keyword">in</span> album_dict[<span class="string">'album'</span>]:</span><br><span class="line">        src_json_path = os.path.join(temp_root, sub_image_dict[<span class="string">'directory'</span>], config.Parameters.Album_Ddescription_File_Name)</span><br><span class="line">        <span class="keyword">assert</span> os.path.exists(src_json_path), <span class="string">f'sub json file <span class="subst">&#123;src_json_path&#125;</span> not found'</span></span><br><span class="line">        </span><br><span class="line">        tar_json_path = os.path.join(hexo_photos_path, sub_image_dict[<span class="string">'directory'</span>], config.Parameters.Album_Ddescription_File_Name)</span><br><span class="line">        image_dir = os.path.join(hexo_photos_path, sub_image_dict[<span class="string">'directory'</span>])</span><br><span class="line">        dir_check(image_dir)</span><br><span class="line">        </span><br><span class="line">        shutil.copyfile(src_json_path, tar_json_path)</span><br><span class="line">        log(<span class="string">f"json file <span class="subst">&#123;sub_image_dict[<span class="string">'directory'</span>] +<span class="string">'_'</span>+ config.Parameters.Album_Ddescription_File_Name&#125;</span> moved to hexo dir"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(image_dir,config.Parameters.Album_Md_File_Name),<span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            fp.writelines(<span class="string">'---'</span>+<span class="string">'\n'</span>)</span><br><span class="line">            fp.writelines(<span class="string">'title: '</span>+sub_image_dict[<span class="string">'title'</span>]+<span class="string">'\n'</span>)</span><br><span class="line">            fp.writelines(<span class="string">'date: '</span>+str(sub_image_dict[<span class="string">'time'</span>][<span class="string">'year'</span>])+<span class="string">'-'</span>+str(sub_image_dict[<span class="string">'time'</span>][<span class="string">'month'</span>])+<span class="string">'-'</span>+str(sub_image_dict[<span class="string">'time'</span>][<span class="string">'day'</span>])+<span class="string">'\n'</span>)</span><br><span class="line">            fp.writelines(<span class="string">'type: photography'</span>+<span class="string">'\n'</span>)</span><br><span class="line">            fp.writelines(<span class="string">'album: '</span>+sub_image_dict[<span class="string">'directory'</span>]+<span class="string">'\n'</span>)</span><br><span class="line">            fp.writelines(<span class="string">'---'</span>+<span class="string">'\n'</span>)</span><br><span class="line">            log(<span class="string">f'create md file of <span class="subst">&#123;os.path.join(image_dir,config.Parameters.Album_Md_File_Name)&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>主函数</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> funs <span class="keyword">import</span> environment_check</span><br><span class="line"><span class="keyword">from</span> funs <span class="keyword">import</span> deal_with_sub_json</span><br><span class="line"><span class="keyword">from</span> funs <span class="keyword">import</span> json_integrate</span><br><span class="line"><span class="keyword">from</span> funs <span class="keyword">import</span> image_compression_and_save</span><br><span class="line"><span class="keyword">from</span> funs <span class="keyword">import</span> make_dir_json_md_of_album</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">'__main__'</span>:</span><br><span class="line">    </span><br><span class="line">    src_image_root = config.Parameters.Image_Root_Path</span><br><span class="line">    temp_image_root = config.Parameters.Uploading_Temp_Image_Path</span><br><span class="line">    hexo_photos_path = os.path.join(config.Parameters.Hexo_Root_Path,config.Parameters.Hexo_Sub_Dir_to_Photos)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## check config environment</span></span><br><span class="line">    environment_check()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## compress and save images</span></span><br><span class="line">    image_compression_and_save(src_image_root, temp_image_root)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## get info of images and save json of each dir</span></span><br><span class="line">    deal_with_sub_json(src_image_root, temp_image_root)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## integrate jsons</span></span><br><span class="line">    album_dict = json_integrate(temp_image_root)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## make folders and markdowns in dir of photos</span></span><br><span class="line">    make_dir_json_md_of_album(temp_image_root, hexo_photos_path, album_dict)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">## upload images with qshell</span></span><br><span class="line">    <span class="keyword">if</span> config.Parameters.Force_Upload:</span><br><span class="line">        os.system(<span class="string">"rm -rf ~/.qshell/qupload"</span>)</span><br><span class="line">        </span><br><span class="line">    cmd = <span class="string">"qshell qupload "</span>+os.path.join(config.Parameters.Uploading_Temp_Image_Path,config.Parameters.Qshell_Config_File_Name)</span><br><span class="line">    os.system(cmd)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>主要函数做了注释，希望可以给大家启发，如果想使用我这套代码可以到 <a href="https://github.com/zywvvd/hexo_album_process" target="_blank" rel="noopener">hexo_album_process</a> 下载</p>
</blockquote>
<h2 id="运行图示"><a href="#运行图示" class="headerlink" title="运行图示"></a>运行图示</h2><ul>
<li>初始相册文件夹pic</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428001615.png"></p>
<ul>
<li>相册内部</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428001650.png"></p>
<ul>
<li>每个文件夹需要有readme.json记录文件夹信息，程序会自动提取，示例如下：</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"time"</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">"year"</span>:<span class="number">2015</span>,</span><br><span class="line">		<span class="attr">"month"</span>:<span class="number">11</span>,</span><br><span class="line">		<span class="attr">"day"</span>:<span class="number">28</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"type"</span>:<span class="string">"风光"</span>,</span><br><span class="line">	<span class="attr">"model"</span>:<span class="string">""</span>,</span><br><span class="line">	<span class="attr">"position"</span>:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">"city"</span>:<span class="string">"合肥"</span>,</span><br><span class="line">		<span class="attr">"street"</span>:<span class="string">"ustc"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">"title"</span>:<span class="string">"USTC"</span>,</span><br><span class="line">	<span class="attr">"balabala"</span>:</span><br><span class="line">		<span class="string">"关于母校。"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置config.py </li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Image_Root_Path = <span class="string">r'/media/vvd/新加卷/pic'</span>                                   												<span class="comment"># root of source raw images</span></span><br><span class="line">Hexo_Root_Path =<span class="string">r'/home/vvd/VVD_Work/Hexo/VVD_Hexo'</span>                        		 					 <span class="comment"># root of Hexo dir  </span></span><br><span class="line">Hexo_Sub_Dir_to_Photos = <span class="string">r'source/photos'</span>                                  												   <span class="comment"># my source dir for album</span></span><br><span class="line">Uploading_Temp_Image_Path = <span class="string">r'/home/vvd/VVD_Work/Hexo/Album_Temp'</span>           	<span class="comment"># root of temp image dir</span></span><br><span class="line">Image_Url_Prefix =<span class="string">r'https://photos.zywvvd.com/vvd_hexo/'</span>                    							  <span class="comment"># prefix of image url</span></span><br></pre></td></tr></table></figure>

<ul>
<li>运行main.py</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428002036.png"></p>
<ul>
<li>临时文件夹产生压缩后的图像文件夹与json文件</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428002127.png"></p>
<ul>
<li>程序会在hexo-&gt;source-&gt; photos文件夹内写入相册文件夹层级结构与对应json文件</li>
</ul>
<p><img src="20200428235033.png"></p>
<ul>
<li>文件夹内的json加入了图像的信息</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428002202.png"></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"time"</span>: &#123;</span><br><span class="line">      <span class="attr">"year"</span>: <span class="number">2015</span>,</span><br><span class="line">      <span class="attr">"month"</span>: <span class="number">11</span>,</span><br><span class="line">      <span class="attr">"day"</span>: <span class="number">28</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">"type"</span>: <span class="string">"风光"</span>,</span><br><span class="line">   <span class="attr">"model"</span>: <span class="string">""</span>,</span><br><span class="line">   <span class="attr">"position"</span>: &#123;</span><br><span class="line">      <span class="attr">"city"</span>: <span class="string">"合肥"</span>,</span><br><span class="line">      <span class="attr">"street"</span>: <span class="string">"ustc"</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">"title"</span>: <span class="string">"USTC"</span>,</span><br><span class="line">   <span class="attr">"balabala"</span>: <span class="string">"关于母校。"</span>,</span><br><span class="line">   <span class="attr">"image_info"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="attr">"Image_Model"</span>: <span class="string">"NIKON D610"</span>,</span><br><span class="line">         <span class="attr">"EXIF_FNumber"</span>: <span class="string">"f11"</span>,</span><br><span class="line">         <span class="attr">"EXIF_FocalLength"</span>: <span class="string">"35mm"</span>,</span><br><span class="line">         <span class="attr">"EXIF_ExposureMode"</span>: <span class="string">"Auto Exposure"</span>,</span><br><span class="line">         <span class="attr">"EXIF_ExposureTime"</span>: <span class="string">"6s"</span>,</span><br><span class="line">         <span class="attr">"EXIF_ISOSpeedRatings"</span>: <span class="string">"100"</span>,</span><br><span class="line">         <span class="attr">"Image_DateTime"</span>: <span class="string">"2015:11:28 00:07:05"</span>,</span><br><span class="line">         <span class="attr">"url"</span>: <span class="string">"https://photos.zywvvd.com/vvd_hexo/2015_11_28_hefei_ustc_fengjing/1.jpg"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="attr">"Image_Model"</span>: <span class="string">"NIKON D610"</span>,</span><br><span class="line">         <span class="attr">"EXIF_FNumber"</span>: <span class="string">"f4"</span>,</span><br><span class="line">         <span class="attr">"EXIF_FocalLength"</span>: <span class="string">"34mm"</span>,</span><br><span class="line">         <span class="attr">"EXIF_ExposureMode"</span>: <span class="string">"Manual Exposure"</span>,</span><br><span class="line">         <span class="attr">"EXIF_ExposureTime"</span>: <span class="string">"25s"</span>,</span><br><span class="line">         <span class="attr">"Image_DateTime"</span>: <span class="string">"2015:11:28 22:13:29"</span>,</span><br><span class="line">         <span class="attr">"url"</span>: <span class="string">"https://photos.zywvvd.com/vvd_hexo/2015_11_28_hefei_ustc_fengjing/2.jpg"</span></span><br><span class="line">      &#125;</span><br><span class="line">   ],</span><br><span class="line">   <span class="attr">"directory"</span>: <span class="string">"2015_11_28_hefei_ustc_fengjing"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>图像会自动上传到七牛云</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200428002346.png"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><blockquote>
<p>文中没有太先进的技术，主要提供了为静态页面自动维护相册问题的解决思路，并分享了json生成与图像上传的工程，有更好的实现方法欢迎交流。</p>
</blockquote>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>本文启发自 <a href="https://asdfv1929.github.io/2018/05/26/next-add-photos/" target="_blank" rel="noopener">https://asdfv1929.github.io/2018/05/26/next-add-photos/</a> 感谢前辈分享</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 使用logging模块管理日志文件</title>
    <url>/2020/04/11/python/logging/python-logging/</url>
    <content><![CDATA[<blockquote>
<p>logging是很友好的python日志管理包，轻便好用，本文介绍logging使用方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h2><blockquote>
<p>在程序中引入包：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br></pre></td></tr></table></figure>

<blockquote>
<p>配置日志设置</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">logging.basicConfig(</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 日志级别,logging.DEBUG,logging.ERROR</span></span><br><span class="line">    level = logging.INFO,  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 日志格式: 时间、代码所在文件名、代码行号、日志级别名字、日志信息</span></span><br><span class="line">    format = <span class="string">'%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)s %(message)s'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印日志的时间</span></span><br><span class="line">    datefmt = <span class="string">'%a, %Y-%m-%d %H:%M:%S'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 日志文件存放的目录（目录必须存在）及日志文件名</span></span><br><span class="line">    filename = log_file_path, </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打开日志文件的方式</span></span><br><span class="line">    filemode = open_type</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>配置说明</p>
</blockquote>
<ul>
<li><p><code>level</code></p>
<p>表示日志记录级别</p>
<p>所谓级别包括：调试级(debug) ，信息级(info)，警告级(warning)，错误级(error)，严重级(critical)</p>
<p>其中的优先级关系为：debug &lt; info &lt; warning &lt;error &lt; critical</p>
<p>日志本身设置有级别（如本例为INFO)，只会记录不小于自身级别的的信息（如本例设置就不会记录DEBUG级别信息）</p>
</li>
<li><p><code>format</code></p>
<p> 格式配置，核心信息为我们需要记录的<code>%(message)s</code>，此外还可以记录时间、文件名、行号、日志级别等信息</p>
</li>
<li><p><code>datefmt</code></p>
<p>时间格式设置<code> &#39;%a, %Y-%m-%d %H:%M:%S&#39;</code>分别表示 -星期 -年 -月 -日 -时 -分 -秒</p>
</li>
<li><p><code>filename</code></p>
<p>日志文件路径</p>
</li>
<li><p><code>filemode</code></p>
<p>日志文件打开模式，一般为<code>w</code>（写入）或<code>a</code>（追加）</p>
</li>
</ul>
<blockquote>
<p>日志记录示例</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">logging.debug(<span class="string">'debug'</span>)  <span class="comment"># this message won't be wrote to the log file, for the priority of DEBUG is lower than INFO</span></span><br><span class="line">    logging.info(<span class="string">'info'</span>)</span><br><span class="line">    logging.warning(<span class="string">'warning'</span>)</span><br><span class="line">    logging.error(<span class="string">'error'</span>)</span><br><span class="line">    logging.critical(<span class="string">'critical'</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>日志文件信息</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Sat, 2020-04-11 15:08:38 logging_test.py[line:51] INFO info</span><br><span class="line">Sat, 2020-04-11 15:08:38 logging_test.py[line:52] WARNING warning</span><br><span class="line">Sat, 2020-04-11 15:08:38 logging_test.py[line:53] ERROR error</span><br><span class="line">Sat, 2020-04-11 15:08:38 logging_test.py[line:54] CRITICAL critical</span><br></pre></td></tr></table></figure>

<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Kite Python代码补全工具安装</title>
    <url>/2020/04/11/python/kite_install/kite_install/</url>
    <content><![CDATA[<blockquote>
<p>Kite是一款将AI机器学习应用到代码补全的工具，本文介绍其在Windows与Linux系统的安装方法。</p>
</blockquote>
<a id="more"></a>

<p>官网：<a href="https://www.kite.com/" target="_blank" rel="noopener">https://www.kite.com/</a></p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><ul>
<li><a href="https://www.kite.com/download/" target="_blank" rel="noopener">https://www.kite.com/download/</a></li>
</ul>
<blockquote>
<p>直接安装下载的 KiteSetup.exe 即可。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029095905.png"></p>
<h4 id="在-VS-code-中使用-kite"><a href="#在-VS-code-中使用-kite" class="headerlink" title="在 VS code 中使用 kite"></a>在 VS code 中使用 kite</h4><blockquote>
<p>安装插件 Kite AI Code AutoComplete</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029100241.png"></p>
<blockquote>
<p>随后可以跟着自动弹出的教程学习使用方法。</p>
</blockquote>
<blockquote>
<p>事实上写代码时仅需关注右下角是否开启了Kite即可：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029100608.png"></p>
<blockquote>
<p>此时写Python代码会有kite 的自动补全：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/images_matrixtime/20201029101019.png"></p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><ul>
<li><a href="https://www.kite.com/download/?loc=top_nav#" target="_blank" rel="noopener">https://www.kite.com/download/?loc=top_nav#</a></li>
</ul>
<p>运行命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash -c &quot;$(wget -q -O - https:&#x2F;&#x2F;linux.kite.com&#x2F;dls&#x2F;linux&#x2F;current)&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>网上有教程说不能使用root用户安装，我在docker中的情况时只能使用root用户安装。</p>
<p>随后VS code 远程调试代码时即可使用kite自动补全。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>在谷歌浏览器调试JavaScript</title>
    <url>/2020/04/03/coding/java_script/js-debug/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍在谷歌浏览器调试JavaScript的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><blockquote>
<p>新建test.html文件，写入：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line">		</span><br><span class="line"><span class="actionscript">        alert(<span class="string">"Hello World!"</span>);</span></span><br><span class="line"><span class="javascript">	<span class="built_in">document</span>.write(<span class="string">"Hello World"</span>)</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> vAlert=&#123;&#125;;</span></span><br><span class="line"><span class="actionscript">        vAlert.show=<span class="function"><span class="keyword">function</span><span class="params">(msg)</span></span>&#123;</span></span><br><span class="line">            alert(msg);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> test_var = <span class="string">'test world'</span></span></span><br><span class="line"><span class="actionscript">        vAlert.show(<span class="string">"测试"</span>);</span></span><br><span class="line"><span class="javascript">	<span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</span></span><br><span class="line"><span class="javascript"><span class="built_in">console</span>.log(test_var)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="调试运行"><a href="#调试运行" class="headerlink" title="调试运行"></a>调试运行</h2><ul>
<li><p>打开谷歌浏览器</p>
</li>
<li><p>运行test.html</p>
</li>
<li><p>F12 ，呼出开发者模式</p>
</li>
<li><p>进入Sources选项卡</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200403001407.png" alt="谷歌浏览器开发者模式"></p>
<ul>
<li>在js 代码加入断点，F5刷新，单步运行</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200403001539.png" alt="断点调试"></p>
<ul>
<li>期间网页会显示代码执行效果，并且在控制台有相应输出，自己也可以在控制台调试当前环境代码</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200403001726.png" alt="控制台调试"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>编程知识</category>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>编程知识</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 获取图像Exif详细信息</title>
    <url>/2020/04/01/python/get_image_exif/get-image-exif/</url>
    <content><![CDATA[<blockquote>
<p>相机拍摄照片会在文件中记录拍摄的重要参数，包括机身信息、光圈、焦距、感光度、时间、拍摄地点等等。本文介绍获取此类信息的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="安装python包"><a href="#安装python包" class="headerlink" title="安装python包"></a>安装python包</h2><blockquote>
<p>安装exifread：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install exifread</span><br></pre></td></tr></table></figure>

<h2 id="上代码"><a href="#上代码" class="headerlink" title="上代码"></a>上代码</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> exifread</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhotoExifInfo</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,photo_path)</span>:</span></span><br><span class="line">        self.photo_path = photo_path</span><br><span class="line">        self.baidu_map_ak = <span class="string">"your baidu map api key"</span></span><br><span class="line">        self.image_info_dict=&#123;&#125;</span><br><span class="line">        self.tags =&#123;&#125;</span><br><span class="line">        self.interested_keys = [</span><br><span class="line">            <span class="string">'EXIF ExposureMode'</span>,\</span><br><span class="line">            <span class="string">'EXIF ExposureTime'</span>,\</span><br><span class="line">            <span class="string">'EXIF Flash'</span>,\</span><br><span class="line">            <span class="string">'EXIF ISOSpeedRatings'</span>,\</span><br><span class="line">            <span class="string">'Image Model'</span>,\</span><br><span class="line">            <span class="string">'EXIF ExifImageWidth'</span>,\</span><br><span class="line">            <span class="string">'EXIF ExifImageLength'</span>,\</span><br><span class="line">            <span class="string">'Image DateTime'</span>,\</span><br><span class="line">            <span class="string">'EXIF DateTimeOriginal'</span>,\</span><br><span class="line">            <span class="string">'Image Make'</span>,\</span><br><span class="line"></span><br><span class="line">            <span class="comment"># lens</span></span><br><span class="line">            <span class="comment"># jiaoju</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_tags</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取照片信息</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        image_content = open(self.photo_path, <span class="string">'rb'</span>)</span><br><span class="line">        tags = exifread.process_file(image_content)</span><br><span class="line">        self.tags = tags</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.interested_keys:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                info = tags[item]</span><br><span class="line">                self.image_info_dict[item] = info</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                print(<span class="string">f'<span class="subst">&#123;self.photo_path&#125;</span> has no attribute of <span class="subst">&#123;item&#125;</span>'</span>)                </span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 遍历获取照片所有信息</span></span><br><span class="line">        <span class="comment">#for j, k in tags.items():</span></span><br><span class="line">            <span class="comment">#print(f"&#123;j&#125; : &#123;k&#125;")</span></span><br><span class="line">            <span class="comment">#print('拍摄时间：', tags['EXIF DateTimeOriginal'])</span></span><br><span class="line">            <span class="comment">#print('照相机制造商：', tags['Image Make'])</span></span><br><span class="line">            <span class="comment">#print('照相机型号：', tags['Image Model'])</span></span><br><span class="line">            <span class="comment">#print('照片尺寸：', tags['EXIF ExifImageWidth'], tags['EXIF ExifImageLength'])</span></span><br><span class="line">            </span><br><span class="line">     </span><br><span class="line">        image_content.close()</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_lng_lat</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""经纬度转换"""</span></span><br><span class="line">        tags = self.tags</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 纬度</span></span><br><span class="line">            LatRef = tags[<span class="string">"GPS GPSLatitudeRef"</span>].printable</span><br><span class="line">            Lat = tags[<span class="string">"GPS GPSLatitude"</span>].printable[<span class="number">1</span>:<span class="number">-1</span>].replace(<span class="string">" "</span>, <span class="string">""</span>).replace(<span class="string">"/"</span>, <span class="string">","</span>).split(<span class="string">","</span>)</span><br><span class="line">            Lat = float(Lat[<span class="number">0</span>]) + float(Lat[<span class="number">1</span>]) / <span class="number">60</span> + float(Lat[<span class="number">2</span>]) / <span class="number">3600</span></span><br><span class="line">            <span class="keyword">if</span> LatRef != <span class="string">"N"</span>:</span><br><span class="line">                Lat = Lat * (<span class="number">-1</span>)</span><br><span class="line">            <span class="comment"># 经度</span></span><br><span class="line">            LonRef = tags[<span class="string">"GPS GPSLongitudeRef"</span>].printable</span><br><span class="line">            Lon = tags[<span class="string">"GPS GPSLongitude"</span>].printable[<span class="number">1</span>:<span class="number">-1</span>].replace(<span class="string">" "</span>, <span class="string">""</span>).replace(<span class="string">"/"</span>, <span class="string">","</span>).split(<span class="string">","</span>)</span><br><span class="line">            Lon = float(Lon[<span class="number">0</span>]) + float(Lon[<span class="number">1</span>]) / <span class="number">60</span> + float(Lon[<span class="number">2</span>]) / <span class="number">3600</span></span><br><span class="line">            <span class="keyword">if</span> LonRef != <span class="string">"E"</span>:</span><br><span class="line">                Lon = Lon * (<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> Lat,Lon</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">'Unable to get'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_city_info</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = self.get_lng_lat()</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            Lat, Lon = result</span><br><span class="line">            url = <span class="string">"https://api.map.baidu.com/reverse_geocoding/v3/?ak="</span>+self.baidu_map_ak+<span class="string">"&amp;output=json&amp;coordtype=wgs84ll&amp;location="</span> + str(Lat) + <span class="string">','</span> + str(Lon)</span><br><span class="line">            <span class="comment">#url = "https://api.map.baidu.com/reverse_geocoding/v3/?ak="+self.baidu_map_ak+"&amp;output=json&amp;coordtype=wgs84ll&amp;location=31.225696563611,121.49884033194"</span></span><br><span class="line">            response = requests.get(url).json()</span><br><span class="line">            status = response[<span class="string">'status'</span>]</span><br><span class="line">            <span class="keyword">if</span> status == <span class="number">0</span>:</span><br><span class="line">                address = response[<span class="string">'result'</span>][<span class="string">'formatted_address'</span>]</span><br><span class="line">                <span class="keyword">if</span> address != <span class="string">""</span>:</span><br><span class="line">                    self.image_info_dict[<span class="string">'Position'</span>] = address</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'baidu_map error'</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_image_info</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.get_tags()</span><br><span class="line">        self.get_city_info()</span><br><span class="line">        <span class="keyword">return</span> self.image_info_dict</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    result = PhotoExifInfo(<span class="string">"test.jpeg"</span>).get_image_info()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> j, k <span class="keyword">in</span> result.items():</span><br><span class="line">        print(<span class="string">f"<span class="subst">&#123;j&#125;</span> : <span class="subst">&#123;k&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>示例输出</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">EXIF ExposureMode : Auto Exposure</span><br><span class="line">EXIF ExposureTime : 10/24723</span><br><span class="line">EXIF Flash : Flash did not fire, auto mode</span><br><span class="line">EXIF ISOSpeedRatings : 50</span><br><span class="line">Image Model : vivo Z1</span><br><span class="line">EXIF ExifImageWidth : 4144</span><br><span class="line">EXIF ExifImageLength : 1968</span><br><span class="line">Image DateTime : 2019:11:03 11:34:24</span><br><span class="line">EXIF DateTimeOriginal : 2019:11:03 11:34:24</span><br><span class="line">Image Make : vivo</span><br><span class="line">Position : 上海市黄浦区中山南路187</span><br></pre></td></tr></table></figure>

<blockquote>
<p>代码中的<code>self.baidu_map_ak</code>需要去百度地图申请，具体方法移步: <a href="https://www.zywvvd.com/2020/04/01/coding/utils/baidumap-ak/">申请百度地图API Key进行百度地图开发，获取经纬度对应地点</a></p>
</blockquote>
<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>申请百度地图API Key进行百度地图开发，获取经纬度对应地点</title>
    <url>/2020/04/01/coding/utils/baidumap-ak/</url>
    <content><![CDATA[<blockquote>
<p> 在程序中获取到了经纬度信息，使用百度地图的开发工具可以将其转换为地点名称。本文介绍申请百度AK（API Key），并用于提取地理信息位置名称的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>申请百度账号</li>
</ul>
<h2 id="申请百度AK"><a href="#申请百度AK" class="headerlink" title="申请百度AK"></a>申请百度AK</h2><ul>
<li>到 <a href="%5Bhttps://lbsyun.baidu.com/index.php?title=%E9%A6%96%E9%A1%B5%5D(https://lbsyun.baidu.com/index.php?title=%E9%A6%96%E9%A1%B5)">百度地图平台</a> ，进入控制台</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200401221918.png" alt="百度地图平台"></p>
<ul>
<li>注册开发者</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200401222749.png" alt="注册"></p>
<ul>
<li><p>申请密钥</p>
<p><img src="https://photos.zywvvd.com/image/20200401223600.png" alt="申请密钥"><img src="https://photos.zywvvd.com/image/20200401223600.png"></p>
</li>
<li><p>创建应用</p>
<p><img src="https://photos.zywvvd.com/image/20200401224843.png"></p>
</li>
<li><p>获得API Key</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200401225152.png" alt="AK"></p>
<h2 id="全球逆地理编码"><a href="#全球逆地理编码" class="headerlink" title="全球逆地理编码"></a>全球逆地理编码</h2><blockquote>
<p>百度地图提供将经纬度转为地理位置的服务—— 全球逆地理编码:</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200401231121.png" alt="逆地理编码"></p>
<ul>
<li>使用语法：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;api.map.baidu.com&#x2F;reverse_geocoding&#x2F;v3&#x2F;?ak&#x3D;您的ak&amp;output&#x3D;json&amp;coordtype&#x3D;wgs84ll&amp;location&#x3D;31.225696563611,121.49884033194  &#x2F;&#x2F;GET请求</span><br></pre></td></tr></table></figure>

<ul>
<li>使用示例，在Python中：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">baidu_map_ak = <span class="comment">#你的百度ak</span></span><br><span class="line">url = <span class="string">"https://api.map.baidu.com/reverse_geocoding/v3/?ak="</span>+baidu_map_ak+<span class="string">"&amp;output=json&amp;coordtype=wgs84ll&amp;location=31.225696563611,121.49884033194"</span></span><br><span class="line">response = requests.get(url).json()</span><br><span class="line">status = response[<span class="string">'status'</span>]</span><br><span class="line">            <span class="keyword">if</span> status == <span class="number">0</span>:</span><br><span class="line">                	address = response[<span class="string">'result'</span>][<span class="string">'formatted_address'</span>]</span><br><span class="line">            		print( <span class="string">f"拍摄地点：<span class="subst">&#123;address&#125;</span>"</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># -&gt; 拍摄地点：上海市黄浦区中山南路187</span></span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>实用工具</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>实用工具</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -22- 添加相册系列 -2- 使用七牛云qshell同步图像目录</title>
    <url>/2020/03/31/next/22_qiniuyun_qshell/qiniuyun-qshell/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍使用 qshell 同步本地文件目录到存储空间并体现出层级结构的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>需要图床管理图片文件夹的需求</li>
<li>申请七牛云账号</li>
<li>开启七牛云图床，<a href="https://www.zywvvd.com/2020/03/25/hexo/9_add_image_bed/add-image-bed/">Hexo -9- 添加七牛云图床</a></li>
</ul>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><blockquote>
<p>要上传的资源目录：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tree</span></span><br><span class="line">.</span><br><span class="line">├── 1</span><br><span class="line">│   ├── a.jpg</span><br><span class="line">│   ├── b.jpg</span><br><span class="line">│   └── c.jpg</span><br><span class="line">├── 2</span><br><span class="line">│   ├── d.jpg</span><br><span class="line">│   ├── e.jpg</span><br><span class="line">│   └── f.jpg</span><br><span class="line">├── g.jpg</span><br><span class="line">├── h.jpg</span><br><span class="line">├── i.jpg</span><br><span class="line">└── j.jpg</span><br></pre></td></tr></table></figure>



<h2 id="工具下载"><a href="#工具下载" class="headerlink" title="工具下载"></a>工具下载</h2><blockquote>
<p>命令行工具 qshell <a href="https://developer.qiniu.com/kodo/tools/1302/qshell" target="_blank" rel="noopener">传送门</a></p>
<ul>
<li>各种操作系统需要下载的版本文档说得很清楚，我的ubuntu18.04 x64下载了qshell-linux-x64-v2.4.1.zip</li>
<li>解压得到 qshell-linux-x64-v2.4.1</li>
<li>重命名为 qshell，并赋予可执行权限</li>
</ul>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mv qshell-linux-x64 qshell</span><br><span class="line">chmod +x qshell</span><br></pre></td></tr></table></figure>



<h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><blockquote>
<p>将qshell文件所在位置加入到 ~/.bashrc</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export PATH="/path of qshell:$PATH"</span><br></pre></td></tr></table></figure>

<blockquote>
<p>加载.bashrc使路径立即生效</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<blockquote>
<p>测试，输入qshell -v 出现版本信息表明配置成功</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">qshell -v</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">qshell version v2.4.1</span></span><br></pre></td></tr></table></figure>



<h2 id="配置账户"><a href="#配置账户" class="headerlink" title="配置账户"></a>配置账户</h2><blockquote>
<p>需要鉴权的命令都需要依赖七牛账号下的 AccessKey 和 SecretKey ，位于个人中心 -&gt; 秘钥管理</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200331231941.png" alt="秘钥管理"></p>
<blockquote>
<p>配置账户:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">qshell account [&lt;AccessKey&gt; &lt;SecretKey&gt; &lt;Name&gt;]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>之后再次输入 qshell account 命令验证设置是否成功</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">qshell account</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Name: zywvvd</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AccessKey: Bd0UYk1e9pFWK×××××××××××××××</span></span><br><span class="line"><span class="meta">#</span><span class="bash">SecretKey: ZFsdguzYE3QUl×××××××××××××××</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此处操作后在当前用户主目录中生成 qshell 目录：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls ~/.qshell/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> account.json</span></span><br></pre></td></tr></table></figure>



<h2 id="编写同步目录文件"><a href="#编写同步目录文件" class="headerlink" title="编写同步目录文件"></a>编写同步目录文件</h2><blockquote>
<p>在上文提到的~/.qshell 目录中创建配置文件，文件内容如下：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat upload.conf </span></span><br><span class="line">&#123;</span><br><span class="line">    "src_dir" : "/home/vvd/VVD_Work/test",</span><br><span class="line">    "bucket" : "vvd-space"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>src_dir 为刚刚我存放照片的路径</p>
</li>
<li><p>bucket 为你的七牛云空间名称</p>
</li>
</ul>
</blockquote>
<h2 id="同步文件"><a href="#同步文件" class="headerlink" title="同步文件"></a>同步文件</h2><blockquote>
<p>在~/.qshell文件夹下执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">qshell qupload upload.conf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>返回上传日志：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Writing upload log to file /home/vvd/.qshell/qupload/040adc5d316ff8cfc274b2e099628234/040adc5d316ff8cfc274b2e099628234.log</span><br><span class="line"></span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/a.jpg =&gt; 1/a.jpg [1/10, 10.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/b.jpg =&gt; 1/b.jpg [2/10, 20.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/c.jpg =&gt; 1/c.jpg [3/10, 30.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/d.jpg =&gt; 2/d.jpg [4/10, 40.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/e.jpg =&gt; 2/e.jpg [5/10, 50.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/f.jpg =&gt; 2/f.jpg [6/10, 60.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/g.jpg =&gt; g.jpg [7/10, 70.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/h.jpg =&gt; h.jpg [8/10, 80.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/i.jpg =&gt; i.jpg [9/10, 90.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/j.jpg =&gt; j.jpg [10/10, 100.0%] ...</span><br><span class="line"></span><br><span class="line">See upload log at path /home/vvd/.qshell/qupload/040adc5d</span><br></pre></td></tr></table></figure>



<h2 id="查看同步日志"><a href="#查看同步日志" class="headerlink" title="查看同步日志"></a>查看同步日志</h2><blockquote>
<p>日志存放在 ~/.qshell 文件夹下qupload文件夹内：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200331234827.png" alt="查看日志"></p>
<h2 id="进入七牛云控制台查看上传的文件"><a href="#进入七牛云控制台查看上传的文件" class="headerlink" title="进入七牛云控制台查看上传的文件"></a>进入七牛云控制台查看上传的文件</h2><blockquote>
<p>在控制台-&gt; 空间管理 -&gt; 文件管理 可以看到同步的文件</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200331234935.png" alt="空间图片"></p>
<h2 id="图片文件目录更新"><a href="#图片文件目录更新" class="headerlink" title="图片文件目录更新"></a>图片文件目录更新</h2><blockquote>
<p>当我们更新了原始图片目录时（新建文件夹new，图片new.jpg）：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tree</span><br><span class="line">.</span><br><span class="line">├── 1</span><br><span class="line">│   ├── a.jpg</span><br><span class="line">│   ├── b.jpg</span><br><span class="line">│   └── c.jpg</span><br><span class="line">├── 2</span><br><span class="line">│   ├── d.jpg</span><br><span class="line">│   ├── e.jpg</span><br><span class="line">│   └── f.jpg</span><br><span class="line">├── g.jpg</span><br><span class="line">├── h.jpg</span><br><span class="line">├── i.jpg</span><br><span class="line">├── j.jpg</span><br><span class="line">└── new</span><br><span class="line">    └── new.jpg</span><br></pre></td></tr></table></figure>

<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><blockquote>
<p>回到~/.qshell 上传文件：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> qshell qupload upload.conf </span><br><span class="line">Writing upload log to file /home/vvd/.qshell/qupload/c50b44d8de5ae468d8080f1f37fb946c/c50b44d8de5ae468d8080f1f37fb946c.log</span><br><span class="line"></span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/a.jpg =&gt; 1/a.jpg [1/8, 12.5%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/b.jpg =&gt; 1/b.jpg [2/8, 25.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/c.jpg =&gt; 1/c.jpg [3/8, 37.5%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/d.jpg =&gt; 2/d.jpg [4/8, 50.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/e.jpg =&gt; 2/e.jpg [5/8, 62.5%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/f.jpg =&gt; 2/f.jpg [6/8, 75.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/g.jpg =&gt; g.jpg [7/8, 87.5%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/h.jpg =&gt; h.jpg [8/8, 100.0%] ...</span><br><span class="line"></span><br><span class="line">See upload log at path /home/vvd/.qshell/qupload/c50b44d8de5ae468d8080f1f37fb946c/c50b44d8de5ae468d8080f1f37fb946c.log</span><br></pre></td></tr></table></figure>

<blockquote>
<p>发现并没有更新，不知道是不是有别的函数来完成这个功能。</p>
<p>于是写了简单脚本upload.sh可以实现实时同步：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">rm  -rf  ~/.qshell/qupload</span><br><span class="line">qshell  qupload  ~/.qshell/upload.conf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用时只需sh upload.sh即可，正好不用每次都找那个 upload.conf 了</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200401002653.png" alt="真 - 同步文件夹"></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><blockquote>
<p>咳咳，人家七牛云有这个设定的，不用自己费劲删人家日志。</p>
<p>在upload.conf中加入配置：</p>
<ul>
<li><p><strong>rescan_local</strong>：支持本地增量上传</p>
</li>
<li><p><strong>overwrite</strong> ：支持本地文件覆盖上传</p>
</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;src_dir&quot; : &quot;&#x2F;home&#x2F;vvd&#x2F;VVD_Work&#x2F;test&quot;,</span><br><span class="line">    &quot;bucket&quot; : &quot;vvd-space&quot;,</span><br><span class="line">    &quot;rescan_local&quot; : true,</span><br><span class="line">    &quot;overwrite&quot; : true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>再上传就好：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> qshell qupload upload.conf </span><br><span class="line">Writing upload log to file /home/vvd/.qshell/qupload/c50b44d8de5ae468d8080f1f37fb946c/c50b44d8de5ae468d8080f1f37fb946c.log</span><br><span class="line"></span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/a.jpg =&gt; 1/a.jpg [1/12, 8.3%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/b.jpg =&gt; 1/b.jpg [2/12, 16.7%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/1/c.jpg =&gt; 1/c.jpg [3/12, 25.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/d.jpg =&gt; 2/d.jpg [4/12, 33.3%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/e.jpg =&gt; 2/e.jpg [5/12, 41.7%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/2/f.jpg =&gt; 2/f.jpg [6/12, 50.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/3/g.jpg =&gt; 3/g.jpg [7/12, 58.3%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/g.jpg =&gt; g.jpg [8/12, 66.7%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/h.jpg =&gt; h.jpg [9/12, 75.0%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/i.jpg =&gt; i.jpg [10/12, 83.3%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/j.jpg =&gt; j.jpg [11/12, 91.7%] ...</span><br><span class="line">Uploading /home/vvd/VVD_Work/test/new/new.jpg =&gt; new/new.jpg [12/12, 100.0%] ...</span><br><span class="line"></span><br><span class="line">See upload log at path /home/vvd/.qshell/qupload/c50b44d8de5ae468d8080f1f37fb946c/c50b44d8de5ae468d8080f1f37fb946c.log</span><br></pre></td></tr></table></figure>



<h2 id="qshell-qupload-配置"><a href="#qshell-qupload-配置" class="headerlink" title="qshell qupload 配置"></a>qshell qupload 配置</h2><blockquote>
<p><code>qupload</code> 功能需要配置文件的支持，配置文件支持的全部参数如下：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;src_dir&quot;            :   &quot;&lt;LocalPath&gt;&quot;,</span><br><span class="line">   &quot;bucket&quot;             :   &quot;&lt;Bucket&gt;&quot;,</span><br><span class="line">   &quot;file_list&quot;          :   &quot;&lt;FileList&gt;&quot;,</span><br><span class="line">   &quot;key_prefix&quot;         :   &quot;&lt;Key Prefix&gt;&quot;,</span><br><span class="line">   &quot;up_host&quot;            :   &quot;&lt;Upload Host&gt;&quot;,</span><br><span class="line">   &quot;ignore_dir&quot;         :   false,</span><br><span class="line">   &quot;overwrite&quot;          :   false,</span><br><span class="line">   &quot;check_exists&quot;       :   false,</span><br><span class="line">   &quot;check_hash&quot;         :   false,</span><br><span class="line">   &quot;check_size&quot;         :   false,</span><br><span class="line">   &quot;rescan_local&quot;       :   true,</span><br><span class="line">   &quot;skip_file_prefixes&quot; :   &quot;test,demo,&quot;,</span><br><span class="line">   &quot;skip_path_prefixes&quot; :   &quot;hello&#x2F;,temp&#x2F;&quot;,</span><br><span class="line">   &quot;skip_fixed_strings&quot; :   &quot;.svn,.git&quot;,</span><br><span class="line">   &quot;skip_suffixes&quot;      :   &quot;.DS_Store,.exe&quot;,</span><br><span class="line">   &quot;log_file&quot;           :   &quot;upload.log&quot;,</span><br><span class="line">   &quot;log_level&quot;          :   &quot;info&quot;,</span><br><span class="line">   &quot;log_rotate&quot;         :   1,</span><br><span class="line">   &quot;log_stdout&quot;         :   false,</span><br><span class="line">   &quot;file_type&quot;          :   0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数名</th>
<th>描述</th>
<th>可选参数</th>
</tr>
</thead>
<tbody><tr>
<td>src_dir</td>
<td>本地同步路径，为全路径格式，工具将同步该目录下面所有的文件；不支持本地路径下的目录软连接。在Windows系统下面使用的时候，注意<code>src_dir</code>的设置遵循<code>D:\\jemy\\backup</code>这种方式。也就是路径里面的<code>\</code>要有两个（<code>\\</code>）</td>
<td>N</td>
</tr>
<tr>
<td>bucket</td>
<td>同步数据的目标空间名称，可以为公开空间或私有空间</td>
<td>N</td>
</tr>
<tr>
<td>file_list</td>
<td>待同步文件列表，该文件列表内容必须是相对于<code>src_dir</code>的文件相对路径列表，可以不指定，工具将自动获取<code>src_dir</code>下面的文件列表。请使用 <code>dircache</code> 命令生成这个文件列表，生成之后可以手动删除不需要的行</td>
<td>Y</td>
</tr>
<tr>
<td>up_host</td>
<td>上传域名，可选设置，一般情况下不需要指定</td>
<td>Y</td>
</tr>
<tr>
<td>ignore_dir</td>
<td>保存文件在七牛空间时，使用的文件名是否忽略本地路径，默认为false</td>
<td>Y</td>
</tr>
<tr>
<td>key_prefix</td>
<td>在保存文件在七牛空间时，使用的文件名的前缀，默认为空字符串</td>
<td>Y</td>
</tr>
<tr>
<td>overwrite</td>
<td>是否覆盖空间中已有的同名文件，默认不覆盖。</td>
<td>Y</td>
</tr>
<tr>
<td>check_exists</td>
<td>每个文件上传之前是否检查空间中是否存在同名文件，默认为false，不检查</td>
<td>Y</td>
</tr>
<tr>
<td>check_hash</td>
<td>在<code>check_exists</code>设置为<code>true</code>的情况下生效，是否检查本地文件hash和空间文件hash一致，默认不检查，节约同步时间</td>
<td>Y</td>
</tr>
<tr>
<td>check_size</td>
<td>在<code>check_exists</code>设置为<code>true</code>的情况下，如果<code>check_hash</code>为<code>false</code>，那么你可以设置<code>check_size</code>为<code>true</code>做简单的大小检查，以查看本地文件和空间文件大小是否一致，默认不检查</td>
<td>Y</td>
</tr>
<tr>
<td>skip_file_prefixes</td>
<td>跳过所有文件名（不带相对路径）以该前缀列表里面字符串为前缀的文件</td>
<td>Y</td>
</tr>
<tr>
<td>skip_path_prefixes</td>
<td>跳过所有文件路径（相对路径）以该前缀列表里面字符串为前缀的文件</td>
<td>Y</td>
</tr>
<tr>
<td>skip_fixed_strings</td>
<td>跳过所有文件路径（相对路径）中包含该字符串列表中字符串的文件</td>
<td>Y</td>
</tr>
<tr>
<td>skip_suffixes</td>
<td>跳过所有以该后缀列表里面字符串为后缀的文件或者目录</td>
<td>Y</td>
</tr>
<tr>
<td>rescan_local</td>
<td>默认情况下，本地新增的文件不会被同步，需要手动设置为true才会去检测新增文件。</td>
<td>Y</td>
</tr>
<tr>
<td>log_level</td>
<td>上传日志输出级别，可选值为<code>debug</code>,<code>info</code>,<code>warn</code>,<code>error</code>,默认<code>info</code></td>
<td>Y</td>
</tr>
<tr>
<td>log_file</td>
<td>上传日志的输出文件，如果不指定会输出到qshell工作目录下默认的文件中，文件名可以在终端输出看到</td>
<td>Y</td>
</tr>
<tr>
<td>log_rotate</td>
<td>上传日志文件的切换周期，单位为天，默认为1天即切换到新的上传日志文件</td>
<td>Y</td>
</tr>
<tr>
<td>log_stdout</td>
<td>上传日志是否同时输出一份到标准终端，默认为false，主要在调试上传功能时可以指定为true</td>
<td>Y</td>
</tr>
<tr>
<td>file_type</td>
<td>文件存储类型，默认为<code>0</code>(标准存储） <code>1</code>为低频存储</td>
<td>Y</td>
</tr>
<tr>
<td>delete_on_success</td>
<td>上传成功的文件，同时删除本地文件，以达到节约磁盘的目的，比如日志归档的场景，默认为<code>false</code>，如果需要开启功能，设置为<code>true</code>即可。</td>
<td>Y</td>
</tr>
</tbody></table>
<h3 id="配置文件示例"><a href="#配置文件示例" class="headerlink" title="配置文件示例"></a>配置文件示例</h3><blockquote>
<p>我的配置文件使用了常用的实用配置，供大家参考：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    	&quot;src_dir&quot; : &quot;&#x2F;Hexo&#x2F;Album_Temp&quot;,       	### 上传文件夹路径（必选）</span><br><span class="line">    	&quot;bucket&quot; : &quot;vvd-space&quot;,								### 七牛云空间名称（必选）</span><br><span class="line">    	&quot;rescan_local&quot; : true,								   ### 支持增量上传（重要）</span><br><span class="line">		&quot;key_prefix&quot;: &quot;vvd_hexo&#x2F;&quot;,						### 上传图像的前缀</span><br><span class="line">		&quot;check_exists&quot;: true,								   ### 上传前是否检查文件是否存在</span><br><span class="line">		&quot;check_size&quot;:true,										 ### 如果存在同名文件检查大小是否相同（比哈希快一些）</span><br><span class="line">		&quot;skip_suffixes&quot;: &quot;.json,.log,.conf&quot;,		### 后缀列表，在上传文件夹路径中文件有这些后缀的就忽略不上传</span><br><span class="line">    	&quot;overwrite&quot; : true										  ### 可否覆盖原文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>上传后的一张图片链接：</p>
</blockquote>
<p><a href="https://photos.zywvvd.com/vvd_hexo/2015_11_28_hefei_ustc_fengjing/1.jpg" target="_blank" rel="noopener">https://photos.zywvvd.com/vvd_hexo/2015_11_28_hefei_ustc_fengjing/1.jpg</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>swig 语法介绍</title>
    <url>/2020/03/31/coding/front_end/swig/swig-grammar/</url>
    <content><![CDATA[<blockquote>
<p>Next 主题使用swig引擎，swig 是node端的一个优秀简洁的模板引擎，本文介绍swig基本语法。</p>
</blockquote>
<a id="more"></a>



<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul>
<li>支持大多数主流浏览器。</li>
<li>表达式兼容性好。</li>
<li>面向对象的模板继承。</li>
<li>将过滤器和转换应用到模板中的输出。</li>
<li>可根据路劲渲染页面。</li>
<li>支持页面复用。</li>
<li>支持动态页面。</li>
<li>可扩展、可定制。</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install swig --save</span></span><br></pre></td></tr></table></figure>



<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><blockquote>
<p>swig有多种实现方式来编译和渲染模板</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> swig = <span class="built_in">require</span>(<span class="string">'swig'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compile a file and store it, rendering it later</span></span><br><span class="line"><span class="keyword">var</span> tpl = swig.compileFile(<span class="string">'/path/to/template.html'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(tpl(&#123; <span class="attr">article</span>: &#123; <span class="attr">title</span>: <span class="string">'Swig is fun!'</span> &#125;&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接渲染字符串模板</span></span><br><span class="line"><span class="built_in">console</span>.log(swig.render(<span class="string">'&#123;% if foo %&#125;Hooray!&#123;% endif %&#125;'</span>, &#123; <span class="attr">locals</span>: &#123; <span class="attr">foo</span>: <span class="literal">true</span> &#125;&#125;));</span><br></pre></td></tr></table></figure>



<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><blockquote>
<p>模板中的变量使用双大括号来声明。例如</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;a&#125;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><blockquote>
<p>变量的属性可以使用<code>.</code>或者<code>[ ]</code>来访问，如下两个是等价的:</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">&#123;&#123; foo.bar &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// is equivalent to</span></span><br><span class="line">&#123;&#123; foo[<span class="string">'bar'</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>他遵循和javascript一样的原则，如果关键词中有<code>-</code>，则必须使用<code>[]</code>来访问属性，不能使用<code>.</code></p>
</blockquote>
<p><strong>Bad!</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123; foo.chicken-tacos &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Good!</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;&#123; foo[<span class="string">'chicken-tacos'</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="未定义和空值"><a href="#未定义和空值" class="headerlink" title="未定义和空值"></a>未定义和空值</h3><blockquote>
<p>如果一个变量未定义或者是空值，在渲染的时候，将会在相应的位置输出一个空的字符串，而不会报异常。</p>
</blockquote>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><blockquote>
<p>变量可以用特殊的链式结构进行修改过滤。</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">&#123;&#123; name|title &#125;&#125; was born <span class="keyword">on</span> &#123;&#123; birthday|date(<span class="string">'F jS, Y'</span>) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// =&gt; Jane was born on July 6th, 1985</span></span><br></pre></td></tr></table></figure>



<h3 id="方法（函数）"><a href="#方法（函数）" class="headerlink" title="方法（函数）"></a>方法（函数）</h3><blockquote>
<p>变量也可以是 JavaScript functions. 值得注意的是，不管你的 autoescape设定是什么样的，方法都不会被 auto-escaped.</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> locals = &#123; <span class="attr">mystuff</span>: <span class="function"><span class="keyword">function</span> <span class="title">mystuff</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'&lt;p&gt;Things!&lt;/p&gt;'</span>; &#125;&#125;;</span><br><span class="line">swig.render(<span class="string">'&#123;&#123; mystuff() &#125;&#125;'</span>, &#123; <span class="attr">locals</span>: locals &#125;);</span><br><span class="line"><span class="comment">// =&gt; &lt;p&gt;Things!&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p> 如果要对函数强制转义输出，只需通过管道将其传递到转义筛选器。</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&#123;&#123; mystuff()|<span class="built_in">escape</span> &#125;&#125;</span><br><span class="line"><span class="comment">// =&gt; &lt;p&gt;Things&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="逻辑标签"><a href="#逻辑标签" class="headerlink" title="逻辑标签"></a>逻辑标签</h2><blockquote>
<p>Swig包含一些基本的可选的代码块，叫做标签，使用标签可以更好的控制模板的渲染输出。标签示例如下：</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> foo %&#125;bar&#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a list of people, only if there are items in the people array</span></span><br><span class="line">&#123;% <span class="keyword">for</span> person in people %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> loop.first %&#125;&lt;ol&gt;&#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line">  &lt;li&gt;&#123;&#123; person.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">  &#123;% <span class="keyword">if</span> loop.last %&#125;&lt;/ol&gt;&#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line">&#123;% <span class="keyword">endfor</span> %&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中<code>{ %  endif  % }</code>和<code>{ %  endfor  % }</code>是结束标签，用于表明代码块的的结束。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;% block tacos %&#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#123;% endblock tacos %&#125;</span><br><span class="line">&#123;% block burritos %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> foo %&#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#123;% <span class="keyword">endif</span> %&#125; <span class="comment">//the above will render if foo == true</span></span><br><span class="line">&#123;% endblock burritos %&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多关于tag的信息，请查看<a href="https://link.jianshu.com/?t=http://node-swig.github.io/swig-templates/docs/tags/" target="_blank" rel="noopener">官方文档</a>，这里挑几个重点的经常见到的说说。</p>
</blockquote>
<h3 id="block标签"><a href="#block标签" class="headerlink" title="block标签"></a>block标签</h3><blockquote>
<p>用于声明一个代码块，继承的子模板中间可以改写或者拓展父模板中同名的代码块。也可查看#继承</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% block body %&#125;...&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>



<h3 id="if-else-endif和if-elseif-endif标签"><a href="#if-else-endif和if-elseif-endif标签" class="headerlink" title="if-else-endif和if-elseif-endif标签"></a><code>if-else-endif</code>和<code>if-elseif-endif</code>标签</h3><blockquote>
<p>这个与java中的if功能类似，做条件判断时使用。满足条件的内容将会被输出。</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> x|lower === <span class="string">'tacos'</span> %&#125;</span><br><span class="line">  You can use filters <span class="keyword">on</span> any operand <span class="keyword">in</span> the statement.</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> x <span class="keyword">in</span> y %&#125;</span><br><span class="line">  If x <span class="keyword">is</span> a value that <span class="keyword">is</span> present <span class="keyword">in</span> y, <span class="keyword">this</span> will <span class="keyword">return</span> <span class="literal">true</span>.</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> <span class="keyword">false</span> %&#125;</span><br><span class="line">  Tacos</span><br><span class="line">&#123;% <span class="keyword">elseif</span> <span class="keyword">true</span> %&#125;</span><br><span class="line">  Burritos</span><br><span class="line">&#123;% <span class="keyword">else</span> %&#125;</span><br><span class="line">  Churros</span><br><span class="line">&#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line"><span class="comment">// =&gt; Burritos</span></span><br></pre></td></tr></table></figure>



<h3 id="extends-标签"><a href="#extends-标签" class="headerlink" title="extends 标签"></a>extends 标签</h3><blockquote>
<p>使当前的模板继承一个父模板，这个标签必须位于模板的最前面。其他查看#继承</p>
</blockquote>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">extends</span> <span class="string">"./layout.html"</span> %&#125;</span><br></pre></td></tr></table></figure>

<h3 id="for标签"><a href="#for标签" class="headerlink" title="for标签"></a>for标签</h3><p>用于遍历对象和数组时使用。</p>
<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>可选</th>
<th>Default</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>key</td>
<td><code>literal</code></td>
<td>✔</td>
<td><code>undefined</code></td>
<td>A shortcut to the index of the array or current key accessor.</td>
</tr>
<tr>
<td>variable</td>
<td><code>literal</code></td>
<td></td>
<td><code>undefined</code></td>
<td>The current value will be assigned to this variable name temporarily. The variable will be reset upon ending the for tag.</td>
</tr>
<tr>
<td>in</td>
<td><code>literal</code></td>
<td></td>
<td><code>undefined</code></td>
<td>Literally, “in”. This token is required.</td>
</tr>
<tr>
<td>object</td>
<td><code>object</code></td>
<td></td>
<td><code>undefined</code></td>
<td>An enumerable object that will be iterated over.</td>
</tr>
</tbody></table>
<h4 id="Returns"><a href="#Returns" class="headerlink" title="Returns"></a>Returns</h4><p><code>loop.index</code>: The current iteration of the loop (1-indexed)</p>
<p><code>loop.index0</code>: The current iteration of the loop (0-indexed)</p>
<p><code>loop.revindex</code>: The number of iterations from the end of the loop (1-indexed)</p>
<p><code>loop.revindex0</code>: The number of iterations from the end of the loop (0-indexed)</p>
<p><code>loop.key</code>: If the iterator is an object, this will be the key of the current item, otherwise it will be the same as the loop.index.</p>
<p><code>loop.first</code>: True if the current object is the first in the object or array.</p>
<p><code>loop.last</code>: True if the current object is the last in the object or array.</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// obj = &#123; one: 'hi', two: 'bye' &#125;;</span><br><span class="line">&#123;% for x in obj %&#125;</span><br><span class="line">  &#123;% if loop.first %&#125;<span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;% endif %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; loop.index &#125;&#125; - &#123;&#123; loop.key &#125;&#125;: &#123;&#123; x &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  &#123;% if loop.last %&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span>&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">// =&gt; <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">//    <span class="tag">&lt;<span class="name">li</span>&gt;</span>1 - one: hi<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">//    <span class="tag">&lt;<span class="name">li</span>&gt;</span>2 - two: bye<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">//    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// arr = [1, 2, 3]</span></span><br><span class="line"><span class="comment">// Reverse the array, shortcut the key/index to `key`</span></span><br><span class="line">&#123;% <span class="keyword">for</span> key, <span class="keyword">val</span> <span class="keyword">in</span> arr|reverse %&#125;</span><br><span class="line">&#123;&#123; key &#125;&#125; -- &#123;&#123; <span class="keyword">val</span> &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"><span class="comment">// =&gt; 0 -- 3</span></span><br><span class="line"><span class="comment">//    1 -- 2</span></span><br><span class="line"><span class="comment">//    2 -- 1</span></span><br></pre></td></tr></table></figure>





<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><blockquote>
<p>Source: <a href="https://link.jianshu.com/?t=https://github.com/paularmstrong/swig/blob/v2.0.0/lib/tags/import.js" target="_blank" rel="noopener">lib/tags/import.js</a></p>
</blockquote>
<blockquote>
<p>允许你引入定义在别的文件当中的宏到你当前的模板文件当中。</p>
</blockquote>
<blockquote>
<p>The import tag is specifically designed for importing macros into your template with a specific context scope. This is very useful for keeping your macros from overriding template context that is being injected by your server-side page generation.</p>
</blockquote>
<h4 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Optional</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>file</td>
<td><code>string orvar</code></td>
<td></td>
<td><code>undefined</code></td>
<td>Relative path from the current template file to the file to import macros from.</td>
</tr>
<tr>
<td>as</td>
<td><code>literal</code></td>
<td></td>
<td><code>undefined</code></td>
<td>Literally, “as”.</td>
</tr>
<tr>
<td>varname</td>
<td><code>literal</code></td>
<td></td>
<td><code>undefined</code></td>
<td>Local-accessible object name to assign the macros to.</td>
</tr>
</tbody></table>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">import</span> <span class="string">'./formmacros.html'</span> <span class="keyword">as</span> form %&#125;</span><br><span class="line">&#123;&#123; form.input(<span class="string">"text"</span>, <span class="string">"name"</span>) &#125;&#125;</span><br><span class="line"><span class="comment">// =&gt; &lt;input type="text" name="name"&gt;</span></span><br><span class="line">&#123;% <span class="keyword">import</span> <span class="string">"../shared/tags.html"</span> <span class="keyword">as</span> tags %&#125;</span><br><span class="line">&#123;&#123; tags.stylesheet(<span class="string">'global'</span>) &#125;&#125;</span><br><span class="line"><span class="comment">// =&gt; &lt;link rel="stylesheet" href="/global.css"&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><blockquote>
<p>Comments注释在渲染时将会被忽略，他们在渲染之前就会移除，所以没人能看到你的注释，除非他们查看你的源代码。</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">&#123; <span class="meta">#</span></span><br><span class="line">This <span class="keyword">is</span> a comment.</span><br><span class="line">It will be fully stripped and ignored during parsing.</span><br><span class="line"><span class="meta"># &#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="空格控制符"><a href="#空格控制符" class="headerlink" title="空格控制符"></a>空格控制符</h2><blockquote>
<p>模板中的任何空格都会被输出在最终生成的页面上。然而，你可以使用空格控制符来消除空格。</p>
</blockquote>
<blockquote>
<p>在tag的前面或者后面添加<code>-</code>来移除前面或者后面的空格。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// seq = [1, 2, 3, 4, 5]</span></span><br><span class="line">&#123;% <span class="keyword">for</span> item in seq -%&#125;&#123;&#123; item &#125;&#125;</span><br><span class="line">&#123;%- <span class="keyword">endfor</span> %&#125;</span><br><span class="line"><span class="comment">// =&gt; 12345</span></span><br></pre></td></tr></table></figure>

<p><code>注意</code> 没有任何空格输出</p>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><blockquote>
<p>swig使用<code>extends</code>关键字来对模板进行继承</p>
</blockquote>
<ul>
<li>layout.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;% block title %&#125;My Site&#123;% endblock %&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  &#123;% block head %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"main.css"</span>&gt;</span></span><br><span class="line">  &#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  &#123;% block content %&#125;&#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>index.html</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">extends</span> <span class="string">'layout.html'</span> %&#125;</span><br><span class="line">&#123;% block title %&#125;My Page&#123;% endblock %&#125;</span><br><span class="line">&#123;% block head %&#125;</span><br><span class="line">  &#123;% parent %&#125;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"custom.css"</span>&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">&lt;p&gt;This <span class="keyword">is</span> just an awesome page.&lt;/p&gt;</span><br><span class="line">&#123;% endblock %&#125;d</span><br></pre></td></tr></table></figure>

<blockquote>
<p>模板<code>index.html</code>继承自<code>layout.html</code>，并且改写或者实现了其中的内容。</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h3><p><a href="https://www.jianshu.com/p/c5d333e6353c" target="_blank" rel="noopener">https://www.jianshu.com/p/c5d333e6353c</a><br><a href="http://node-swig.github.io/swig-templates/docs/api/#CacheOptionshttp://node-swig.github.io/swig-templates/docs/api/#CacheOptions" target="_blank" rel="noopener">http://node-swig.github.io/swig-templates/docs/api/#CacheOptionshttp://node-swig.github.io/swig-templates/docs/api/#CacheOptions</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>编程知识</category>
        <category>前端</category>
        <category>swig</category>
      </categories>
      <tags>
        <tag>编程知识</tag>
        <tag>前端</tag>
        <tag>swig</tag>
      </tags>
  </entry>
  <entry>
    <title>pip 常用命令与国内源配置</title>
    <url>/2020/03/30/coding/environment/pip-chinese-source/pip-chinese-source/</url>
    <content><![CDATA[<blockquote>
<p>pip默认源存在速度慢的问题，本文介绍pip命令添加国内源的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="pip常用命令"><a href="#pip常用命令" class="headerlink" title="pip常用命令"></a>pip常用命令</h3><h4 id="安装包"><a href="#安装包" class="headerlink" title="安装包"></a>安装包</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install Package</span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<h4 id="更新包"><a href="#更新包" class="headerlink" title="更新包"></a>更新包</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install -U Package</span><br></pre></td></tr></table></figure>

<h4 id="卸载包"><a href="#卸载包" class="headerlink" title="卸载包"></a>卸载包</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip uninstall Package</span><br></pre></td></tr></table></figure>

<h4 id="列出已安装软件"><a href="#列出已安装软件" class="headerlink" title="列出已安装软件"></a>列出已安装软件</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip list</span><br><span class="line">pip freeze</span><br><span class="line">pip freeze -r requirements.txt</span><br></pre></td></tr></table></figure>

<h4 id="某个包详细信息"><a href="#某个包详细信息" class="headerlink" title="某个包详细信息"></a>某个包详细信息</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip show -f Package</span><br></pre></td></tr></table></figure>

<h3 id="国内源配置"><a href="#国内源配置" class="headerlink" title="国内源配置"></a>国内源配置</h3><h4 id="常用的国内镜像"><a href="#常用的国内镜像" class="headerlink" title="常用的国内镜像"></a>常用的国内镜像</h4><ul>
<li>阿里云 <a href="http://mirrors.aliyun.com/pypi/simple/" target="_blank" rel="noopener">http://mirrors.aliyun.com/pypi/simple/</a></li>
<li>豆瓣<a href="http://pypi.douban.com/simple/" target="_blank" rel="noopener">http://pypi.douban.com/simple/</a></li>
<li>清华大学 <a href="https://pypi.tuna.tsinghua.edu.cn/simple/" target="_blank" rel="noopener">https://pypi.tuna.tsinghua.edu.cn/simple/</a></li>
<li>中国科学技术大学 <a href="http://pypi.mirrors.ustc.edu.cn/simple/" target="_blank" rel="noopener">http://pypi.mirrors.ustc.edu.cn/simple/</a></li>
<li>华中科技大学<a href="http://pypi.hustunique.com/" target="_blank" rel="noopener">http://pypi.hustunique.com/</a></li>
</ul>
<p><strong>新版ubuntu要求使用https源，要注意。</strong></p>
<blockquote>
<p>就我的经验来说阿里云是目前用下来最稳定可靠的。</p>
</blockquote>
<h4 id="临时使用"><a href="#临时使用" class="headerlink" title="临时使用"></a>临时使用</h4><blockquote>
<p>在使用pip的时候，加上参数 <code>-i</code> 和镜像地址</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install -i http://mirrors.aliyun.com/pypi/simple/ tensorboard</span><br></pre></td></tr></table></figure>

<blockquote>
<p>从清华源安装 tensorboard</p>
</blockquote>
<h4 id="命令配置"><a href="#命令配置" class="headerlink" title="命令配置"></a>命令配置</h4><blockquote>
<p>在终端输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install pip -U    # 升级pip到最新版本</span><br><span class="line">pip config set global.index-url http://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此方法配置后安装包时可能会提示下载源不可信，需要手动加上<code>--trusted-host mirrors.aliyun.com</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">The repository located at mirrors.aliyun.com is not a trusted or secure host and is being ignored. If this repository is available via HTTPS we recommend you use HTTPS instead, otherwise you may silence this warning and allow it anyway with &#39;--trusted-host mirrors.aliyun.com&#39;.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这样就不那么香了，一劳永逸的解决方案是修改pip配置文件</p>
</blockquote>
<h4 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h4><h5 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h5><blockquote>
<p>配置文件位置：</p>
</blockquote>
<ul>
<li> <code>~/.pip/pip.conf </code></li>
<li><code>~/.config/pip/pip.conf</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url &#x3D; http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F;</span><br><span class="line">trusted-host &#x3D; mirrors.aliyun.com</span><br></pre></td></tr></table></figure>

<h5 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h5><blockquote>
<p>配置文件位置：</p>
</blockquote>
<ul>
<li><code>%HOMEPATH%\pip\pip.ini</code>，即 <code>C:\Users\pip\pip.ini</code></li>
<li><code>%APPDATA%\pip\pip.ini</code>，即<code>C:\Users\AppData\Roaming\pip\pip.ini</code></li>
</ul>
<blockquote>
<p>可以通过在cmd中输入 <code>echo %APPDATA%</code> 或  <code>echo %HOMEPATH%</code> 查看自己的相关路径</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">[global]</span></span><br><span class="line"><span class="string">index-url</span> <span class="string">=</span> <span class="string">http://mirrors.aliyun.com/pypi/simple/</span></span><br><span class="line"><span class="string">[install]</span></span><br><span class="line"><span class="string">trusted-host</span> <span class="string">=</span> <span class="string">mirrors.aliyun.com</span></span><br></pre></td></tr></table></figure>

<h4 id="调整源地址"><a href="#调整源地址" class="headerlink" title="调整源地址"></a>调整源地址</h4><ul>
<li>将源地址修改为 <code>https</code> 也可以避免信任危机</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url &#x3D; https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F;</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>程序人生</category>
        <category>环境配置</category>
      </categories>
      <tags>
        <tag>程序人生</tag>
        <tag>环境配置</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -21- 添加相册系列 - 1- 框架设置</title>
    <url>/2020/03/29/next/21_add_photos/add-photos/</url>
    <content><![CDATA[<blockquote>
<p> Next 主题原生没有相册功能，我又是摄影爱好者，不得不下点功夫在这了。本系列介绍添加相册的方法，本文是开篇，记录Next主题下开启相册按钮和开启相应页面，后面的一边研究一边发。</p>
</blockquote>
<a id="more"></a>

<h2 id="Next设置"><a href="#Next设置" class="headerlink" title="Next设置"></a>Next设置</h2><ul>
<li>新建hexo page</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page photos</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将会在<code>source/</code>下创建<code>photos/index.md</code></p>
</blockquote>
<ul>
<li>在index.md中添加<code>type: photos</code></li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: photos</span><br><span class="line">date: 2020-03-22 23:03:55</span><br><span class="line">type: photos</span><br></pre></td></tr></table></figure>

<ul>
<li>修改<code>主题配置文件</code>，在<code>menu</code>字段中加入<code>photos: /photos/ || image</code></li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Usage: `Key: /link/ || icon`</span></span><br><span class="line"><span class="comment"># Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.</span></span><br><span class="line"><span class="comment"># Value before `||` delimiter is the target link, value after `||` delimiter is the name of Font Awesome icon.</span></span><br><span class="line"><span class="comment"># When running the site in a subdirectory (e.g. yoursite.com/blog), remove the leading slash from link value (/archives -&gt; archives).</span></span><br><span class="line"><span class="comment"># External url should start with http:// or https://</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="attr">photos:</span> <span class="string">/photos/</span> <span class="string">||</span> <span class="string">image</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">/sitemap.xml</span> <span class="string">||</span> <span class="string">sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<ul>
<li>修改 themes/next/languages/zh-Hans.yml，添加photos字段</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">首页</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">归档</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">分类</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">标签</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">关于</span></span><br><span class="line">  <span class="attr">search:</span> <span class="string">搜索</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">公益404</span></span><br><span class="line">  <span class="attr">something:</span> <span class="string">有料</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">站点地图</span></span><br><span class="line">  <span class="attr">photos:</span> <span class="string">相册</span></span><br></pre></td></tr></table></figure>

<ul>
<li>此时效果</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200329233209.png" alt="相册"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -12- 强制使用https协议</title>
    <url>/2020/03/28/hexo/12_force_https/force-https/</url>
    <content><![CDATA[<blockquote>
<p>https 是一种通过计算机网络进行安全通信的传输协议，经由HTTP进行通信，利用SSL/TLS建立全信道，加密数据包，相比与http更加安全。本文介绍Hexo博客强制用户https协议访问的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改-Pages-设置"><a href="#修改-Pages-设置" class="headerlink" title="修改 Pages 设置"></a>修改 Pages 设置</h2><blockquote>
<p>在hexo 挂载的pages中设置（例如我的是github pages），勾选 Enforce HTTPS</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200329221359.png" alt="pages"></p>
<blockquote>
<p>此时用户访问您链接时必须使用https协议</p>
</blockquote>
<h2 id="CDN加速设置"><a href="#CDN加速设置" class="headerlink" title="CDN加速设置"></a>CDN加速设置</h2><blockquote>
<p>设置了CDN加速的同志也要在相应的控制台进行设置，不然可能会因为pages强制https，但CDN没有这样的要求，使用http协议访问你的加速域名，当转到源时发现协议不对，又跳转使用源的原始链接，导致CDN加速失效。</p>
<p>进入控制台（我的是七牛云，具体加速设置参考：<a href="https://www.zywvvd.com/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/">Hexo -7- Github源七牛云CDN加速教程（详细）</a>）-&gt; CDN -&gt; 域名管理 -&gt; 配置相应的域名</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200329222035.png" alt="配置域名"></p>
<blockquote>
<p>修改Https配置</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200329222136.png" alt="Https配置"></p>
<blockquote>
<p>开启强制https</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200329222240.png" alt="强制https开关"></p>
<blockquote>
<p>配置完毕，用户只能用https访问你的站点了。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200329222408.png" alt="安全链接"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -11- 修改网站Logo</title>
    <url>/2020/03/28/hexo/11_change_logo/change-logo/</url>
    <content><![CDATA[<blockquote>
<p> Next 主题默认的网站logo是字母N，本文介绍如何更换成自己的logo。</p>
</blockquote>
<a id="more"></a>

<h2 id="编辑logo图像文件"><a href="#编辑logo图像文件" class="headerlink" title="编辑logo图像文件"></a>编辑logo图像文件</h2><blockquote>
<p>Next主题logo一共四个：</p>
<ul>
<li>16×16 png</li>
<li>32×32 png</li>
<li>180×180 png</li>
<li>512 ×512 svn</li>
</ul>
</blockquote>
<blockquote>
<p>设计好自己的logo后在前三种尺寸下保存成png</p>
</blockquote>
<blockquote>
<p>在 <a href="https://c.runoob.com/more/svgeditor/" target="_blank" rel="noopener">https://c.runoob.com/more/svgeditor/</a> 可以设计自己的svg图像</p>
</blockquote>
<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>将图像放入 themes -&gt; next -&gt; source -&gt; images 文件夹下，修改主题配置文件</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Site Information Settings</span></span><br><span class="line"><span class="comment"># See: https://theme-next.org/docs/getting-started/</span></span><br><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/logo-16.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/logo-32.png</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/logo-180.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">/images/logo-512.svg</span></span><br><span class="line">  <span class="comment">#android_manifest: /images/manifest.json</span></span><br><span class="line">  <span class="comment">#ms_browserconfig: /images/browserconfig.xml</span></span><br></pre></td></tr></table></figure>

<h2 id="效果示例"><a href="#效果示例" class="headerlink" title="效果示例"></a>效果示例</h2><p><img src="https://photos.zywvvd.com/image/20200329220315.png" alt="logo效果"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -20- 使用自定义样式 （custom style)</title>
    <url>/2020/03/28/next/20_custom_style/custom-style/</url>
    <content><![CDATA[<blockquote>
<p>Next主题允许用户使用自定义样式个性化设置自己网站的主题，本文介绍使用自定义样式的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>去掉<code>主题配置文件</code> 中<code>custom_file_path</code>字段<code>style</code>值的注释</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Define custom file paths.</span></span><br><span class="line"><span class="comment"># Create your custom files in site directory `source/_data` and uncomment needed files below.</span></span><br><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="comment">#head: source/_data/head.swig</span></span><br><span class="line">  <span class="comment">#header: source/_data/header.swig</span></span><br><span class="line">  <span class="comment">#sidebar: source/_data/sidebar.swig</span></span><br><span class="line">  <span class="comment">#postMeta: source/_data/post-meta.swig</span></span><br><span class="line">  <span class="comment">#postBodyEnd: source/_data/post-body-end.swig</span></span><br><span class="line">  <span class="comment">#footer: source/_data/footer.swig</span></span><br><span class="line">  <span class="comment">#bodyEnd: source/_data/body-end.swig</span></span><br><span class="line">  <span class="comment">#variable: source/_data/variables.styl</span></span><br><span class="line">  <span class="comment">#mixin: source/_data/mixins.styl</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">source/_data/styles.styl</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时我们已经允许博客运用<code>source/_data/styles.styl</code>中的样式，此处要说明的是，此处的source代表的是Hexo根目录的source文件夹，不是next主题中的source</p>
</blockquote>
<h2 id="创建样式文件"><a href="#创建样式文件" class="headerlink" title="创建样式文件"></a>创建样式文件</h2><blockquote>
<p>在Hexo -&gt; source文件夹下建立 <code>_data</code>文件夹，新建文件<code>styles.styl</code>文件，在文件中设置的css会被应用到站点中：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200328153349.png" alt="styles.styl"></p>
<blockquote>
<p>事实上在Next 7.7 主题中已经放置了用户自定义设置的styl文件，具体位置：</p>
<p>themes/next/source/css/custom.styl</p>
<p>将该文件内容复制到刚刚新建的<code>styles.styl</code>文件中，此时站点已经发生了一些变化</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200328153732.png" alt="styles.styl效果"></p>
<blockquote>
<p>文件中的注释很友好，用户可以方便地修改成自己喜欢的样式。</p>
</blockquote>
<h2 id="我的修改方案"><a href="#我的修改方案" class="headerlink" title="我的修改方案"></a>我的修改方案</h2><blockquote>
<p>我简单按照自己的想法配置了<code>styles.styl</code>文件：</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// Custom styles.</span><br><span class="line"></span><br><span class="line">// 网站最顶部条线的颜色</span><br><span class="line"><span class="selector-class">.headband</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#F2F4EF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置背景图片</span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">url</span>(/images/bg.png);</span><br><span class="line">    <span class="attribute">background-repeat</span>:no-repeat;</span><br><span class="line">    <span class="attribute">background-attachment</span>:fixed;</span><br><span class="line">    <span class="attribute">background-position</span>:center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置侧边栏左上角网站标题和副标题区颜色</span><br><span class="line"><span class="selector-class">.site-meta</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="number">#222222</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置侧边栏网站标题样式</span><br><span class="line"><span class="selector-class">.site-title</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置侧边栏网站标题鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.site-title</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">	<span class="attribute">letter-spacing</span>: <span class="number">0.4rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏网站副标题样式</span><br><span class="line"><span class="selector-class">.site-subtitle</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.site-author-image</span>&#123;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章标题鼠标悬浮下划线样式</span><br><span class="line"><span class="selector-class">.posts-expand</span> <span class="selector-class">.post-title-link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">	<span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scaleX</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">transition-duration</span>: <span class="number">0.2s</span>;</span><br><span class="line">    <span class="attribute">transition-timing-function</span>: ease-in-out;</span><br><span class="line">    <span class="attribute">transition-delay</span>: <span class="number">0s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章标题颜色</span><br><span class="line"><span class="selector-class">.posts-expand</span> <span class="selector-class">.post-title-link</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 阅读全文按钮样式</span><br><span class="line"><span class="selector-class">.btn</span> &#123;</span><br><span class="line">	<span class="attribute">border</span>:<span class="number">2px</span> solid <span class="number">#DfA710</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 阅读全文按钮鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置文章和侧边栏中链接样式</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.exturl</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">border-bottom-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改文章页侧边栏文章目录下面的第一个标题的鼠标悬浮样式</span><br><span class="line">// 真的有毒，文章目录第一个标题的样式还是单独设置的...一开始还没发现</span><br><span class="line"><span class="selector-class">.post-toc</span> <span class="selector-class">.nav</span> <span class="selector-class">.active-current</span> &gt; <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页面左边文章标题颜色</span><br><span class="line"><span class="selector-class">.post-toc</span> <span class="selector-tag">ol</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">border-bottom-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页面左边文章标题active时颜色</span><br><span class="line"><span class="selector-class">.post-toc</span> <span class="selector-class">.nav</span> <span class="selector-class">.active</span> &gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">border-bottom-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页侧边栏文章目录和站点概况鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.sidebar-nav</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页侧边栏文章目录和站点概况active时鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.sidebar-nav</span> <span class="selector-class">.sidebar-nav-active</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页侧边栏文章目录和站点概况active时样式</span><br><span class="line"><span class="selector-class">.sidebar-nav</span> <span class="selector-class">.sidebar-nav-active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">border-bottom-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 社交栏鼠标悬浮样式</span><br><span class="line"><span class="selector-id">#sidebar</span> <span class="selector-tag">div</span><span class="selector-class">.links-of-author</span><span class="selector-class">.motion-element</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 友链鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.sidebar</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.sidebar</span> <span class="selector-tag">span</span><span class="selector-class">.exturl</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-bottom-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// RSS文字颜色</span><br><span class="line">//#sidebar div.feed-link.motion-element &gt; a &#123;</span><br><span class="line">//  color: #DfA710;</span><br><span class="line">//&#125;</span><br><span class="line"></span><br><span class="line">// RSS图标颜色</span><br><span class="line">//#sidebar div.feed-link.motion-element &gt; a i&#123;</span><br><span class="line">//  color: #DfA710;</span><br><span class="line">//&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏日志、分类、标签 上面的数字的颜色</span><br><span class="line"><span class="selector-class">.site-state-item-count</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置底部文章分页数字鼠标悬浮上划线颜色</span><br><span class="line"><span class="selector-class">.pagination</span> <span class="selector-class">.prev</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.pagination</span> <span class="selector-class">.next</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.pagination</span> <span class="selector-class">.page-number</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-top-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置文章页上一篇文章和下一篇文章鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.post-nav-item</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改鼠标选中字符的颜色</span><br><span class="line"><span class="comment">/* webkit, opera, IE9 */</span></span><br><span class="line"><span class="selector-pseudo">::selection</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#DfA710</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7f7f7</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* firefox */</span></span><br><span class="line"><span class="selector-pseudo">::-moz-selection</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#DfA710</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7f7f7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏返回顶部按钮鼠标悬浮样式</span><br><span class="line"><span class="selector-class">.back-to-top</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 当页面处于 首页、标签、分类、归档、关于页面其中之一时，处于哪个页面哪个选项就变蓝</span><br><span class="line"><span class="selector-id">#menu</span> &gt; <span class="selector-tag">li</span><span class="selector-class">.menu-item-active</span> &gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏导航小圆点颜色</span><br><span class="line"><span class="selector-class">.menu-item-active</span> <span class="selector-tag">a</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-class">.menu</span> <span class="selector-class">.menu-item</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-class">.menu</span> <span class="selector-class">.menu-item</span> <span class="selector-tag">span</span><span class="selector-class">.exturl</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏上半部分设置为透明</span><br><span class="line"><span class="selector-class">.menu-item-active</span> <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-class">.menu</span> <span class="selector-class">.menu-item</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.menu</span> <span class="selector-class">.menu-item</span> <span class="selector-tag">span</span><span class="selector-class">.exturl</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">242</span>, <span class="number">242</span>, <span class="number">242</span>, <span class="number">0.30</span>);</span><br><span class="line">  border-bottom-color: rgba(255, 255, 255, 0.2);;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 侧边栏下半部分设置为透明</span><br><span class="line"><span class="selector-class">.sidebar</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sidebar-inner</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置底部文章分页部分为透明</span><br><span class="line"><span class="selector-class">.pagination</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pagination</span> <span class="selector-class">.page-number</span><span class="selector-class">.current</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 导航栏底部百分比透明</span><br><span class="line"><span class="selector-class">.back-to-top</span>,</span><br><span class="line"><span class="selector-class">.back-to-top</span><span class="selector-pseudo">:hover</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置文章背景透明度</span><br><span class="line"><span class="selector-class">.post-block</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 这里需要完全透明，不然就会在上面的0.2基础上再进行透明度计算</span><br><span class="line"><span class="selector-class">.btn</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header-inner</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main-inner</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.site-brand-container</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="number">#222222</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 代码区背景</span><br><span class="line"><span class="selector-class">.table-container</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">240</span>, <span class="number">240</span>, <span class="number">222</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.table-container</span> <span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">237</span>,<span class="number">237</span>, <span class="number">225</span>, <span class="number">0.03</span>);</span><br><span class="line">&#125;</span><br><span class="line">// 代码背景</span><br><span class="line"><span class="selector-tag">table</span> &gt; <span class="selector-tag">tbody</span> &gt; <span class="selector-tag">tr</span><span class="selector-pseudo">:nth-of-type(odd)</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span> &gt; <span class="selector-tag">tbody</span> &gt; <span class="selector-tag">tr</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">233</span>,<span class="number">230</span>, <span class="number">230</span>, <span class="number">0.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">pre</span>,</span><br><span class="line"><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">200</span>, <span class="number">31</span>, <span class="number">33</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">//代码行标背景</span><br><span class="line"><span class="selector-class">.highlight</span> <span class="selector-class">.gutter</span> <span class="selector-tag">pre</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgbargba</span>(<span class="number">227</span>, <span class="number">235</span>, <span class="number">227</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.highlight</span> <span class="selector-class">.code</span> <span class="selector-tag">pre</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">29</span>, <span class="number">31</span>, <span class="number">100</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 评论</span><br><span class="line"><span class="selector-class">.comments</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 文章页内作者信息</span><br><span class="line"><span class="selector-class">.post-copyright</span> &#123;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">3px</span> solid <span class="number">#DfA710</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 行内代码块的自定义样式 */</span></span><br><span class="line"><span class="selector-tag">code</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">239</span>, <span class="number">183</span>, <span class="number">48</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0px</span> solid <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 底部动态的叶子图标</span><br><span class="line"><span class="selector-class">.with-love</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 去掉文章白色背景</span><br><span class="line"><span class="selector-class">.main-inner</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 标签页链接下划线颜色</span><br><span class="line"><span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.exturl</span> &#123;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#DfA710</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 标签页链接鼠标悬浮颜色</span><br><span class="line"><span class="selector-class">.tag-cloud</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#DfA710</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中背景图像 bg.jpg 存放在主题source中的images文件夹内</p>
<p>初步效果：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200328182253.png" alt="示例效果"></p>
<h2 id="自定义修改样式"><a href="#自定义修改样式" class="headerlink" title="自定义修改样式"></a>自定义修改样式</h2><blockquote>
<p>当我们想修改页面的某个地方时，具体该添加哪个样式表呢？</p>
<p>解决这个问题可以用浏览器的调试工具（一般浏览器<code>F12</code>可以调出），查看感兴趣内容的名称，建立同名css可以覆盖原有样式，例如我要修改侧边栏导航部分的背景颜色</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200328174513.png" alt="查看元素名称"></p>
<blockquote>
<p>确定了元素名为 <code>header-inner</code>，在styles.styl中配置相应的css：</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.header-inner</span>&#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后，可以明显地看到效果</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200328174723.png" alt="修改效果"></p>
<blockquote>
<p>妈耶，赶紧改回来。</p>
<p>反正就是这么改的啦。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -19- 开启fancybox查看图片大图</title>
    <url>/2020/03/28/next/19_next_fancybox/next-fancybox/</url>
    <content><![CDATA[<blockquote>
<p>fancybox插件可以帮助我们查看博客大图，本文介绍Next 7.7.1 主题开启fancybox的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>开启 fancybox开关即可：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># FancyBox is a tool that offers a nice and elegant way to add zooming functionality for images.</span></span><br><span class="line"><span class="comment"># For more information: https://fancyapps.com/fancybox</span></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h2 id="示例效果"><a href="#示例效果" class="headerlink" title="示例效果"></a>示例效果</h2><p><img src="https://photos.zywvvd.com/image/20200328005031.png" alt="fancybox示例"></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>解决Ubuntu循环登陆问题 + Nvidia驱动、Cuda、Cudnn安装</title>
    <url>/2020/03/27/software/install/nvidia-install/nvidia-install/</url>
    <content><![CDATA[<blockquote>
<p>ubuntu系统显卡驱动偶尔会出现奇怪的问题，造成图形用户界面循环登陆，本文记录相关问题的解决方案。</p>
</blockquote>
<a id="more"></a>

<h3 id="卸载旧驱动"><a href="#卸载旧驱动" class="headerlink" title="卸载旧驱动"></a>卸载旧驱动</h3><ul>
<li>在登陆界面 ctrl+alt+F2 进入非图形界面控制台，登陆后输入命令：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove nvidia-*</span><br><span class="line">sudo apt-get autoremove</span><br><span class="line">sudo apt-get purge nvidia*</span><br></pre></td></tr></table></figure>

<h3 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h3><blockquote>
<p>加入PPA，然后更新库</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:graphics-drivers</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看适合本机的nvidia驱动</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ubuntu-drivers devices</span><br></pre></td></tr></table></figure>

<blockquote>
<p>选择合适自己的版本</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nvidia-driver-440 nvidia-settings nvidia-prime</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用nvidia-smi 查看是否已经读取到安装的驱动，如果提示没有找到命令重启后再试</p>
</blockquote>
<h3 id="安装Cuda"><a href="#安装Cuda" class="headerlink" title="安装Cuda"></a>安装Cuda</h3><blockquote>
<p>到Cuda <a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="noopener">下载地址</a>下载适合自己的Cuda文件，建议下载runfile格式，比如我下载的<code>cuda_10.2.89_440.33.01_linux.run</code>，在文件所在文件夹安装：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo sh cuda_10.2.89_440.33.01_linux.run</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>accept</li>
<li>n （不安装驱动）</li>
<li>y</li>
<li>y</li>
<li>y</li>
</ul>
</blockquote>
<blockquote>
<p>设置环境变量，在~/.bashrc 文件末尾加入：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export LD_LIBRARY_PATH&#x3D;$LD_LIBRARY_PATH:&#x2F;usr&#x2F;local&#x2F;cuda&#x2F;lib64</span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;cuda&#x2F;bin</span><br><span class="line">export CUDA_HOME&#x3D;$CUDA_HOME:&#x2F;usr&#x2F;local&#x2F;cuda</span><br></pre></td></tr></table></figure>

<blockquote>
<p>终端运行：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<blockquote>
<p>运行：nvcc –version，如果显示类似如下信息说明安装成功</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvcc: NVIDIA (R) Cuda compiler driver</span><br><span class="line">Copyright (c) 2005-2019 NVIDIA Corporation</span><br><span class="line">Built on Wed_Oct_23_19:24:38_PDT_2019</span><br><span class="line">Cuda compilation tools, release 10.2, V10.2.89</span><br></pre></td></tr></table></figure>

<h3 id="安装Cudnn"><a href="#安装Cudnn" class="headerlink" title="安装Cudnn"></a>安装Cudnn</h3><blockquote>
<p>到Cudnn<a href="https://developer.nvidia.com/rdp/form/cudnn-download-survey" target="_blank" rel="noopener">下载页面</a>下载与驱动、Cuda、需要运行软件要求相应的版本（需要注册Nvidia账号）。</p>
<p>Ubuntu可以下载<code>.solitairetheme8</code>格式文件，只要将扩展名改为<code>tgz</code>即可解压</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -xvf cudnn-10.2-linux-x64-v7.6.5.32.tgz</span><br></pre></td></tr></table></figure>

<blockquote>
<p>得到名为cuda的文件夹，在当前目录（不要进入cuda）运行：</p>
</blockquote>
<h4 id="Cudnn-version-lt-8-0"><a href="#Cudnn-version-lt-8-0" class="headerlink" title="Cudnn version &lt; 8.0"></a>Cudnn version &lt; 8.0</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cp cuda/include/cudnn.h /usr/local/cuda/include/</span><br><span class="line">sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64/</span><br><span class="line">sudo chmod a+r /usr/local/cuda/include/cudnn.h</span><br><span class="line">sudo chmod a+r /usr/local/cuda/lib64/libcudnn*</span><br></pre></td></tr></table></figure>

<blockquote>
<p>输入<code>cat /usr/local/cuda/include/cudnn.h | grep CUDNN_MAJOR -A 2</code>可查看版本</p>
</blockquote>
<h4 id="Cudnn-version-≥-8-0"><a href="#Cudnn-version-≥-8-0" class="headerlink" title="Cudnn version ≥ 8.0"></a>Cudnn version ≥ 8.0</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cp cuda/include/* /usr/local/cuda/include/</span><br><span class="line">sudo cp cuda/lib64/* /usr/local/cuda/lib64/</span><br><span class="line">sudo chmod +x /usr/local/cuda/include/cudnn.h</span><br><span class="line">sudo chmod +x /usr/local/cuda/lib64/libcudnn*</span><br></pre></td></tr></table></figure>

<blockquote>
<p>输入<code>cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2</code>可以查看版本</p>
</blockquote>
<h3 id="安装测试"><a href="#安装测试" class="headerlink" title="安装测试"></a>安装测试</h3><blockquote>
<p>查看显卡信息：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看Cuda版本：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看Cudnn版本</p>
</blockquote>
<p>cudnn version &lt; 8.0</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /usr/local/cuda/include/cudnn.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure>

<p>cudnn version ≥ 8.0</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;local&#x2F;cuda&#x2F;include&#x2F;cudnn_version.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>软件安装</category>
        <category>故障排除</category>
      </categories>
      <tags>
        <tag>故障排除</tag>
        <tag>软件</tag>
        <tag>软件安装</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -10- 使用PicGo配合七牛云图床实现Markdown图像无痛管理</title>
    <url>/2020/03/26/hexo/10_using_picgo/using-picgo/</url>
    <content><![CDATA[<blockquote>
<p> 在七牛云图床搭建好的情况下，我们可以有地方存放Markdown中的图像，而且速度很快，不占用Pages的空间，但是生成图像手动上传，名称管理实在是让人头疼。为了让图床管理不再反人类，PicGo应运而生，本文介绍PicGo结合七牛云管理Hexo图片的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>Hexo博客搭建并挂载在服务器</li>
<li>申请七牛云并搭建好图床，方法参考<a href="https://www.zywvvd.com/2020/03/25/hexo/9_add_image_bed/add-image-bed/">Hexo -9- 添加七牛云图床</a></li>
</ul>
<h2 id="工具下载"><a href="#工具下载" class="headerlink" title="工具下载"></a>工具下载</h2><ul>
<li><p>下载地址： <a href="https://github.com/Molunerfinn/PicGo/releases" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases</a></p>
</li>
<li><p>当前最高版本 2.2.2</p>
</li>
<li><p>Windows 下载 <a href="https://github.com/Molunerfinn/PicGo/releases/download/v2.2.2/PicGo-Setup-2.2.2.exe" target="_blank" rel="noopener">PicGo-Setup-2.2.2.exe</a></p>
</li>
<li><p>Max 下载 <a href="https://github.com/Molunerfinn/PicGo/releases/download/v2.2.2/PicGo-2.2.2-mac.zip" target="_blank" rel="noopener">PicGo-2.2.2-mac.zip</a></p>
</li>
<li><p>Linux 下载 <a href="https://github.com/Molunerfinn/PicGo/releases/download/v2.2.2/PicGo-2.2.2.AppImage" target="_blank" rel="noopener">PicGo-2.2.2.AppImage</a></p>
</li>
</ul>
<h2 id="AppImage"><a href="#AppImage" class="headerlink" title="AppImage"></a>AppImage</h2><blockquote>
<p>AppImage是个啥？</p>
<p>资料来源：<a href="https://blog.csdn.net/aboutmn/article/details/87254930" target="_blank" rel="noopener">https://blog.csdn.net/aboutmn/article/details/87254930</a></p>
</blockquote>
<ul>
<li><p>AppImage 使用通用的软件格式，通过将整个软件打包成AppImage,一个包包含了所有的功能. 并且几乎可以在所有的linux发行版本中使用。</p>
</li>
<li><p>通常我们安装linux软件将会在不同的目录生成多个文件，并且需要root权限来对系统进行修改。</p>
</li>
<li><p>AppImage 不需要这么做。事实上，AppImage 并不需要安装。AppImage 是一个压缩的镜像文件，它包含所有运行所需要的依赖和库文件。</p>
</li>
<li><p>你可以直接执行AppImage 文件不需要安装。当你把AppImage 文件删除，整个软件也被删除了。你可以把它当成windows系统中的那些免安装的exe文件。</p>
</li>
<li><p>优点：</p>
<ul>
<li>可以运行在各种平台</li>
<li>不需要安装，直接执行</li>
<li>不需要root权限，不需要修改系统文件</li>
<li>便携性：可以在位置执行</li>
<li>App 只读</li>
<li>卸载便利，只需要删除AppImage文件即可</li>
</ul>
</li>
<li><p>使用AppImage 文件</p>
<ul>
<li>下载AppImage 文件</li>
<li>赋予可执行权限</li>
<li>双击或者在命令行中执行</li>
</ul>
</li>
</ul>
<h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><blockquote>
<p>在程序中上传剪贴板图片需要用到xclip</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install xclip</span><br></pre></td></tr></table></figure>



<h2 id="图床设置"><a href="#图床设置" class="headerlink" title="图床设置"></a>图床设置</h2><ul>
<li>运行程序，仔细找找，会发现桌面多了个蓝方块，不要慌乱，这就是PicGo</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326230922.png" alt="PicGo 迷你形态"></p>
<ul>
<li>在方块上右键 -&gt; 打开详细窗口 -&gt; 图床设置 -&gt; 七牛图床</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326231131.png" alt="七牛图床设置"></p>
<ul>
<li>其中AccessKey在七牛云控制台 -&gt; 头像 -&gt; 个人中心</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326231309.png" alt="个人中心"></p>
<ul>
<li>密钥管理中SecretKey保管好，这是私钥不宜外传</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326231405.png" alt="秘钥管理"></p>
<ul>
<li><p>存储空间名称为七牛云空间名称</p>
</li>
<li><p>访问网址为七牛云外链域名，我们已经在配置七牛云时设置成了空间加速域名</p>
</li>
<li><p>存储区域填写相应代号</p>
</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326231725.png" alt="存储区域代号"></p>
<ul>
<li>剩下两项根据个人情况填，但不建议填后缀，毕竟文件后缀都是根据图片改变的</li>
<li>确定 -&gt; 设置为默认图床，此时图床配置已经成功</li>
</ul>
<h2 id="其他设置"><a href="#其他设置" class="headerlink" title="其他设置"></a>其他设置</h2><blockquote>
<p>因为我们大多的应用场景是在Markdown中加入图片链接，我们更需要PicGo直接将图片链接编辑为Markdown支持的图片格式，但自带的Markdown格式不包含协议，不带https://，因此我们自己设置。</p>
</blockquote>
<ul>
<li>PicGo设置 -&gt; 自定义链接设置</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326232155.png" alt="自定义链接"></p>
<ul>
<li>设置格式为<code>![](https://$url)</code></li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326232244.png" alt="自定义格式"></p>
<ul>
<li>同时建议设置成时间戳重命名，保证图片不会重复</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326232705.png"></p>
<ul>
<li>回到上传区 -&gt; 将链接格式改为 Custom，此后每次上传图片后会复制相应格式的链接到剪贴板</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326232447.png" alt="链接格式"></p>
<ul>
<li>PicGo设置 -&gt; 修改快捷键，将上传设置成自己的快捷键</li>
</ul>
<p><img src="https://photos.zywvvd.com/image/20200326232942.png" alt="快捷键"></p>
<h2 id="无痛添加图片流程"><a href="#无痛添加图片流程" class="headerlink" title="无痛添加图片流程"></a>无痛添加图片流程</h2><ul>
<li><p>从此以后我们添加图片的流程为：</p>
<ul>
<li>Ctrl+Alt+A 截图 -&gt; 画框 -&gt; 编号 -&gt; 马赛克 -&gt; 写字 -&gt; Enter将图片添加到剪贴板 （还没有这种体验的同学参考<a href="https://www.zywvvd.com/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/">Ubuntu 软件<strong>推荐</strong> - 截图利器 flameshot-具有快捷键自由截图、截图涂鸦、截图添加文字等功能</a>）</li>
<li>Ctrl+Shift+Q 上传图片</li>
<li>Ctrl+V 粘贴链接</li>
</ul>
</li>
</ul>
<p><strong>舒服 。。。</strong></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -9- 添加七牛云图床</title>
    <url>/2020/03/25/hexo/9_add_image_bed/add-image-bed/</url>
    <content><![CDATA[<blockquote>
<p>Hexo 博客挂载在网页服务器上会出现图像加载缓慢、存储空间有限的问题，在各大网络加速运营商提供的图床服务可以有效解决此类问题，由于七牛云服务器物美价廉，还有免费10g空间，本文介绍使用七牛云作为Hexo图床的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>已经准备好了Hexo博客并挂载在某个服务器</li>
<li>申请<a href="https://www.qiniu.com/" target="_blank" rel="noopener">七牛云</a>账号</li>
<li>申请域名并备案</li>
</ul>
<h2 id="创建七牛云空间"><a href="#创建七牛云空间" class="headerlink" title="创建七牛云空间"></a>创建七牛云空间</h2><blockquote>
<p>创建空间</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/20200326000626.png" alt="创建空间"></p>
<blockquote>
<p>填写配置信息</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/20200326001145.png" alt="配置信息"></p>
<blockquote>
<p>创建二级域名，例如我的 ：photos.zywvvd.com ，并申请相应的ssl证书，具体可参考<a href="https://www.zywvvd.com/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/#%E7%94%B3%E8%AF%B7SSL%E5%85%8D%E8%B4%B9%E8%AF%81%E4%B9%A6%EF%BC%88%E8%B2%8C%E4%BC%BC%E5%8F%AF%E9%80%89%EF%BC%89">SSL免费证书申请</a>。</p>
<p>配置加速域名：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326001555.png"></p>
<blockquote>
<p>信息设置</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326002037.png" alt="配置其余信息"></p>
<blockquote>
<p>图床默认域名设置，将文件管理-&gt; 默认域名设置为我们加速的二级域名：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326002404.png" alt="默认域名配置"></p>
<blockquote>
<p>域名运营商处将空间CNAME添加到加速二级域名的CNAME值中：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326002718.png" alt="复制CNAME值"></p>
<p><img src="https://photos.zywvvd.com/image/20200326002829.png" alt="域名设置"></p>
<blockquote>
<p>此时七牛云空间CNAME验证成功，图床搭建完毕</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326002914.png" alt="配置成功"></p>
<blockquote>
<p>选择文件管理中的上传图片即可将图像放置到图床管理：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326003021.png" alt="上传图片"></p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><blockquote>
<p>此时查看图片详情获取图像链接，在浏览器输入可以看到相应图像内容：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200326003133.png" alt="图像示例"></p>
<h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><blockquote>
<p>图床是博客图片长期管理的重要基石，但手动上传管理图像实在反人类，参考<a href="https://www.zywvvd.com/2020/03/26/hexo/10_using_picgo/using-picgo/">Hexo -10- 使用PicGo配合七牛云图床实现Markdown图像无痛管理</a>有效解决图床图片管理的问题。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -18- 添加代码复制按钮</title>
    <url>/2020/03/23/next/18_next_add_codecopy/next_add_codecopy/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍Next 7.7.1 主题添加代码复制按钮的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>配置copy_button字段：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Add copy button on codeblock</span></span><br><span class="line"><span class="attr">copy_button:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Show text copy result.</span></span><br><span class="line">  <span class="attr">show_result:</span> <span class="string">default</span></span><br><span class="line">  <span class="comment"># Available values: default | flat | mac</span></span><br><span class="line">  <span class="attr">style:</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>设置 enable 为 true，show_result为default。</p>
</blockquote>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><img src="/2020/03/23/next/18_next_add_codecopy/next_add_codecopy/xiaoguo.png" class="" title="配置效果">

<blockquote>
<p>复制成功后按钮会有状态变化提示。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -17- 添加文章版权声明</title>
    <url>/2020/03/23/next/17_next_add_copyright/add-copyright/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍Next 7.7.1 主题添加版权声明的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>开启版权需要 license 不为false 并且 post 不为 false，我们在此把 post 设置为 true 就好：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Creative Commons 4.0 International License.</span></span><br><span class="line"><span class="comment"># See: https://creativecommons.org/share-your-work/licensing-types-examples</span></span><br><span class="line"><span class="comment"># Available values of license: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span></span><br><span class="line"><span class="comment"># You can set a language value if you prefer a translated version of CC license, e.g. deed.zh</span></span><br><span class="line"><span class="comment"># CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.org</span></span><br><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>尝试通过修改设定更改语言失败了。</p>
</blockquote>
<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><img src="/2020/03/23/next/17_next_add_copyright/add-copyright/xiaoguo.png" class="" title="效果示例">

<h2 id="进阶升级"><a href="#进阶升级" class="headerlink" title="进阶升级"></a>进阶升级</h2><blockquote>
<p>如果不想使用英文版只好手动更改源码，将<code>themes/next/layout/_partials/post/post-copyright.swig</code>文件内容替换为：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;%- set ccIcon = '<span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-fw fa-creative-commons"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>' %&#125;</span><br><span class="line">&#123;%- set ccText = theme.creative_commons.license | upper %&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"post-copyright"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"post-copyright-author"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>本文标题&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&#123; page.title &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>文章作者&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&#123; theme.author &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>发布时间&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&#123; page.date.format("YYYY年MM月DD日 - HH:mm:ss") &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>最后更新&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>&#123;&#123; page.updated.format("YYYY年MM月DD日 - HH:mm:ss") &#125;&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>原始链接&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(page.path) &#125;&#125;"</span> <span class="attr">title</span>=<span class="string">"&#123;&#123; page.title &#125;&#125;"</span>&gt;</span>&#123;&#123; page.permalink &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>许可协议&amp;nbsp:&amp;nbsp&amp;nbsp<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-creative-commons"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">rel</span>=<span class="string">"license"</span> <span class="attr">href</span>=<span class="string">"https://creativecommons.org/licenses/by-nc-nd/4.0/"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">title</span>=<span class="string">"Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)"</span>&gt;</span>署名-非商业性使用-禁止演绎 4.0 国际<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 转载请保留原文链接及作者<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br><span class="line">	</span><br><span class="line">   <span class="comment">&lt;!-- &lt;strong&gt;&#123;&#123; __('post.copyright.author') + __('symbol.colon') &#125;&#125; &lt;/strong&gt;</span></span><br><span class="line"><span class="comment">    &#123;&#123;- page.author or author &#125;&#125;</span></span><br><span class="line"><span class="comment">  &lt;/li&gt;</span></span><br><span class="line"><span class="comment">  &lt;li class="post-copyright-link"&gt;</span></span><br><span class="line"><span class="comment">    &lt;strong&gt;&#123;&#123; __('post.copyright.link') + __('symbol.colon') &#125;&#125;&lt;/strong&gt;</span></span><br><span class="line"><span class="comment">    &#123;&#123; next_url(page.permalink, page.permalink, &#123;title: page.title&#125;) &#125;&#125;</span></span><br><span class="line"><span class="comment">  &lt;/li&gt;</span></span><br><span class="line"><span class="comment">  &lt;li class="post-copyright-license"&gt;</span></span><br><span class="line"><span class="comment">    &lt;strong&gt;&#123;&#123; __('post.copyright.license_title') + __('symbol.colon') &#125;&#125; &lt;/strong&gt;</span></span><br><span class="line"><span class="comment">    &#123;&#123;- __('post.copyright.license_content', next_url(ccURL, ccIcon + ccText)) &#125;&#125;</span></span><br><span class="line"><span class="comment">  &lt;/li&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="新版效果"><a href="#新版效果" class="headerlink" title="新版效果"></a>新版效果</h3><img src="/2020/03/23/next/17_next_add_copyright/add-copyright/xiaoguo2.png" class="" title="进阶版效果示例"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -16- 添加搜索功能</title>
    <url>/2020/03/21/next/16_next_add_search/next-add-search/</url>
    <content><![CDATA[<blockquote>
<p> 本文介绍开启 Next 主题站内搜索功能的方法。</p>
</blockquote>
<a id="more"></a>

<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><blockquote>
<p>安装插件<code>hexo-generator-searchdb</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<blockquote>
<p>确定插件安装过程中，没有错误，不然生成站点可能会有搜索框显示问题。</p>
</blockquote>
<h3 id="修改站点配置文件"><a href="#修改站点配置文件" class="headerlink" title="修改站点配置文件"></a>修改站点配置文件</h3><blockquote>
<p>添加内容：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Search </span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">./public/search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure>



<h3 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h3><blockquote>
<p>修改主题配置文件，开启站内搜索开关：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Local Search</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/hexo-generator-searchdb</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">7</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<h3 id="生成站点"><a href="#生成站点" class="headerlink" title="生成站点"></a>生成站点</h3><blockquote>
<p>生成 hexo 站点，建议先清理public文件夹，避免显示异常的问题：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>



<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><blockquote>
<p>成功后可以搜索站内内容：</p>
</blockquote>
<img src="/2020/03/21/next/16_next_add_search/next-add-search/search.png" class="" title="本地搜索"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -15- 增加赞赏功能</title>
    <url>/2020/03/21/next/15_add_reward/next-add-reward/</url>
    <content><![CDATA[<blockquote>
<p> 赞赏啊，是一个博客里的摆设功能。<br> 本文介绍如何在Hexo Next主题中加入赞赏。</p>
</blockquote>
<a id="more"></a>

<h3 id="获取支付码"><a href="#获取支付码" class="headerlink" title="获取支付码"></a>获取支付码</h3><blockquote>
<p>在微信、支付宝中拿到赞赏码、付款码图片，放入themes/next/source/images文件夹中。</p>
<p>比如我的是 wechatpay.png和alipay.jpg</p>
</blockquote>
<h3 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h3><blockquote>
<p>修改主题配置文件：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Reward (Donate)</span></span><br><span class="line"><span class="comment"># Front-matter variable (unsupport animation).</span></span><br><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="comment"># If true, reward will be displayed in every article by default.</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span> <span class="comment"># 开启后鼠标放到图片上文字不停抖动，不建议开启</span></span><br><span class="line">  <span class="attr">comment:</span> <span class="string">您的支持是我前进的最大动力！</span></span><br><span class="line"></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">/images/wechatpay.png</span></span><br><span class="line">  <span class="attr">alipay:</span> <span class="string">/images/alipay.jpg</span></span><br><span class="line">  <span class="comment">#paypal: /images/paypal.png</span></span><br><span class="line">  <span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure>

<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><blockquote>
<p>生成hexo 后，在每篇文章下方都出现了donate按钮，点击会展开：</p>
</blockquote>
<img src="/2020/03/21/next/15_add_reward/next-add-reward/donate.png" class="" title="设置效果">

<h3 id="翻译"><a href="#翻译" class="headerlink" title="翻译"></a>翻译</h3><blockquote>
<p>如果你不喜欢Donate、 Wechat Pay 和 Alipay这样的字眼，可以在 themes/next/languages/zh-Hans.yml 中添加字段进行翻译：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">donate:</span> <span class="string">赏</span></span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">微</span> <span class="string">信</span></span><br><span class="line">  <span class="attr">alipay:</span> <span class="string">支付宝</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>翻译后就是现在的效果：</p>
</blockquote>
<center>↓↓↓</center><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -8- 生成 sitemap 提交给Google、百度站长</title>
    <url>/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/</url>
    <content><![CDATA[<blockquote>
<p> 为了成功引起搜索引擎的注意，我们主动生成供其抓取的文件，本文介绍hexo博客创建sitemap的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="生成Sitemap"><a href="#生成Sitemap" class="headerlink" title="生成Sitemap"></a>生成Sitemap</h2><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><blockquote>
<p>安装普通 sitemap 和百度 sitemap 两种：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure>

<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><blockquote>
<p>修改站点配置文件，加入：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">plugins:</span> </span><br><span class="line">  <span class="string">hexo-generator-baidu-sitemap</span></span><br><span class="line">  <span class="string">hexo-generator-sitemap</span></span><br><span class="line"></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>确认站点配置中url和root的正确性，站点地图会根据url生成完整的链接</p>
</blockquote>
<h4 id="可选操作"><a href="#可选操作" class="headerlink" title="可选操作"></a>可选操作</h4><blockquote>
<p>修改Next 主题配置文件，打开菜单字段中的站点地图：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">/sitemap.xml</span> <span class="string">||</span> <span class="string">sitemap</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改themes/next/languages/zh-Hans.yml，添加字段：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">sitemap:</span> <span class="string">站点地图</span></span><br></pre></td></tr></table></figure>

<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/side.png" class="" title="侧边栏站点地图按钮">

<h3 id="生成xml文件"><a href="#生成xml文件" class="headerlink" title="生成xml文件"></a>生成xml文件</h3><blockquote>
<p>生成Hexo站点，会在public文件夹中创建baidusitemap.xml 和 sitemap.xml文件</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/sitemap.png" class="" title="sitemap文件">

<blockquote>
<p> 在浏览器中输入 <a href="https://www.zywvvd.com/sitemap.xml">https://www.zywvvd.com/sitemap.xml</a> 和 <a href="https://www.zywvvd.com/baidusitemap.xml">https://www.zywvvd.com/baidusitemap.xml</a> 已经可以看到自己的站点地图了。</p>
</blockquote>
<h2 id="提交Google站长"><a href="#提交Google站长" class="headerlink" title="提交Google站长"></a>提交Google站长</h2><blockquote>
<p>有了sitemap比没有要更容易被收录，但是相比于主动提交给搜索引擎效率就差很多了，因此我们将生成的map先提交给google</p>
</blockquote>
<h3 id="查看站点是否被google收录"><a href="#查看站点是否被google收录" class="headerlink" title="查看站点是否被google收录"></a>查看站点是否被google收录</h3><blockquote>
<p>google搜索site:域名即可：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/googlesite.png" class="" title="查询谷歌收录情况">

<h3 id="添加网址"><a href="#添加网址" class="headerlink" title="添加网址"></a>添加网址</h3><blockquote>
<p> 进入<a href="https://www.google.com/webmasters" target="_blank" rel="noopener">Google Search Console</a>，用谷歌账号登录，此时需要选择添加搜索的网址类型，我们申请的域名一般都是域级别的，比如我的 zywvvd.com ，可以建立不同前缀的二级域名，因此我们选择<code>网域</code>：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/googleyanzheng.png" class="" title="添加网域">

<blockquote>
<p> 为防止恶意使用该功能，需要验证网域所有权，默认方式通过DNS验证，我们就用这种方法：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/googleyz.png" class="" title="DNS验证">

<blockquote>
<p>将google提供的TXT添加到域名的@解析当中：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/baiduyz.png" class="" title="添加TXT字段">

<blockquote>
<p>等一会点击验证即可通过：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/chenggong.png" class="" title="完成验证">

<h3 id="添加站点地图"><a href="#添加站点地图" class="headerlink" title="添加站点地图"></a>添加站点地图</h3><blockquote>
<p>选择带前缀的地址 ：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/www.png" class="" title="选择地址">

<blockquote>
<p>选择站点地图，并添加刚刚生成的sitemap.xml即可</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/zd.png" class="" title="站点地图">

<blockquote>
<p>可以看到站点地图解析成功：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/googlechenggong.png" class="" title="添加成功">

<h2 id="提交百度站长"><a href="#提交百度站长" class="headerlink" title="提交百度站长"></a>提交百度站长</h2><blockquote>
<p>国内还是百度最好用了，我们也把地图给百度站长。</p>
<p>参考：<a href="https://zhuanlan.zhihu.com/p/100922816" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/100922816</a></p>
</blockquote>
<h3 id="查看网站是否被收录"><a href="#查看网站是否被收录" class="headerlink" title="查看网站是否被收录"></a>查看网站是否被收录</h3><blockquote>
<p>百度搜索 site: 域名可以查看</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/sousuo.png" class="" title="是否收录">

<h3 id="添加网址-1"><a href="#添加网址-1" class="headerlink" title="添加网址"></a>添加网址</h3><blockquote>
<p>百度提交<a href="https://ziyuan.baidu.com/site/index" target="_blank" rel="noopener">网址入口</a>，用百度账号登录后，还是添加网站的过程</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/tianjiabd.png" class="" title="百度添加网站">

<blockquote>
<p>补充个人信息后，来到第一步输入网站，建议为www前缀：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/bdwangzhan.png" class="" title="录入网站">

<blockquote>
<p>第二步根据个人情况填写信息，每个月只能改一次，确定就好；</p>
<p>第三步选择我们已经熟悉的CNAME验证，根据给定的前缀建立解析，类型CNAME，值填 ziyuan.baidu.com</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/bdcname.png" class="" title="百度CNAME验证">

<blockquote>
<p>点击验证即可：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/bdchenggong.png" class="" title="百度验证成功">

<h3 id="提交百度搜索的不同方式"><a href="#提交百度搜索的不同方式" class="headerlink" title="提交百度搜索的不同方式"></a>提交百度搜索的不同方式</h3><blockquote>
<p>百度提供了自动提交和手动提交两种方式，其中自动提交又分为主动推送、自动推送和 sitemap 三种方式，以下是官方给出的解释：</p>
</blockquote>
<ul>
<li>主动推送：最为快速的提交方式，推荐您将站点当天新产出链接立即通过此方式推送给百度，以保证新链接可以及时被百度收录</li>
<li>自动推送：是轻量级链接提交组件，将自动推送的 JS 代码放置在站点每一个页面源代码中，当页面被访问时，页面链接会自动推送给百度，有利于新页面更快被百度发现</li>
<li>sitemap：您可以定期将网站链接放到sitemap中，然后将sitemap提交给百度。百度会周期性的抓取检查您提交的sitemap，对其中的链接进行处理，但收录速度慢于主动推送</li>
<li>手动提交：如果您不想通过程序提交，那么可以采用此种方式，手动将链接提交给百度</li>
</ul>
<blockquote>
<p>四种提交方式对比：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/zh.jpg" class="" title="提交方式对比">

<h3 id="主动推送"><a href="#主动推送" class="headerlink" title="主动推送"></a>主动推送</h3><h4 id="安装插件-1"><a href="#安装插件-1" class="headerlink" title="安装插件"></a>安装插件</h4><blockquote>
<p>安装插件：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-baidu-url-submit --save</span><br></pre></td></tr></table></figure>

<h4 id="配置站点配置文件"><a href="#配置站点配置文件" class="headerlink" title="配置站点配置文件"></a>配置站点配置文件</h4><blockquote>
<p>向站点配置文件加入：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">baidu_url_submit:</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">1</span>              <span class="comment"># 提交最新的多少个链接</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">www.zywvvd.com</span>    <span class="comment"># 在百度站长平台中添加的域名</span></span><br><span class="line">  <span class="attr">token:</span> <span class="string">YQlkVp*******</span>      <span class="comment"># 秘钥</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">baidu_urls.txt</span>   <span class="comment"># 文本文档的地址， 新链接会保存在此文本文档里</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中的 token 可以在【链接提交】-【自动提交】-【主动推送】下面看到，接口调用地址最后面 token=xxxxx 即为你的 token</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/token.png" class="" title="token">

<blockquote>
<p>加入新的deployer：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:zywvvd/zywvvd.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">baidu_url_submitter</span></span><br></pre></td></tr></table></figure>

<h4 id="推送网址"><a href="#推送网址" class="headerlink" title="推送网址"></a>推送网址</h4><blockquote>
<p>此后每次hexo d都会将最新的1条网址推送给百度，而且成功时会有标识：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&#123;"remain":2997,"success":1&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>表示成功推送一条，今天还能推2997条。</p>
</blockquote>
<h3 id="自动推送"><a href="#自动推送" class="headerlink" title="自动推送"></a>自动推送</h3><blockquote>
<p>在网站中加入如下代码：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> theme.baidu_push %&#125;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bp = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    <span class="keyword">var</span> curProtocol = <span class="built_in">window</span>.location.protocol.split(<span class="string">':'</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (curProtocol === <span class="string">'https'</span>) &#123;</span><br><span class="line">        bp.src = <span class="string">'https://zz.bdstatic.com/linksubmit/push.js'</span>;        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        bp.src = <span class="string">'http://push.zhanzhang.baidu.com/push.js'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>)[<span class="number">0</span>];</span><br><span class="line">    s.parentNode.insertBefore(bp, s);</span><br><span class="line">&#125;)();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&#123;% endif %&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码在Next主题中已经集成，在 7.7.1中，代码位于 themes/next/layout/_third-party/baidu-push.swig文件中，仅需修改主题配置文件即可：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO.</span></span><br><span class="line"><span class="attr">baidu_push:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h3 id="提交Sitemap"><a href="#提交Sitemap" class="headerlink" title="提交Sitemap"></a>提交Sitemap</h3><blockquote>
<p>选择搜索服务的链接提交：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/ljtj.png" class="" title="链接提交">

<blockquote>
<p>在自动提交- sitemap 中添加我们的sitemap链接即可：</p>
</blockquote>
<img src="/2020/03/21/hexo/8_hexo_generate_sitemap/generate-sitemap/bdst.png" class="" title="sitemap提交">

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -14- 为Hexo Next7.7.1 添加RSS （带按钮）</title>
    <url>/2020/03/20/next/14_add_rss/next-add-rss/</url>
    <content><![CDATA[<blockquote>
<p>Next 7.7 将RSS按钮的代码删掉了，按照以往添加RSS的方法设置后可以生成xml文件，但没有按钮。本文介绍在Next 7.7 添加带按钮的RSS方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="添加RSS"><a href="#添加RSS" class="headerlink" title="添加RSS"></a>添加RSS</h2><h3 id="安装插件-hexo-generator-feed"><a href="#安装插件-hexo-generator-feed" class="headerlink" title="安装插件 hexo-generator-feed"></a>安装插件 hexo-generator-feed</h3><blockquote>
<p>在hexo 目录运行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure>

<h3 id="配置站点配置文件"><a href="#配置站点配置文件" class="headerlink" title="配置站点配置文件"></a>配置<code>站点配置文件</code></h3><blockquote>
<p>在站点配置文件添加：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">plugins:</span> <span class="string">hexo-generate-feed</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># rss配置</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">20</span></span><br><span class="line">  <span class="attr">hub:</span></span><br><span class="line">  <span class="attr">content:</span></span><br><span class="line">  <span class="attr">content_limit:</span> <span class="number">140</span></span><br><span class="line">  <span class="attr">content_limit_delim:</span> <span class="string">' '</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br></pre></td></tr></table></figure>

<h3 id="配置Next主题配置文件"><a href="#配置Next主题配置文件" class="headerlink" title="配置Next主题配置文件"></a>配置Next<code>主题配置文件</code></h3><blockquote>
<p>主题配置文件默认没有rss字段，需要自己手动添加</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set rss to false to disable feed link.</span></span><br><span class="line"><span class="comment"># Leave rss as blank to use site's feed link, and install hexo-generator-feed: `npm install hexo-generator-feed --save`.</span></span><br><span class="line"><span class="comment"># Set rss to specific value if you have burned your feed already.</span></span><br><span class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure>

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><blockquote>
<p>此时运行hexo g已经可以看到</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">INFO  Generated: atom.xml</span><br></pre></td></tr></table></figure>

<blockquote>
<p>事实上已经配置成功</p>
<p>但是侧边栏没有RSS按钮</p>
</blockquote>
<h2 id="在侧边栏添加RSS按钮"><a href="#在侧边栏添加RSS按钮" class="headerlink" title="在侧边栏添加RSS按钮"></a>在侧边栏添加RSS按钮</h2><blockquote>
<p>在Hexo/themes/next/layout/_partials/sidebar文件夹，打开site-overview.swig文件</p>
<p>在<code>- if theme.site_state </code>前加入代码：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">&#123;%</span> <span class="string">if</span> <span class="string">theme.rss</span> <span class="string">%&#125;</span></span><br><span class="line">   <span class="string">&lt;div</span> <span class="string">class="feed-link</span> <span class="string">motion-element"&gt;</span></span><br><span class="line">     <span class="string">&lt;a</span> <span class="string">href="&#123;&#123;</span> <span class="string">url_for(theme.rss)</span> <span class="string">&#125;&#125;"</span> <span class="string">rel="alternate"&gt;</span></span><br><span class="line">       <span class="string">&lt;i</span> <span class="string">class="fa</span> <span class="string">fa-rss"&gt;&lt;/i&gt;</span></span><br><span class="line">       <span class="string">RSS</span></span><br><span class="line">     <span class="string">&lt;/a&gt;</span></span><br><span class="line">   <span class="string">&lt;/div&gt;</span></span><br><span class="line"> <span class="string">&#123;%</span> <span class="string">endif</span> <span class="string">%&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>执行hexo g &amp;&amp; hexo s 即可查看效果</p>
</blockquote>
<img src="/2020/03/20/next/14_add_rss/next-add-rss/xg.png" class="" title="效果示例"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -7- Github源七牛云CDN加速教程（详细）</title>
    <url>/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/</url>
    <content><![CDATA[<blockquote>
<p>Hexo使用Github Pages时存在加载缓慢的问题，国内很多CDN平台可以为网站提供加速服务，由于偶然的原因选择了<a href="https://portal.qiniu.com/" target="_blank" rel="noopener">七牛云</a>，可以免费生成SSL证书，http协议免费10g流量。但是网上相关教程并不友好，花了好多时间终于成功，在此将过程记录下来供后人参考。</p>
</blockquote>
<a id="more"></a>

<h2 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h2><blockquote>
<p>我的当前情况和需求：</p>
</blockquote>
<ul>
<li>已经申请了域名 zywvvd.com</li>
<li>服务器为国外的Github</li>
<li>正在使用Github分发的二级域名 zywvvd.github.io</li>
<li>已经将Hexo挂载到 <a href="http://www.zywvvd.com/">www.zywvvd.com</a></li>
<li><strong>需要</strong> : 七牛云CDN加速站点，使得用户访问 <a href="http://www.zywvvd.com/">www.zywvvd.com</a> 时速度快，而且顺利转到我的Hexo主页</li>
</ul>
<h2 id="CDN-Content-Delivery-Network-加速原理"><a href="#CDN-Content-Delivery-Network-加速原理" class="headerlink" title="CDN(Content Delivery Network)加速原理"></a>CDN(Content Delivery Network)加速原理</h2><blockquote>
<p>访问Github Pages缓慢的原因</p>
</blockquote>
<ul>
<li>服务器在国外，数据交互困难</li>
<li>客观因素无法改变，但是我们还是要求国内访问要快</li>
</ul>
<blockquote>
<p>CDN 原理</p>
</blockquote>
<ul>
<li>国内建立多个用于缓存静态页面的服务器</li>
<li>建立缓存区指向国外的站点，将其缓存到到国内的服务器</li>
<li>生成指向国内缓存的CANME（IP地址的别名）</li>
<li>将要加速的域名解析到上述CANME上，实现该域名访问时的加速</li>
</ul>
<h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><ul>
<li><p>测速网站1 ：<a href="http://www.webkaka.com/Ping.aspx" target="_blank" rel="noopener">http://www.webkaka.com/Ping.aspx</a></p>
</li>
<li><p>测速网站2：<a href="https://www.17ce.com/" target="_blank" rel="noopener">https://www.17ce.com/</a></p>
</li>
<li><p>教程1：<a href="%5Bhttps://geek-space.cn/post/hexo-qiniu.html#%E4%B8%8B%E9%9D%A2%E5%B0%B1%E6%98%AF%E6%95%99%E7%A8%8B%E4%BA%86%EF%BC%88%E8%BF%99%E9%87%8C%E5%81%87%E8%AE%BE%E6%82%A8%E5%B7%B2%E7%BB%8F%E6%8E%8C%E6%8F%A1%E4%BA%86%E5%BB%BA%E7%AB%99%E7%9A%84%E6%8A%80%E6%9C%AF%EF%BC%89%5D(https://geek-space.cn/post/hexo-qiniu.html#%E4%B8%8B%E9%9D%A2%E5%B0%B1%E6%98%AF%E6%95%99%E7%A8%8B%E4%BA%86%EF%BC%88%E8%BF%99%E9%87%8C%E5%81%87%E8%AE%BE%E6%82%A8%E5%B7%B2%E7%BB%8F%E6%8E%8C%E6%8F%A1%E4%BA%86%E5%BB%BA%E7%AB%99%E7%9A%84%E6%8A%80%E6%9C%AF%EF%BC%89)">Hexo 开启 CDN 加速访问</a></p>
</li>
<li><p>教程2：<a href="https://www.zhyong.cn/posts/ddf2/" target="_blank" rel="noopener">Hexo+Next 使用 CDN 加速网站以及静态文件</a></p>
</li>
<li><p>教程3：<a href="https://blog.csdn.net/zydarChen/article/details/89584937" target="_blank" rel="noopener">使用CDN加速你的博客</a></p>
</li>
</ul>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>Hexo建站成功并挂载在互联网</li>
<li>已经申请并备案自己的域名并成功绑定Hexo站点</li>
<li>申请<a href="https://portal.qiniu.com/" target="_blank" rel="noopener">七牛云</a>账号</li>
</ul>
<h2 id="加速教程"><a href="#加速教程" class="headerlink" title="加速教程"></a>加速教程</h2><blockquote>
<p>正片开始</p>
</blockquote>
<h3 id="重新解析站点到其他二级域名"><a href="#重新解析站点到其他二级域名" class="headerlink" title="重新解析站点到其他二级域名"></a>重新解析站点到其他二级域名</h3><blockquote>
<p>这里的其他是相对与前缀<code>www</code>来说的。</p>
<p>是这样的，因为我想来访者通过域名 <a href="http://www.zywvvd.com/">www.zywvvd.com</a> 访问我的站点，也就是说这是我需要加速的域名，不能再把这个域名直接解析到我们的Hexo站点了，但是还是需要有一个二级域名指向他，因此需要将Hexo站点绑定到其他二级域名，我用的是 <a href="https://zzz.zywvvd.com/" target="_blank" rel="noopener">https://zzz.zywvvd.com/</a></p>
</blockquote>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/cname.png" class="" title="源站CNAME设置">

<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/jiexi.png" class="" title="添加新的二级域名解析">

<blockquote>
<p>此时可以通过 <a href="https://zzz.zywvvd.com/" target="_blank" rel="noopener">https://zzz.zywvvd.com/</a> 访问我的站点，但仍是原来的龟速</p>
</blockquote>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/before.png" class="" title="加速前">

<h3 id="申请SSL免费证书（貌似可选）"><a href="#申请SSL免费证书（貌似可选）" class="headerlink" title="申请SSL免费证书（貌似可选）"></a>申请SSL免费证书（貌似可选）</h3><blockquote>
<p>SSL证书用于域名支持https协议，七牛云在http协议下每月提供10g免费流量，但是我不开启https就无法访问站点，所以申请了证书，需要每月流量费用0.28元/GB，对我来说一个月几块钱足够了。</p>
<p>建议提前申请证书，开通域名加速后再申请会提示不支持www开头的域名，但是直接申请可以发放。</p>
</blockquote>
<ul>
<li>进入七牛云控制台，选择SSL证书服务：</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/ssl.png" class="" title="SSL证书服务">

<ul>
<li>购买证书（别慌，免费的）</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/goumai.png" class="" title="购买证书">

<ul>
<li>选择TrustAsia DV 域名型</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/hedui.png" class="" title="选择域名类型">

<ul>
<li>点击核对信息并支付，确认支付即可</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/queren.png" class="" title="核对支付">

<ul>
<li>点击补全信息，填入站点域名、备注、企业和个人信息（信息仅用于此次注册）</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/buquan.png" class="" title="补全信息">

<ul>
<li>提交后需要DNS验证，在一级域名出建立指定的二级域名，记录类型设置为TXT，主机记录填入指定值，一会就会验证成功</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/dnsyz.png" class="" title="DNS验证">

<ul>
<li>等待一会就签发成功啦</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/qianfa.png" class="" title="签发SSL证书">

<h3 id="在Hexo添加测试文件"><a href="#在Hexo添加测试文件" class="headerlink" title="在Hexo添加测试文件"></a>在Hexo添加测试文件</h3><ul>
<li>所谓的测试文件就是随便一个小文件，放在Hexo/source文件夹下</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/test.png" class="" title="测试文件">

<ul>
<li>hexo g ，hexo d 后可以访问 zywvvd.github.io/test.html 查看</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/fangwentest.png" class="" title="访问测试文件">

<h3 id="添加CDN加速域名"><a href="#添加CDN加速域名" class="headerlink" title="添加CDN加速域名"></a>添加CDN加速域名</h3><ul>
<li>七牛云控制台，CDN，选择域名管理，添加域名</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/tianjia.png" class="" title="添加域名">

<ul>
<li>选择 普通域名 填写你要加速的域名（需要备案） 选择通信协议 https（我用http失败了）</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/yumingshezhi.png" class="" title="填入信息">

<ul>
<li><font color=red size=6 face='微软雅黑'>重点！！！</font></li>
</ul>
<blockquote>
<p>覆盖范围：按照个人需求设置</p>
<p>使用场景：动态加速</p>
<p>源站配置：源站填github分发的二级域名</p>
<p>回源Host：填之前我们移动的二级域名，比如我的是 zzz.zywvvd.com/ </p>
<p>源站测试：填入刚刚的test.html，点击测试</p>
</blockquote>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/yuanzhan.png" class="" title="源站配置">

<ul>
<li>其他根据个人需求配置，没特殊要求默认即可，等待一会即提示成功建立加速域名</li>
</ul>
<h3 id="添加七牛云CNAME解析"><a href="#添加七牛云CNAME解析" class="headerlink" title="添加七牛云CNAME解析"></a>添加七牛云CNAME解析</h3><ul>
<li>此时配置刚刚建立的域名，会提示你需要配置CNAME</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/tishi.png" class="" title="提示">

<ul>
<li>返回域名管理，复制CNAME</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/cn.png" class="" title="复制CNAME">

<ul>
<li>在域名商处添加加速前缀的二级域名，解析到上述CNAME</li>
</ul>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/jie.png" class="" title="配置CNAME">

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><blockquote>
<p>此时我们已经完成了：</p>
</blockquote>
<ul>
<li>加速域名 → 七牛云CNAME → 备用二级域名 → Gtihub二级域名 → 站点服务器</li>
</ul>
<blockquote>
<p>可以用dig 命令测试 ，见到七牛云的CNAME解析就可以了:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dig www.zywvvd.com</span><br></pre></td></tr></table></figure>

<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/dig.png" class="" title="dig测试">

<blockquote>
<p>最实在的当然还是测速了</p>
</blockquote>
<img src="/2020/03/19/hexo/7_hexo_speed_up/hexo-speed-up/after.png" class="" title="网速测试">

<blockquote>
<p>舒服。。。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -13- 修复由于添加live2D造成的不蒜子统计失效</title>
    <url>/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/</url>
    <content><![CDATA[<blockquote>
<p> 使用nextV7.7.1 主题时，在hexo中添加live2D看板娘后next原生自带的不蒜子统计会失效，本文介绍该问题的修复方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="问题复现"><a href="#问题复现" class="headerlink" title="问题复现"></a>问题复现</h2><blockquote>
<p>开启next 主题中不蒜子统计：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class="line"><span class="comment"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装live2d插件：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>

<blockquote>
<p>问题出现：</p>
</blockquote>
<img src="/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/bug.png" class="" title="问题复现">

<h2 id="修复bug"><a href="#修复bug" class="headerlink" title="修复bug"></a>修复bug</h2><h3 id="方法1-卸载livd2d"><a href="#方法1-卸载livd2d" class="headerlink" title="方法1. 卸载livd2d"></a>方法1. 卸载livd2d</h3><blockquote>
<p>卸载live2d可以解决问题:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm uninstall --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>

<img src="/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/fix1.png" class="" title="方法1">

<h3 id="方法2-手动重新添加不蒜子"><a href="#方法2-手动重新添加不蒜子" class="headerlink" title="方法2. 手动重新添加不蒜子"></a>方法2. 手动重新添加不蒜子</h3><blockquote>
<p>看板娘怎么可以卸载？？？？？ 绝对不能接受！！！</p>
</blockquote>
<ul>
<li>关闭next原生不蒜子</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class="line"><span class="comment"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span></span><br></pre></td></tr></table></figure>

<h4 id="修复主页总数统计"><a href="#修复主页总数统计" class="headerlink" title="修复主页总数统计"></a>修复主页总数统计</h4><ul>
<li>在<code>Hexo根目录</code>/themes/next/layout/_partials/文件夹中修改 footer.swig，在最后一行前加入代码：</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>	</span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-item-icon"</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-group"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span>&gt;</span>总访客&amp;nbsp<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>&amp;nbsp人<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-divider"</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"post-meta-item-icon"</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-eye"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">span</span>&gt;</span>访问总量&amp;nbsp<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>&amp;nbsp次<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    	</span><br><span class="line">&#123;&#123;- next_inject('footer') &#125;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>效果：</p>
</blockquote>
<img src="/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/fix2.png" class="" title="修复主页总数统计">

<h4 id="修复文章统计"><a href="#修复文章统计" class="headerlink" title="修复文章统计"></a>修复文章统计</h4><blockquote>
<p>可以通过开启 <code>主题配置文件</code> - valine 评论中的 <code>visitor</code> 开关来替代不蒜子的统计功能。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">valine:</span><br><span class="line">  enable: true</span><br><span class="line">  ...</span><br><span class="line">  visitor: true # Article reading statistic</span><br></pre></td></tr></table></figure>

<blockquote>
<p>开启valine方法参考<a href="http://localhost:4000/zywvvd.github.io/2020/02/28/next/6_add_valine_comments/add-valine-comments/" target="_blank" rel="noopener">Next -6- 添加Valine评论系统</a></p>
</blockquote>
<img src="/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/fix3.png" class="" title="修复文章统计"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -6- FontAwesome 4.7.0 中完整的675个图标样式CSS参考</title>
    <url>/2020/03/09/hexo/6_hexo_icons/hexo-icons/</url>
    <content><![CDATA[<blockquote>
<p>Hexo 支持FontAwesome图标，就是在代码中出现名字以<code>fa fa</code>开头的类名，本文介绍具具体图标来源和使用方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="图标列表"><a href="#图标列表" class="headerlink" title="图标列表"></a>图标列表</h2><blockquote>
<p><a href="https://9iphp.com/fa-icons" target="_blank" rel="noopener">官方链接</a></p>
</blockquote>
<h3 id="New-Icons-in-4-7"><a href="#New-Icons-in-4-7" class="headerlink" title="New Icons in 4.7"></a>New Icons in 4.7</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/1.png" class="" title="New-Icons-in-4.7">

<h3 id="Web-Application-Icons"><a href="#Web-Application-Icons" class="headerlink" title="Web Application Icons"></a>Web Application Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/2.png" class="" title="Web-Application-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/3.png" class="" title="Web-Application-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/4.png" class="" title="Web-Application-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/5.png" class="" title="Web-Application-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/6.png" class="" title="Web-Application-Icons">

<h3 id="Accessibility-Icons"><a href="#Accessibility-Icons" class="headerlink" title="Accessibility Icons"></a>Accessibility Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/7.png" class="" title="Accessibility-Icons">

<h3 id="Hand-Icons"><a href="#Hand-Icons" class="headerlink" title="Hand Icons"></a>Hand Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/8.png" class="" title="Hand-Icons">

<h3 id="Transportation-Icons"><a href="#Transportation-Icons" class="headerlink" title="Transportation Icons"></a>Transportation Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/9.png" class="" title="Transportation-Icons">

<h3 id="Gender-Icons"><a href="#Gender-Icons" class="headerlink" title="Gender Icons"></a>Gender Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/10.png" class="" title="Gender-Icons">

<h3 id="File-Type-Icons"><a href="#File-Type-Icons" class="headerlink" title="File Type Icons"></a>File Type Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/11.png" class="" title="File-Type-Icons">

<h3 id="Spinner-Icons"><a href="#Spinner-Icons" class="headerlink" title="Spinner Icons"></a>Spinner Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/12.png" class="" title="Spinner-Icons">

<h3 id="Form-Control-Icons"><a href="#Form-Control-Icons" class="headerlink" title="Form Control Icons"></a>Form Control Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/13.png" class="" title="Form-Control-Icons">

<h3 id="Payment-Icons"><a href="#Payment-Icons" class="headerlink" title="Payment Icons"></a>Payment Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/14.png" class="" title="Payment-Icons">

<h3 id="Chart-Icons"><a href="#Chart-Icons" class="headerlink" title="Chart Icons"></a>Chart Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/15.png" class="" title="Chart-Icons">

<h3 id="Currency-Icons"><a href="#Currency-Icons" class="headerlink" title="Currency Icons"></a>Currency Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/16.png" class="" title="Currency-Icons">

<h3 id="Text-Editor-Icons"><a href="#Text-Editor-Icons" class="headerlink" title="Text Editor Icons"></a>Text Editor Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/17.png" class="" title="Text-Editor-Icons">

<h3 id="Directional-Icons"><a href="#Directional-Icons" class="headerlink" title="Directional Icons"></a>Directional Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/18.png" class="" title="Directional-Icons">

<h3 id="Video-Player-Icons"><a href="#Video-Player-Icons" class="headerlink" title="Video Player Icons"></a>Video Player Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/19.png" class="" title="Video-Player-Icons">

<h3 id="Brand-Icons"><a href="#Brand-Icons" class="headerlink" title="Brand Icons"></a>Brand Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/20.png" class="" title="Brand-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/21.png" class="" title="Brand-Icons">

<img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/22.png" class="" title="Brand-Icons">

<h3 id="Medical-Icons"><a href="#Medical-Icons" class="headerlink" title="Medical Icons"></a>Medical Icons</h3><img src="/2020/03/09/hexo/6_hexo_icons/hexo-icons/23.png" class="" title="Medical-Icons">

<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><blockquote>
<p>首先引入CSS文件：<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"></p>
<p>在Hexo中不需要手动引入，可以直接使用。</p>
<p>用</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-XXXX"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>输出图标<br>比如在hexo文章中添加代码</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fa fa-home"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><span class="fa fa-home"></span></p>
<blockquote>
<p> 可输出 <code>家</code> 图标</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -5- 添加 live2d 看板动画</title>
    <url>/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/</url>
    <content><![CDATA[<blockquote>
<p>live2d是一种应用于电子游戏的绘图渲染技术，技术由日本Cybernoids公司开发。通过一系列的连续图像和人物建模来生成一种类似三维模型的二维图像。 在Hexo中生成可以与用户互动的卡通人物，简直就是博客的灵魂所在。本文介绍live2d 看板动画添加方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="安装-hexo-helper-live2d"><a href="#安装-hexo-helper-live2d" class="headerlink" title="安装 hexo-helper-live2d"></a>安装 hexo-helper-live2d</h2><blockquote>
<p>官网链接 <a href="https://github.com/EYHN/hexo-helper-live2d/blob/HEAD/README.zh-CN.md" target="_blank" rel="noopener">hexo-helper-live2d Github 官方链接</a></p>
<p>安装时需要在 Hexo 工程目录下输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>

<h2 id="挑选喜欢的模型"><a href="#挑选喜欢的模型" class="headerlink" title="挑选喜欢的模型"></a>挑选喜欢的模型</h2><blockquote>
<p>基础的live2d模型有很多，挑选你喜欢的记录下他的名字：</p>
</blockquote>
<h3 id="chitose"><a href="#chitose" class="headerlink" title="chitose"></a>chitose</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/chitose.png" class="" title="chitose">

<h3 id="epsilon2-1"><a href="#epsilon2-1" class="headerlink" title="epsilon2_1"></a>epsilon2_1</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/epsilon2_1.png" class="" title="epsilon2_1">

<h3 id="gf"><a href="#gf" class="headerlink" title="gf"></a>gf</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/gf.png" class="" title="gf">

<h3 id="haru-01"><a href="#haru-01" class="headerlink" title="haru/01"></a>haru/01</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/haru01.png" class="" title="haru-01">

<h3 id="haru-02"><a href="#haru-02" class="headerlink" title="haru/02"></a>haru/02</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/haru02.png" class="" title="haru-02">

<h3 id="haruto"><a href="#haruto" class="headerlink" title="haruto"></a>haruto</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/haruto.png" class="" title="haruto">

<h3 id="hibiki"><a href="#hibiki" class="headerlink" title="hibiki"></a>hibiki</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/hibiki.png" class="" title="hibiki">

<h3 id="hijiki"><a href="#hijiki" class="headerlink" title="hijiki"></a>hijiki</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/hijiki.png" class="" title="hijiki">

<h3 id="izumi"><a href="#izumi" class="headerlink" title="izumi"></a>izumi</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/izumi.png" class="" title="izumi">

<h3 id="koharu"><a href="#koharu" class="headerlink" title="koharu"></a>koharu</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/koharu.png" class="" title="koharu">

<h3 id="miku"><a href="#miku" class="headerlink" title="miku"></a>miku</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/miku.png" class="" title="miku">

<h3 id="nico"><a href="#nico" class="headerlink" title="nico"></a>nico</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/nico.png" class="" title="nico">

<h3 id="nietzsche"><a href="#nietzsche" class="headerlink" title="nietzsche"></a>nietzsche</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/nietzsche.png" class="" title="nietzsche">

<h3 id="ni-j"><a href="#ni-j" class="headerlink" title="ni-j"></a>ni-j</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/ni-j.png" class="" title="ni-j">

<h3 id="nipsilon"><a href="#nipsilon" class="headerlink" title="nipsilon"></a>nipsilon</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/nipsilon.png" class="" title="nipsilon">

<h3 id="nito"><a href="#nito" class="headerlink" title="nito"></a>nito</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/nito.png" class="" title="nito">

<h3 id="shizuku"><a href="#shizuku" class="headerlink" title="shizuku"></a>shizuku</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/shizuku.png" class="" title="shizuku">

<h3 id="tororo"><a href="#tororo" class="headerlink" title="tororo"></a>tororo</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/tororo.png" class="" title="tororo">

<h3 id="tsumiki"><a href="#tsumiki" class="headerlink" title="tsumiki"></a>tsumiki</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/tsumiki.png" class="" title="tsumiki">

<h3 id="unitychan"><a href="#unitychan" class="headerlink" title="unitychan"></a>unitychan</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/unitychan.png" class="" title="unitychan">

<h3 id="wanko"><a href="#wanko" class="headerlink" title="wanko"></a>wanko</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/wanko.png" class="" title="wanko">

<h3 id="z16"><a href="#z16" class="headerlink" title="z16"></a>z16</h3><img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/z16.png" class="" title="z16">

<h2 id="模型下载"><a href="#模型下载" class="headerlink" title="模型下载"></a>模型下载</h2><h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><blockquote>
<p>在hexo目录中输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save live2d-widget-model-`模型名字`</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 此时在<code>hexo根目录</code>/node_modules/ 文件夹中增加 ‘ live2d-widget-model-<code>模型名字</code> ‘ 文件夹</p>
</blockquote>
<img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/new_dir.png" class="" title="新增文件夹">



<h3 id="github下载"><a href="#github下载" class="headerlink" title="github下载"></a>github下载</h3><blockquote>
<p>上述列表模型<a href="https://github.com/xiazeyu/live2d-widget-models" target="_blank" rel="noopener"> github地址 </a> </p>
<p>新模型 <a href="https://github.com/summerscar/live2dDemo" target="_blank" rel="noopener">gtihub地址</a></p>
<p>可以下载模型放在<code>hexo根目录</code>/node_modules/ 文件夹中，以达到命令行安装的效果</p>
</blockquote>
<h2 id="模型应用配置"><a href="#模型应用配置" class="headerlink" title="模型应用配置"></a>模型应用配置</h2><blockquote>
<p>在<code>站点配置文件</code>中加入配置信息：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span></span><br><span class="line">  <span class="attr">tagMode:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">log:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-&lt;模型名字&gt;</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span>  <span class="comment"># left</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">220</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">440</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span>   <span class="comment">#是否在手机进行显示</span></span><br><span class="line">  <span class="attr">react:</span></span><br><span class="line">    <span class="attr">opacity:</span> <span class="number">0.7</span></span><br></pre></td></tr></table></figure>

<h2 id="haru"><a href="#haru" class="headerlink" title="haru"></a>haru</h2><blockquote>
<p>haru 和其他模型有些不同，haru包中包含 01 / 02 两个模型，在使用时模型名字为：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">model:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">live2d-widget-model-haru/01</span></span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">model:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">live2d-widget-model-haru/02</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时模型仍然无法正确加载，因为<code>hexo根目录</code>/node_modules/live2d-widget-model-haru/01/或02/ 中的json文件是空的，所以需要把<code>hexo根目录</code>/node_modules/live2d-widget-model-haru/中的json文件复制到01/或02/文件夹中。</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><blockquote>
<p>输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在<code>http://127.0.0.1:4000/</code>查看测试结果 (示例为z16)</p>
</blockquote>
<img src="/2020/03/09/hexo/5_hexo_add_live2d/add-live2d/test.png" class="" title="示例效果">

<h2 id="加强版（可以说话、互动）"><a href="#加强版（可以说话、互动）" class="headerlink" title="加强版（可以说话、互动）"></a>加强版（可以说话、互动）</h2><blockquote>
<p><a href="https://github.com/stevenjoezhang/live2d-widget" target="_blank" rel="noopener">优化版live2d-widget</a></p>
</blockquote>
<blockquote>
<p>具体方法参考</p>
<p><a href="https://blog.csdn.net/weixin_34235371/article/details/91468588" target="_blank" rel="noopener">https://blog.csdn.net/weixin_34235371/article/details/91468588</a></p>
<p> <a href="https://blog.csdn.net/cungudafa/article/details/104282643#_47" target="_blank" rel="noopener">https://blog.csdn.net/cungudafa/article/details/104282643#_47</a></p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -12- 渲染markdown数学公式</title>
    <url>/2020/03/09/next/12_add_formular/next-add-formular/</url>
    <content><![CDATA[<blockquote>
<p>Hexo next主题默认的markdown渲染引擎不会渲染数学公式，V7.7主题提供了渲染公式的方法，下面介绍如何使用该功能。</p>
</blockquote>
<a id="more"></a>

<h2 id="示例公式内容"><a href="#示例公式内容" class="headerlink" title="示例公式内容"></a>示例公式内容</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line"><span class="code">	Precision=\frac&#123;TP&#125;&#123;TP+FP&#125;</span></span><br><span class="line">$$</span><br></pre></td></tr></table></figure>

<h2 id="默认渲染效果"><a href="#默认渲染效果" class="headerlink" title="默认渲染效果"></a>默认渲染效果</h2><img src="/2020/03/09/next/12_add_formular/next-add-formular/moren.png" class="" title="默认渲染">

<h2 id="开启公式渲染的方法"><a href="#开启公式渲染的方法" class="headerlink" title="开启公式渲染的方法"></a>开启公式渲染的方法</h2><h3 id="在-Next-主题中开启-MathJax-开关"><a href="#在-Next-主题中开启-MathJax-开关" class="headerlink" title="在 Next 主题中开启 MathJax 开关"></a>在 Next 主题中开启 MathJax 开关</h3><blockquote>
<p>编辑next<code>主题配置文件</code>，将MathJax 开关改为<code>True</code></p>
</blockquote>
<img src="/2020/03/09/next/12_add_formular/next-add-formular/math.png" class="" title="编辑主题配置文件">

<h3 id="修改文章Front-matter"><a href="#修改文章Front-matter" class="headerlink" title="修改文章Front-matter"></a>修改文章Front-matter</h3><blockquote>
<p>在想要添加公式文章的<code>Front-matter</code>中添加<code>mathjax: true</code>即可</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: test_title</span><br><span class="line">date: 2020-02-27 16:41:16</span><br><span class="line">tags: [test_tag]</span><br><span class="line">categories: [test_cate]</span><br><span class="line">mathjax: true</span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><blockquote>
<p>再次写入示例公式代码，即可正常渲染。</p>
</blockquote>
<p>$$<br>Precision=\frac{TP}{TP+FP}<br>$$</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -11- 为文章添加阅读进度</title>
    <url>/2020/03/09/next/11_article_percentage/article-percentage/</url>
    <content><![CDATA[<blockquote>
<p>Next可以在文章中添加当前阅读进度的百分比或颜色进度条，本文介绍功能开启方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="阅读进度百分比"><a href="#阅读进度百分比" class="headerlink" title="阅读进度百分比"></a>阅读进度百分比</h2><blockquote>
<p>修改<code>主题配置文件</code>，修改<code>back2top</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开启 back to top 按钮</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span> <span class="comment"># true 表示在侧边栏显示，false则在侧下角</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span> <span class="comment"># 开启进度百分比</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>效果：</p>
</blockquote>
<img src="/2020/03/09/next/11_article_percentage/article-percentage/percentage.png" class="" title="进度百分比">



<h2 id="颜色进度条"><a href="#颜色进度条" class="headerlink" title="颜色进度条"></a>颜色进度条</h2><blockquote>
<p>修改<code>主题配置文件</code>，修改<code>reading_progress</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Reading progress bar</span></span><br><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开启进度条</span></span><br><span class="line">  <span class="comment"># Available values: top | bottom</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">bottom</span> <span class="comment"># 设置位置 可以为  top | bottom</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">"#37c6c0"</span> <span class="comment"># 进度条颜色 16进制RGB</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">3px</span> <span class="comment"># 高度</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>效果：</p>
</blockquote>
<img src="/2020/03/09/next/11_article_percentage/article-percentage/processbar.png" class="" title="颜色进度条"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -10- 页面右上角添加Fork me on github按钮</title>
    <url>/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍Hexo博客Next主题在页面右上角（或者左上角）添加“Fork me on github”按钮。</p>
</blockquote>
<a id="more"></a>

<h2 id="选择按钮样式"><a href="#选择按钮样式" class="headerlink" title="选择按钮样式"></a>选择按钮样式</h2><blockquote>
<p>在 <a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">GitHub Corners</a> 或 <a href="https://github.blog/2008-12-19-github-ribbons/" target="_blank" rel="noopener">GitHub Ribbons</a> 选择自己喜欢的按钮样式并复制代码，将href换成自己的链接。</p>
</blockquote>
<h3 id="Corners"><a href="#Corners" class="headerlink" title="Corners"></a>Corners</h3><blockquote>
<p>假设选择了这一款</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/corner.png" class="" title="Corners">

<blockquote>
<p>代码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;your-url&quot; class&#x3D;&quot;github-corner&quot; aria-label&#x3D;&quot;View source on GitHub&quot;&gt;&lt;svg width&#x3D;&quot;80&quot; height&#x3D;&quot;80&quot; viewBox&#x3D;&quot;0 0 250 250&quot; style&#x3D;&quot;fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; right: 0;&quot; aria-hidden&#x3D;&quot;true&quot;&gt;&lt;path d&#x3D;&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot; fill&#x3D;&quot;currentColor&quot; style&#x3D;&quot;transform-origin: 130px 106px;&quot; class&#x3D;&quot;octo-arm&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot; fill&#x3D;&quot;currentColor&quot; class&#x3D;&quot;octo-body&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;&lt;&#x2F;a&gt;&lt;style&gt;.github-corner:hover .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;@keyframes octocat-wave&#123;0%,100%&#123;transform:rotate(0)&#125;20%,60%&#123;transform:rotate(-25deg)&#125;40%,80%&#123;transform:rotate(10deg)&#125;&#125;@media (max-width:500px)&#123;.github-corner:hover .octo-arm&#123;animation:none&#125;.github-corner .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;&#125;&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>替换链接，主要修改：<code>href=&quot;https://your-url&quot;</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;zywvvd&quot; class&#x3D;&quot;github-corner&quot; aria-label&#x3D;&quot;View source on GitHub&quot;&gt;&lt;svg width&#x3D;&quot;80&quot; height&#x3D;&quot;80&quot; viewBox&#x3D;&quot;0 0 250 250&quot; style&#x3D;&quot;fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; right: 0;&quot; aria-hidden&#x3D;&quot;true&quot;&gt;&lt;path d&#x3D;&quot;M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2&quot; fill&#x3D;&quot;currentColor&quot; style&#x3D;&quot;transform-origin: 130px 106px;&quot; class&#x3D;&quot;octo-arm&quot;&gt;&lt;&#x2F;path&gt;&lt;path d&#x3D;&quot;M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z&quot; fill&#x3D;&quot;currentColor&quot; class&#x3D;&quot;octo-body&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;&lt;&#x2F;a&gt;&lt;style&gt;.github-corner:hover .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;@keyframes octocat-wave&#123;0%,100%&#123;transform:rotate(0)&#125;20%,60%&#123;transform:rotate(-25deg)&#125;40%,80%&#123;transform:rotate(10deg)&#125;&#125;@media (max-width:500px)&#123;.github-corner:hover .octo-arm&#123;animation:none&#125;.github-corner .octo-arm&#123;animation:octocat-wave 560ms ease-in-out&#125;&#125;&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Ribbons"><a href="#Ribbons" class="headerlink" title="Ribbons"></a>Ribbons</h3><blockquote>
<p>假设选择了这一款</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/ribbin.png" class="" title="Ribbons">

<blockquote>
<p>代码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;you&quot;&gt;&lt;img width&#x3D;&quot;149&quot; height&#x3D;&quot;149&quot; src&#x3D;&quot;https:&#x2F;&#x2F;github.blog&#x2F;wp-content&#x2F;uploads&#x2F;2008&#x2F;12&#x2F;forkme_right_green_007200.png?resize&#x3D;149%2C149&quot; class&#x3D;&quot;attachment-full size-full&quot; alt&#x3D;&quot;Fork me on GitHub&quot; data-recalc-dims&#x3D;&quot;1&quot;&gt;&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>替换链接，修改<code>href=&quot;https://github.com/you&quot;</code>为自己的链接；</p>
<p>现有代码直接使用会出问题，需要在img标签中加入 <code>style=&quot;position:absolute; right:-2px; top:2px;</code>“</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;github.com&#x2F;zywvvd&quot; &gt;</span><br><span class="line">    		&lt;img width&#x3D;&quot;149&quot; height&#x3D;&quot;149&quot;  style&#x3D;&quot;position:absolute; right:-2px; top:2px;&quot; src&#x3D;&quot;https:&#x2F;&#x2F;github.blog&#x2F;wp-content&#x2F;uploads&#x2F;2008&#x2F;12&#x2F;forkme_right_green_007200.png?resize&#x3D;149%2C149&quot; class&#x3D;&quot;attachment-full size-full&quot; alt&#x3D;&quot;Fork me on GitHub&quot; data-recalc-dims&#x3D;&quot;1&quot;&gt;</span><br><span class="line">    	&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<h2 id="代码加入工程"><a href="#代码加入工程" class="headerlink" title="代码加入工程"></a>代码加入工程</h2><blockquote>
<p>将改好的代码粘贴到<code>themes/next/layout/_layout.swig</code>文件中<code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code>下面一行：</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/layout.png" class="" title="_layout.swig文件">

<blockquote>
<p>Coners</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/daima1.png" class="" title="Coners代码">

<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/shili1.png" class="" title="Coners效果">

<blockquote>
<p>Ribbons</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/daima2.png" class="" title="Ribbons代码">

<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/shili2.png" class="" title="Ribbons效果">

<h2 id="同时应用Coners和Ribbons"><a href="#同时应用Coners和Ribbons" class="headerlink" title="同时应用Coners和Ribbons"></a>同时应用Coners和Ribbons</h2><blockquote>
<p>向_layout.png中加入两段代码，修改图片颜色：</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/daima3.png" class="" title="两段代码">

<blockquote>
<p>效果：</p>
</blockquote>
<img src="/2020/02/29/next/10_fork_me_on_github/fork-me-on-github/shili3.png" class="" title="同时应用效果"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -9- 添加头像</title>
    <url>/2020/02/28/next/9_add_avatar/add-avatar/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍Next主题添加头像的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="头像文件"><a href="#头像文件" class="headerlink" title="头像文件"></a>头像文件</h2><blockquote>
<p>把准备好的头像图片放在<code>/next/source/images/</code>文件夹内。</p>
</blockquote>
<img src="/2020/02/28/next/9_add_avatar/add-avatar/avatar.png" class="" title="头像图片">

<h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><blockquote>
<p>修改<code>avatar.url</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># Replace the default image and set the url here.</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/avatar.jpg</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be dispalyed in circle.</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be rotated with the cursor.</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/9_add_avatar/add-avatar/xiaoguo.png" class="" title="主页效果"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -8- 修改文章模板</title>
    <url>/2020/02/28/next/8_change_model_of_post/change-model-of-post/</url>
    <content><![CDATA[<blockquote>
<p>Next文章内容会是丰富多彩的，但是要素主要为：标题、日期、标签、类别、摘要、more标签和正文，每次创建文章都需要创建这些内容过于繁琐而且容易出错，将相关内容加入到模板可以规范格式、省去重复劳动并且避免错误。</p>
</blockquote>
<a id="more"></a>

<h2 id="修改方法"><a href="#修改方法" class="headerlink" title="修改方法"></a>修改方法</h2><blockquote>
<p>hexo在新建文章时会默认套用<code>/hexo_root/scaffolds/post.md</code>模板，默认为：</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">tags:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将其修改为你需要的模式：</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="section">## 概述</span></span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; 本文。</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--more--&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">## 正文</span></span><br></pre></td></tr></table></figure>

<h2 id="新建文章"><a href="#新建文章" class="headerlink" title="新建文章"></a>新建文章</h2><blockquote>
<p>新建文章就是模板的形式了：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new test_post</span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/8_change_model_of_post/change-model-of-post/model.png" class="" title="模板文章"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -7- 为文章在主页添加“阅读更多”</title>
    <url>/2020/02/28/next/7_read_more/read-more/</url>
    <content><![CDATA[<blockquote>
<p>Hexo的主页会显示博客文章，但是每篇文章都显示全文会影响文章展示的效果。</p>
<p>本篇介绍为文章在主页设置摘要的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="Next标签（推荐）"><a href="#Next标签（推荐）" class="headerlink" title="Next标签（推荐）"></a>Next标签（推荐）</h2><blockquote>
<p>Markdown中的注释</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!--more--&gt;</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>本身对文档没有影响，但在Next中会被识别为摘要截断的标志。标志之后的内容不会在首页显示。</p>
<p>而且会生成一个<code>阅读全文</code>的按钮。</p>
<p>这种方法被Next官方推荐，因为它在满足需求的同时也可以让Hexo中的插件识别。</p>
</blockquote>
<img src="/2020/02/28/next/7_read_more/read-more/comment.png" class="" title="文中添加more注释">

<blockquote>
<p>实际效果</p>
</blockquote>
<img src="/2020/02/28/next/7_read_more/read-more/xiaoguo1.png" class="" title="阅读全文">

<h2 id="自动形成摘要"><a href="#自动形成摘要" class="headerlink" title="自动形成摘要"></a>自动形成摘要</h2><blockquote>
<p>在<code>主题配置文件</code>中添加：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure>

<p>默认截取的长度为 150 字符，可以根据需要自行设定。</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -6- 添加Valine评论系统</title>
    <url>/2020/02/28/next/6_add_valine_comments/add-valine-comments/</url>
    <content><![CDATA[<blockquote>
<p>Next V7.7.1 自带很多评论系统，其中Valine诞生于2017年8月7日，是一款基于Leancloud的快速、简洁且高效的无后端评论系统。Valine具有添加方便，轻量，运行、加载速度快，不需要用户登录等优点。</p>
<p>本文介绍Next中添加Valine评论系统的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="依赖leancloud"><a href="#依赖leancloud" class="headerlink" title="依赖leancloud"></a>依赖leancloud</h2><ul>
<li>申请leancloud账号，<a href="https://www.leancloud.cn/" target="_blank" rel="noopener">官网链接</a>。</li>
<li>登录leancloud，进入控制台点击创建应用。</li>
</ul>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/chuangjianyingyong.png" class="" title="创建应用">

<ul>
<li>填写应用名称，选择开发版</li>
</ul>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/chuangjian.png" class="" title="创建应用">

<ul>
<li>创建成功后点击应用右上角的<code>齿轮</code>进入应用设置</li>
</ul>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/chilun.png" class="" title="创建设置">

<ul>
<li>设置选项卡中选择<code>应用 Keys</code>，右边AppID和AppKey就是我们需要的标识和密钥。</li>
</ul>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/keys.png" class="" title="应用 Keys">

<h2 id="本地设置"><a href="#本地设置" class="headerlink" title="本地设置"></a>本地设置</h2><blockquote>
<p>在Next<code>主题配置文件</code>中修改valine字段内的值，将enable设置为true，将刚刚得到的AppID和AppKey填入相应字段中。</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Valine</span></span><br><span class="line"><span class="comment"># For more information: https://valine.js.org, https://github.com/xCss/Valine</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="string">XXXXXXXXXXX&lt;</span> <span class="string">your</span> <span class="string">AppID&gt;XXXXXXXXXXXX</span> <span class="comment"># Your leancloud application appid</span></span><br><span class="line">  <span class="attr">appkey:</span> <span class="string">XXXXXX&lt;your</span> <span class="string">AppKey&gt;XXXXXXX</span> <span class="comment"># Your leancloud application appkey</span></span><br><span class="line">  <span class="attr">notify:</span> <span class="literal">true</span> <span class="comment"># Mail notifier</span></span><br><span class="line">  <span class="attr">verify:</span> <span class="literal">true</span> <span class="comment"># Verification code</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">遗憾莫过于难忘你的背影，却找不到你来过的痕迹</span> <span class="string">...</span> <span class="comment"># Comment box placeholder</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">mm</span> <span class="comment"># Gravatar style</span></span><br><span class="line">  <span class="attr">guest_info:</span> <span class="string">nick,mail,link</span> <span class="comment"># Custom comment header</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> <span class="comment"># Pagination size</span></span><br><span class="line">  <span class="attr">language:</span> <span class="comment"># Language, available values: en, zh-cn</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">true</span> <span class="comment"># Article reading statistic</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="literal">true</span> <span class="comment"># If false, comment count will only be displayed in post page, not in home page</span></span><br><span class="line">  <span class="attr">recordIP:</span> <span class="literal">false</span> <span class="comment"># Whether to record the commenter IP</span></span><br><span class="line">  <span class="attr">serverURLs:</span> <span class="comment"># When the custom domain name is enabled, fill it in here (it will be detected automatically by default, no need to fill in)</span></span><br><span class="line">  <span class="comment">#post_meta_order: 0</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改enable和AppID、AppKey之后：</p>
</blockquote>
<ul>
<li>notify：评论后的邮件提示，还需要在leancloud中设置邮件模板自动回复</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">你在&#123;&#123;appname&#125;&#125; 的评论收到了新的回复</span><br><span class="line"></span><br><span class="line">&lt;p&gt;Hi, &#123;&#123;username&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">你在 &#123;&#123;appname&#125;&#125; 的评论收到了新的回复，请点击查看：</span><br><span class="line">&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href&#x3D;&quot;你的网址首页链接&quot; style&#x3D;&quot;display: inline-block; padding: 10px 20px; border-radius: 4px; background-color: #3090e4; color: #fff; text-decoration: none;&quot;&gt;马上查看&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>verify：评论时需要验证码</li>
<li>placeholder：占位符，就是在没有评论时默认的提示文字</li>
<li>visitor：标题和首页显示浏览量(与不蒜子的会重复，可以选择一个保留)</li>
</ul>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><blockquote>
<p>Next V7.7.1 已经集成了相关程序包，不需要额外安装，只要填入AppID和AppKey就好，否则容易出现各种奇怪的问题（别问我怎么知道的）</p>
</blockquote>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/valine.png" class="" title="评论测试">

<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/post.png" class="" title="评论统计">

<h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><blockquote>
<p>可选操作：在【Leancloud】 -&gt; 【设置】 -&gt; 【安全中心】 -&gt; 【Web 安全域名】把你的域名加进去，可防止数据被篡改。</p>
</blockquote>
<h2 id="标题Valine字段翻译"><a href="#标题Valine字段翻译" class="headerlink" title="标题Valine字段翻译"></a>标题Valine字段翻译</h2><blockquote>
<p>这个字段生成过程和其他不一样，定义的变量在post下的comments下的valine，修改zh-Hans.yml</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post:</span></span><br><span class="line">  <span class="attr">comments:</span></span><br><span class="line">    <span class="attr">valine:</span> <span class="string">评论次数</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/fanyi.png" class="" title="Valine翻译">

<h2 id="源码踪迹"><a href="#源码踪迹" class="headerlink" title="源码踪迹"></a>源码踪迹</h2><blockquote>
<p>相关的Valine评论数生成的源文件是<code>themes -&gt; next -&gt; scripts -&gt; filters -&gt; comment -&gt; valine.js</code></p>
</blockquote>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/valinejs.png" class="" title="valine.js">

<blockquote>
<p>该函数在同文件夹下的<code>common.js</code>文件内</p>
</blockquote>
<img src="/2020/02/28/next/6_add_valine_comments/add-valine-comments/commonjs.png" class="" title="common.js">

<blockquote>
<p>因此在zh-Hans.yml中定义post.comments.valine 变量的翻译字段</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -5- 设定站点建立时间</title>
    <url>/2020/02/28/next/5_settings/next-settings/</url>
    <content><![CDATA[<blockquote>
<p>Hexo博客Next主题的站点建立时间主要体现在页脚的 <code>© 2020</code> ，如果不修改会设置为当前年份。本文介绍该年份设置方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h2><blockquote>
<p>在<code>主题配置文件</code>中修改footer字段的since：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the date when the site was setup. If not defined, current year will be used.</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2019</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/5_settings/next-settings/since.png" class="" title="效果展示"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -4- 增加站点访客、文章阅读量、字符统计、阅读时间统计与对应词条翻译</title>
    <url>/2020/02/28/next/4_add_viewers/viewers/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍增加Next主题文章阅读数量和访客数量的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="不蒜子站点访客、文章阅读量"><a href="#不蒜子站点访客、文章阅读量" class="headerlink" title="不蒜子站点访客、文章阅读量"></a>不蒜子站点访客、文章阅读量</h2><blockquote>
<p>修改<code>主题配置文件</code>不蒜子<code>enable</code>的开关为<code>true</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Show Views / Visitors of the website / page with busuanzi.</span></span><br><span class="line"><span class="comment"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/4_add_viewers/viewers/post.png" class="" title="文章阅读数">

<img src="/2020/02/28/next/4_add_viewers/viewers/footer.png" class="" title="访客与阅读总量">

<h3 id="统计失效时的调整方法"><a href="#统计失效时的调整方法" class="headerlink" title="统计失效时的调整方法"></a>统计失效时的调整方法</h3><blockquote>
<p>有时数据统计会失效，此时删除hexo根目录的<code>db.json</code>，执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure>

<h2 id="字符统计、阅读时间统计"><a href="#字符统计、阅读时间统计" class="headerlink" title="字符统计、阅读时间统计"></a>字符统计、阅读时间统计</h2><blockquote>
<p>启用 hexo-symbols-count-time ，官方<a href="https://github.com/theme-next/hexo-symbols-count-time" target="_blank" rel="noopener">Github链接</a>，执行命令：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-symbols-count-time</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在<code>站点配置文件</code>加入：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span>                <span class="comment"># 文章字数统计</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span>                   <span class="comment"># 文章阅读时长</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span>          <span class="comment"># 站点总字数统计</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span>             <span class="comment"># 站点总阅读时长</span></span><br><span class="line">  <span class="attr">exclude_codeblock:</span> <span class="literal">false</span>     <span class="comment"># 排除代码字数统计</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以调整<code>主题配置文件</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Post wordcount display settings</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/hexo-symbols-count-time</span></span><br><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span>  <span class="comment"># 是否换行显示 字数统计 及 阅读时长</span></span><br><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span>  <span class="comment"># 文章 字数统计 阅读时长 使用图标 还是 文本表示</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">true</span> <span class="comment"># 博客底部统计 字数统计 阅读时长 使用图标 还是 文本表示</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/4_add_viewers/viewers/words.png" class="" title="字符统计、阅读时间">

<h2 id="对应词条翻译"><a href="#对应词条翻译" class="headerlink" title="对应词条翻译"></a>对应词条翻译</h2><blockquote>
<p>对上述词条翻译找了好久，终于摸索出来了，在此贡献给大家，在zh-Hans.yml中加入：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post:</span></span><br><span class="line">  <span class="attr">views:</span> <span class="string">阅读次数</span></span><br><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">time:</span> <span class="string">阅读时长</span></span><br><span class="line">  <span class="attr">count:</span> <span class="string">本文字数</span></span><br><span class="line">  <span class="attr">count_total:</span> <span class="string">站点总字数</span></span><br><span class="line">  <span class="attr">time_total:</span> <span class="string">站点阅读时长</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/28/next/4_add_viewers/viewers/header-zh.png" class="" title="post翻译">

<img src="/2020/02/28/next/4_add_viewers/viewers/footer-zh.png" class="" title="footer翻译"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -3- 将页面英文标识翻译为中文</title>
    <url>/2020/02/28/next/3_translate/translate/</url>
    <content><![CDATA[<blockquote>
<p>Next默认界面中菜单、文章信息、站点信息名称为英文，本文介绍将这些英文翻译为中文的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><blockquote>
<p> 设置<code>站点配置信息</code>Site中的<code>language</code>值为 <code>zh-Hans</code>，<a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/24/hexo/hexo_config/Hexo%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE/">Hexo - 站点信息配置</a>。</p>
</blockquote>
<h2 id="配置翻译文件"><a href="#配置翻译文件" class="headerlink" title="配置翻译文件"></a>配置翻译文件</h2><blockquote>
<p>在/hexo_root/themes/next/languages/文件夹中创建<code>zh-Hans.yml</code>文件</p>
</blockquote>
<ul>
<li>翻译菜单</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">首页</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">归档</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">分类</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">标签</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">关于</span></span><br><span class="line">  <span class="attr">search:</span> <span class="string">搜索</span></span><br><span class="line">  <span class="attr">commonweal:</span> <span class="string">公益404</span></span><br><span class="line">  <span class="attr">something:</span> <span class="string">有料</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译文章标题</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post:</span></span><br><span class="line">  <span class="attr">posted:</span> <span class="string">发表于</span></span><br><span class="line">  <span class="attr">edited:</span> <span class="string">编辑于</span></span><br><span class="line">  <span class="attr">in:</span> <span class="string">类别</span></span><br><span class="line">  <span class="attr">views:</span> <span class="string">阅读次数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译侧边栏</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sidebar:</span></span><br><span class="line">  <span class="attr">toc:</span> <span class="string">文章目录</span></span><br><span class="line">  <span class="attr">overview:</span> <span class="string">小站概览</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译站点状态</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">state:</span></span><br><span class="line">  <span class="attr">posts:</span> <span class="string">日志</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">分类</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">标签</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译文章阅读次数</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post:</span></span><br><span class="line">  <span class="attr">views:</span> <span class="string">阅读次数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译阅读时长、文本字数</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">time:</span> <span class="string">阅读时长</span></span><br><span class="line">  <span class="attr">count:</span> <span class="string">本文字数</span></span><br><span class="line">  <span class="attr">count_total:</span> <span class="string">站点总字数</span></span><br><span class="line">  <span class="attr">time_total:</span> <span class="string">站点阅读时长</span></span><br></pre></td></tr></table></figure>

<ul>
<li>翻译footer词条</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">主题方案</span></span><br><span class="line">  <span class="attr">powered:</span> <span class="string">技术支持</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时相应的内容会被翻译成设定的文字</p>
</blockquote>
<img src="/2020/02/28/next/3_translate/translate/xiaoguo.png" class="" title="翻译后的页面">

<img src="/2020/02/28/next/3_translate/translate/header-zh.png" class="" title="翻译后的页面">

<img src="/2020/02/28/next/3_translate/translate/xiaoguo2.png" class="" title="翻译后的页面"><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -2- 增加 tags, about, categories 页面</title>
    <url>/2020/02/28/next/2_add_pages/add-tags-about-categories-page/</url>
    <content><![CDATA[<blockquote>
<p>Next主题支持文章按照类别划分，而且可以为文章添加标签，并且有专门的页面用来管理和检索。而新安装的Next主题不带about, tags, categories页面，默认只有Archives。本文介绍这些页面的添加方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="开启菜单按钮"><a href="#开启菜单按钮" class="headerlink" title="开启菜单按钮"></a>开启菜单按钮</h2><blockquote>
<p>在<code>主题配置文件</code>中开启相应按钮（去掉行前的<code>#</code>）</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Menu Settings</span></span><br><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage: `Key: /link/ || icon`</span></span><br><span class="line"><span class="comment"># Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.</span></span><br><span class="line"><span class="comment"># Value before `||` delimiter is the target link, value after `||` delimiter is the name of Font Awesome icon.</span></span><br><span class="line"><span class="comment"># When running the site in a subdirectory (e.g. yoursite.com/blog), remove the leading slash from link value (/archives -&gt; archives).</span></span><br><span class="line"><span class="comment"># External url should start with http:// or https://</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时页面菜单发生了一些变化，但是按钮链接没有对应页面</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/openbuttons.png" class="" title="开启按钮">

<h2 id="添加页面"><a href="#添加页面" class="headerlink" title="添加页面"></a>添加页面</h2><h3 id="添加-tags"><a href="#添加-tags" class="headerlink" title="添加 tags"></a>添加 tags</h3><blockquote>
<p>在hexo目录的终端输入命令新建文章，layout设置为page，文章名称为tags</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时在 /hexo_root/source/tags/文件夹中出现了<code>index.md</code>文件，打开并修改Front-matter内容</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: 文章标签</span><br><span class="line">date: 2020-02-28 13:01:59</span><br><span class="line">type: "tags"</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时tags页面已经可以打开</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/tags.png" class="" title="tags页面">

<h3 id="添加-categories"><a href="#添加-categories" class="headerlink" title="添加 categories"></a>添加 categories</h3><blockquote>
<p>在hexo目录的终端输入命令新建文章，layout设置为page，文章名称为categories</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时在 /hexo_root/source/categories/文件夹中出现了<code>index.md</code>文件，打开并修改Front-matter内容</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: 文章类别</span><br><span class="line">date: 2020-02-28 13:03:19</span><br><span class="line">type: "categories"</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时categories页面已经可以打开</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/categories.png" class="" title="categories页面">

<h3 id="添加about"><a href="#添加about" class="headerlink" title="添加about"></a>添加about</h3><blockquote>
<p>在hexo目录的终端输入命令新建文章，layout设置为page，文章名称为about</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时在 /hexo_root/source/about/文件夹中出现了<code>index.md</code>文件，打开并修改Front-matter内容</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: 小站自述</span><br><span class="line">date: 2020-02-28 13:07:35</span><br><span class="line">type: "about"</span><br></pre></td></tr></table></figure>

<blockquote>
<p>同时可以在文件中加入站点描述内容</p>
<p>此时about页面已经可以打开</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/about.png" class="" title="about页面">

<h2 id="设置文章类别和标签"><a href="#设置文章类别和标签" class="headerlink" title="设置文章类别和标签"></a>设置文章类别和标签</h2><blockquote>
<p>修改/hexo_root/source/_posts/hello-world.md，在Front-matter中添加标签和类别</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: Hello World</span><br><span class="line">tags: [tag1,tag2]</span><br><span class="line">categories: [cate,sub<span class="emphasis">_cate,sub_</span>sub_cate]</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">title: Hello World</span><br><span class="line">tags: </span><br><span class="line"><span class="bullet">- </span>tag1</span><br><span class="line"><span class="bullet">- </span>tag2</span><br><span class="line">categories: </span><br><span class="line"><span class="bullet">- </span>cate</span><br><span class="line"><span class="bullet">- </span>sub_cate</span><br><span class="line"><span class="bullet">- </span>sub<span class="emphasis">_sub_</span>cate</span><br></pre></td></tr></table></figure>

<blockquote>
<p>主页面侧边栏状态会发生变化</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/state.png" class="" title="侧边栏显示类别标签">

<blockquote>
<p>标签页面（标签内容数量多字体会相应变大）</p>
<p>一篇文章可以设置多个平行标签</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/tags2.png" class="" title="标签页面显示标签">

<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/tags3.png" class="" title="文章标签">

<blockquote>
<p>分类页面</p>
<p>类别标签不并列，安装顺序设置级别</p>
</blockquote>
<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/categories2.png" class="" title="分类页面显示分类">

<img src="/2020/02/28/next/2_add_pages/add-tags-about-categories-page/categories3.png" class="" title="文章分类">

<h2 id="关闭评论"><a href="#关闭评论" class="headerlink" title="关闭评论"></a>关闭评论</h2><blockquote>
<p>后续站点可能会开启评论功能，如果不希望上述页面开启评论可以在页面<code>index.md</code>的Front-matter中添加</p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">comments: false</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -4- 向文章添加图片的方法</title>
    <url>/2020/02/27/hexo/4_hexo_add_image/hexo-add-image/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍Hexo编辑文章时添加图像的各种方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="绝对路径本地引用"><a href="#绝对路径本地引用" class="headerlink" title="绝对路径本地引用"></a>绝对路径本地引用</h2><blockquote>
<p>当Hexo项目中只用到少量图片时，可以将图片统一放在source/images文件夹中，通过markdown语法访问它们。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">![](&#x2F;images&#x2F;image.jpg)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此方法加载的图片既可以在首页内容中访问到，也可以在文章正文中访问到。</p>
</blockquote>
<h2 id="相对路径本地引用"><a href="#相对路径本地引用" class="headerlink" title="相对路径本地引用"></a>相对路径本地引用</h2><blockquote>
<p>图片除了可以放在统一的images文件夹中，还可以放在文章自己的目录中。文章的目录可以通过设置<code>站点配置文件</code>的 <code>post_asset_folder: true</code>来自动生成。</p>
</blockquote>
<img src="/2020/02/27/hexo/4_hexo_add_image/hexo-add-image/config.png" class="" title="配置文件修改">

<blockquote>
<p>将_config.yml文件中的配置项post_asset_folder设为true后，执行命令$ hexo new post_name，在source/_posts中会生成文章post_name.md和同名文件夹post_name。将图片资源放在post_name中，文章就可以使用相对路径引用图片资源了。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">![](image.jpg)</span><br></pre></td></tr></table></figure>



<h2 id="标签插件语法引用"><a href="#标签插件语法引用" class="headerlink" title="标签插件语法引用"></a>标签插件语法引用</h2><p>这种相对路径的图片显示方法在博文详情页面显示没有问题，但是在首页预览页面图片将显示不出来。如果希望<strong>图片在文章和首页中同时显示</strong>，可以使用标签插件语法。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 本地图片资源，不限制图片尺寸</span><br><span class="line">&#123;% asset_img image.jpg This is an image %&#125;</span><br><span class="line"># 网络图片资源，限制图片显示尺寸</span><br><span class="line">&#123;% img http:&#x2F;&#x2F;www.viemu.com&#x2F;vi-vim-cheat-sheet.gif 200 400 vi-vim-cheat-sheet %&#125;</span><br></pre></td></tr></table></figure>



<h2 id="HTML语法引用"><a href="#HTML语法引用" class="headerlink" title="HTML语法引用"></a>HTML语法引用</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;SpellCheck.png&quot; width&#x3D;&quot;50%&quot; height&#x3D;&quot;50%&quot; title&#x3D;&quot;拼写检查工具Grammarly.&quot; alt&#x3D;&quot;拼写检查工具Grammarly.&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>直接将<code>![](image.jpg)</code>替换上面的语法即可。</p>
<h2 id="启用fancybox：点击查看图片大图"><a href="#启用fancybox：点击查看图片大图" class="headerlink" title="启用fancybox：点击查看图片大图"></a>启用fancybox：点击查看图片大图</h2><p>我这里使用的是Hexo的NexT主题，NexT主题中提供了fancybox的方便接口。</p>
<p>Usage：<a href="https://github.com/theme-next/theme-next-fancybox3" target="_blank" rel="noopener">https://github.com/theme-next/theme-next-fancybox3</a><br>markdown用法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% img http:&#x2F;&#x2F;www.viemu.com&#x2F;vi-vim-cheat-sheet.gif 600 600 &quot;点击查看大图:vi&#x2F;vim-cheat-sheet&quot; %&#125;</span><br></pre></td></tr></table></figure>



<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习-基础知识 - PR、ROC曲线与AUC</title>
    <url>/2020/02/27/machine_learning/basic_knowledge/PR_and_ROC/PR-and-ROC/</url>
    <content><![CDATA[<blockquote>
<p>PR曲线与ROC曲线都是机器学习中性能评估的重要指标，本文主要讲这两个曲线。</p>
</blockquote>
<a id="more"></a>

<h2 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h2><ul>
<li>熟悉基础定义<a href="https://www.zywvvd.com/2020/02/26/machine_learning/basic_knowledge/TP_FN_FP_TN/Evaluation-index/">TP, FN, FP, TN</a>。</li>
<li>理解主要评估指标概念<a href="https://www.zywvvd.com/2020/02/27/machine_learning/basic_knowledge/performance_evaluation/Performance-evaluation/">Precision, Recall,  FNR, FPR, TPR, TNR</a>等。</li>
</ul>
<h2 id="示例数据"><a href="#示例数据" class="headerlink" title="示例数据"></a>示例数据</h2><table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>真实类别</center></td>
        <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>N</center></td>
         <td><center>N</center></td>
         <td><center>N</center></td>
         <td><center>N</center></td>
    </tr>
</table>

<blockquote>
<p>预测-1</p>
</blockquote>
 <table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>预测为正样本<br>的概率</center></td>
        <td><center><font >0.9</font></center></td>
          <td><center><font >0.8</font></center></td>
          <td><center><font>0.7</font></center></td>
         <td><center><font >0.6</font></center></td>
         <td><center><font >0.6</font></center></td>
          <td><center><font>0.4</font></center></td>
         <td><center><font >0.5</font></center></td>
          <td><center><font >0.4</font></center></td>
         <td><center><font>0.3</font></center></td>
         <td><center><font >0.2</font></center></td>
    </tr>
</table>

<blockquote>
<p>预测-2</p>
</blockquote>
 <table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>预测为正样本<br>的概率</center></td>
        <td><center><font >0.8</font></center></td>
          <td><center><font >0.7</font></center></td>
          <td><center><font>0.7</font></center></td>
         <td><center><font >0.8</font></center></td>
         <td><center><font >0.7</font></center></td>
          <td><center><font>0.4</font></center></td>
         <td><center><font >0.6</font></center></td>
          <td><center><font >0.3</font></center></td>
         <td><center><font>0.3</font></center></td>
         <td><center><font >0.1</font></center></td>
    </tr>
</table>

<h2 id="PR曲线"><a href="#PR曲线" class="headerlink" title="PR曲线"></a>PR曲线</h2><blockquote>
<p>含义：PR曲线中P为Precision（查准率），R为Recall（查全率）。以Recall为横坐标、Precision为纵坐标绘制的曲线即为PR曲线。有同学可能会问Precision、Recall不就是一个值么，怎么画出的曲线？</p>
</blockquote>
<h3 id="曲线的由来"><a href="#曲线的由来" class="headerlink" title="曲线的由来"></a>曲线的由来</h3><p>事实上机器学习训练好的模型在对测试样本进行预测的时候，输出的原始结果是模型预测该样本为正样本的概率，而不是我们平时经常听到的Positive或Negative，而概率如何转化为机器学习的输出靠的是一个阈值，当概率大于阈值则判断其为正样本，反之为负样本。</p>
<p>而这个非常关键的阈值本身不是固定的，在阈值变化过程中模型对样本的预测类别也会相应发生变化，那么阈值不断变化导致模型Precision和Recall变化，将这些点连成线也就是PR曲线了。</p>
<h3 id="绘制示例数据的PR曲线"><a href="#绘制示例数据的PR曲线" class="headerlink" title="绘制示例数据的PR曲线"></a>绘制示例数据的PR曲线</h3><blockquote>
<p>为直观展示PR曲线绘制过程，根据示例数据绘制PR曲线（简便起见阈值选定为0.05-0.95，跨度0.1）。</p>
</blockquote>
 <table>
    <tr>
         <th   ><center>阈值</center></th>
        <th colspan="4" ><center>预测-1</center></th>
        <th  colspan="4"><center>预测-2</center></th>
    </tr>  
      <tr>
        <td rowspan="3"><center><font >0.05</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >0.6</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.6</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
     <td rowspan="3"><center><font >0.15</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >0.6</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.67</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.25</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
   <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >0.67</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.67</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.35</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >2</font></center></td>
          <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.86</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.45</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.55</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >5</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.65</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >3</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.5</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.75</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >4</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.33</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.85</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >5</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0.17</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >-</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.95</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
    </tr>
  <tr>
        <td><center><font >Precision</font></center></td>
        <td><center><font >-</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >Precision</font></center></td>
        <td><center><font >-</font></center></td>
          <td><center><font >Recall</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
</table>

<blockquote>
<p>结果坐标</p>
</blockquote>
<table>
      <tr>
        <th colspan = "2"><center><font >编号</font></center></td>
        <th><center><font >1</font></center></td>
          <th><center><font >2</font></center></td>
        <th><center><font >3</font></center></td>
          <th><center><font >4</font></center></td>
        <th><center><font >5</font></center></td>
          <th><center><font >6</font></center></td>
        <th><center><font >7</font></center></td>
<th><center><font >8</font></center></td>
          <th><center><font >9</font></center></td>
        <th><center><font >10</font></center></td>
    </tr>
   <tr>
        <td rowspan="2"><center><font >预测-1</font></center></td>
       <td><center><font >Recall</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >0.83</font></center></td>
       <td><center><font >0.5</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >0.17</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <tr>
        <td><center><font >Precision</font></center></td>
          <td><center><font >0.6</font></center></td>
        <td><center><font >0.6</font></center></td>
          <td><center><font >0.67</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >1</font></center></td>
       <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >-</font></center></td>
    </tr>
   <tr>
        <td rowspan="2"><center><font >预测-2</font></center></td>
         <td><center><font >Recall</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >0.83</font></center></td>
       <td><center><font >0.83</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <tr>
     <td><center><font >Precision</font></center></td>
          <td><center><font >0.6</font></center></td>
        <td><center><font >0.67</font></center></td>
          <td><center><font >0.67</font></center></td>
        <td><center><font >0.86</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >0.83</font></center></td>
       <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >-</font></center></td>
        <td><center><font >-</font></center></td>
    </tr>
</table>

<blockquote>
<p>PR曲线：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200505233947.png" alt="PR曲线"></p>
<blockquote>
<ul>
<li><p>如果一个学习器的P-R曲线被另一个学习器的P-R曲线完全包住，则可断言后者的性能优于前者，示例数据中根据PR曲线可以看到预测2优于预测1</p>
</li>
<li><p>至于有交叉的情况可以判断曲线下方的面积大小来判断，面积大的性能更好</p>
</li>
<li><p>平衡点（BEP）是P=R时的取值，如果这个值较大，则说明学习器的性能较好</p>
</li>
</ul>
<p>参考<a href="https://www.jianshu.com/p/ac46cb7e6f87" target="_blank" rel="noopener">性能评估之PR曲线与ROC曲线</a>。</p>
</blockquote>
<h2 id="ROC曲线"><a href="#ROC曲线" class="headerlink" title="ROC曲线"></a>ROC曲线</h2><blockquote>
<p>ROC曲线英文’receiver operating characteristic curve’，直译为“接受者操作特性曲线”，又称为感受性曲线（sensitivity curve）。得此名的原因在于曲线上各点反映着相同的感受性，它们都是对同一信号刺激的反应，只不过是在几种不同的判定标准下所得的结果而已。</p>
<p>ROC曲线是在门限阈值不断变化过程中以虚警概率（FPR）为横轴，击中概率（TPR）为纵轴绘制而成的曲线。</p>
</blockquote>
<h3 id="绘制示例数据的ROC曲线"><a href="#绘制示例数据的ROC曲线" class="headerlink" title="绘制示例数据的ROC曲线"></a>绘制示例数据的ROC曲线</h3><blockquote>
<p>为直观展示ROC曲线绘制过程，根据示例数据绘制ROC曲线（简便起见阈值选定为0.05-0.95，跨度0.1）。</p>
</blockquote>
 <table>
    <tr>
         <th   ><center>阈值</center></th>
        <th colspan="4" ><center>预测-1</center></th>
        <th  colspan="4"><center>预测-2</center></th>
    </tr>  
      <tr>
        <td rowspan="3"><center><font >0.05</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
     <td rowspan="3"><center><font >0.15</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.25</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
   <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.35</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >6</font></center></td>
        <td><center><font >2</font></center></td>
          <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >6</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0.5</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0.25</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.45</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0.25</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0.25</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.55</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >5</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >3</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.83</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0.25</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.65</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >3</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >3</font></center></td>
          <td><center><font >5</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >1</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.5</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.83</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.75</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >4</font></center></td>
          <td><center><font >2</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >4</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.33</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.85</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >1</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >5</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0.17</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <td rowspan="3"><center><font >0.95</font></center></td>
              <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
          <td><center><font >TP</font></center></td>
            <td><center><font >FP</font></center></td>
              <td><center><font >TN</font></center></td>
            <td><center><font >FN</font></center></td>
    </tr>  
     <tr>
        <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >4</font></center></td>
        <td><center><font >6</font></center></td>
    </tr>
  <tr>
        <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >FPR</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >TPR</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
</table>

<blockquote>
<p>结果坐标</p>
</blockquote>
<table>
      <tr>
        <th colspan = "2"><center><font >编号</font></center></td>
        <th><center><font >1</font></center></td>
          <th><center><font >2</font></center></td>
        <th><center><font >3</font></center></td>
          <th><center><font >4</font></center></td>
        <th><center><font >5</font></center></td>
          <th><center><font >6</font></center></td>
        <th><center><font >7</font></center></td>
<th><center><font >8</font></center></td>
          <th><center><font >9</font></center></td>
        <th><center><font >10</font></center></td>
    </tr>
   <tr>
        <td rowspan="2"><center><font >预测-1</font></center></td>
        <td><center><font >FPR</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >0.75</font></center></td>
        <td><center><font >0.5</font></center></td>
          <td><center><font >0.25</font></center></td>
        <td><center><font >0</font></center></td>
       <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <tr>
        <td><center><font >TPR</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >0.83</font></center></td>
       <td><center><font >0.5</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >0.17</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
   <tr>
        <td rowspan="2"><center><font >预测-2</font></center></td>
        <td><center><font >FPR</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >0.75</font></center></td>
          <td><center><font >0.75</font></center></td>
        <td><center><font >0.25</font></center></td>
          <td><center><font >0.25</font></center></td>
        <td><center><font >0.25</font></center></td>
       <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
 <tr>
        <td><center><font >TPR</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >1</font></center></td>
        <td><center><font >1</font></center></td>
          <td><center><font >0.83</font></center></td>
        <td><center><font >0.83</font></center></td>
       <td><center><font >0.83</font></center></td>
        <td><center><font >0.33</font></center></td>
          <td><center><font >0</font></center></td>
        <td><center><font >0</font></center></td>
    </tr>
</table>

<blockquote>
<p>ROC曲线：</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200505234008.png" alt="ROC曲线"></p>
<blockquote>
<p>ROC曲线图中，坐标（0,0）代表的含义是虚警概率为0，既没有负样本被判定为正样本，同时召回率也为0，既没有正样本被判定为正样本 —— 也就是此处表示所有样本都判定为了负样本。这是由于阈值选择接近1，导致没有样本被划定到正样本区域内，并不说明模型不好，事实上所有的模型都会经过这一点；</p>
<p>同理，坐标（1,1）表示阈值接近0，所有样本均被判定为正；</p>
<p>坐标（0,1）意味着完美的分类器，在虚警为0的情况下正确判断了所有正样本，这也是我们机器学习人的毕生追求。因此ROC曲线越接近左上角，模型性能越好。</p>
</blockquote>
<h2 id="AUC"><a href="#AUC" class="headerlink" title="AUC"></a>AUC</h2><blockquote>
<ul>
<li><p> AUC是英文 Area under Curve的缩写，表示的是ROC曲线下的面积，也就是ROC曲线在[0,1]上的积分</p>
</li>
<li><p>这是用来评价模型分类器性能的指标，对不同模型来说，AUC越大表示分类性能越好</p>
</li>
<li><p>AUC取值范围为[0,1]，有效果的分类器会大于0.5，效果差的会接近0.5</p>
</li>
<li><p>如果有人问为什么不是接近0的效果最差呢？ 事实上如果你得到了AUC为0的分类器，只需要对输出取反你就得到了完美的分类器。</p>
</li>
</ul>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>基础知识</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>性能评估</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习-基础知识 - Precision, Recall, Sensitivity, Specificity, Accuracy, FNR, FPR, TPR, TNR, F1 Score, Balanced F Score</title>
    <url>/2020/02/27/machine_learning/basic_knowledge/performance_evaluation/Performance-evaluation/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍机器学习中的二分类性能评估指标Precision, Recall, Sensitivity, Specificity, Accuracy, FNR, FPR, TNR, TPR, F1 Score, Balanced F Score基本含义，给出公式和具体算例，并作简要分析。</p>
</blockquote>
<a id="more"></a>

<h2 id="基础定义"><a href="#基础定义" class="headerlink" title="基础定义"></a>基础定义</h2><table>
    <tr>
        <th colspan="2" rowspan="2" ><center>评估指标</center></th>
         <th colspan="2" ><center>预测结果</center></th>
    </tr>  
    <tr>
        <th  ><center>正样本</center></th>
        <th  ><center>负样本</center></th>
    </tr >
    <tr >
        <td rowspan="2"><center>实际<br>情况</center></td>
        <td><center>正样本</center></td>
        <td><center>TP</center></td>
        <td><center>FN</center></td>
    </tr>
    <tr >
        <td><center>负样本</center></td>
        <td><center>FP</center></td>
        <td><center>TN</center></td>
    </tr>
</table>

<blockquote>
<p>具体含义和理解参考 <a href="https://www.zywvvd.com/2020/02/26/machine_learning/basic_knowledge/TP_FN_FP_TN/Evaluation-index/">机器学习-基础知识- TP、FN、FP、TN</a>。</p>
</blockquote>
<p><img src="https://photos.zywvvd.com/image/20200506000757.png"></p>
<h2 id="示例用例"><a href="#示例用例" class="headerlink" title="示例用例"></a>示例用例</h2><blockquote>
<p>样本信息</p>
</blockquote>
<table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>真实类别</center></td>
        <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>P</center></td>
         <td><center>N</center></td>
         <td><center>N</center></td>
         <td><center>N</center></td>
    </tr>
</table>
> 预测-1
 <table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>预测类别</center></td>
        <td><center><font color='green'>P</font></center></td>
          <td><center><font color='green'>P</font></center></td>
          <td><center><font color='green'>P</font></center></td>
         <td><center><font color='red'>N</font></center></td>
         <td><center><font color='red'>N</font></center></td>
          <td><center><font color='red'>N</font></center></td>
         <td><center><font color='red'>N</font></center></td>
          <td><center><font color='green'>N</font></center></td>
         <td><center><font color='green'>N</font></center></td>
         <td><center><font color='green'>N</font></center></td>
    </tr>
     <tr>
         <td><center>评估指标</center></td>
         <td><center>TP</center></td>
          <td><center>3</center></td>
          <td><center>TN</center></td>
          <td><center>3</center></td>
          <td><center>FP</center></td>
          <td><center>0</center></td>
          <td><center>FN</center></td>
          <td><center>4</center></td>
     </tr>
</table>

<blockquote>
<p>预测-2</p>
</blockquote>
 <table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>预测类别</center></td>
         <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
          <td><center><font color='red'>N</font></center></td>
          <td><center><font color='red'>N</font></center></td>
          <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
        <td><center><font color='red'>P</font></center></td>
         <td><center><font color='green'>N</font></center></td>
          <td><center><font color='green'>N</font></center></td>
    </tr>
          <tr>
         <td><center>评估指标</center></td>
         <td><center>TP</center></td>
          <td><center>5</center></td>
          <td><center>TN</center></td>
          <td><center>2</center></td>
          <td><center>FP</center></td>
          <td><center>1</center></td>
          <td><center>FN</center></td>
          <td><center>2</center></td>
     </tr>
</table>

<blockquote>
<p>预测-3</p>
</blockquote>
 <table>
    <tr>
        <th ><center>样本编号</center></th>
         <th  ><center>1</center></th>
        <th  ><center>2</center></th>
        <th  ><center>3</center></th>
        <th  ><center>4</center></th>
        <th  ><center>5</center></th>
        <th  ><center>6</center></th>
        <th  ><center>7</center></th>
        <th  ><center>8</center></th>
        <th  ><center>9</center></th>
        <th  ><center>10</center></th>
    </tr>  
    <tr>
        <td><center>预测类别</center></td>
         <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
            <td><center><font color='green'>P</font></center></td>
            <td><center><font color='green'>P</font></center></td>
          <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
         <td><center><font color='green'>P</font></center></td>
        <td><center><font color='red'>P</font></center></td>
         <td><center><font color='red'>P</font></center></td>
          <td><center><font color='red'>P</font></center></td>
    </tr>
          <tr>
         <td><center>评估指标</center></td>
         <td><center>TP</center></td>
          <td><center>7</center></td>
          <td><center>TN</center></td>
          <td><center>0</center></td>
          <td><center>FP</center></td>
          <td><center>3</center></td>
          <td><center>FN</center></td>
          <td><center>0</center></td>
     </tr>
</table>

<h2 id="Precision"><a href="#Precision" class="headerlink" title="Precision"></a>Precision</h2><blockquote>
<p>译为：<code>精确率</code>，<code>查准率</code>。</p>
<p>含义：预测所有正样本中判断正确的比例：</p>
</blockquote>
<p>$$<br>Precision=\frac{TP}{TP+FP}<br>$$</p>
<blockquote>
<p>预测用例Precision：</p>
</blockquote>
<p>$$<br>Precision_{预测1}=\frac{TP}{TP+FP}=\frac{3}{3+0}=1<br>$$</p>
<p>$$<br>Precision_{预测2}=\frac{TP}{TP+FP}=\frac{5}{5+1}\approx 0.83<br>$$</p>
<p>$$<br>Precision_{预测3}=\frac{TP}{TP+FP}=\frac{7}{7+3}=0.7<br>$$</p>
<blockquote>
<p>可以看到预测1判断出的正样本全部正确，因此该预测具有最高的查准率。</p>
<p>可以理解Precision为模型判断为正样本的置信概率，概率越高，该模型判断出的正样本越可信。</p>
</blockquote>
<h2 id="FDR（False-Discorvery-Rate）"><a href="#FDR（False-Discorvery-Rate）" class="headerlink" title="FDR（False Discorvery Rate）"></a>FDR（False Discorvery Rate）</h2><blockquote>
<p>译为：<code>过杀率(工业缺陷)</code>。<br>含义：反映了检测器判断为正样本的样本中，负样本所占比例：</p>
</blockquote>
<p>$$<br>FDR=\frac{FP}{TP+FP}=1-Precision<br>$$</p>
<blockquote>
<p>预测用例FA：</p>
</blockquote>
<p>$$<br>FDR_{预测1}=\frac{FP}{TP+FP}=\frac{0}{3+0}=0<br>$$</p>
<p>$$<br>FDR_{预测2}=\frac{FP}{TP+FP}=\frac{1}{5+1}\approx0.17<br>$$</p>
<p>$$<br>FDR_{预测3}=\frac{FP}{TP+FP}=\frac{3}{7+3}=0.3<br>$$</p>
<h2 id="Recall-Sensitivity-TPR（True-Positive-Rate）"><a href="#Recall-Sensitivity-TPR（True-Positive-Rate）" class="headerlink" title="Recall / Sensitivity / TPR（True Positive Rate）"></a>Recall / Sensitivity / TPR（True Positive Rate）</h2><blockquote>
<p>译为：<code>召回率</code>，<code>查全率</code> ， <code>敏感性</code> ， <code>真正率</code>。</p>
<p>含义：预测正确的所有正样本占实际所有正样本的比例：</p>
</blockquote>
<p>$$<br>Recall=Sensitivity=TPR=\frac{TP}{TP+FN}<br>$$</p>
<blockquote>
<p> 预测用例Recall / Sensitivity / TPR：</p>
</blockquote>
<p>$$<br>Recall_{预测1}=\frac{TP}{TP+FN}=\frac{3}{3+4}\approx0.43<br>$$</p>
<p>$$<br>Recall_{预测2}=\frac{TP}{TP+FN}=\frac{5}{5+2}\approx0.71<br>$$</p>
<p>$$<br>Recall_{预测3}=\frac{TP}{TP+FN}=\frac{7}{7+0}=1<br>$$</p>
<blockquote>
<p>查全率和查准率考量角度不同，不关注模型判断出正样本是否足够准确，关注模型挑对的正样本占全部正样本的比例。</p>
<p>因此最简单判断所有样本为正的策略可以得到100%的查全率，因为这个模型查到的正样本很“全”。</p>
</blockquote>
<h2 id="Specificity-TNR-（True-Negative-Rate）"><a href="#Specificity-TNR-（True-Negative-Rate）" class="headerlink" title="Specificity / TNR （True Negative Rate）"></a>Specificity / TNR （True Negative Rate）</h2><blockquote>
<p>译为：<code>特异度</code>，<code>真负率</code>。<br>含义：预测正确的所有负样本占实际所有负样本的比例：</p>
</blockquote>
<p>$$<br>Specificity=TNR=\frac{TN}{TN+FP}<br>$$</p>
<blockquote>
<p>预测用例Specificity / TNR ：</p>
</blockquote>
<p>$$<br>Specificity_{预测1}=\frac{TN}{TN+FP}=\frac{3}{3+0}=1<br>$$</p>
<p>$$<br>Specificity_{预测2}=\frac{TN}{TN+FP}=\frac{2}{2+1}\approx0.67<br>$$</p>
<p>$$<br>Specificity_{预测3}=\frac{TN}{TN+FP}=\frac{0}{0+3}=0<br>$$</p>
<blockquote>
<p>与查全率相似，描述的是另一边的情况。</p>
</blockquote>
<h2 id="FPR（False-Positive-Rate）"><a href="#FPR（False-Positive-Rate）" class="headerlink" title="FPR（False Positive Rate）"></a>FPR（False Positive Rate）</h2><blockquote>
<p>译为：<code>假正率</code>，<code>误检率</code>，<code>虚警概率</code>。<br>含义：预测误判为正样本的负样本数量占实际所有负样本的比例：</p>
</blockquote>
<p>$$<br>FPR=\frac{FP}{FP+TN}<br>$$</p>
<blockquote>
<p>预测用例FPR：</p>
</blockquote>
<p>$$<br>FPR_{预测1}=\frac{FP}{FP+TN}=\frac{0}{0+3}=0<br>$$</p>
<p>$$<br>FPR_{预测2}=\frac{FP}{FP+TN}=\frac{1}{1+2}\approx0.33<br>$$</p>
<p>$$<br>FPR_{预测3}=\frac{FP}{FP+TN}=\frac{3}{3+0}=1<br>$$</p>
<h2 id="FNR（False-Negative-Rate）"><a href="#FNR（False-Negative-Rate）" class="headerlink" title="FNR（False Negative Rate）"></a>FNR（False Negative Rate）</h2><blockquote>
<p>译为：<code>假负率</code>，<code>漏警概率</code>，<code>漏检率</code>。<br>含义：预测误判为负样本的正样本数量占实际所有正样本的比例：</p>
</blockquote>
<p>$$<br>FNR=\frac{FN}{FN+TP}=1-Recall<br>$$</p>
<blockquote>
<p>预测用例FNR：</p>
</blockquote>
<p>$$<br>FNR_{预测1}=\frac{FN}{FN+TP}=\frac{4}{4+3}\approx0.57<br>$$</p>
<p>$$<br>FNR_{预测2}=\frac{FN}{FN+TP}=\frac{2}{2+5}\approx0.29<br>$$</p>
<p>$$<br>FNR_{预测3}=\frac{FN}{FN+TP}=\frac{0}{0+7}=0<br>$$</p>
<h1 id="Accuracy"><a href="#Accuracy" class="headerlink" title="Accuracy"></a>Accuracy</h1><blockquote>
<p>译为：<code>正确率</code><br>含义：所有实验中预测正确的样本数占所有样本数量的比例。</p>
</blockquote>
<p>$$<br>Accuracy=\frac{TP+TN}{TP+FP+TN+FN}<br>$$</p>
<blockquote>
<p>预测用例Accuracy：</p>
</blockquote>
<p>$$<br>Accuracy_{预测1}=\frac{TP+TN}{TP+FP+TN+FN}=\frac{3+3}{3+0+3+4}=0.6<br>$$</p>
<p>$$<br>Accuracy_{预测2}=\frac{TP+TN}{TP+FP+TN+FN}=\frac{5+2}{5+1+2+2}=0.7<br>$$</p>
<p>$$<br>Accuracy_{预测3}=\frac{TP+TN}{TP+FP+TN+FN}=\frac{7+0}{7+3+0+0}=0.7<br>$$</p>
<blockquote>
<p>事实上预测1,2的模型对正、负样本都是有有一定正确分类能力的，预测3模型仅仅使用了“将所有样本都判为正”的策略既收获了最高的正确率，并不是这个指标有问题，而是数据分布本身并不平衡。</p>
<p>样本中正样本居多，预测3的模型成功预测了数据中正样本占大多数，因此策略得到了高正确率的回报。</p>
</blockquote>
<h2 id="Error-Rate"><a href="#Error-Rate" class="headerlink" title="Error Rate"></a>Error Rate</h2><blockquote>
<p>译为：<code>错误率</code><br>含义：所有实验中预测错误的样本数占所有样本数量的比例。</p>
</blockquote>
<p>$$<br>Error_Rate=\frac{FP+FN}{TP+FP+TN+FN}=1-Accuracy<br>$$</p>
<blockquote>
<p>预测用例Accuracy：</p>
</blockquote>
<p>$$<br>Error_Rate_{预测1}=\frac{FP+FN}{TP+FP+TN+FN}=\frac{0+4}{3+0+3+4}=0.4<br>$$</p>
<p>$$<br>Error_Rate_{预测2}=\frac{FP+FN}{TP+FP+TN+FN}=\frac{1+2}{5+1+2+2}=0.3<br>$$</p>
<p>$$<br>Error_Rate_{预测3}=\frac{FP+FN}{TP+FP+TN+FN}=\frac{3+0}{7+3+0+0}=0.3<br>$$</p>
<h2 id="F1-Score-Balanced-F-Score"><a href="#F1-Score-Balanced-F-Score" class="headerlink" title="F1 Score / Balanced F Score"></a>F1 Score / Balanced F Score</h2><blockquote>
<p>译为：<code>F1 分数</code> / <code>平衡F分数</code><br>含义：F1分数兼顾了分类模型的精确率和召回率，定义为模型精确率和召回率的调和平均数。</p>
</blockquote>
<p>$$<br>F_1 Score=2\times\frac{Precision\times Recall}{Precision+ Recall}<br>$$</p>
<blockquote>
<p>预测用例F1 Score：</p>
</blockquote>
<p>$$<br>F_1 Score_{预测1}=2\times\frac{Precision_{预测1}\times Recall_{预测1}}{Precision_{预测1}+ Recall_{预测1}}=2\times\frac{1\times \frac{3}{7}}{1+ \frac{3}{7}}= 0.6<br>$$</p>
<p>$$<br>F_1 Score_{预测2}=2\times\frac{Precision_{预测2}\times Recall_{预测2}}{Precision_{预测2}+ Recall_{预测2}}=2\times\frac{\frac{5}{6} \times \frac{5}{7}}{\frac{5}{6} + \frac{5}{7}}\approx 0.77<br>$$</p>
<p>$$<br>F_1 Score_{预测3}=2\times\frac{Precision_{预测3}\times Recall_{预测3}}{Precision_{预测3}+ Recall_{预测3}}=2\times\frac{0.7 \times 1}{0.7 + 1}\approx 0.82<br>$$</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>基础知识</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>性能评估</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习-基础知识- TP, FN, FP, TN</title>
    <url>/2020/02/26/machine_learning/basic_knowledge/TP_FN_FP_TN/Evaluation-index/</url>
    <content><![CDATA[<blockquote>
<p>本文介绍机器学习的一系列基础评估指标。</p>
</blockquote>
<a id="more"></a>

<h2 id="基础定义"><a href="#基础定义" class="headerlink" title="基础定义"></a>基础定义</h2><ul>
<li>T ： True 表示判断正确</li>
<li>F ： False 表示判断错误</li>
<li>P ： PostIve 表示判断该样本为正样本</li>
<li>N ： Negative 表示判断该样本为负样本</li>
</ul>
<h2 id="指标定义"><a href="#指标定义" class="headerlink" title="指标定义"></a>指标定义</h2><blockquote>
<p>如果总是记混，按照上述字母顺序翻译出意义即可。</p>
</blockquote>
<ul>
<li>TP ： (T)该判断正确，(P)判断该样本为正样本（事实上样本为正）</li>
<li>TN ： (T)该判断正确，(N)判断该样本为负样本（事实上样本为负）</li>
<li>FP ： (F)该判断错误，(P)判断该样本为正样本（事实上样本为负）</li>
<li>FN ： (F)该判断错误，(N)判断该样本为负样本（事实上样本为正）</li>
</ul>
<table>
    <tr>
        <th colspan="2" rowspan="2" ><center>评估指标</center></th>
         <th colspan="2" ><center>预测结果</center></th>
    </tr>  
    <tr>
        <th  ><center>正样本</center></th>
        <th  ><center>负样本</center></th>
    </tr >
    <tr >
        <td rowspan="2"><center>实际<br>情况</center></td>
        <td><center>正样本</center></td>
        <td><center>TP</center></td>
        <td><center>FN</center></td>
    </tr>
    <tr >
        <td><center>负样本</center></td>
        <td><center>FP</center></td>
        <td><center>TN</center></td>
    </tr>
</table>

<h2 id="加深理解"><a href="#加深理解" class="headerlink" title="加深理解"></a>加深理解</h2><ul>
<li><p>TP和TN为判别器判断正确的情况，把事实上原本的正/负样本正确分类</p>
</li>
<li><p>FP 表示把负样本误认成了正样本，表示虚警</p>
</li>
<li><p>FN表示把正样本误认成了负样本，表示漏警</p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>机器学习</category>
        <category>基础知识</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
        <tag>性能评估</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -3- 常用命令汇总</title>
    <url>/2020/02/25/hexo/3_hexo_commands/hexo-commands/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Hexo常用命令与相应说明，相关文档也可以参考<a href="https://hexo.io/zh-cn/docs/commands" target="_blank" rel="noopener">官方文档</a>。</p>
</blockquote>
<a id="more"></a>

<h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo init [folder]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>新建网站。如果没有设置 <code>folder</code> ，Hexo 默认在目前的文件夹建立网站。</p>
</blockquote>
<h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>新建文章。如果没有设置 <code>layout</code> 的话，默认使用 <a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">_config.yml</a> 中的 <code>default_layout</code> 参数代替。如果标题包含空格的话，请使用引号括起来。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo new &quot;post title with whitespace&quot;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-p</code>, <code>--path</code></td>
<td align="left">自定义新文章的路径</td>
</tr>
<tr>
<td align="left"><code>-r</code>, <code>--replace</code></td>
<td align="left">如果存在同名文章，将其替换</td>
</tr>
<tr>
<td align="left"><code>-s</code>, <code>--slug</code></td>
<td align="left">文章的 Slug，作为新文章的文件名和发布后的 URL</td>
</tr>
</tbody></table>
<p>默认情况下，Hexo 会使用文章的标题来决定文章文件的路径。对于独立页面来说，Hexo 会创建一个以标题为名字的目录，并在目录中放置一个 <code>index.md</code> 文件。你可以使用 <code>--path</code> 参数来覆盖上述行为、自行决定文件的目录：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page --path about&#x2F;me &quot;About me&quot;</span><br></pre></td></tr></table></figure>

<p>以上命令会创建一个 <code>source/about/me.md</code> 文件，同时 Front Matter 中的 title 为 <code>&quot;About me&quot;</code></p>
<p>注意！title 是必须指定的！如果你这么做并不能达到你的目的：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new page --path about&#x2F;me</span><br></pre></td></tr></table></figure>

<p>此时 Hexo 会创建 <code>source/_posts/about/me.md</code>，同时 <code>me.md</code> 的 Front Matter 中的 title 为 <code>&quot;page&quot;</code>。这是因为在上述命令中，hexo-cli 将 <code>page</code> 视为指定文章的标题、并采用默认的 <code>layout</code>。</p>
<h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>生成静态文件。</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-d</code>, <code>--deploy</code></td>
<td align="left">文件生成后立即部署网站</td>
</tr>
<tr>
<td align="left"><code>-w</code>, <code>--watch</code></td>
<td align="left">监视文件变动</td>
</tr>
<tr>
<td align="left"><code>-b</code>, <code>--bail</code></td>
<td align="left">生成过程中如果发生任何未处理的异常则抛出异常</td>
</tr>
<tr>
<td align="left"><code>-f</code>, <code>--force</code></td>
<td align="left">强制重新生成文件 Hexo 引入了差分机制，如果 <code>public</code> 目录存在，那么 <code>hexo g</code> 只会重新生成改动的文件。 使用该参数的效果接近 <code>hexo clean &amp;&amp; hexo generate</code></td>
</tr>
<tr>
<td align="left"><code>-c</code>, <code>--concurrency</code></td>
<td align="left">最大同时生成文件的数量，默认无限制</td>
</tr>
</tbody></table>
<p>该命令可以简写为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure>

<h2 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo publish [layout] &lt;filename&gt;</span><br></pre></td></tr></table></figure>

<p>发表草稿。</p>
<h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>启动服务器。默认情况下，访问网址为： <code>http://localhost:4000/</code>。</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-p</code>, <code>--port</code></td>
<td align="left">重设端口</td>
</tr>
<tr>
<td align="left"><code>-s</code>, <code>--static</code></td>
<td align="left">只使用静态文件</td>
</tr>
<tr>
<td align="left"><code>-l</code>, <code>--log</code></td>
<td align="left">启动日记记录，使用覆盖记录格式</td>
</tr>
</tbody></table>
<p>该命令可以简写为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo s</span><br></pre></td></tr></table></figure>

<h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>部署网站。</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-g</code>, <code>--generate</code></td>
<td align="left">部署之前预先生成静态文件</td>
</tr>
</tbody></table>
<p>该命令可以简写为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></table></figure>

<h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo render &lt;file1&gt; [file2] ...</span><br></pre></td></tr></table></figure>

<p>渲染文件。</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-o</code>, <code>--output</code></td>
<td align="left">设置输出路径</td>
</tr>
</tbody></table>
<h2 id="migrate"><a href="#migrate" class="headerlink" title="migrate"></a>migrate</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo migrate &lt;type&gt;</span><br></pre></td></tr></table></figure>

<p>从其他博客系统 <a href="https://hexo.io/zh-cn/docs/migration" target="_blank" rel="noopener">迁移内容</a>。</p>
<h2 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure>

<p>清除缓存文件 (<code>db.json</code>) 和已生成的静态文件 (<code>public</code>)。</p>
<p>在某些情况（尤其是更换主题后），如果发现您对站点的更改无论如何也不生效，您可能需要运行该命令。</p>
<h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo list &lt;type&gt;</span><br></pre></td></tr></table></figure>

<p>列出网站资料。</p>
<h2 id="version"><a href="#version" class="headerlink" title="version"></a>version</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo version</span><br></pre></td></tr></table></figure>

<p>显示 Hexo 版本。</p>
<h2 id="常用组合命令"><a href="#常用组合命令" class="headerlink" title="常用组合命令"></a>常用组合命令</h2><blockquote>
<p>清除缓存、重新生成静态文件</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g</span><br></pre></td></tr></table></figure>

<blockquote>
<p>清除缓存、重新生成静态文件、同时部署</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure>



<h2 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h2><h3 id="安全模式"><a href="#安全模式" class="headerlink" title="安全模式"></a>安全模式</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo --safe</span><br></pre></td></tr></table></figure>

<p>在安全模式下，不会载入插件和脚本。当您在安装新插件遭遇问题时，可以尝试以安全模式重新执行。</p>
<h3 id="调试模式"><a href="#调试模式" class="headerlink" title="调试模式"></a>调试模式</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo --debug</span><br></pre></td></tr></table></figure>

<p>在终端中显示调试信息并记录到 <code>debug.log</code>。当您碰到问题时，可以尝试用调试模式重新执行一次，并 <a href="https://github.com/hexojs/hexo/issues/new" target="_blank" rel="noopener">提交调试信息到 GitHub</a>。</p>
<h3 id="简洁模式"><a href="#简洁模式" class="headerlink" title="简洁模式"></a>简洁模式</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo --silent</span><br></pre></td></tr></table></figure>

<p>隐藏终端信息。</p>
<h3 id="自定义配置文件的路径"><a href="#自定义配置文件的路径" class="headerlink" title="自定义配置文件的路径"></a>自定义配置文件的路径</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 使用 custom.yml 代替默认的 _config.yml</span><br><span class="line">$ hexo server --config custom.yml</span><br><span class="line"></span><br><span class="line"># 使用 custom.yml 和 custom2.json，其中 custom2.json 优先级更高</span><br><span class="line">$ hexo generate --config custom.yml,custom2.json,custom3.yml</span><br></pre></td></tr></table></figure>

<p>自定义配置文件的路径，指定这个参数后将不再使用默认的 <code>_config.yml</code>。<br>你可以使用一个 YAML 或 JSON 文件的路径，也可以使用逗号分隔（无空格）的多个 YAML 或 JSON 文件的路径。例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 使用 custom.yml 代替默认的 _config.yml</span><br><span class="line">$ hexo server --config custom.yml</span><br><span class="line"></span><br><span class="line"># 使用 custom.yml, custom2.json 和 custom3.yml，其中 custom3.yml 优先级最高，其次是 custom2.json</span><br><span class="line">$ hexo generate --config custom.yml,custom2.json,custom3.yml</span><br></pre></td></tr></table></figure>

<p>当你指定了多个配置文件以后，Hexo 会按顺序将这部分配置文件合并成一个 <code>_multiconfig.yml</code>。如果遇到重复的配置，排在后面的文件的配置会覆盖排在前面的文件的配置。这个原则适用于任意数量、任意深度的 YAML 和 JSON 文件。</p>
<h3 id="显示草稿"><a href="#显示草稿" class="headerlink" title="显示草稿"></a>显示草稿</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo --draft</span><br></pre></td></tr></table></figure>

<p>显示 <code>source/_drafts</code> 文件夹中的草稿文章。</p>
<h3 id="自定义-CWD"><a href="#自定义-CWD" class="headerlink" title="自定义 CWD"></a>自定义 CWD</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo --cwd &#x2F;path&#x2F;to&#x2F;cwd</span><br></pre></td></tr></table></figure>

<p>自定义当前工作目录（Current working directory）的路径。</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - xlrd,xlwt模块操作excel文件</title>
    <url>/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/</url>
    <content><![CDATA[<blockquote>
<p>Python输出的数据用Excel文件查看往往更直观，而且Excel中的数据也常常需要读取到Python程序中。Python的xlrd和xlwt模块便是为此而生。文本记录这两个模块的使用方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h2><blockquote>
<p>使用read_test.xlsx作为读取excel的测试文件。其中两个工作表，分别为：</p>
</blockquote>
<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/read_test1.png" class="" title="测试信息表1">

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/read_test2.png" class="" title="测试信息表2">

<h2 id="模块安装"><a href="#模块安装" class="headerlink" title="模块安装"></a>模块安装</h2><blockquote>
<p>用pip可以方便地安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install xlrd</span><br><span class="line">pip install xlwt</span><br></pre></td></tr></table></figure>

<h2 id="xlrd"><a href="#xlrd" class="headerlink" title="xlrd"></a>xlrd</h2><h3 id="读取excel文件（xls，xlsx）"><a href="#读取excel文件（xls，xlsx）" class="headerlink" title="读取excel文件（xls，xlsx）"></a>读取excel文件（xls，xlsx）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 读取excel文件</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    data = xlrd.open_workbook(<span class="string">'read_test.xlsx'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    print(err)</span><br></pre></td></tr></table></figure>

<h3 id="获取工作表信息"><a href="#获取工作表信息" class="headerlink" title="获取工作表信息"></a>获取工作表信息</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取工作表信息</span></span><br><span class="line">print(len(data.sheets()))</span><br><span class="line">sheet_names = data.sheet_names()</span><br><span class="line">print(sheet_names)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="number">2</span></span><br><span class="line">[<span class="string">'信息表2'</span>, <span class="string">'信息表1'</span>]</span><br></pre></td></tr></table></figure>

<h3 id="获取工作表内容"><a href="#获取工作表内容" class="headerlink" title="获取工作表内容"></a>获取工作表内容</h3><h4 id="通过索引"><a href="#通过索引" class="headerlink" title="通过索引"></a>通过索引</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 通过索引获取工作表内容</span></span><br><span class="line">info_sheet_1 = data.sheet_by_index(<span class="number">0</span>)</span><br><span class="line">info_sheet_2 = data.sheet_by_index(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'sheet :<span class="subst">&#123;info_sheet_1.name&#125;</span>  row_num: <span class="subst">&#123;info_sheet_1.nrows&#125;</span> column_num: <span class="subst">&#123;info_sheet_1.ncols&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'sheet :<span class="subst">&#123;info_sheet_2.name&#125;</span>  row_num: <span class="subst">&#123;info_sheet_2.nrows&#125;</span> column_num: <span class="subst">&#123;info_sheet_2.ncols&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sheet :信息表<span class="number">1</span>  row_num: <span class="number">5</span> column_num: <span class="number">7</span></span><br><span class="line">sheet :信息表<span class="number">2</span>  row_num: <span class="number">5</span> column_num: <span class="number">7</span></span><br></pre></td></tr></table></figure>

<h4 id="通过名称"><a href="#通过名称" class="headerlink" title="通过名称"></a>通过名称</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 通过名称获取工作表内容</span></span><br><span class="line">sheet_names = data.sheet_names()</span><br><span class="line">info_sheet_1 = data.sheet_by_name(sheet_names[<span class="number">0</span>])</span><br><span class="line">info_sheet_2 = data.sheet_by_name(sheet_names[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'sheet :<span class="subst">&#123;info_sheet_1.name&#125;</span>  row_num: <span class="subst">&#123;info_sheet_1.nrows&#125;</span> column_num: <span class="subst">&#123;info_sheet_1.ncols&#125;</span>'</span>)</span><br><span class="line">print(<span class="string">f'sheet :<span class="subst">&#123;info_sheet_2.name&#125;</span>  row_num: <span class="subst">&#123;info_sheet_2.nrows&#125;</span> column_num: <span class="subst">&#123;info_sheet_2.ncols&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sheet :信息表<span class="number">1</span>  row_num: <span class="number">5</span> column_num: <span class="number">7</span></span><br><span class="line">sheet :信息表<span class="number">2</span>  row_num: <span class="number">5</span> column_num: <span class="number">7</span></span><br></pre></td></tr></table></figure>

<h3 id="获取工作表中数据内容"><a href="#获取工作表中数据内容" class="headerlink" title="获取工作表中数据内容"></a>获取工作表中数据内容</h3><h4 id="获取工作表行信息"><a href="#获取工作表行信息" class="headerlink" title="获取工作表行信息"></a>获取工作表行信息</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取工作表行信息</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(info_sheet_1.nrows):</span><br><span class="line">    print(info_sheet_1.row_values(i))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(info_sheet_2.nrows):</span><br><span class="line">    print(info_sheet_2.row_values(i))</span><br><span class="line">    </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'信息表 1'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'姓名'</span>, <span class="string">'性别'</span>, <span class="string">'年龄'</span>, <span class="string">'籍贯'</span>, <span class="string">'手机'</span>, <span class="string">'邮箱'</span>, <span class="string">'备注'</span>]</span><br><span class="line">[<span class="string">'淑芬'</span>, <span class="string">'女'</span>, <span class="number">32.0</span>, <span class="string">'山东'</span>, <span class="number">12345678900.0</span>, <span class="string">'Shufen@163.com'</span>, <span class="string">'爱好读书'</span>]</span><br><span class="line">[<span class="string">'建国'</span>, <span class="string">'男'</span>, <span class="number">43.0</span>, <span class="string">'北京'</span>, <span class="number">13265498700.0</span>, <span class="string">'Jianguo@126.com'</span>, <span class="string">'儿女双全'</span>]</span><br><span class="line">[<span class="string">'大胖'</span>, <span class="string">'男'</span>, <span class="number">18.0</span>, <span class="string">'甘肃'</span>, <span class="number">12435698700.0</span>, <span class="string">'Dapang@110.com'</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'信息表 2'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'姓名'</span>, <span class="string">'性别'</span>, <span class="string">'年龄'</span>, <span class="string">'籍贯'</span>, <span class="string">'手机'</span>, <span class="string">'邮箱'</span>, <span class="string">'备注'</span>]</span><br><span class="line">[<span class="string">'三凤'</span>, <span class="string">'女'</span>, <span class="number">28.0</span>, <span class="string">'河南'</span>, <span class="number">12388678900.0</span>, <span class="string">'sanfeng@163.com'</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'王聪'</span>, <span class="string">'男'</span>, <span class="number">31.0</span>, <span class="string">'浙江'</span>, <span class="number">13266498700.0</span>, <span class="string">'Wangcong@119.com'</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'Lilei'</span>, <span class="string">'男'</span>, <span class="number">22.0</span>, <span class="string">'Australia'</span>, <span class="number">12499998700.0</span>, <span class="string">'Lilei@130.com'</span>, <span class="string">'英语流利'</span>]</span><br></pre></td></tr></table></figure>
<h4 id="获取工作表列信息"><a href="#获取工作表列信息" class="headerlink" title="获取工作表列信息"></a>获取工作表列信息</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取工作表列信息</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(info_sheet_1.ncols):</span><br><span class="line">    print(info_sheet_1.col_values(i))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(info_sheet_2.ncols):</span><br><span class="line">    print(info_sheet_2.col_values(i))</span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt;[<span class="string">'信息表 1'</span>, <span class="string">'姓名'</span>, <span class="string">'淑芬'</span>, <span class="string">'建国'</span>, <span class="string">'大胖'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'性别'</span>, <span class="string">'女'</span>, <span class="string">'男'</span>, <span class="string">'男'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'年龄'</span>, <span class="number">32.0</span>, <span class="number">43.0</span>, <span class="number">18.0</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'籍贯'</span>, <span class="string">'山东'</span>, <span class="string">'北京'</span>, <span class="string">'甘肃'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'手机'</span>, <span class="number">12345678900.0</span>, <span class="number">13265498700.0</span>, <span class="number">12435698700.0</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'邮箱'</span>, <span class="string">'Shufen@163.com'</span>, <span class="string">'Jianguo@126.com'</span>, <span class="string">'Dapang@110.com'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'备注'</span>, <span class="string">'爱好读书'</span>, <span class="string">'儿女双全'</span>, <span class="string">''</span>]</span><br><span class="line">[<span class="string">'信息表 2'</span>, <span class="string">'姓名'</span>, <span class="string">'三凤'</span>, <span class="string">'王聪'</span>, <span class="string">'Lilei'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'性别'</span>, <span class="string">'女'</span>, <span class="string">'男'</span>, <span class="string">'男'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'年龄'</span>, <span class="number">28.0</span>, <span class="number">31.0</span>, <span class="number">22.0</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'籍贯'</span>, <span class="string">'河南'</span>, <span class="string">'浙江'</span>, <span class="string">'Australia'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'手机'</span>, <span class="number">12388678900.0</span>, <span class="number">13266498700.0</span>, <span class="number">12499998700.0</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'邮箱'</span>, <span class="string">'sanfeng@163.com'</span>, <span class="string">'Wangcong@119.com'</span>, <span class="string">'Lilei@130.com'</span>]</span><br><span class="line">[<span class="string">''</span>, <span class="string">'备注'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">'英语流利'</span>]</span><br></pre></td></tr></table></figure>

<h4 id="获取工作表指定位置信息"><a href="#获取工作表指定位置信息" class="headerlink" title="获取工作表指定位置信息"></a>获取工作表指定位置信息</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取工作表指定位置信息</span></span><br><span class="line">print(info_sheet_1.cell(<span class="number">2</span>,<span class="number">1</span>).value) </span><br><span class="line">print(info_sheet_1.cell_value(<span class="number">2</span>,<span class="number">1</span>))</span><br><span class="line">print(info_sheet_1.row(<span class="number">2</span>)[<span class="number">1</span>].value)</span><br><span class="line">print(info_sheet_1.row_values(<span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">print(info_sheet_1.col(<span class="number">1</span>)[<span class="number">2</span>].value)</span><br><span class="line">print(info_sheet_1.col_values(<span class="number">1</span>)[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;女</span><br><span class="line">女</span><br><span class="line">女</span><br><span class="line">女</span><br><span class="line">女</span><br><span class="line">女</span><br></pre></td></tr></table></figure>

<h4 id="获取工作表中数据的类型"><a href="#获取工作表中数据的类型" class="headerlink" title="获取工作表中数据的类型"></a>获取工作表中数据的类型</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取工作表中数据的类型</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(info_sheet_1.ncols):</span><br><span class="line">    print(info_sheet_1.cell(<span class="number">2</span>,i).ctype) </span><br><span class="line">    </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p># 说明：ctype : 0 empty,1 string, 2 number, 3 date, 4 boolean, 5 error</p>
</blockquote>
<h4 id="获取合并单元格信息"><a href="#获取合并单元格信息" class="headerlink" title="获取合并单元格信息"></a>获取合并单元格信息</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 获取合并单元格信息</span></span><br><span class="line">print(info_sheet_1.merged_cells)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>)]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这返回的四个数字定位了一组合并单元格操作，如果把四个数表示为(A,B,C,D)，可以这样理解：</p>
<ul>
<li>合并单元格的起始（左上角）单元格（在合并区域内）坐标为[A,C]</li>
<li>合并单元格的结束（右下角）单元格（在合并区域外）坐标为[B,D]</li>
</ul>
</blockquote>
<h2 id="xlwt"><a href="#xlwt" class="headerlink" title="xlwt"></a>xlwt</h2><h3 id="建立xlwt对象"><a href="#建立xlwt对象" class="headerlink" title="建立xlwt对象"></a>建立xlwt对象</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"></span><br><span class="line"><span class="comment">## 建立xlwt对象</span></span><br><span class="line">wb = xlwt.Workbook()</span><br></pre></td></tr></table></figure>

<h3 id="建立工作表"><a href="#建立工作表" class="headerlink" title="建立工作表"></a>建立工作表</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 建立工作表</span></span><br><span class="line">test_sheet_1 = xlsx_writer.add_sheet(<span class="string">'Test Sheet 1'</span>) </span><br><span class="line">test_sheet_2 = xlsx_writer.add_sheet(<span class="string">'Test Sheet 2'</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xlsx'</span>)   <span class="comment"># 保存xlsx</span></span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xls'</span>)   <span class="comment"># 保存xls</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    print(err)</span><br></pre></td></tr></table></figure>

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/write1.png" class="" title="建立工作表">

<h3 id="向数据表写入内容"><a href="#向数据表写入内容" class="headerlink" title="向数据表写入内容"></a>向数据表写入内容</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 向数据表写入内容</span></span><br><span class="line">test_sheet_1.write(<span class="number">1</span>,<span class="number">1</span>,<span class="number">123</span>)</span><br><span class="line">test_sheet_1.write(<span class="number">1</span>,<span class="number">2</span>,<span class="number">110</span>)</span><br><span class="line">test_sheet_1.write(<span class="number">1</span>,<span class="number">3</span>,xlwt.Formula(<span class="string">"B2+C2"</span>))</span><br><span class="line">test_sheet_1.write(<span class="number">1</span>,<span class="number">4</span>,<span class="string">'test'</span>)</span><br><span class="line">test_sheet_1.write(<span class="number">1</span>,<span class="number">5</span>,<span class="literal">True</span>)</span><br><span class="line">test_sheet_2.write(<span class="number">3</span>,<span class="number">3</span>,xlwt.Formula(<span class="string">"'&#123;&#125;'!$B$2+'&#123;&#125;'!$D$2"</span>.format(test_sheet_1.name,test_sheet_1.name)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xlsx'</span>)   <span class="comment"># 保存xlsx</span></span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xls'</span>)   <span class="comment"># 保存xls</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    print(err)</span><br></pre></td></tr></table></figure>

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/write2.png" class="" title="表格1">

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/write3.png" class="" title="表格2">

<h3 id="设置列宽、行高"><a href="#设置列宽、行高" class="headerlink" title="设置列宽、行高"></a>设置列宽、行高</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 设置列宽、行高</span></span><br><span class="line">test_sheet_1.col(<span class="number">0</span>).width = <span class="number">400</span>*<span class="number">30</span> </span><br><span class="line">test_sheet_1.row(<span class="number">0</span>).height = <span class="number">1000</span> </span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xlsx'</span>)   <span class="comment"># 保存xlsx</span></span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xls'</span>)   <span class="comment"># 保存xls</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    print(err)</span><br></pre></td></tr></table></figure>

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/write4.png" class="" title="表格宽高">

<h3 id="设置内容样式"><a href="#设置内容样式" class="headerlink" title="设置内容样式"></a>设置内容样式</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 初始化样式</span></span><br><span class="line">style = xlwt.XFStyle()  <span class="comment"># 样式类实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建字体</span></span><br><span class="line">font = xlwt.Font() <span class="comment"># 字体类实例</span></span><br><span class="line">font.name = <span class="string">'Times New Roman'</span> <span class="comment"># 字体名称</span></span><br><span class="line">font.bold = <span class="literal">True</span> <span class="comment"># 加粗</span></span><br><span class="line">font.italic =<span class="literal">True</span> <span class="comment"># 倾斜</span></span><br><span class="line">font.height = <span class="number">300</span> <span class="comment"># 字号 200 为 10 points</span></span><br><span class="line">font.colour_index=<span class="number">3</span> <span class="comment"># 颜色编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建边框</span></span><br><span class="line">borders= xlwt.Borders() <span class="comment"># 边框类实例</span></span><br><span class="line">borders.left= <span class="number">6</span></span><br><span class="line">borders.right= <span class="number">6</span></span><br><span class="line">borders.top= <span class="number">6</span></span><br><span class="line">borders.bottom= <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建对齐</span></span><br><span class="line">alignment = xlwt.Alignment() <span class="comment"># 对齐类实例</span></span><br><span class="line"><span class="comment">#alignment.horz = xlwt.Alignment.HORZ_LEFT    # 水平左对齐</span></span><br><span class="line"><span class="comment">#alignment.horz = xlwt.Alignment.HORZ_RIGHT     # 水平右对齐</span></span><br><span class="line">alignment.horz = xlwt.Alignment.HORZ_CENTER      <span class="comment"># 水平居中 </span></span><br><span class="line"><span class="comment">#alignment.vert = xlwt.Alignment.VERT_TOP  # 垂直靠上</span></span><br><span class="line"><span class="comment">#alignment.vert = xlwt.Alignment.VERT_BOTTOM  # 垂直靠下</span></span><br><span class="line">alignment.vert = xlwt.Alignment.VERT_CENTER      <span class="comment"># 垂直居中 </span></span><br><span class="line">alignment.wrap = <span class="number">1</span>      <span class="comment"># 自动换行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建模式</span></span><br><span class="line">pattern = xlwt.Pattern() <span class="comment"># 模式类实例</span></span><br><span class="line">pattern.pattern = xlwt.Pattern.SOLID_PATTERN <span class="comment"># 固定的样式</span></span><br><span class="line">pattern.pattern_fore_colour = xlwt.Style.colour_map[<span class="string">'yellow'</span>] <span class="comment"># 背景颜色</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 应用样式</span></span><br><span class="line">style.font = font</span><br><span class="line">style.borders = borders</span><br><span class="line">style.num_format_str = <span class="string">'#,##0.0000'</span> <span class="comment"># 内容格式</span></span><br><span class="line">style.alignment = alignment</span><br><span class="line">style.pattern=pattern</span><br><span class="line"></span><br><span class="line"><span class="comment">## 合并单元格(A,B,C,D) 表示合并左上角[A,C]和右下角[B,D]单元格坐标(均在合并单元格内部)</span></span><br><span class="line">test_sheet_1.write_merge(<span class="number">3</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="string">' Merge '</span>,style) <span class="comment"># ' Merge ' 为写入内容，应用 style 样式</span></span><br><span class="line"></span><br><span class="line">test_sheet_1.write(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1234567.890123</span>,style) <span class="comment"># 向[0,0]坐标单元格写入数据，应用style样式</span></span><br><span class="line"></span><br><span class="line">style.num_format_str = <span class="string">'#,##0.000%'</span> <span class="comment"># 内容格式</span></span><br><span class="line">test_sheet_1.write(<span class="number">6</span>, <span class="number">0</span>, <span class="number">67.8123456</span>,style) <span class="comment"># 整数部分用逗号分隔，小数部分保留3位小数并以百分数表示</span></span><br><span class="line"></span><br><span class="line">style.num_format_str = <span class="string">'###%'</span> <span class="comment"># 内容格式</span></span><br><span class="line">test_sheet_1.write(<span class="number">6</span>, <span class="number">5</span>, <span class="number">0.128</span>,style) </span><br><span class="line"></span><br><span class="line">style.num_format_str = <span class="string">'###.##%'</span> <span class="comment"># 内容格式</span></span><br><span class="line">test_sheet_1.write(<span class="number">6</span>, <span class="number">4</span>, <span class="number">0.128</span>,style) </span><br><span class="line"></span><br><span class="line">style.num_format_str = <span class="string">'000.00%'</span> <span class="comment"># 内容格式</span></span><br><span class="line">test_sheet_1.write(<span class="number">6</span>, <span class="number">3</span>, <span class="number">0.128</span>,style) </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xlsx'</span>)   <span class="comment"># 保存xlsx</span></span><br><span class="line">    xlsx_writer.save(<span class="string">'write_test.xls'</span>)   <span class="comment"># 保存xls</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">    print(err)</span><br></pre></td></tr></table></figure>

<img src="/2020/02/25/python/python_xlrd_xlwt/python-xlrd-xlwt/write5.png" class="" title="设置内容样式">

<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Excel</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - 获取文件夹内所有文件</title>
    <url>/2020/02/25/python/file_list/python-file-list/</url>
    <content><![CDATA[<blockquote>
<p>本文记录Python 获取指定文件夹内所有文件的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><blockquote>
<p>新建了3个文件夹和11个文件</p>
</blockquote>
<img src="/2020/02/25/python/file_list/python-file-list/ceshihuanjing.png" class="" title="测试环境">

<h2 id="glob"><a href="#glob" class="headerlink" title="glob"></a>glob</h2><blockquote>
<p>glob模块可以返回指定路径（可绝对/可相对）下的符合制定匹配模式的文件路径。</p>
<ul>
<li><code>*</code> ： 匹配0或多个任意字符</li>
<li><code>?</code>： 匹配单个字符</li>
<li><code>[]</code>： 匹配范围内的字符（如<code>[a-d]</code>匹配a,b,c,d）</li>
</ul>
</blockquote>
<h3 id="glob-glob"><a href="#glob-glob" class="headerlink" title="glob.glob"></a>glob.glob</h3><blockquote>
<p> 返回所有匹配文件路径列表，参数为pathname，该参数中定义路径匹配规则。</p>
</blockquote>
<p>用例1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">file_path=<span class="string">'*'</span></span><br><span class="line">print(glob.glob(file_path))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'3b'</span>, <span class="string">'b'</span>, <span class="string">'1'</span>, <span class="string">'2b'</span>, <span class="string">'2a'</span>, <span class="string">'1a'</span>, <span class="string">'2'</span>, <span class="string">'3a'</span>, <span class="string">'glob_test.py'</span>, <span class="string">'1b'</span>]</span><br></pre></td></tr></table></figure>

<p>用例2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">file_path=<span class="string">'*[0-9]'</span></span><br><span class="line">print(glob.glob(file_path))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'3'</span>, <span class="string">'d2'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'d3'</span>, <span class="string">'d1'</span>]</span><br></pre></td></tr></table></figure>

<p>用例3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">file_path=<span class="string">'?'</span></span><br><span class="line">print(glob.glob(file_path))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>]</span><br></pre></td></tr></table></figure>

<p>用例4</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">file_path=<span class="string">'*b'</span></span><br><span class="line">print(glob.glob(file_path))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'3b'</span>, <span class="string">'b'</span>, <span class="string">'2b'</span>, <span class="string">'1b'</span>]</span><br></pre></td></tr></table></figure>

<h3 id="glob-iglob"><a href="#glob-iglob" class="headerlink" title="glob.iglob"></a>glob.iglob</h3><blockquote>
<p>iglob返回<em>generator</em>对象，每次调用返回一个路径。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">file_path=<span class="string">'*'</span></span><br><span class="line">generator=glob.iglob(file_path)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> generator:</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span></span><br><span class="line">a</span><br><span class="line"><span class="number">3</span>b</span><br><span class="line">d2</span><br><span class="line">b</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span>b</span><br><span class="line"><span class="number">2</span>a</span><br><span class="line"><span class="number">1</span>a</span><br><span class="line"><span class="number">2</span></span><br><span class="line">d3</span><br><span class="line"><span class="number">3</span>a</span><br><span class="line">glob_test.py</span><br><span class="line">d1</span><br><span class="line"><span class="number">1</span>b</span><br></pre></td></tr></table></figure>

<h2 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h2><blockquote>
<p>glob方便好用，但是从上述用例输出可以看出glob难以区分文件夹和文件，只识别名称，虽然绝大多数情况文件有后缀，为以往万一，在此补充OS返回指定文件夹下文件名的方法。</p>
</blockquote>
<h3 id="OS-walk"><a href="#OS-walk" class="headerlink" title="OS.walk"></a>OS.walk</h3><blockquote>
<p>OS.walk(filepath) 返回指定目录下所有目录、文件、子目录下的目录、文件。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">filePath = <span class="string">'.'</span></span><br><span class="line"><span class="keyword">for</span> i,j,k <span class="keyword">in</span> os.walk(filePath):</span><br><span class="line">    print(i,j,k)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>. [<span class="string">'d2'</span>, <span class="string">'d3'</span>, <span class="string">'d1'</span>] [<span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'3b'</span>, <span class="string">'b'</span>, <span class="string">'1'</span>, <span class="string">'2b'</span>, <span class="string">'2a'</span>, <span class="string">'1a'</span>, <span class="string">'2'</span>, <span class="string">'3a'</span>, <span class="string">'glob_test.py'</span>, <span class="string">'1b'</span>]</span><br><span class="line">./d2 [] []</span><br><span class="line">./d3 [] []</span><br><span class="line">./d1 [] []</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>i：父目录路径</li>
<li>j：父目录内文件夹</li>
<li>k：父目录内文件</li>
</ul>
</blockquote>
<h3 id="os-listdir"><a href="#os-listdir" class="headerlink" title="os.listdir"></a>os.listdir</h3><blockquote>
<p>os.listdir(filepath)和glob.glob(‘*’)效果类似，返回文件夹下所有文件与文件夹名。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">filePath = <span class="string">'.'</span>    </span><br><span class="line">print(os.listdir(filePath))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'3b'</span>, <span class="string">'d2'</span>, <span class="string">'b'</span>, <span class="string">'1'</span>, <span class="string">'2b'</span>, <span class="string">'2a'</span>, <span class="string">'1a'</span>, <span class="string">'2'</span>, <span class="string">'d3'</span>, <span class="string">'3a'</span>, <span class="string">'glob_test.py'</span>, <span class="string">'d1'</span>, <span class="string">'1b'</span>]</span><br></pre></td></tr></table></figure>

<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>文件处理</tag>
      </tags>
  </entry>
  <entry>
    <title>Python - DOM操作XML技巧汇总</title>
    <url>/2020/02/24/python/processing_xml/python-xml/</url>
    <content><![CDATA[<blockquote>
<p>XML已经成为数据传输存储使用越来越广泛的数据格式，本文讲述使用Python DOM处理XML文件的方法。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>安装Python</li>
<li><a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/24/course/words/XML/xml-%E6%95%99%E7%A8%8B/">XML基础知识</a></li>
</ul>
<h2 id="Python常用处理XML库"><a href="#Python常用处理XML库" class="headerlink" title="Python常用处理XML库"></a>Python常用处理XML库</h2><blockquote>
<p> 常见的 XML 编程接口有 DOM 和 SAX，这两种接口处理 XML 文件的方式不同，当然使用场合也不同。Python 有三种方法解析 XML，SAX，DOM，以及 ElementTree:</p>
</blockquote>
<h3 id="DOM-Document-Object-Model-本文介绍"><a href="#DOM-Document-Object-Model-本文介绍" class="headerlink" title="DOM(Document Object Model) - 本文介绍"></a>DOM(Document Object Model) - 本文介绍</h3><p>DOM (Document Object Model) 译为文档对象模型，是 HTML 和 XML 文档的编程接口。HTML DOM 定义了访问和操作 HTML 文档的标准方法。将 XML 数据在内存中解析成一个树，通过对树的操作来操作XML。</p>
<h3 id="SAX-simple-API-for-XML"><a href="#SAX-simple-API-for-XML" class="headerlink" title="SAX (simple API for XML )"></a>SAX (simple API for XML )</h3><p>Python 标准库包含 SAX 解析器，SAX 用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。</p>
<h3 id="ElementTree-元素树"><a href="#ElementTree-元素树" class="headerlink" title="ElementTree(元素树)"></a>ElementTree(元素树)</h3><p>ElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。</p>
<h2 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--file name "test.xml" 2020.2.24 by VVD--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bookstore</span> <span class="attr">type</span>=<span class="string">"info science"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"Coding"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>C++Primer<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>StanleyB.Lippman<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>60.0<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2009<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"Computer"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>编译原理<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">author</span>&gt;</span>AlfredV.Aho<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">price</span>&gt;</span>70.0<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2013<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Python-DOM-解析XML"><a href="#Python-DOM-解析XML" class="headerlink" title="Python DOM 解析XML"></a>Python DOM 解析XML</h2><h3 id="DOM节点树"><a href="#DOM节点树" class="headerlink" title="DOM节点树"></a>DOM节点树</h3><blockquote>
<p>一个 DOM 的解析器在解析一个 XML 文档时，一次性读取整个文档，把文档中所有元素保存在内存中的一个树结构里。</p>
</blockquote>
<img src="/2020/02/24/python/processing_xml/python-xml/nodetree.gif" class="" title="节点示例">

<h4 id="节点级别"><a href="#节点级别" class="headerlink" title="节点级别"></a>节点级别</h4><blockquote>
<p>节点树中的节点彼此之间都有等级关系。</p>
</blockquote>
<ul>
<li>在节点树中，顶端的节点成为根节点</li>
<li>根节点之外的每个节点都有一个父节点</li>
<li>节点可以有任何数量的子节点</li>
<li>叶子是没有子节点的节点</li>
<li>同级节点是拥有相同父节点的节点</li>
</ul>
<h3 id="解析XML"><a href="#解析XML" class="headerlink" title="解析XML"></a>解析XML</h3><blockquote>
<p>python 加载DOM解析XML，并输出整个XML</p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#加载DOM minidom模块</span></span><br><span class="line"><span class="keyword">from</span> xml.dom.minidom <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="comment">#解析XML文件</span></span><br><span class="line">contents=parse(<span class="string">'test.xml'</span>)</span><br><span class="line">root=contents.documentElement</span><br><span class="line"></span><br><span class="line">print(root.toxml())</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&lt;bookstore type=<span class="string">"info science"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;book category=<span class="string">"Coding"</span>&gt;</span><br><span class="line">		&lt;title&gt;C++Primer&lt;/title&gt;</span><br><span class="line">		&lt;author&gt;StanleyB.Lippman&lt;/author&gt;</span><br><span class="line">		&lt;price&gt;60.0&lt;/price&gt;</span><br><span class="line">        &lt;year&gt;2009&lt;/year&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line"></span><br><span class="line">	&lt;book category=<span class="string">"Computer"</span>&gt;</span><br><span class="line">		&lt;title&gt;编译原理&lt;/title&gt;</span><br><span class="line">		&lt;author&gt;AlfredV.Aho&lt;/author&gt;</span><br><span class="line">		&lt;price&gt;70.0&lt;/price&gt;</span><br><span class="line">        &lt;year&gt;2013&lt;/year&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bookstore&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时root获取了XML文件中所有内容，组织成了一棵树，root就是该树的根节点</p>
</blockquote>
<h3 id="获取节点名称"><a href="#获取节点名称" class="headerlink" title="获取节点名称"></a>获取节点名称</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取节点名称</span></span><br><span class="line">print(root.nodeName)</span><br><span class="line">print(root.tagName)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bookstore</span><br><span class="line">bookstore</span><br></pre></td></tr></table></figure>

<h3 id="获取子节点"><a href="#获取子节点" class="headerlink" title="获取子节点"></a>获取子节点</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取子节点</span></span><br><span class="line">children_Nodes=root.childNodes</span><br><span class="line">print(<span class="string">f'子节点个数：<span class="subst">&#123;children_Nodes.length&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> children_Nodes:</span><br><span class="line">    <span class="keyword">print</span> (item.toxml())</span><br><span class="line">    </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>子节点个数：<span class="number">5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&lt;book category=<span class="string">"Coding"</span>&gt;</span><br><span class="line">		&lt;title&gt;C++Primer&lt;/title&gt;</span><br><span class="line">		&lt;author&gt;StanleyB.Lippman&lt;/author&gt;</span><br><span class="line">		&lt;price&gt;60.0&lt;/price&gt;</span><br><span class="line">        &lt;year&gt;2009&lt;/year&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&lt;book category=<span class="string">"Computer"</span>&gt;</span><br><span class="line">		&lt;title&gt;编译原理&lt;/title&gt;</span><br><span class="line">		&lt;author&gt;AlfredV.Aho&lt;/author&gt;</span><br><span class="line">		&lt;price&gt;70.0&lt;/price&gt;</span><br><span class="line">        &lt;year&gt;2013&lt;/year&gt;</span><br><span class="line">	&lt;/book&gt;</span><br></pre></td></tr></table></figure>

<h3 id="节点类型"><a href="#节点类型" class="headerlink" title="节点类型"></a>节点类型</h3><blockquote>
<p>为什么2本书却有5个节点？</p>
<p>因为两本书前中后各有一个回车，被划为文本节点。</p>
<p>DOM规定节点：</p>
<ol>
<li>整个文档是一个文档节点</li>
<li>每个 XML 标签是一个元素节点</li>
<li>包含在 XML 元素中的文本是文本节点</li>
<li>每一个 XML 属性是一个属性节点</li>
<li>注释属于注释节点</li>
</ol>
</blockquote>
<img src="/2020/02/24/python/processing_xml/python-xml/leixing.png" class="" title="节点类型">

<h4 id="文本总是存储在文本节点中"><a href="#文本总是存储在文本节点中" class="headerlink" title="文本总是存储在文本节点中"></a>文本总是存储在文本节点中</h4><blockquote>
<p> 在 DOM 处理中一个普遍的错误是，认为元素节点包含文本。</p>
<p> 不过，元素节点的文本是存储在文本节点中的。</p>
<p> 在这个例子中：<code>&lt;year&gt;2005&lt;/year&gt;</code>，元素节点 <code>&lt;year&gt;</code>，拥有一个值为 “2005” 的文本节点。</p>
<p> “2005” 不是 <code>&lt;year&gt;</code> 元素的值！d</p>
</blockquote>
<h3 id="获取节点属性"><a href="#获取节点属性" class="headerlink" title="获取节点属性"></a>获取节点属性</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取节点属性</span></span><br><span class="line">print(root.attributes.items())</span><br><span class="line">atr_root=root.attributes[<span class="string">'type'</span>]</span><br><span class="line">print(atr_root.name)</span><br><span class="line">print(atr_root.value)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[(<span class="string">'type'</span>, <span class="string">'info science'</span>)]</span><br><span class="line">type</span><br><span class="line">info science</span><br></pre></td></tr></table></figure>

<h3 id="获取指定名称的节点"><a href="#获取指定名称的节点" class="headerlink" title="获取指定名称的节点"></a>获取指定名称的节点</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取指定名称的节点</span></span><br><span class="line">books=root.getElementsByTagName(<span class="string">'book'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> book <span class="keyword">in</span> books:</span><br><span class="line">    <span class="keyword">print</span> (book.nodeName)</span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt;book</span><br><span class="line">book</span><br></pre></td></tr></table></figure>

<h3 id="判断是否包含属性值"><a href="#判断是否包含属性值" class="headerlink" title="判断是否包含属性值"></a>判断是否包含属性值</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#判断是否包含属性值</span></span><br><span class="line">print(books[<span class="number">0</span>].hasAttribute(<span class="string">'nnn'</span>))</span><br><span class="line">print(books[<span class="number">0</span>].hasAttribute(<span class="string">'category'</span>))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="literal">False</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="获取节点指定属性的属性值"><a href="#获取节点指定属性的属性值" class="headerlink" title="获取节点指定属性的属性值"></a>获取节点指定属性的属性值</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取节点指定属性的属性值</span></span><br><span class="line">print(books[<span class="number">0</span>].getAttribute(<span class="string">'category'</span>))</span><br><span class="line">print(books[<span class="number">1</span>].getAttribute(<span class="string">'category'</span>))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;Coding</span><br><span class="line">Computer</span><br></pre></td></tr></table></figure>

<h3 id="获取节点文本值"><a href="#获取节点文本值" class="headerlink" title="获取节点文本值"></a>获取节点文本值</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取节点文本值</span></span><br><span class="line">node=books[<span class="number">0</span>]</span><br><span class="line">author=node.getElementsByTagName(<span class="string">'author'</span>)</span><br><span class="line">print(author[<span class="number">0</span>].firstChild.data)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;StanleyB.Lippman</span><br></pre></td></tr></table></figure>

<h3 id="判断是否有子节点"><a href="#判断是否有子节点" class="headerlink" title="判断是否有子节点"></a>判断是否有子节点</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#判断是否有子节点</span></span><br><span class="line">print(root.hasChildNodes())</span><br><span class="line">print(author[<span class="number">0</span>].hasChildNodes())</span><br><span class="line">print(author[<span class="number">0</span>].firstChild.hasChildNodes())</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="literal">True</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h3 id="DOM解析XML方法总结"><a href="#DOM解析XML方法总结" class="headerlink" title="DOM解析XML方法总结"></a>DOM解析XML方法总结</h3><ul>
<li>contents = xml.dom.minidom.parse(filename)：加载读取XML文件</li>
<li>node = contents.documentElement：获取XML文档对象</li>
<li>node.getAttribute(AttributeName)：获取XML节点属性值</li>
<li>node.getElementsByTagName(TagName)：获取XML节点对象集合</li>
<li>node.childNodes ：返回子节点列表。</li>
<li>node.childNodes[index].nodeValue：获取XML节点值</li>
<li>node.firstChild：访问第一个节点，等价于pagexml.childNodes[0]</li>
<li>node.toxml(‘UTF-8’)返回Node节点的xml表示的文本：</li>
<li>访问元素属性：<br>atr=Node.attributes[“id”]<br>atr.name # “id”<br>atr.value #属性的值</li>
<li>node.nodeName/node.tagName：节点的名称</li>
<li>node.nodeValue：节点的值，文本节点才有值，其它节点返回的是None</li>
<li>node.nodeType：节点的类型</li>
</ul>
<h2 id="Python-DOM-修改XML"><a href="#Python-DOM-修改XML" class="headerlink" title="Python DOM 修改XML"></a>Python DOM 修改XML</h2><h3 id="生成XML树、添加属性"><a href="#生成XML树、添加属性" class="headerlink" title="生成XML树、添加属性"></a>生成XML树、添加属性</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> xml.dom <span class="keyword">import</span> minidom</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.创建DOM树对象</span></span><br><span class="line">dom=minidom.Document()</span><br><span class="line"><span class="comment"># 2.创建根节点。每次都要用DOM对象来创建任何节点。</span></span><br><span class="line">root_node=dom.createElement(<span class="string">'root'</span>)</span><br><span class="line"><span class="comment"># 3.用DOM对象添加根节点</span></span><br><span class="line">dom.appendChild(root_node)</span><br><span class="line"><span class="comment"># 用DOM对象创建元素子节点</span></span><br><span class="line">book_node=dom.createElement(<span class="string">'book'</span>)</span><br><span class="line"><span class="comment"># 用父节点对象添加元素子节点</span></span><br><span class="line">root_node.appendChild(book_node)</span><br><span class="line"><span class="comment"># 设置该节点的属性</span></span><br><span class="line">book_node.setAttribute(<span class="string">'price'</span>,<span class="string">'399'</span>)</span><br><span class="line">name_node=dom.createElement(<span class="string">'name'</span>)</span><br><span class="line">book_node.appendChild(name_node)</span><br><span class="line"><span class="comment"># 也用DOM创建文本节点，把文本节点（文字内容）看成子节点</span></span><br><span class="line">name_text=dom.createTextNode(<span class="string">'C++ Primer 第1版'</span>)</span><br><span class="line"><span class="comment"># 用添加了文本的节点对象（看成文本节点的父节点）添加文本节点</span></span><br><span class="line">name_node.appendChild(name_text)</span><br><span class="line"></span><br><span class="line">print(dom.toxml()) <span class="comment">#字符格式输出</span></span><br><span class="line">print(dom.toprettyxml()) <span class="comment">#美丽的输出</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; &lt;?xml version="1.0" ?&gt;&lt;root&gt;&lt;book price="399"&gt;&lt;name&gt;C++ Primer 第1版&lt;/name&gt;&lt;/book&gt;&lt;/root&gt;</span><br><span class="line">&lt;?xml version="1.0" ?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">	&lt;book price=<span class="string">"399"</span>&gt;</span><br><span class="line">		&lt;name&gt;C++ Primer 第1版&lt;/name&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<h3 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#增加要删除的节点</span></span><br><span class="line">another_node=dom.createElement(<span class="string">'delete'</span>)</span><br><span class="line">another_node_child=dom.createElement(<span class="string">'content'</span>)</span><br><span class="line">another_node_child_text=dom.createTextNode(<span class="string">'testing data'</span>)</span><br><span class="line">another_node_child.appendChild(another_node_child_text)</span><br><span class="line">another_node.appendChild(another_node_child)</span><br><span class="line">root_node.appendChild(another_node)</span><br><span class="line">print(dom.toprettyxml())</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&lt;?xml version="1.0" ?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">	&lt;book price=<span class="string">"399"</span>&gt;</span><br><span class="line">		&lt;name&gt;C++ Primer 第1版&lt;/name&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line">	&lt;delete&gt;</span><br><span class="line">		&lt;content&gt;testing data&lt;/content&gt;</span><br><span class="line">	&lt;/delete&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#删除上文增加的节点</span></span><br><span class="line">children_Nodes=root_node.childNodes</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(children_Nodes.length<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">if</span> children_Nodes[i].tagName==<span class="string">'delete'</span>:</span><br><span class="line">        children_Nodes.remove(children_Nodes[i]) <span class="comment">#删除root中的文本节点</span></span><br><span class="line"></span><br><span class="line">print(dom.toprettyxml())</span><br><span class="line">        </span><br><span class="line">&gt;&gt;&gt; &lt;?xml version="1.0" ?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">	&lt;book price=<span class="string">"399"</span>&gt;</span><br><span class="line">		&lt;name&gt;C++ Primer 第1版&lt;/name&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<h3 id="删除节点属性"><a href="#删除节点属性" class="headerlink" title="删除节点属性"></a>删除节点属性</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#删除节点属性</span></span><br><span class="line">book_node.setAttribute(<span class="string">'price'</span>,<span class="string">'199'</span>)</span><br><span class="line">print(book_node.hasAttribute(<span class="string">'price'</span>))</span><br><span class="line">print(book_node.getAttribute(<span class="string">'price'</span>))</span><br><span class="line">book_node.removeAttribute(<span class="string">'price'</span>)</span><br><span class="line">print(book_node.hasAttribute(<span class="string">'price'</span>))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="literal">True</span></span><br><span class="line"><span class="number">199</span></span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h3 id="修改节点内容"><a href="#修改节点内容" class="headerlink" title="修改节点内容"></a>修改节点内容</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改节点内容</span></span><br><span class="line">children_Nodes=root_node.childNodes</span><br><span class="line">name_Append = <span class="string">' (中文版)'</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> children_Nodes:</span><br><span class="line">    <span class="comment">#print (item.toxml())</span></span><br><span class="line">    tag_name=<span class="string">'name'</span></span><br><span class="line">    c_name = item.getElementsByTagName(tag_name)</span><br><span class="line">    print(c_name[<span class="number">0</span>].firstChild.data)</span><br><span class="line">    c_name[<span class="number">0</span>].firstChild.data+=name_Append</span><br><span class="line">print(dom.toprettyxml())</span><br><span class="line">    </span><br><span class="line">    &gt;&gt;&gt;C++ Primer 第<span class="number">1</span>版</span><br><span class="line">&lt;?xml version="1.0" ?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">	&lt;book&gt;</span><br><span class="line">		&lt;name&gt;C++ Primer 第1版 (中文版)&lt;/name&gt;</span><br><span class="line">	&lt;/book&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<h3 id="修改节点属性"><a href="#修改节点属性" class="headerlink" title="修改节点属性"></a>修改节点属性</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改节点属性</span></span><br><span class="line">book_node.setAttribute(<span class="string">'price'</span>,<span class="string">'199'</span>)</span><br><span class="line">print(book_node.hasAttribute(<span class="string">'price'</span>))</span><br><span class="line">print(book_node.getAttribute(<span class="string">'price'</span>))</span><br><span class="line"></span><br><span class="line">book_node.setAttribute(<span class="string">'price'</span>,<span class="string">'399'</span>)</span><br><span class="line">print(book_node.getAttribute(<span class="string">'price'</span>))</span><br><span class="line"></span><br><span class="line">book_node.setAttribute(<span class="string">'price2'</span>,<span class="string">'599'</span>)</span><br><span class="line">print(book_node.attributes.items())</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">True</span></span><br><span class="line"><span class="number">199</span></span><br><span class="line"><span class="number">399</span></span><br><span class="line">[(<span class="string">'price'</span>, <span class="string">'399'</span>), (<span class="string">'price2'</span>, <span class="string">'599'</span>)]</span><br></pre></td></tr></table></figure>

<h3 id="修改节点名称-可用、不安全"><a href="#修改节点名称-可用、不安全" class="headerlink" title="修改节点名称(可用、不安全)"></a>修改节点名称(可用、不安全)</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改节点名称(可用、不安全)</span></span><br><span class="line">name_node=dom.createElement(<span class="string">'name'</span>)</span><br><span class="line">name_node.nodeName=<span class="string">'node name'</span></span><br><span class="line">name_node.tagName=<span class="string">'tag name'</span></span><br><span class="line">root_node.appendChild(name_node)</span><br><span class="line">print(dom.toxml())</span><br><span class="line">print(name_node.nodeName)</span><br><span class="line">print(name_node.localName)</span><br><span class="line"><span class="comment">#删掉刚刚增加的测试节点</span></span><br><span class="line">children_Nodes=root_node.childNodes</span><br><span class="line">children_Nodes.remove(children_Nodes[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&lt;?xml version="1.0" ?&gt;&lt;root&gt;&lt;book price="399" price2="599"&gt;&lt;name&gt;C++ Primer 第1版 (中文版)&lt;/name&gt;&lt;/book&gt;&lt;tag name/&gt;&lt;/root&gt;</span><br><span class="line">node name</span><br><span class="line">tag name</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以看到，改变tagName在事实上实现了改变节点名称的效果，但nodeName并没有一并更新，使用时需要谨慎。</p>
</blockquote>
<h3 id="DOM修改XML方法总结"><a href="#DOM修改XML方法总结" class="headerlink" title="DOM修改XML方法总结"></a>DOM修改XML方法总结</h3><ul>
<li>dom=minidom.Document()  #创建DOM树对象</li>
<li>root_node=dom.createElement(‘root’) #用DOM对象创建元素节点</li>
<li>name_text=dom.createTextNode(‘计算机程序设计语言 第1版’)#用DOM对象创建文本节点</li>
<li>dom.appendChild(root_node) # 用DOM对象添加节点</li>
<li>book_node.setAttribute(‘price’,’199’) #添加节点属性（可多个），也可以用来覆盖修改原有的属性</li>
<li>children_Nodes.remove(children_Nodes[i]) #删除节点</li>
<li>book_node.removeAttribute(‘price’) #删除节点属性</li>
<li>price[0].firstChild.data=str(price_float) #直接修改文本节点完成对xml保存内容的修改</li>
<li>name_node.tagName=’tag name’ #修改节点名称</li>
</ul>
<h2 id="Python-DOM-写入XML"><a href="#Python-DOM-写入XML" class="headerlink" title="Python DOM 写入XML"></a>Python DOM 写入XML</h2><h3 id="写入XML"><a href="#写入XML" class="headerlink" title="写入XML"></a>写入XML</h3><blockquote>
<p> 语法：writexml(writer, indent=””, addindent=””, newl=””, encoding=None)</p>
</blockquote>
<ul>
<li>writer：文件对象</li>
<li>indent：根节点缩进格式（一般根节点不缩进，所以一般为空）</li>
<li>addindent：子节点缩进格式（一般为空格<code>    </code>或制表符<code>\t</code>）</li>
<li>newl：换行格式（一般为换行回车<code>\n</code>)</li>
<li>encoding：编码方式</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Python DOM 写入XML</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'write_test.xml'</span>,<span class="string">'w'</span>,encoding=<span class="string">'UTF-8'</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    dom.writexml(writer,indent=<span class="string">''</span>,addindent=<span class="string">'    '</span>,newl=<span class="string">'\n'</span>,encoding=<span class="string">'UTF-8'</span>)</span><br></pre></td></tr></table></figure>

<p>得到xml文件<code>write_test.xml</code>：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">book</span> <span class="attr">price</span>=<span class="string">"399"</span> <span class="attr">price2</span>=<span class="string">"599"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>C++ Primer 第1版 (中文版)<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><blockquote>
<p>文中测试环境与所有源码可在<a href="https://github.com/zywvvd/Python_Practise" target="_blank" rel="noopener">Github</a>下载。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>XML</tag>
      </tags>
  </entry>
  <entry>
    <title>文字编码 - XML 教程</title>
    <url>/2020/02/24/words/xml/course/xml/</url>
    <content><![CDATA[<blockquote>
<p>XML 指可扩展标记语言，被设计用来传输和存储数据。本文记录XML基础知识。</p>
<p>教程参考<a href="https://www.w3school.com.cn/xml/index.asp" target="_blank" rel="noopener">w3school</a>。</p>
</blockquote>
<a id="more"></a>

<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li>XML 指可扩展标记语言（EXtensible Markup Language）</li>
<li>XML 是一种标记语言，很类似 HTML</li>
<li>XML 的设计宗旨是传输数据，而非显示数据</li>
<li>XML 标签没有被预定义。您需要自行定义标签</li>
<li>XML 被设计为具有自我描述性。</li>
<li>XML 是 W3C 的推荐标准</li>
<li>XML 是没有任何行为的纯文本，仅编码保存数据</li>
</ul>
<h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><ul>
<li>XML 把数据从 HTML 分离</li>
<li>XML 简化数据共享</li>
<li>XML 简化数据传输</li>
<li>XML 简化平台的变更</li>
</ul>
<h2 id="XML-树结构"><a href="#XML-树结构" class="headerlink" title="XML 树结构"></a>XML 树结构</h2><blockquote>
<p>XML 文档形成了一种树结构，它从“根部”开始，然后扩展到“枝叶”。</p>
</blockquote>
<ul>
<li><p>XML 文档必须包含根元素。该元素是所有其他元素的父元素</p>
</li>
<li><p>XML 文档中的元素形成了一棵文档树。这棵树从根部开始，并扩展到树的最底端</p>
</li>
<li><p>所有元素均可拥有子元素</p>
</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"COOKING"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span>Everyday Italian<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Giada De Laurentiis<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>30.00<span class="tag">&lt;/<span class="name">price</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"CHILDREN"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"WEB"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span>Learning XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Erik T. Ray<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2003<span class="tag">&lt;/<span class="name">year</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>39.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码表示了具有如下元素框架的三本书。</p>
</blockquote>
<img src="/2020/02/24/words/xml/course/xml/nodetree.gif" class="" title="数据结构实例">

<h2 id="语法规则"><a href="#语法规则" class="headerlink" title="语法规则"></a>语法规则</h2><ul>
<li><p>所有 XML 元素都须有关闭标签（声明不是XML元素，恰好他又不需要关闭）</p>
</li>
<li><p>XML 标签对大小写敏感，必须使用相同的大小写来编写打开标签和关闭标签：</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Message</span>&gt;</span>这是错误的。<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span>这是正确的。<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>XML 必须正确地嵌套</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span>错误嵌套<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span>正确嵌套<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>XML 文档必须有根元素</li>
</ul>
<blockquote>
<p>XML 文档必须有一个元素是所有其他元素的父元素。该元素称为根元素。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">subchild</span>&gt;</span>.....<span class="tag">&lt;/<span class="name">subchild</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>XML 的属性值须加引号</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">date</span>=<span class="string">08/08/2008</span>&gt;</span>      <span class="comment">&lt;!-- 错误属性 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">date</span>=<span class="string">"08/08/2008"</span>&gt;</span>      <span class="comment">&lt;!-- 正确属性 --&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>实体引用</li>
</ul>
<blockquote>
<p>在 XML 中，有 5 个预定义的实体引用：</p>
</blockquote>
<table>
<thead>
<tr>
<th>&lt;</th>
<th>&lt;</th>
<th>小于</th>
</tr>
</thead>
<tbody><tr>
<td>&gt;</td>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&amp;</td>
<td>&amp;</td>
<td>和号</td>
</tr>
<tr>
<td>&apos;</td>
<td>‘</td>
<td>单引号</td>
</tr>
<tr>
<td>&quot;</td>
<td>“</td>
<td>引号</td>
</tr>
</tbody></table>
<ul>
<li>注释</li>
</ul>
<blockquote>
<p>语法与 HTML 的语法很相似：</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- This is a comment --&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>在 XML 中，空格会被保留</p>
</li>
<li><p>XML 以 LF 存储换行</p>
</li>
</ul>
<blockquote>
<p>在 Windows 应用程序中，换行通常以一对字符来存储：回车符 (CR) 和换行符 (LF)。这对字符与打字机设置新行的动作有相似之处。在 Unix 应用程序中，新行以 LF 字符存储。而 Macintosh 应用程序使用 CR 来存储新行。</p>
</blockquote>
<h2 id="XML-元素"><a href="#XML-元素" class="headerlink" title="XML 元素"></a>XML 元素</h2><h3 id="XML-元素-1"><a href="#XML-元素-1" class="headerlink" title="XML 元素"></a>XML 元素</h3><blockquote>
<p>XML 元素指的是从（且包括）开始标签直到（且包括）结束标签的部分。</p>
<p>元素可包含其他元素、文本或者两者的混合物。元素也可以拥有属性。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"CHILDREN"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">"WEB"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Learning XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Erik T. Ray<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2003<span class="tag">&lt;/<span class="name">year</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>39.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="XML-命名规则"><a href="#XML-命名规则" class="headerlink" title="XML 命名规则"></a>XML 命名规则</h3><ul>
<li>名称可以含字母、数字以及其他的字符</li>
<li>名称不能以数字或者标点符号开始</li>
<li>名称不能以字符 “xml”（或者 XML、Xml）开始</li>
<li>名称不能包含空格</li>
</ul>
<h3 id="最佳命名习惯"><a href="#最佳命名习惯" class="headerlink" title="最佳命名习惯"></a>最佳命名习惯</h3><ul>
<li><p>使名称具有描述性。使用下划线的名称也很不错。</p>
</li>
<li><p>名称应当比较简短，比如：<book_title>，而不是：<the_title_of_the_book>。</p>
</li>
<li><p>避免 “-“ 字符。如果您按照这样的方式进行命名：”first-name”，一些软件会认为你需要提取第一个单词。</p>
</li>
<li><p>避免 “.” 字符。如果您按照这样的方式进行命名：”first.name”，一些软件会认为 “name” 是对象 “first” 的属性。</p>
</li>
<li><p>避免 “:” 字符。冒号会被转换为命名空间来使用（稍后介绍）。</p>
</li>
</ul>
<h2 id="XML-属性"><a href="#XML-属性" class="headerlink" title="XML 属性"></a>XML 属性</h2><blockquote>
<p>XML 元素可以在开始标签中包含属性，类似 HTML。属性 (Attribute) 提供关于元素的额外（附加）信息。</p>
</blockquote>
<ul>
<li>XML 属性必须加引号，单引号和双引号均可使用。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">person</span> <span class="attr">sex</span>=<span class="string">"female"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">person</span> <span class="attr">sex</span>=<span class="string">'female'</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="XML-元素-vs-属性"><a href="#XML-元素-vs-属性" class="headerlink" title="XML 元素 vs. 属性"></a>XML 元素 vs. 属性</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">person</span> <span class="attr">sex</span>=<span class="string">"female"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">firstname</span>&gt;</span>Anna<span class="tag">&lt;/<span class="name">firstname</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">lastname</span>&gt;</span>Smith<span class="tag">&lt;/<span class="name">lastname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">person</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">person</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">sex</span>&gt;</span>female<span class="tag">&lt;/<span class="name">sex</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">firstname</span>&gt;</span>Anna<span class="tag">&lt;/<span class="name">firstname</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">lastname</span>&gt;</span>Smith<span class="tag">&lt;/<span class="name">lastname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">person</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>上述代码表示了同样的信息，也就是说XML中，属性携带的信息量可以被子元素取代。没有什么规矩可以告诉我们什么时候该使用属性，而什么时候该使用子元素。在 HTML 中，属性用起来很便利，但是在 XML 中，您应该尽量避免使用属性。如果信息感觉起来很像数据，那么请使用子元素吧。</p>
</blockquote>
<h3 id="XML属性的缺点"><a href="#XML属性的缺点" class="headerlink" title="XML属性的缺点"></a>XML属性的缺点</h3><ul>
<li>属性无法包含多重的值（元素可以）</li>
<li>属性无法描述树结构（元素可以）</li>
<li>属性不易扩展（为未来的变化）</li>
<li>属性难以阅读和维护</li>
</ul>
<h2 id="XML-验证"><a href="#XML-验证" class="headerlink" title="XML 验证"></a>XML 验证</h2><blockquote>
<p>拥有正确语法的 XML 被称为“形式良好”的 XML。通过 DTD 验证的 XML 是“合法”的 XML。</p>
</blockquote>
<h3 id="“形式良好”（Well-Formed）的-XML-文档"><a href="#“形式良好”（Well-Formed）的-XML-文档" class="headerlink" title="“形式良好”（Well Formed）的 XML 文档"></a>“形式良好”（Well Formed）的 XML 文档</h3><ul>
<li>XML 文档必须有根元素</li>
<li>XML 文档必须有关闭标签</li>
<li>XML 标签对大小写敏感</li>
<li>XML 元素必须被正确的嵌套</li>
<li>XML 属性必须加引号</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>文字编码</category>
      </categories>
      <tags>
        <tag>XML</tag>
        <tag>文字编码</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu 软件推荐 - 截图利器 flameshot-具有快捷键自由截图、截图涂鸦、截图添加文字等功能</title>
    <url>/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/</url>
    <content><![CDATA[<blockquote>
<p>Ubuntu 在使用过程中经常有截图的需求，自带的截图工具功能单一。我对截图工具的需求是：快捷键自由区域截图、可涂鸦（框、箭头、模糊）、可添加文字、可保存到指定文件夹、可复制到剪贴板、速度快。结合上述特征，推荐大家使用flameshot 0.6+(0.5+版本不带文字工具）。</p>
</blockquote>
<a id="more"></a>

<h2 id="安装方法一（亲测可用）"><a href="#安装方法一（亲测可用）" class="headerlink" title="安装方法一（亲测可用）"></a>安装方法一（亲测可用）</h2><blockquote>
<p>参考链接：<a href="https://blog.csdn.net/qq_36743482/article/details/94735338" target="_blank" rel="noopener">Ubuntu（Debian）截图并编辑软件推荐</a>。</p>
</blockquote>
<h3 id="clone-github"><a href="#clone-github" class="headerlink" title="clone github"></a>clone github</h3><blockquote>
<p>通过github下载源码编译安装，首先在终端进入软件安装的文件夹（我选择了/usr/share/flameshot/，此处需要超级用户权限），clone仓库：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo git clone https://github.com/lupoDharkael/flameshot.git</span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/gitclone.png" class="" title="clone仓库">

<h3 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h3><blockquote>
<p>根据作者在github上的安装介绍，安装Ubuntu（Debian）依赖库：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Compile-time</span></span><br><span class="line">sudo apt install g++ build-essential qt5-default qt5-qmake qttools5-dev-tools</span><br></pre></td></tr></table></figure>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/yilaiku1.png" class="" title="安装依赖库">
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Run-time</span></span><br><span class="line">sudo apt install libqt5dbus5 libqt5network5 libqt5core5a libqt5widgets5 libqt5gui5 libqt5svg5-dev</span><br></pre></td></tr></table></figure>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/yilaiku2.png" class="" title="安装依赖库">
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Optional</span></span><br><span class="line">sudo apt install git openssl ca-certificates</span><br></pre></td></tr></table></figure>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/yilaiku3.png" class="" title="安装依赖库">

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure>

<h3 id="Build-amp-Install"><a href="#Build-amp-Install" class="headerlink" title="Build &amp; Install"></a>Build &amp; Install</h3><blockquote>
<p>进入flameshot根目录，执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mkdir build</span><br><span class="line">cd build</span><br><span class="line">qmake ../</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/build.png" class="" title="Build">

<blockquote>
<p>继续执行：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/install.png" class="" title="Install">

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><blockquote>
<p>此时已经成功安装flameshot，输入命令测试并查看程序版本，运行时间（2020.02.24）：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">flameshot --version</span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/test.png" class="" title="测试">

<blockquote>
<p>版本V0.6+即可，执行flameshot命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">flameshot</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时屏幕右上角会出现“火焰截屏”的图标。</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/tubiao.png" class="" title="图标">

<blockquote>
<p>右键图标，选择设置，勾选文字功能。</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/wenzishezhi.png" class="" title="添加文字功能">

<blockquote>
<p>此时双击火焰图标可以进行截图。</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/jieping.png" class="" title="截图过程">

<h3 id="设置键盘快捷键"><a href="#设置键盘快捷键" class="headerlink" title="设置键盘快捷键"></a>设置键盘快捷键</h3><blockquote>
<p>距离拥有类似QQ截图功能只差一步，打开系统设置，选择设备。</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/kuaijiejian1.png" class="" title="系统设置">

<blockquote>
<p>键盘-键盘快捷键-滚动条最下面-添加-设置快捷键（我设置的是ctrl+alt+A）</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/kuaijiejian2.png" class="" title="快捷键设置">

<blockquote>
<p>之后就可以享受便捷截图的快乐了！</p>
</blockquote>
<h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h3><blockquote>
<ul>
<li><p>选区过后可以进行涂鸦、添加文字、模糊等编辑操作</p>
</li>
<li><p>通过滚轮改变字号、符号粗细</p>
</li>
<li><p>ctrl+S 保存当前截图</p>
</li>
<li><p>Enter 当前截图存入剪贴板</p>
</li>
<li><p>ctrl+Z 撤销</p>
</li>
<li><p>Esc 取消</p>
</li>
</ul>
<p>也可以进入设置界面自行设置</p>
</blockquote>
<img src="/2020/02/24/software/recommend/ubuntu/flameshot/Ubuntu-flameshot/jiepingshili.png" class="" title="截图展示">

<h2 id="安装方法二"><a href="#安装方法二" class="headerlink" title="安装方法二"></a>安装方法二</h2><blockquote>
<p>apt安装（未测试）</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:rikmills/bionic</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt install flameshot</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>软件</category>
        <category>软件推荐</category>
        <category>Ubuntu 软件推荐</category>
      </categories>
      <tags>
        <tag>软件</tag>
        <tag>软件推荐</tag>
        <tag>Ubuntu 软件推荐</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -2- 站点信息配置</title>
    <url>/2020/02/24/hexo/2_hexo_config/Hexo_config/</url>
    <content><![CDATA[<blockquote>
<p> Hexo框架中配置文件内容描述与示例。</p>
</blockquote>
<a id="more"></a>

<h2 id="config-yml-站点配置文件"><a href="#config-yml-站点配置文件" class="headerlink" title="_config.yml - 站点配置文件"></a>_config.yml - 站点配置文件</h2><blockquote>
<p>在各种Hexo相关教程中频繁出现<code>站点配置文件</code>，指的是Hexo根目录中的文件<code>_config.yml</code>。</p>
</blockquote>
<img src="/2020/02/24/hexo/2_hexo_config/Hexo_config/zhandianpeizhiwenjian.png" class="" title="站点配置文件">

<blockquote>
<p>具体内容也可以参考<a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">官方文档</a>。</p>
</blockquote>
<ul>
<li>注意：配置过程中每一项的<code>英文冒号</code>后需要一个<code>空格</code>。</li>
</ul>
<h2 id="Site-网站"><a href="#Site-网站" class="headerlink" title="Site - 网站"></a>Site - 网站</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>title</code></td>
<td align="left">网站标题</td>
</tr>
<tr>
<td align="left"><code>subtitle</code></td>
<td align="left">网站副标题</td>
</tr>
<tr>
<td align="left"><code>description</code></td>
<td align="left">网站描述</td>
</tr>
<tr>
<td align="left"><code>keywords</code></td>
<td align="left">网站的关键词。使用半角逗号 <code>,</code> 分隔多个关键词。</td>
</tr>
<tr>
<td align="left"><code>author</code></td>
<td align="left">您的名字</td>
</tr>
<tr>
<td align="left"><code>language</code></td>
<td align="left">网站使用的语言 (<code>初始建议此处设置为zh-Hans，便于后续稳定翻译</code>)</td>
</tr>
<tr>
<td align="left"><code>timezone</code></td>
<td align="left">网站时区。Hexo 默认使用您电脑的时区。请参考 <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="noopener">时区列表</a> 进行设置，如 <code>America/New_York</code>, <code>Japan</code>, 和 <code>UTC</code> 。一般的，对于中国大陆地区可以使用 <code>Asia/Shanghai</code>。</td>
</tr>
</tbody></table>
<p><font color='red' face='黑体' size=5><b>这部分是我们刚刚建站时需要设置的部分，建议修改。<br>以我的站点配置为例：</b></font></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">又见苍岚</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">'www.zywvvd.com'</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">'Stay hungury ! Stay foolish ！'</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="string">'人工智能, 深度学习, 个人博客'</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Yiwei</span> <span class="string">Zhang</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-Hans</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/hexo/2_hexo_config/Hexo_config/title.png" class="" title="示例效果">

<h2 id="URL-网址"><a href="#URL-网址" class="headerlink" title="URL - 网址"></a>URL - 网址</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>url</code></td>
<td align="left">网址</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>root</code></td>
<td align="left">网站根目录</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>permalink</code></td>
<td align="left">文章的 <a href="https://hexo.io/zh-cn/docs/permalinks" target="_blank" rel="noopener">永久链接</a> 格式</td>
<td align="left"><code>:year/:month/:day/:title/</code></td>
</tr>
<tr>
<td align="left"><code>permalink_defaults</code></td>
<td align="left">永久链接中各部分的默认值</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>pretty_urls</code></td>
<td align="left">改写 <a href="https://hexo.io/zh-cn/docs/variables" target="_blank" rel="noopener"><code>permalink</code></a> 的值来美化 URL</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>pretty_urls.trailing_index</code></td>
<td align="left">是否在永久链接中保留尾部的 <code>index.html</code>，设置为 <code>false</code> 时去除</td>
<td align="left"><code>true</code></td>
</tr>
<tr>
<td align="left"><code>pretty_urls.trailing_html</code></td>
<td align="left">是否在永久链接中保留尾部的 <code>.html</code>, 设置为 <code>false</code> 时去除 (<em>对尾部的 <code>index.html</code>无效</em>)</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><font color='red' face='黑体' size=5><b>url 和 root 需要关联到挂载的服务器目录</b></font></p>
<blockquote>
<p>修改<code>站点配置文件</code>，填入网址设置：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">http://github.com/&lt;Github账号&gt;/&lt;Github账号&gt;.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/&lt;Github账号&gt;.github.io/</span></span><br></pre></td></tr></table></figure>

<p><font color='red' face='黑体' size=5><b>修改文章永久链接</b></font></p>
<blockquote>
<p>默认文章路径类似： <a href="https://www.zywvvd.com/2020/02/27/hexo/xxx">https://www.zywvvd.com/2020/02/27/hexo/xxx</a></p>
<p>这是因为文章链接配置<code>permalink</code>值默认为<code>:year/:month/:day/:title/</code></p>
<p>不喜欢此种形式链接的同学可以自定义修改，例如：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">:category/:title/</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以使用如下变量和 Front-matter 中的所有属性。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">变量</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>:year</code></td>
<td align="left">文章的发表年份（4 位数）</td>
</tr>
<tr>
<td align="left"><code>:month</code></td>
<td align="left">文章的发表月份（2 位数）</td>
</tr>
<tr>
<td align="left"><code>:i_month</code></td>
<td align="left">文章的发表月份（去掉开头的零）</td>
</tr>
<tr>
<td align="left"><code>:day</code></td>
<td align="left">文章的发表日期 (2 位数)</td>
</tr>
<tr>
<td align="left"><code>:i_day</code></td>
<td align="left">文章的发表日期（去掉开头的零）</td>
</tr>
<tr>
<td align="left"><code>:hour</code></td>
<td align="left">文章发表时的小时 (2 位数)</td>
</tr>
<tr>
<td align="left"><code>:minute</code></td>
<td align="left">文章发表时的分钟 (2 位数)</td>
</tr>
<tr>
<td align="left"><code>:title</code></td>
<td align="left">文件名称</td>
</tr>
<tr>
<td align="left"><code>:post_title</code></td>
<td align="left">文章标题</td>
</tr>
<tr>
<td align="left"><code>:id</code></td>
<td align="left">文章 ID (<em>not persistent across <a href="https://hexo.io/zh-cn/docs/commands#clean" target="_blank" rel="noopener">cache reset</a></em>)</td>
</tr>
<tr>
<td align="left"><code>:category</code></td>
<td align="left">分类。如果文章没有分类，则是 <code>default_category</code> 配置信息。</td>
</tr>
</tbody></table>
<h2 id="Directory-目录"><a href="#Directory-目录" class="headerlink" title="Directory - 目录"></a>Directory - 目录</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>source_dir</code></td>
<td align="left">资源文件夹，这个文件夹用来存放内容。</td>
<td align="left"><code>source</code></td>
</tr>
<tr>
<td align="left"><code>public_dir</code></td>
<td align="left">公共文件夹，这个文件夹用于存放生成的站点文件。</td>
<td align="left"><code>public</code></td>
</tr>
<tr>
<td align="left"><code>tag_dir</code></td>
<td align="left">标签文件夹</td>
<td align="left"><code>tags</code></td>
</tr>
<tr>
<td align="left"><code>archive_dir</code></td>
<td align="left">归档文件夹</td>
<td align="left"><code>archives</code></td>
</tr>
<tr>
<td align="left"><code>category_dir</code></td>
<td align="left">分类文件夹</td>
<td align="left"><code>categories</code></td>
</tr>
<tr>
<td align="left"><code>code_dir</code></td>
<td align="left">Include code 文件夹，<code>source_dir</code> 下的子目录</td>
<td align="left"><code>downloads/code</code></td>
</tr>
<tr>
<td align="left"><code>i18n_dir</code></td>
<td align="left">国际化（i18n）文件夹</td>
<td align="left"><code>:lang</code></td>
</tr>
<tr>
<td align="left"><code>skip_render</code></td>
<td align="left">跳过指定文件的渲染。匹配到的文件将会被不做改动地复制到 <code>public</code> 目录中。您可使用 <a href="https://github.com/micromatch/micromatch#extended-globbing" target="_blank" rel="noopener">glob 表达式</a>来匹配路径。</td>
<td align="left"></td>
</tr>
</tbody></table>
<h2 id="Writing-文章"><a href="#Writing-文章" class="headerlink" title="Writing - 文章"></a>Writing - 文章</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>new_post_name</code></td>
<td align="left">新文章的文件名称</td>
<td align="left">:title.md</td>
</tr>
<tr>
<td align="left"><code>default_layout</code></td>
<td align="left">预设布局</td>
<td align="left">post</td>
</tr>
<tr>
<td align="left"><code>auto_spacing</code></td>
<td align="left">在中文和英文之间加入空格</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left"><code>titlecase</code></td>
<td align="left">把标题转换为 title case</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left"><code>external_link</code></td>
<td align="left">在新标签中打开链接</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left"><code>external_link.enable</code></td>
<td align="left">在新标签中打开链接</td>
<td align="left"><code>true</code></td>
</tr>
<tr>
<td align="left"><code>external_link.field</code></td>
<td align="left">对整个网站（<code>site</code>）生效或仅对文章（<code>post</code>）生效</td>
<td align="left"><code>site</code></td>
</tr>
<tr>
<td align="left"><code>external_link.exclude</code></td>
<td align="left">需要排除的域名。主域名和子域名如 <code>www</code> 需分别配置</td>
<td align="left"><code>[]</code></td>
</tr>
<tr>
<td align="left"><code>filename_case</code></td>
<td align="left">把文件名称转换为 (1) 小写或 (2) 大写</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left"><code>render_drafts</code></td>
<td align="left">显示草稿</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left"><code>post_asset_folder</code></td>
<td align="left">启动 <a href="https://hexo.io/zh-cn/docs/asset-folders" target="_blank" rel="noopener">Asset 文件夹</a> (建议设置为 True )</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left"><code>relative_link</code></td>
<td align="left">把链接改为与根目录的相对位址</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left"><code>future</code></td>
<td align="left">显示未来的文章</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left"><code>highlight</code></td>
<td align="left">代码块的设置</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>highlight.enable</code></td>
<td align="left">开启代码块高亮</td>
<td align="left"><code>true</code></td>
</tr>
<tr>
<td align="left"><code>highlight.auto_detect</code></td>
<td align="left">如果未指定语言，则启用自动检测</td>
<td align="left"><code>false</code></td>
</tr>
<tr>
<td align="left"><code>highlight.line_number</code></td>
<td align="left">显示行数 <em>Enabling this option will also enable <code>wrap</code> option</em></td>
<td align="left"><code>true</code></td>
</tr>
<tr>
<td align="left"><code>highlight.tab_replace</code></td>
<td align="left">用 n 个空格替换 tabs；如果值为空，则不会替换 tabs</td>
<td align="left"><code>&#39;&#39;</code></td>
</tr>
<tr>
<td align="left"><code>highlight.wrap</code></td>
<td align="left">Wrap the code block in <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/table" target="_blank" rel="noopener">``</a></td>
<td align="left"><code>true</code></td>
</tr>
<tr>
<td align="left"><code>highlight.hljs</code></td>
<td align="left">Use the <code>hljs-*</code> prefix for CSS classes</td>
<td align="left"><code>false</code></td>
</tr>
</tbody></table>
<p><font color='red' face='黑体' size=5><b><code>post_asset_folder</code>修改为true，这样新建文章时会创建同名文件夹，便于后期博客图片等资源管理</b></font></p>
<h2 id="Category-amp-Tag-分类-amp-标签"><a href="#Category-amp-Tag-分类-amp-标签" class="headerlink" title="Category &amp; Tag - 分类 &amp; 标签"></a>Category &amp; Tag - 分类 &amp; 标签</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>default_category</code></td>
<td align="left">默认分类</td>
<td align="left"><code>uncategorized</code></td>
</tr>
<tr>
<td align="left"><code>category_map</code></td>
<td align="left">分类别名</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>tag_map</code></td>
<td align="left">标签别名</td>
<td align="left"></td>
</tr>
</tbody></table>
<h2 id="Date-Time-format-日期-时间格式"><a href="#Date-Time-format-日期-时间格式" class="headerlink" title="Date / Time format - 日期 / 时间格式"></a>Date / Time format - 日期 / 时间格式</h2><p>Hexo 使用 <a href="http://momentjs.com/" target="_blank" rel="noopener">Moment.js</a> 来解析和显示时间。</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>date_format</code></td>
<td align="left">日期格式</td>
<td align="left"><code>YYYY-MM-DD</code></td>
</tr>
<tr>
<td align="left"><code>time_format</code></td>
<td align="left">时间格式</td>
<td align="left"><code>HH:mm:ss</code></td>
</tr>
<tr>
<td align="left"><code>use_date_for_updated</code></td>
<td align="left">启用以后，如果 Front Matter 中没有指定 <code>updated</code>， <a href="https://hexo.io/zh-cn/docs/variables#%E9%A1%B5%E9%9D%A2%E5%8F%98%E9%87%8F" target="_blank" rel="noopener"><code>post.updated</code></a> 将会使用 <code>date</code> 的值而不是文件的创建时间。在 Git 工作流中这个选项会很有用</td>
<td align="left"><code>true</code></td>
</tr>
</tbody></table>
<h2 id="Pagination-分页"><a href="#Pagination-分页" class="headerlink" title="Pagination - 分页"></a>Pagination - 分页</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>per_page</code></td>
<td align="left">每页显示的文章量 (0 = 关闭分页功能)</td>
<td align="left"><code>10</code></td>
</tr>
<tr>
<td align="left"><code>pagination_dir</code></td>
<td align="left">分页目录</td>
<td align="left"><code>page</code></td>
</tr>
</tbody></table>
<h2 id="Extensions-扩展"><a href="#Extensions-扩展" class="headerlink" title="Extensions - 扩展"></a>Extensions - 扩展</h2><table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>theme</code></td>
<td align="left">当前主题名称。值为<code>false</code>时禁用主题</td>
</tr>
<tr>
<td align="left"><code>theme_config</code></td>
<td align="left">主题的配置文件。在这里放置的配置会覆盖主题目录下的 <code>_config.yml</code> 中的配置</td>
</tr>
<tr>
<td align="left"><code>deploy</code></td>
<td align="left">部署部分的设置</td>
</tr>
<tr>
<td align="left"><code>meta_generator</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/meta#%E5%B1%9E%E6%80%A7" target="_blank" rel="noopener">Meta generator</a> 标签。 值为 <code>false</code> 时 Hexo 不会在头部插入该标签</td>
</tr>
</tbody></table>
<p><font color='red' face='黑体' size=5><b>更换主题时改变theme的值为主题名称</b></font></p>
<h3 id="Include-Exclude-file-s-包括或不包括目录和文件"><a href="#Include-Exclude-file-s-包括或不包括目录和文件" class="headerlink" title="Include / Exclude file(s) - 包括或不包括目录和文件"></a>Include / Exclude file(s) - 包括或不包括目录和文件</h3><blockquote>
<p> 在 Hexo 配置文件中，通过设置 include/exclude 可以让 Hexo 进行处理或忽略某些目录和文件夹。你可以使用 <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">glob 表达式</a> 对目录和文件进行匹配。</p>
</blockquote>
<p><code>include</code> and <code>exclude</code> options only apply to the <code>source/</code> folder, whereas <code>ignore</code> option applies to all folders.</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>include</code></td>
<td align="left">Hexo 默认会忽略隐藏文件和文件夹（包括名称以下划线和 <code>.</code> 开头的文件和文件夹，Hexo 的 <code>_posts</code> 和 <code>_data</code> 等目录除外）。通过设置此字段将使 Hexo 处理他们并将它们复制到 <code>source</code> 目录下。</td>
</tr>
<tr>
<td align="left"><code>exclude</code></td>
<td align="left">Hexo 会忽略这些文件和目录</td>
</tr>
<tr>
<td align="left"><code>ignore</code></td>
<td align="left">Ignore files/folders</td>
</tr>
</tbody></table>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next -1- 主题安装</title>
    <url>/2020/02/24/next/1_theme_install/Next-install/</url>
    <content><![CDATA[<blockquote>
<p>next 是 Hexo 当前最流行的主题，其简约优雅的风格和对多种插件的原生支持使其备受青睐。我本人也是next主题的用户，接下来将由本篇开启next安装美化的系列文章，保证从安装Hexo开始只要安装系列文章操作，你也可以达拥有同样效果的博客。</p>
<p>本文主要记录Next主题的安装和常用的美化方法，有疑问欢迎在评论区交流。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li>安装Hexo，<a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/19/hexo/hexo_build/Hexo%E6%95%99%E7%A8%8B/">Hexo - 博客搭建基础教程</a></li>
<li>完成基础配置，<a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/24/hexo/hexo_config/Hexo%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE/">Hexo - 站点信息配置</a></li>
<li>了解Hexo命令，<a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/25/hexo/hexo_commands/hexo-commands/">Hexo - 常用命令汇总</a></li>
</ul>
<h2 id="安装Next主题"><a href="#安装Next主题" class="headerlink" title="安装Next主题"></a>安装Next主题</h2><blockquote>
<p>Next最新版本为V7.7.1 (2020.02.24)，官方链接<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">Next Github链接</a>。</p>
</blockquote>
<h3 id="下载Next仓库"><a href="#下载Next仓库" class="headerlink" title="下载Next仓库"></a>下载Next仓库</h3><blockquote>
<p>安装时进入Hexo根目录clone Next仓库：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd hexo</span><br><span class="line">git clone https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<h3 id="更改配置文件"><a href="#更改配置文件" class="headerlink" title="更改配置文件"></a>更改配置文件</h3><blockquote>
<p>修改<code>站点配置文件</code>，将theme更改为next。</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/peizhizhutu.png" class="" title="配置主题">

<blockquote>
<p>此时next已经安装并配置完成，更新hexo即可查看效果。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/nextanzhuangshili.png" class="" title="next示意图">

<h2 id="更换主题风格"><a href="#更换主题风格" class="headerlink" title="更换主题风格"></a>更换主题风格</h2><blockquote>
<p>修改<code>主题配置文件</code>中<code>scheme</code> 字段的值，默认为<code>Muse</code>：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scheme:</span> <span class="string">Muse</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/nextanzhuangshili.png" class="" title="Muse">

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scheme:</span> <span class="string">Mist</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/mist.png" class="" title="Mist">

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scheme:</span> <span class="string">Pisces</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/Pisces.png" class="" title="Pisces">

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure>

<img src="/2020/02/24/next/1_theme_install/Next-install/Gemini.png" class="" title="Gemini">



<blockquote>
<p>我目前使用的是Gemini</p>
</blockquote>
<h2 id="更新next仓库"><a href="#更新next仓库" class="headerlink" title="更新next仓库"></a>更新next仓库</h2><blockquote>
<p>在hexo根目录/themes/next 文件夹下执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd themes/next</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Next</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Git - 连接 Github 远程仓库</title>
    <url>/2020/02/23/git/link_github/Git-connect-remote-pos/</url>
    <content><![CDATA[<blockquote>
<p>本教程记录了本地Git与远程Github仓库连接的方法。设置成功后可以从远程仓库获取代码、将本地代码推送到远端。</p>
</blockquote>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><blockquote>
<ul>
<li>申请Github账号</li>
<li>基础Git语法知识</li>
<li>本地安装好Git bash运行环境</li>
</ul>
</blockquote>
<h2 id="建立远程仓库"><a href="#建立远程仓库" class="headerlink" title="建立远程仓库"></a>建立远程仓库</h2><blockquote>
<p>登录Github账号后点击右上角加号建立自己的仓库，名称自拟。</p>
<p>此处以test为例。</p>
</blockquote>
<img src="/2020/02/23/git/link_github/Git-connect-remote-pos/xinjiancangku.png" class="" title="建立远程仓库示例">

<h2 id="配置-SSH-秘钥"><a href="#配置-SSH-秘钥" class="headerlink" title="配置 SSH 秘钥"></a>配置 SSH 秘钥</h2><h3 id="创建SSH密钥"><a href="#创建SSH密钥" class="headerlink" title="创建SSH密钥"></a>创建SSH密钥</h3><blockquote>
<p>在Git bash中执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C "abc@163.com"   #此处填自己注册GitHub的邮箱</span><br></pre></td></tr></table></figure>

<blockquote>
<p>没有特殊需求的话可以不设置密码，两次回车继续。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">~/vvd_git$ ssh-keygen -t rsa -C "zywvvd@mail.ustc.edu.cn"</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/home/zywvvd/.ssh/id_rsa): </span><br><span class="line">Created directory '/home/zywvvd/.ssh'.</span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /home/zywvvd/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /home/zywvvd/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:klt1J9JxcGBj7xgB5dC1cXsQmK9ioOhInLRgqKppO8k zywvvd@mail.ustc.edu.cn</span><br><span class="line">The key's randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|      o+p+=o+.   |</span><br><span class="line">|       B.Bo+ o   |</span><br><span class="line">|      = *.+ . .  |</span><br><span class="line">|.    o = *.  .   |</span><br><span class="line">|oo  . . u..      |</span><br><span class="line">|* +   . .        |</span><br><span class="line">|+*.. . .         |</span><br><span class="line">|*E  .  .   .     |</span><br><span class="line">|Ooo              |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 得到类似上述输出即为创建成功。得到的文件放在~/.ssh文件夹中。</p>
</blockquote>
<h3 id="设置Github"><a href="#设置Github" class="headerlink" title="设置Github"></a>设置Github</h3><ul>
<li><p>登陆github</p>
</li>
<li><p>在settings中设置 ‘SSH and GPG keys’</p>
</li>
<li><p>添加new SSH key—— 设置名字并将.ssh 文件夹中isa.pub公钥文件的内容复制进去</p>
</li>
</ul>
<h3 id="测试SSH秘钥"><a href="#测试SSH秘钥" class="headerlink" title="测试SSH秘钥"></a>测试SSH秘钥</h3><blockquote>
<p>执行命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<blockquote>
<p>输出结果：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Warning: Permanently added the RSA host key for IP address '52.74.223.139' to the list of known hosts.</span><br><span class="line">Hi zywvvd! You've successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>出现欢迎字段说明SSH密钥配置成功。</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="同步本地库到远程库上"><a href="#同步本地库到远程库上" class="headerlink" title="同步本地库到远程库上"></a>同步本地库到远程库上</h3><blockquote>
<p>在已有的本地仓库中使用remote命令链接仓库：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/zywvvd/test.git</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编辑本地库内容，推送到远程端：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo "#example" &gt;&gt; README.md</span><br><span class="line">git add README.md</span><br><span class="line">git commit -m "README.md created"</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<p>此时可以在github端看到更新上传的说明文件。</p>
<h3 id="克隆仓库"><a href="#克隆仓库" class="headerlink" title="克隆仓库"></a>克隆仓库</h3><blockquote>
<p>执行如下命令以创建一个本地仓库的克隆版本：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone /path/to/repository</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果是远端服务器上的仓库，你的命令会是这个样子：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone username@host:/path/to/repository</span><br></pre></td></tr></table></figure>

<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo -1- 博客搭建基础教程</title>
    <url>/2020/02/19/hexo/1_hexo_build/Hexo/</url>
    <content><![CDATA[<blockquote>
<p>建立个人博客的需求由来已久，能拥有自己的技术博客是广大程序员的梦想。相比于早些时候的WordPress、织梦等框架，就个人站点来说，用Hexo搭建博客可以用“怎一个爽字了得”形容。Hexo基于Node.js开发，具有轻量、方便、易部署等特点，主题丰富简约，依赖github即可构建站点，近些年受到广泛关注。此篇文章旨在和与我一样的初学者分享经验，有疑问欢迎在评论区交流。</p>
</blockquote>
<a id="more"></a>



<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li><p><code>github账号</code>：需要申请一个属于你的github账号，可以在<a href="https://github.com/" target="_blank" rel="noopener">这里申请</a>。</p>
</li>
<li><p><code>git bash</code>： 需要有git bash运行环境，相关安装和使用教程请<a href="%5Bhttps://www.baidu.com/s?wd=gitbash&rsv_spt=1&rsv_iqid=0xeaa75c680004abbf&issp=1&f=8&rsv_bp=1&rsv_idx=2&ie=utf-8&tn=baiduhome_pg&rsv_enter=1&rsv_dl=ib&rsv_sug3=8&rsv_sug1=7&rsv_sug7=101&rsv_sug2=0&inputT=2890&rsv_sug4=3589">询问度娘</a>。</p>
</li>
<li><p><code>Node.js</code>： 必须安装 Node.js 开发环境，建议参考<a href="https://www.simon96.online/2018/11/10/hexo-env/" target="_blank" rel="noopener">Hexo 环境搭建</a>。</p>
</li>
<li><p><code>个人域名</code>(可选)：申请自己的域名可以有自己专用的地址解析链接，我使用<a href="https://cloud.baidu.com/product/bcd/price.html" target="_blank" rel="noopener">百度智能云</a>申请的域名，用着还不错，也比较便宜。</p>
</li>
<li><p><code>markdown</code>：Hexo使用Markdown解析文章，不熟悉的同学可以移步<a href="https://www.zywvvd.com/2020/02/18/Markdown-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/">Markdown 简明教程</a>。</p>
</li>
<li><p><code>html\css\js基础</code>： 有最好，没有也没关系。</p>
</li>
</ul>
<h2 id="Hexo的安装、初始化、本地预览"><a href="#Hexo的安装、初始化、本地预览" class="headerlink" title="Hexo的安装、初始化、本地预览"></a>Hexo的安装、初始化、本地预览</h2><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><blockquote>
<p>在git bash环境下输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<h3 id="初始化Hexo"><a href="#初始化Hexo" class="headerlink" title="初始化Hexo"></a>初始化Hexo</h3><blockquote>
<p>在选好的文件夹下运行命令，我们以 TestHexo 为例设立我们的第一个Hexo 站点。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo init TestHexo</span><br></pre></td></tr></table></figure>

<img src="/2020/02/19/hexo/1_hexo_build/Hexo/anzhuanghexo.png" class="" title="安装">

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd TestHexo</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<blockquote>
<p>完成后在TestHexo 文件夹中会有如下内容：</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/chushihuawenjianjia.png" class="" title="初始化Hexo文件">

<p>如果你坚持到了这里，那么恭喜你：</p>
<p>此时本地的Hexo站点已经完成了（什么不是刚开始么？？ 是的已经结束了）。</p>
<h3 id="本地预览"><a href="#本地预览" class="headerlink" title="本地预览"></a>本地预览</h3><blockquote>
<p>为了查看本地站点实际效果，输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<blockquote>
<p>会在本地搭建服务器挂载生成的本地站点，通过访问 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000</a> 浏览自己的网站。</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/yulanyemian.png" class="" title="预览页面">



<h2 id="Hexo-部署到Github"><a href="#Hexo-部署到Github" class="headerlink" title="Hexo 部署到Github"></a>Hexo 部署到Github</h2><h3 id="在Github端创建仓库"><a href="#在Github端创建仓库" class="headerlink" title="在Github端创建仓库"></a>在Github端创建仓库</h3><p> 仓库名：&lt;Github 账号&gt;.github.io</p>
<h3 id="安装Hexo-git-插件"><a href="#安装Hexo-git-插件" class="headerlink" title="安装Hexo-git 插件"></a>安装Hexo-git 插件</h3><p>执行命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<h3 id="链接本地与远程仓库"><a href="#链接本地与远程仓库" class="headerlink" title="链接本地与远程仓库"></a>链接本地与远程仓库</h3><blockquote>
<p>需要在本地建立SSh key，并添加到远程的github配置中。可参考<a href="https://www.zywvvd.com/zywvvd.github.io/2020/02/23/Git-%E8%BF%9E%E6%8E%A5-Github-%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/">Git 连接 Github 远程仓库</a></p>
</blockquote>
<h3 id="修改站点配置文件"><a href="#修改站点配置文件" class="headerlink" title="修改站点配置文件"></a>修改<code>站点配置文件</code></h3><blockquote>
<p><code>站点配置文件</code>为Hexo根目录下的 _config.yml文件，编辑该文件，找到相关部分并修改。</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:&lt;Github账号&gt;/&lt;Github账号&gt;.github.io.git</span>  <span class="comment">#该地址写ssh地址，不写http地址。</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改<code>站点配置文件</code>，填入网址设置：</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">http://github.com/&lt;Github账号&gt;/&lt;Github账号&gt;.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/&lt;Github账号&gt;.github.io/</span></span><br></pre></td></tr></table></figure>

<h3 id="推送到Github"><a href="#推送到Github" class="headerlink" title="推送到Github"></a>推送到Github</h3><blockquote>
<p>依次输入命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 当见到返回：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">INFO  Deploy done: git</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 即为推送成功。</p>
<p>至此，您的Hexo博客已经搭建在GithubPages, 域名为<code>https://&lt;Github账号&gt;.github.io</code>。</p>
</blockquote>
<h2 id="自定义域名"><a href="#自定义域名" class="headerlink" title="自定义域名"></a>自定义域名</h2><blockquote>
<p>在站点部署在Github基础上，您也可以将自己购买的域名解析到刚刚建立的地址。</p>
</blockquote>
<h3 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h3><blockquote>
<p>在域名设置界面:</p>
</blockquote>
<ul>
<li><p>类型选择为 CNAME；</p>
</li>
<li><p>主机记录即域名前缀，填写为www；</p>
</li>
<li><p>记录值填写为&lt;Github账号名称&gt;.github.io；</p>
</li>
<li><p>解析线路，TTL 默认即可。</p>
</li>
</ul>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/yumingshezhi.png" class="" title="域名配置">

<blockquote>
<p>提示：域名需要按照国家要求备案</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/beian.png" class="" title="域名备案">

<h3 id="仓库设置"><a href="#仓库设置" class="headerlink" title="仓库设置"></a>仓库设置</h3><blockquote>
<p>进入github建立的hexo仓库，点击settings按钮设置仓库，在Custom domin中填入自己的域名，并Save：</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/customdomin.png" class="" title="仓库设置">

<h3 id="本地设置"><a href="#本地设置" class="headerlink" title="本地设置"></a>本地设置</h3><blockquote>
<p>在Hexo站点目录source文件夹中，创建名为<code>CNAME</code>的文件，并向其写入<code>自定义域名</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo www.zywvvd.com &gt;&gt; CNAME    #域名部分请替换为你自己的</span><br></pre></td></tr></table></figure>

<img src="/2020/02/19/hexo/1_hexo_build/Hexo/cname.png" class="" title="CNAME文件">

<blockquote>
<p>几分钟之后，即可通过该域名访问Hexo站点。     <a href="https://www.zywvvd.com/">又见苍岚</a></p>
</blockquote>
<h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><blockquote>
<p> hexo主题有很多,默认主题为landscape。</p>
<p>更换主题需要下载主题包放在Hexo目录中themes文件夹内，如我下载了Next主题，文件夹如图所示。</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/nextwenjianjia.png" class="" title="Themes文件夹">

<blockquote>
<p>并将<code>站点配置文件</code>中主题换成相应的主题名：</p>
</blockquote>
<img src="/2020/02/19/hexo/1_hexo_build/Hexo/zhutipeizhi.png" class="" title="主题配置">

<blockquote>
<p>主题可以在<a href="https://github.com/search?q=hexo-theme" target="_blank" rel="noopener">github</a>现有的工作中挑选。</p>
</blockquote>
<h3 id="Next"><a href="#Next" class="headerlink" title="Next"></a>Next</h3><blockquote>
<p>个人使用的是Hexo人气最高的主题Next，当前版本 V 7.7.1，具有简介大方，原生自带大量实用工具，社区活跃等优点。</p>
<p>有喜欢类似风格的小伙伴可以到<a href="https://www.zywvvd.com/categories/Next/">Next 系列教程</a>了解一下。</p>
</blockquote>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>文字编码 - Markdown 简明教程</title>
    <url>/2020/02/18/words/markdown/course/Markdown/</url>
    <content><![CDATA[<blockquote>
<p>Markdown 是一种轻量级标记语言，文件以.md/.markdown为后缀，语法简单实用，编写的文档可以导出 HTML 、Word、图像、PDF、Epub 等多种格式，近年来快速流行在程序员群体中。本教程列举了markdown最常用的语法，仅需随便一款markdown编辑器即可轻松学习。</p>
</blockquote>
<a id="more"></a>

<h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h2><blockquote>
<p> 文章题目，设有6个等级，可被获取生成文章目录。</p>
</blockquote>
<p>语法：若干个(1-6)<code>#</code>后接<code>空格</code>代表不同级别(1-6)的标题</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># 一级标题</span></span><br><span class="line"><span class="section">## 二级标题</span></span><br><span class="line"><span class="section">### 三级标题</span></span><br><span class="line"><span class="section">#### 四级标题</span></span><br><span class="line"><span class="section">##### 五级标题</span></span><br><span class="line"><span class="section">###### 六级标题</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/biaoti.png" class="" title="标题示例">



<h2 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h2><blockquote>
<p>方便分割内容</p>
</blockquote>
<p>语法：<code>***</code> 或<code>---</code>则会出现一条线</p>
<p>示例编码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">***</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<hr>
<hr>
<h2 id="格式标记"><a href="#格式标记" class="headerlink" title="格式标记"></a>格式标记</h2><blockquote>
<p>简单方便的格式标记</p>
</blockquote>
<p>语法：<code>*</code> 内容<code>*</code>或<code>_</code>内容<code>_</code>标记为倾斜； <code>**</code> 内容<code>**</code> 或<code>__</code>内容<code>__</code>标记为加粗；<code>***</code> 内容<code>**</code> 或<code>___</code>内容<code>___</code>标记为加粗倾斜。</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="emphasis">*倾斜*</span></span><br><span class="line"><span class="emphasis">_倾斜_</span></span><br><span class="line"><span class="strong">**加粗**</span></span><br><span class="line"><span class="strong">__加粗__</span></span><br><span class="line"><span class="strong">***加粗倾斜**</span>*</span><br><span class="line"><span class="strong">___加粗倾斜__</span>_</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/jiacuqingxie.png" class="" title="加粗倾斜示例">



<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><blockquote>
<p>内容条理化的利器，分为有序列表和无序列表</p>
</blockquote>
<h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3><p>语法：<code>序号</code>加上<code>.</code>和 <code>空格</code></p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1. </span>内容1</span><br><span class="line"><span class="bullet">2. </span>内容2</span><br><span class="line"><span class="bullet">3. </span>内容3</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/youxuliebiao.png" class="" title="有序列表示例">



<h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><p>语法：<code>*</code>、<code>+</code>或是<code>- </code>加 <code>空格</code> 作为列表标记</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">*  </span>内容1</span><br><span class="line"><span class="bullet">*  </span>内容2</span><br><span class="line"><span class="bullet">*  </span>内容3</span><br><span class="line"></span><br><span class="line"><span class="bullet">+  </span>内容4</span><br><span class="line"><span class="bullet">+  </span>内容5</span><br><span class="line"><span class="bullet">+  </span>内容6</span><br><span class="line"></span><br><span class="line"><span class="bullet">-  </span>内容7</span><br><span class="line"><span class="bullet">- </span>内容8</span><br><span class="line"><span class="bullet">- </span>内容9</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/wuxuliebiao.png" class="" title="无序列表示例">



<h3 id="列表嵌套"><a href="#列表嵌套" class="headerlink" title="列表嵌套"></a>列表嵌套</h3><p>语法： 使用<code>4个空格</code>缩进即可进行列表嵌套</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1. </span>有序内容1</span><br><span class="line"><span class="bullet">    + </span>无序内容1</span><br><span class="line"><span class="bullet">    + </span>无序内容2</span><br><span class="line"><span class="bullet">2. </span>有序内容2</span><br><span class="line"><span class="bullet">    + </span>无序内容1</span><br><span class="line"><span class="bullet">    + </span>无序内容2</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/qiantaoliebiao.png" class="" title="嵌套列表示例">



<h2 id="区块（引用）"><a href="#区块（引用）" class="headerlink" title="区块（引用）"></a>区块（引用）</h2><blockquote>
<p>为内容分区块，可嵌套</p>
</blockquote>
<p>语法：<code>&gt;</code>  加 <code>空格</code> 作为标记</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="quote">&gt; 第一层</span></span><br><span class="line">&gt;&gt; 第二层</span><br><span class="line">&gt;&gt;&gt; 第三层</span><br><span class="line">&gt;&gt;&gt;&gt; 第四层</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/qukuai.png" class="" title="区块示例">



<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><blockquote>
<p>代码段可以用多种语言高亮显示代码，内容不会被markdown标记解释，有两种标记方式</p>
</blockquote>
<h3 id="代码片段"><a href="#代码片段" class="headerlink" title="代码片段"></a>代码片段</h3><p>语法：用前后两个`` ` (主键盘区左上角，Esc下面的按键)包裹代码片段</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">`cout&lt;&lt;"Hello world"&lt;&lt;endl; `</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/daimapianduan.png" class="" title="代码片段示例">

<h3 id="代码区块"><a href="#代码区块" class="headerlink" title="代码区块"></a>代码区块</h3><p>语法：建议用前后各三个`` `包裹代码作为markdown中的代码段，这种语法更容易被编辑工具识别和支持</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">​<span class="code">```</span> c++</span><br><span class="line"><span class="section">#include &lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">   cout <span class="xml"><span class="tag">&lt;&lt; "<span class="attr">Hello</span> <span class="attr">World</span>";</span></span></span><br><span class="line"><span class="xml">   return 0;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">​</span></span><br></pre></td></tr></table></figure>


<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/daimaduan.png" class="" title="代码区块示例">



<h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><blockquote>
<p>编辑文本变成超链接</p>
</blockquote>
<p>语法：</p>
<p><code>[</code> <code>链接名称</code> <code>]</code> <code>(</code> <code>链接地址</code> <code>)</code>       或       <code>&lt;</code> <code>链接地址</code> <code>&gt;</code> （中间无空格）</p>
<p>示例编码：</p>
<p>​```markdown<br><a href="https://www.zywvvd.com/">又见苍岚</a><br>或<br> <a href="https://www.zywvvd.com/">https://www.zywvvd.com</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">实际效果：</span><br><span class="line"></span><br><span class="line">[又见苍岚](https:&#x2F;&#x2F;www.zywvvd.com)</span><br><span class="line">或</span><br><span class="line"> &lt;https:&#x2F;&#x2F;www.zywvvd.com&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 图片</span><br><span class="line"></span><br><span class="line">语法格式：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;markdown</span><br><span class="line">![alt 属性](图片地址)</span><br><span class="line">![alt 属性](图片地址 &quot;可选标题&quot;)</span><br></pre></td></tr></table></figure>

<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">苍岚1</span>](<span class="link">http://zywvvd.github.io/images/avatar1.jpg</span>)</span><br><span class="line">![<span class="string">苍岚2</span>](<span class="link">http://zywvvd.github.io/images/avatar2.jpg "CangLan"</span>)</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<p><img src="http://zywvvd.github.io/images/avatar1.jpg" alt="苍岚1"><br><img src="http://zywvvd.github.io/images/avatar2.jpg" alt=" " title="苍岚2"></p>
<h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><blockquote>
<p>可以方便地插入表格。</p>
</blockquote>
<p>语法：用 <code>|</code> 分隔单元格，使用 <code>-</code> 来分隔表头和其他行， <code>:-</code> <code>-:</code> <code>:-:</code>分别表示左、右、中的对齐方式。</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">| 左对齐表头 | 右对齐表头|居中对齐表头|</span><br><span class="line">|:--- | ---: |:---: |</span><br><span class="line">|内容1| 内容2|内容3|</span><br><span class="line">|内容4|内容5|内容6|</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/biaoge.png" class="" title="表格示例">

<h2 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h2><blockquote>
<p>可以插入Tex或LaTex等公式编辑器生成的格式代码</p>
</blockquote>
<p>语法：输入<code>$$</code>包裹公式</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">\mathbf&#123;X&#125;<span class="emphasis">_1\times\mathbf&#123;X&#125;_</span>2 = \mathbf&#123;X&#125;_3</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<p>实际效果：</p>
<p>$$<br>\mathbf{X}_1\times\mathbf{X}_2 = \mathbf{X}_3<br>$$</p>
<blockquote>
<p>而且公式可以编号和引用：</p>
</blockquote>
<p>语法：</p>
<ul>
<li>编号：<code>\tag{1}</code></li>
<li>标签：<code>\label{eq1}</code></li>
<li>引用：<code>\eqref{eq1}​</code></li>
</ul>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">\mathbf&#123;X&#125;<span class="emphasis">_1\times\mathbf&#123;X&#125;_</span>2 = \mathbf&#123;X&#125;_3 \tag&#123;1&#125; \label&#123;eq1&#125;</span><br><span class="line">$$</span><br><span class="line">在公式$\eqref&#123;eq1&#125;$中...</span><br></pre></td></tr></table></figure>

<p>实际效果：<br>$$<br>\mathbf{X}_1\times\mathbf{X}_2 = \mathbf{X}_3 \tag{1} \label{eq2}<br>$$<br>在公式$\eqref{eq2}$中…</p>
<h2 id="任务列表"><a href="#任务列表" class="headerlink" title="任务列表"></a>任务列表</h2><blockquote>
<p>简单的任务标记</p>
</blockquote>
<p>语法：<code>- 空格[空格]空格</code>不勾选<code> -空格[x]空格</code>勾选</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>[ ] 挣他一个亿</span><br><span class="line"><span class="bullet">- </span>[x] 花个五千万</span><br><span class="line"><span class="bullet">- </span>[ ]  存个五千万</span><br><span class="line"><span class="bullet">- </span>[ ] 年利息二百万</span><br><span class="line"><span class="bullet">- </span>[ ] 实现财务自由</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/renwuliebiao.png" class="" title="任务列表示例">



<h2 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h2><blockquote>
<p>支持脚注功能，鼠标悬停可以读出内容</p>
</blockquote>
<p>语法： 文中定义脚注A - <code>[^A]</code>（脚注前需要有内容），对应A的脚注文本<code>[^A]: 脚注的*文本*</code></p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">你可以使用脚注像这样[^脚注]</span><br><span class="line">脚注前面需要有内容！！！</span><br><span class="line">[<span class="symbol">^脚注</span>]: <span class="link">这里写脚注的*文本*</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<p>你可以使用脚注像这样<a href="%E8%BF%99%E9%87%8C%E5%86%99%E8%84%9A%E6%B3%A8%E7%9A%84*%E6%96%87%E6%9C%AC*">^脚注</a><br>脚注前面需要有内容！！！</p>
<h2 id="高级链接"><a href="#高级链接" class="headerlink" title="高级链接"></a>高级链接</h2><blockquote>
<p>可以将链接地址放在变量中</p>
</blockquote>
<p>语法： 链接<code>[链接名称]</code> <code>[变量A]</code>，设置变量A <code>[A]:链接地址</code></p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">加油 [<span class="string">又见苍岚</span>][<span class="symbol">a</span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">a</span>]:<span class="link">https://www.zywvvd.com</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<p>加油 <a href="https://www.zywvvd.com/">又见苍岚</a></p>
<h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><blockquote>
<p>markdown支持流程图功能，这里介绍框架语法，只不过不是所有markdown编辑器、显示框架都支持</p>
</blockquote>
<p>语法： ```mermaid  和  ``` 包裹的部分 可以解读成流程图</p>
<p>示例编码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">​&lt;pre <span class="class"><span class="keyword">class</span>="<span class="title">mermaid</span>"&gt;<span class="title">graph</span> <span class="title">LR</span></span></span><br><span class="line"><span class="class"><span class="title">A</span>[方形] --&gt;<span class="title">B</span>(圆角)</span></span><br><span class="line"><span class="class">    <span class="title">B</span> --&gt; <span class="title">C</span>&#123;</span>条件a&#125;</span><br><span class="line">    C --&gt;|a=<span class="number">1</span>| D[结果<span class="number">1</span>]</span><br><span class="line">    C --&gt;|a=<span class="number">2</span>| E[结果<span class="number">2</span>]</span><br><span class="line">    F[横向流程图]</span><br><span class="line">​&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">实际效果：</span><br><span class="line"></span><br><span class="line">&#123;% asset_img liuchengtu.png  流程图示例 %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 转义字符</span><br><span class="line"></span><br><span class="line">&gt; Markdown 使用了很多特殊符号来表示特定的意义，如果需要显示特定的符号则需要使用转义字符，Markdown 使用反斜杠转义特殊字符</span><br><span class="line"></span><br><span class="line">语法：`\` 加特殊字符</span><br><span class="line"></span><br><span class="line">示例编码：</span><br><span class="line"></span><br><span class="line">​```markdown</span><br><span class="line">\*\*不想被加粗\*\*我也不想\*\*</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<p>**不想被加粗**我也不想**</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><blockquote>
<p>markdown可以根据标题内容自动提取目录</p>
</blockquote>
<p>语法：<code>[toc]</code>回车即可</p>
<p>示例编码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[toc]</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/2020/02/18/words/markdown/course/Markdown/mulu.png" class="" title="目录示例">

<h2 id="使用HTML代码实现高级效果"><a href="#使用HTML代码实现高级效果" class="headerlink" title="使用HTML代码实现高级效果"></a>使用HTML代码实现高级效果</h2><blockquote>
<p>markdown语法简单，内容表现丰富程度有限。但其本身兼容HTML代码，可以借助其实现高级显示的效果。</p>
</blockquote>
<h3 id="文本对齐"><a href="#文本对齐" class="headerlink" title="文本对齐"></a>文本对齐</h3><blockquote>
<p>借助align属性可以实现文本对齐</p>
</blockquote>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">'center'</span>&gt;</span>居中文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">'right'</span>&gt;</span>右对齐文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">'left'</span>&gt;</span>左对齐文本<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实际效果：</p>
<div>
<p align='center'>居中文本</p>
<p align='right'>右对齐文本</p>
<p align='left'>左对齐文本</p>
</div>


<h3 id="图像水平排列"><a href="#图像水平排列" class="headerlink" title="图像水平排列"></a>图像水平排列</h3><blockquote>
<p>markdown自带图像插入功能无法水平自由排列，借助html中的table和img标签可以实现。</p>
</blockquote>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"timg.jpg"</span>  <span class="attr">height</span>=<span class="string">"240"</span> <span class="attr">width</span>=<span class="string">"240"</span>&gt;</span> <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"timg.jpg"</span>  <span class="attr">height</span>=<span class="string">"240"</span> <span class="attr">width</span>=<span class="string">"240"</span>&gt;</span> <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span> 图1  <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span> 图2 <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"timg.jpg"</span>  <span class="attr">height</span>=<span class="string">"240"</span> <span class="attr">width</span>=<span class="string">"240"</span>&gt;</span> <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"timg.jpg"</span>  <span class="attr">height</span>=<span class="string">"240"</span> <span class="attr">width</span>=<span class="string">"240"</span>&gt;</span> <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span> 图3  <span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span> 图4<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<table>
    <tr>
        <td ><center><img src="timg.jpg"  height="240" width="240"> </center></td>
        <td ><center><img src="timg.jpg"  height="240" width="240"> </center></td>
    </tr>
    <tr>
        <td ><center> 图1  </center></td>
        <td ><center> 图2 </center></td>
    </tr>
      <tr>
        <td ><center><img src="timg.jpg"  height="240" width="240"> </center></td>
        <td ><center><img src="timg.jpg"  height="240" width="240"> </center></td>
    </tr>
    <tr>
        <td ><center> 图3  </center></td>
        <td ><center> 图4</center></td>
    </tr>
</table>

<h3 id="合并单元格"><a href="#合并单元格" class="headerlink" title="合并单元格"></a>合并单元格</h3><blockquote>
<p>markdown 自带语法只支持基本表格，复杂表格需要HTML语言描述。</p>
</blockquote>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">"2"</span> <span class="attr">rowspan</span>=<span class="string">"2"</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>评估指标<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">"2"</span> &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>预测结果<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>  &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>正样本<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>  &gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>负样本<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tr</span> &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>实际<span class="tag">&lt;<span class="name">br</span>&gt;</span>情况<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>正样本<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>TP<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>FN<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>负样本<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>FP<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>TN<span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<table>
    <tr>
        <th colspan="2" rowspan="2" ><center>评估指标</center></th>
         <th colspan="2" ><center>预测结果</center></th>
    </tr>  
    <tr>
        <th  ><center>正样本</center></th>
        <th  ><center>负样本</center></th>
    </tr >
    <tr >
        <td rowspan="2"><center>实际<br>情况</center></td>
        <td><center>正样本</center></td>
        <td><center>TP</center></td>
        <td><center>FN</center></td>
    </tr>
    <tr >
        <td><center>负样本</center></td>
        <td><center>FP</center></td>
        <td><center>TN</center></td>
    </tr>
</table>

<h3 id="文字改变颜色、大小、字体"><a href="#文字改变颜色、大小、字体" class="headerlink" title="文字改变颜色、大小、字体"></a>文字改变颜色、大小、字体</h3><p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">"宋体"</span> &gt;</span>我是宋体字<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span>  <span class="attr">size</span>=<span class="string">10</span>&gt;</span>我是10号字<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">red</span>&gt;</span>我是红色字<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">red</span> <span class="attr">size</span>=<span class="string">10</span> <span class="attr">face</span>=<span class="string">'宋体'</span>&gt;</span>我是红色10号宋体字<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<p><font face="宋体" >我是宋体字</font></p>
<p><font  size=10>我是10号字</font></p>
<p><font color=red>我是红色字</font></p>
<p><font color=red size=10 face='宋体'>我是红色10号宋体字</font></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      <categories>
        <category>文字编码</category>
      </categories>
      <tags>
        <tag>文字编码</tag>
        <tag>Markdown</tag>
      </tags>
  </entry>
</search>
