

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="codeva-rLWafCJGYc" />
  <link rel="apple-touch-icon" sizes="76x76" href="/image/avatar.png">
  <link rel="icon" href="/image/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Yiwei Zhang">
  <meta name="keywords" content="人工智能, 深度学习, 个人博客, 机器学习">
  
    <meta name="description" content="在Mongodb中我们使用mongodump命令来备份MongoDB数据。本文记录相关内容。">
<meta property="og:type" content="article">
<meta property="og:title" content="MongoDB 备份与恢复">
<meta property="og:url" content="https://www.zywvvd.com/notes/coding/dataset/mongodb-dump-restore/mongodb-dump-restore/index.html">
<meta property="og:site_name" content="又见苍岚">
<meta property="og:description" content="在Mongodb中我们使用mongodump命令来备份MongoDB数据。本文记录相关内容。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-08-21T05:11:34.000Z">
<meta property="article:modified_time" content="2025-04-30T06:50:13.436Z">
<meta property="article:author" content="Yiwei Zhang">
<meta property="article:tag" content="Coding">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="MongoDB">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>MongoDB 备份与恢复 - 又见苍岚</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/reward.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.zywvvd.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":90,"cursorChar":"_","loop":false,"scope":["home"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Cv0XNeBSBdAPAIuVj3PsyM3R-MdYXbMMI","app_key":"4PU1rNlGrqXWzhfW3dgq98oX","server_url":null,"path":"window.location.pathname","ignore_local":false},"gtag":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="又见苍岚" type="application/atom+xml">
</head>

<script>
// 页面加载完成后隐藏加载动画
document.addEventListener("readystatechange", function() {
    const loader = document.getElementById('Loadanimation');
    if (loader) {
        // 停留1秒后开始淡出
        setTimeout(function() {
            loader.style.transition = 'opacity 1.2s';
            loader.style.opacity = '0';
            // 淡出完成后隐藏
            setTimeout(() => {
                loader.style.display = 'none';
            }, 1000); // 等待淡出动画完成
        }, 700); // 停留0.8秒
    }
});
</script>



<body>
  
<div id="Loadanimation" style="z-index:999999;">
<div id="Loadanimation-center">
   <div id="Loadanimation-center-absolute">
       <div class="xccx_object" id="xccx_four"></div>
       <div class="xccx_object" id="xccx_three"></div>
       <div class="xccx_object" id="xccx_two"></div>
       <div class="xccx_object" id="xccx_one"></div>
   </div>
</div>
</div>

<link href="/css/loading.css"type="text/css"rel="stylesheet"/>






<div>
	<div class='real_mask' style="
		background-color: rgba(0,0,0,0.4);
		width: 100%;
		height: 100%;
		position: fixed;
		z-index: -777;
	"></div>
	<div id="banner_video_insert">
	</div>	
	<div id='vvd_banner_img'>
	</div>
</div>
<div id="banner"></div>







  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>CangLan</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
		<div >
		      <a class="nav-link" href="/" target="_self" data-umami-event="Navigation-Homepage">

		        <i class="iconfont icon-home-fill"></i>
		        <span>首页</span>
		      </a>
		</div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-shuji1"></i>
                <span>文章</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/archives/" target="_self" data-umami-event="Navigation-Archive">

                    <i class="iconfont icon-archive-fill"></i>
                    <span>归档</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/categories/" target="_self" data-umami-event="Navigation-Category">

                    <i class="iconfont icon-category-fill"></i>
                    <span>分类</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/tags/" target="_self" data-umami-event="Navigation-Tag">

                    <i class="iconfont icon-tags-fill"></i>
                    <span>标签</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/shuoshuo/" target="_self" data-umami-event="Navigation-Shuoshuo">

                    <i class="iconfont icon-24gf-bubblesDots4"></i>
                    <span>说说</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-momo"></i>
                <span>社交</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/links/" target="_self" data-umami-event="Navigation-Friends">

                    <i class="iconfont icon-link-fill"></i>
                    <span>友链</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/messagebd/" target="_self" data-umami-event="Navigation-MessageBoard">

                    <i class="iconfont icon-comment"></i>
                    <span>留言板</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/atom.xml" target="_self" data-umami-event="Navigation-RSS">

                    <i class="iconfont icon-dingyue"></i>
                    <span>RSS订阅</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/reccomments/" target="_self" data-umami-event="Navigation-Recent-Comments">

                    <i class="iconfont icon-icon-pinglunguanli-pinglunliebiao"></i>
                    <span>近期评论</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-user-fill"></i>
                <span>个人</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/about/" target="_self" data-umami-event="Navigation-AboutMe">

                    <i class="iconfont icon-guanyuwomen"></i>
                    <span>关于</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/playlist/" target="_self" data-umami-event="Navigation-Music">

                    <i class="iconfont icon-music"></i>
                    <span>歌单</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33035" target="_self" data-umami-event="Navigation-Nextcloud">

                    <i class="iconfont icon-xuniyingpan"></i>
                    <span>网盘</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33043" target="_self" data-umami-event="Navigation-Emby">

                    <i class="iconfont icon-meiti"></i>
                    <span>影院</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33036" target="_self" data-umami-event="Navigation-OneDev">

                    <i class="iconfont icon-git"></i>
                    <span>仓库</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33041" target="_self" data-umami-event="Navigation-Wiki">

                    <i class="iconfont icon-wiki"></i>
                    <span>百科</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-ic_fly"></i>
                <span>导航</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/site-map/" target="_self" data-umami-event="Navigation-SiteMap">

                    <i class="iconfont icon-lianjie"></i>
                    <span>链接</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/nodeppt/hexo/snavigation/" target="_self" data-umami-event="Navigation-Search">

                    <i class="iconfont icon-sousuo"></i>
                    <span>搜索</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-wangzhan"></i>
                <span>站点</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33039/share/0zx3o21oIpZTZqwC/%E5%8F%88%E8%A7%81%E8%8B%8D%E5%B2%9A" target="_self" data-umami-event="Navigation-Umami">

                    <i class="iconfont icon-tongji2"></i>
                    <span>站点分析</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/earth_sta/" target="_self" data-umami-event="Navigation-Globe">

                    <i class="iconfont icon-tongjifenxi-xiangmubiaogetongji"></i>
                    <span>访问统计</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33034/status/show" target="_self" data-umami-event="Navigation-Monitor">

                    <i class="iconfont icon-jiankong"></i>
                    <span>站点监控</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-chuansong"></i>
                <span>传送</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://www.foreverblog.cn/go.html" target="_self" data-umami-event="Navigation-ForeverBolg">

                    <i class="iconfont icon-a-BlackHole"></i>
                    <span>十年之约</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://www.travellings.cn/go.html" target="_self" data-umami-event="Navigation-DriveTo">

                    <i class="iconfont icon-train1"></i>
                    <span>开往</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://bf.zzxworld.com/" target="_self" data-umami-event="Navigation-BlogFinder">

                    <i class="iconfont icon-icon-"></i>
                    <span>BlogFinder</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-gongju"></i>
                <span>工具</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/calculator" target="_self" data-umami-event="Navigation-Calculator">

                    <i class="iconfont icon-jisuan"></i>
                    <span>计算器</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/webgraphviz" target="_self" data-umami-event="Navigation-WebGtaphviz">

                    <i class="iconfont icon-tongyong-huatugongju2"></i>
                    <span>Graphviz</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/formular_reco" target="_self" data-umami-event="Navigation-Formular-Reco">

                    <i class="iconfont icon-a-checkformula"></i>
                    <span>公式识别</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://uipv4.zywvvd.com:33030/HexoFiles/new/bg-trans.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">MongoDB 备份与恢复</span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Yiwei Zhang
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-08-21 13:11" pubdate>
          2024年8月21日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          12k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          100 分钟
        
      </span>
    

    
    
      
        <span id="vvdpost_container_page_pvuv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="vvdpost_value_page_pv">0</span> 次&nbsp&nbsp
		  <i class="iconfont icon-users" aria-hidden="true"></i>
		  <span id="vvdpost_value_page_uv">0</span> 人&nbsp&nbsp
		  <i class="iconfont icon-comment" aria-hidden="true"></i>
		  <span id="vvdpost_value_page_cn">0</span> 条
        </span>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
	      console.log("PVUV_" + window.location.pathname);

	      // 使用 fetch API 发送 POST 请求
	      fetch('https://uipv4.zywvvd.com:33037/poststats', { 
		  method: 'POST',
		  headers: {
		      'Content-Type': 'application/json'
		  },
		  body: JSON.stringify(window.location.pathname) // 将路径名作为对象发送，以便在服务器端更容易处理
	      })
	      .then(response => {
		  // 检查响应状态
		  if (!response.ok) {
		      throw new Error('Network response was not ok ' + response.statusText);
		  }
		  return response.json(); // 解析 JSON 响应
	      })
	      .then(data => {
		  // 处理解析后的数据
		  console.log(data.pv);
		  var pvCtn = document.querySelector('#vvdpost_container_page_pvuv');
		  if (pvCtn) {
		      var pvEle = document.querySelector('#vvdpost_value_page_pv');
		      var uvEle = document.querySelector('#vvdpost_value_page_uv');
		      var cnEle = document.querySelector('#vvdpost_value_page_cn');
		      if (pvEle && uvEle) {
		          pvEle.innerText = data.pv;
		          uvEle.innerText = data.uv;
		          cnEle.innerText = data.cn;
		          pvCtn.style.display = 'inline';
		      }
		  }
	      })
	      .catch(error => {
		  // 处理请求错误
		  console.error('There has been a problem with your fetch operation:', error);
	      });
      });
  </script>
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>


	<script type="text/javascript" src="/vvd_js/jquery.js"></script>
	<script async src="https://uipv4.zywvvd.com:33039/script.js" data-website-id="dd4a05c6-dde2-4743-9c3a-a79d6bee0778"></script>
	<div class="banner" id='banner' >

		<div class="full-bg-img" >

			
				<script>
					var ua = navigator.userAgent;
					var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
						isIphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
						isAndroid = ua.match(/(Android)\s+([\d.]+)/),
						isMobile = isIphone || isAndroid;

					function set_video_attr(id){
						var height = document.body.clientHeight
						var width = document.body.clientWidth
						var video_item = document.getElementById(id);

						if (height / width < 0.56){
							video_item.setAttribute('width', '100%');
							video_item.setAttribute('height', 'auto');
						} else {
							video_item.setAttribute('height', '100%');
							video_item.setAttribute('width', 'auto');
						}
					}

					fetch('https://uipv4.zywvvd.com:33037/wallpaper-pair')
					  .then(response => response.json()) // 解析JSON数据
					  .then(data => {
						console.log('获取链接成功');
						video_url = data[0][0]
						pre_show_image_url = data[0][1]

						banner_obj = document.getElementById("banner")
						banner_obj.style.cssText = "background: url('" + pre_show_image_url + "') no-repeat;"

						vvd_banner_obj = document.getElementById("vvd_banner_img")
						vvd_banner_content = "<img id='banner_img_item' src='" + pre_show_image_url + "'style='position: fixed; z-index: -999'>"
						vvd_banner_obj.innerHTML = vvd_banner_content 

						if (!isMobile) {
							video_html_res = "<video id='video_item' style='position: fixed; z-index: -888;'  muted='muted' src=" + video_url + " autoplay='autoplay' loop='loop'></video>"
							document.getElementById("banner_video_insert").innerHTML = video_html_res;
							set_video_attr('video_item')
							set_video_attr('banner_img_item')
						}
					    
					  })
					  .catch((error) => {
					    console.error('请求失败,尝试本地获取背景图像：', error);
	    					$.getJSON('/vvd_js/video_url.json', function(data){

							var video_list_length = data.length
							var seed = Math.random()
							index = Math.floor(seed * video_list_length)

							video_url = data[index][0]
							pre_show_image_url = data[index][1]

							banner_obj = document.getElementById("banner")
							banner_obj.style.cssText = "background: url('" + pre_show_image_url + "') no-repeat;"

							vvd_banner_obj = document.getElementById("vvd_banner_img")
							vvd_banner_content = "<img id='banner_img_item' src='" + pre_show_image_url + "'style='position: fixed; z-index: -999'>"
							vvd_banner_obj.innerHTML = vvd_banner_content 

							if (!isMobile) {
								video_html_res = "<video id='video_item' style='position: fixed; z-index: -888;'  muted='muted' src=" + video_url + " autoplay='autoplay' loop='loop'></video>"
								document.getElementById("banner_video_insert").innerHTML = video_html_res;
								set_video_attr('video_item')
								set_video_attr('banner_img_item')
							}
						});
					  });






					if (!isMobile){
						window.onresize = function(){
							set_video_attr('video_item')
							set_video_attr('banner_img_item')
							}
						}
				</script>

			


			
			</div>
		</div>
    </div>

  </header>

  <main>
    
      



<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">

            <!-- <h1 id="seo-header">MongoDB 备份与恢复</h1> -->

            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    <!-- compatible with older versions-->
                    本文最后更新于：2025年4月30日 下午
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <blockquote>
<p>在Mongodb中我们使用mongodump命令来备份MongoDB数据。本文记录相关内容。</p>
</blockquote>
<span id="more"></span>
<h3 id="数据备份">数据备份</h3>
<p>在Mongodb中我们使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。</p>
<p>mongodump命令可以通过参数指定导出的数据量级转存的服务器。</p>
<p><code>mongodump</code> 是一种用于创建数据库内容二进制导出文件的实用程序。<code>mongodump</code> 可以从以下位置导出数据：</p>
<ul>
<li>独立运行部署</li>
<li>副本集</li>
<li>分片集群</li>
<li>无服务器实例</li>
</ul>
<p>mongodump 可以连接到 mongod 和 mongos 实例。</p>
<p><strong>注意：需要从系统命令行运行 <code>mongodump</code>，而非 <code>mongo shell</code>。</strong></p>
<h4 id="语法">语法</h4>
<p><code>mongodump</code>语法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">mongodump <span class="hljs-tag">&lt;<span class="hljs-name">options</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">connection-string</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>要指定 MongoDB 实例的主机和/或端口，可以执行以下任一操作：</p>
<ul>
<li>
<p>在 <code>--uri connection string</code> 选项中指定主机名和端口：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mongodump <span class="hljs-attr">--uri</span>=<span class="hljs-string">&quot;mongodb://mongodb0.example.com:27017&quot;</span> <span class="hljs-selector-attr">[additional options]</span><br></code></pre></td></tr></table></figure>
</li>
<li>
<p>在 <code>--host</code> 选项中指定主机名和端口：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mongodump <span class="hljs-attr">--host</span>=<span class="hljs-string">&quot;mongodb0.example.com:27017&quot;</span>  <span class="hljs-selector-attr">[additional options]</span><br></code></pre></td></tr></table></figure>
</li>
<li>
<p>在 <code>--host</code> 和 <code>--port</code> 选项中指定主机名和端口：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">mongodump <span class="hljs-attribute">--host</span>=<span class="hljs-string">&quot;mongodb0.example.com&quot;</span> <span class="hljs-attribute">--port</span>=27017 [additional options]<br></code></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="常用选项">常用选项</h4>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--help</code></td>
<td>返回有关 <code>mongodump</code> 的选项和使用的信息。</td>
<td></td>
</tr>
<tr>
<td><code>--out=&lt;path&gt;, -o=&lt;path&gt;</code></td>
<td>指定 mongodump 将在其中为转储数据库写入 BSON 文件的目录。默认情况下，mongodump 会将输出文件保存在当前工作目录中名为 dump 的目录中。</td>
<td>一般会将输出文件存放在名为 dump 的文件夹中。</td>
</tr>
<tr>
<td><code>--db=&lt;database&gt;, -d=&lt;database&gt;</code></td>
<td>指定要备份的数据库。如果不指定数据库，<code>mongodump</code> 会将此实例中的所有数据库复制到转储文件。</td>
<td></td>
</tr>
<tr>
<td><code>--password=&lt;password&gt;, -p=&lt;password&gt;</code></td>
<td>指定密码，用于对使用身份验证的 MongoDB 数据库进行身份验证。</td>
<td></td>
</tr>
<tr>
<td><code>--username=&lt;username&gt;, -u=&lt;username&gt;</code></td>
<td>指定用户名，用于对使用身份验证的 MongoDB 数据库进行身份验证。</td>
<td></td>
</tr>
<tr>
<td><code>--port=&lt;port&gt;</code></td>
<td>指定 MongoDB 实例侦听客户端连接的 TCP 端口。</td>
<td><em>默认</em>: 27017</td>
</tr>
<tr>
<td><code>--host=&lt;hostname&gt;&lt;:port&gt;, -h=&lt;hostname&gt;&lt;:port&gt;</code></td>
<td>指定 MongoDB 部署的可解析主机名。默认情况下，<code>mongodump</code> 尝试连接到在本地主机端口号 <code>27017</code> 上运行的 MongoDB 实例。</td>
<td><em>默认</em>：localhost:27017</td>
</tr>
<tr>
<td><code>--version</code></td>
<td>返回 <code>mongodump</code> 版本号。</td>
<td></td>
</tr>
</tbody>
</table>
<p>当数据库指定了需要鉴权访问，则必须输入正确的用户名和密码才可以执行 <code>mongodump</code>，否则不予执行备份命令。</p>
<h4 id="详细选项">详细选项</h4>
<ul>
<li>
<p><code>--help</code></p>
<p>返回有关 <code>mongodump</code> 的选项和使用的信息。</p>
</li>
<li>
<p><code>--verbose, -v</code></p>
<p>增加标准输出或日志文件中返回的内部报告数量。通过多次包含该选项，可以使用 <code>-v</code> 形式增加详细程度。例如：<code>-vvvvv</code>。</p>
</li>
<li>
<p><code>--quiet</code></p>
<p>在尝试限制输出量的安静模式下运行 <code>mongodump</code>。该选项会抑制：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-database-command">数据库命令</a>复制活动已接受和已关闭的事件连接所有日志，包括错误信息，解析选项时出现的错误信息除外</p>
</li>
<li>
<p><code>--version</code></p>
<p>返回 <code>mongodump</code> 版本号。</p>
</li>
<li>
<p><code>--config=&lt;filename&gt;</code></p>
<p><em>版本 100.3.0 中的新增内容</em>。指定包含以下 <code>mongodump</code> 选项的敏感值的 YAML 配置文件的完整路径：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>--uri</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a>除通过密码提示来指定密码之外，这是为 <code>mongodump</code> 指定密码的另一推荐方法。配置文件采用以下形式：<code>password: &lt;password&gt;uri: mongodb://mongodb0.example.com:27017sslPEMKeyPassword: &lt;password&gt;</code>向 <code>password:</code> 字段指定密码并在 <code>uri:</code> 字段中提供包含冲突密码的连接字符串将导致错误。请务必使用相应的文件系统权限保护此文件。注意如果使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--config"><code>--config</code></a> 来指定配置文件，并使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a>、<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>--uri</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 选项来 <code>mongodump</code>，那么每个命令行选项均会覆盖其在配置文件中的相应选项。</p>
</li>
<li>
<p><code>--uri=&lt;connectionString&gt;</code></p>
<p>指定 MongoDB 部署的可解析<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/">URI 连接字符串</a>，用引号引起来：<code>--uri=&quot;mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]&quot;</code>从 <code>mongodump</code> 的 <code>100.0</code> 版本开始，也可以将连接字符串作为位置参数提供，而无需使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>--uri</code></a> 选项：<code>mongodump mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]</code>作为位置参数，可以在命令行上的任何位置指定连接字符串，前提是它以 <code>mongodb://</code> 或 <code>mongodb+srv://</code> 开头。例如：<code>mongodump --username joe --password secret1 mongodb://mongodb0.example.com:27017 --ssl</code>只能提供一个连接字符串。无论是使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>--uri</code></a> 选项还是作为位置参数，尝试纳入多个连接字符串都会导致错误。有关连接字符串组件的信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/">连接字符串 URI 格式</a>文档。注意<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>connection string</code></a> 中的某些组件也可以使用各自的显式命令行选项来指定，例如 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--username"><code>--username</code></a> 和 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a>。在提供连接字符串的同时，使用显式选项并指定冲突信息会导致错误。注意如果是在 Ubuntu 18.04 上使用 <code>mongodump</code>，则在使用带 <code>mongodb+srv://</code> 选项的 （采用 <code>cannot unmarshal DNS</code> 格式）时，可能会出现“<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>](https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri)”错误消息。如果是这样，请改用以下选项之一：带有[</code></a>（格式为 ）的 <code>mongodb://</code> 选项<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--host"><code>--host</code></a> 选项指定直接连接的主机警告在某些系统上，使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>--uri</code></a> 选项在连接字符串中提供的密码，可能会被其他用户调用的系统状态程序（如 <code>ps</code> ）探测到。请考虑：在连接字符串中省略密码，接收交互式密码提示，或者使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--config"><code>--config</code></a> 选项指定包含密码的配置文件。</p>
</li>
<li>
<p><code>--host=&lt;hostname&gt;&lt;:port&gt;, -h=&lt;hostname&gt;&lt;:port&gt;</code></p>
<p><em>默认</em>：localhost:27017指定 MongoDB 部署的可解析主机名。默认情况下，<code>mongodump</code> 尝试连接到在本地主机端口号 <code>27017</code> 上运行的 MongoDB 实例。要连接到副本集，请指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-replication.replSetName"><code>replSetName</code></a> 和副本集成员的种子列表，如下所示：<code>--host=&lt;replSetName&gt;/&lt;hostname1&gt;&lt;:port&gt;,&lt;hostname2&gt;&lt;:port&gt;,&lt;...&gt;</code>指定副本集列表格式时，<code>mongodump</code> 始终连接到<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-primary">主节点</a>还可以通过仅指定该成员的主机和端口来连接至副本集的任何单个成员：<code>--host=&lt;hostname1&gt;&lt;:port&gt;</code>如果您使用 IPv6 并采用 <code>&lt;address&gt;:&lt;port&gt;</code> 格式，那么您必须将地址与端口的组合部分用方括号括起。例如：<code>[&lt;address&gt;]</code>。或者，您也可直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定主机名。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--host"><code>--host</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--port=&lt;port&gt;</code></p>
<p><em>默认</em>: 27017指定 MongoDB 实例侦听客户端连接的 TCP 端口。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定端口。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--port"><code>--port</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--ssl</code></p>
<p>启用与已启用 TLS/SSL 支持的 <code>mongod</code> 或 <code>mongos</code> 的连接。或者，也可以直接在<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中配置 TLS/SSL 支持。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--ssl"><code>--ssl</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--sslCAFile=&lt;filename&gt;</code></p>
<p>指定包含来自证书颁发机构的根证书链的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。或者，也可以直接在 <code>.pem</code> 中指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 文件。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslCAFile"><code>--sslCAFile</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--sslPEMKeyFile=&lt;filename&gt;</code></p>
<p>指定同时包含 TLS/SSL 证书和密钥的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。使用<code>--ssl</code>选项连接到启用了<code>mongod</code>且<code>mongos</code>的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.CAFile"><code>CAFile</code></a>或<em>没有</em>时，需要使用此选项。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.allowConnectionsWithoutCertificates"><code>allowConnectionsWithoutCertificates</code></a>或者，也可以直接在 <code>.pem</code> 中指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 文件。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslPEMKeyFile"><code>--sslPEMKeyFile</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--sslPEMKeyPassword=&lt;value&gt;</code></p>
<p>指定解密证书密钥文件的密码（即 <code>--sslPEMKeyFile</code>）。仅当证书密钥文件已加密时才使用 ``–sslPEMKeyPassword<code> 选项。在所有情况下，</code>mongodump<code>都会对所有日志记录和报告输出中的密码进行脱敏。如果 PEM 文件中的私钥已加密，并且您未指定</code>–sslPEMKeyPassword<code> 选项，</code>mongodump<code> 将提示输入密码。请参阅[ TLS/SSL 证书密码。](https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/#std-label-ssl-certificate-password)或者，您也可以直接在 [</code>URI connection string<code>](https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri) 中指定密码。在提供连接字符串的同时使用 [</code>–sslPEMKeyPassword<code>](https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslPEMKeyPassword) 并指定冲突信息将导致错误。警告在某些系统上，直接使用 [</code>–sslPEMKeyPassword<code>](https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslPEMKeyPassword) 选项提供的密码，可能会被其他用户调用的系统状态程序（如 </code>ps<code>）探测到。可以考虑使用 [</code>–config`](<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--config">https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--config</a>) 选项，指定一个包含密码的配置文件。</p>
</li>
<li>
<p><code>--sslCRLFile=&lt;filename&gt;</code></p>
<p>指定包含证书吊销列表的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。</p>
</li>
<li>
<p><code>--sslAllowInvalidCertificates</code></p>
<p>绕过对服务器证书的验证检查并允许使用无效证书。 使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.allowInvalidCertificates"><code>allowInvalidCertificates</code></a>设置时，MongoDB 将使用无效证书记录为警告。警告尽管可用，但请尽可能避免使用 <code>--sslAllowInvalidCertificates</code> 选项。如果需要使用 <code>--sslAllowInvalidCertificates</code>，请仅在不可能入侵的系统上使用该选项。在未验证服务器证书的情况下，连接到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongos/#mongodb-binary-bin.mongos"><code>mongos</code></a> 实例存在潜在的安全风险。如果只需禁用 TLS/SSL 证书中的主机名验证，请参阅 <code>--sslAllowInvalidHostnames</code>。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中禁用证书验证。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslAllowInvalidCertificates"><code>--sslAllowInvalidCertificates</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--sslAllowInvalidHostnames</code></p>
<p>禁用 TLS/SSL 证书中的主机名验证。即使证书中的主机名与指定的主机名不匹配，也支持 <code>mongodump</code> 连接到 MongoDB 实例。或者，您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中禁用主机名验证。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--sslAllowInvalidHostnames"><code>--sslAllowInvalidHostnames</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--username=&lt;username&gt;, -u=&lt;username&gt;</code></p>
<p>指定用户名，用于对使用身份验证的 MongoDB 数据库进行身份验证。与 <code>--password &lt;mongodump --password&gt;</code> 和 <code>--authenticationDatabase &lt;mongodump --authenticationDatabase&gt;</code> 选项结合使用。或者，也可直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定用户名。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--username"><code>--username</code></a> 并指定冲突信息将导致错误。如果使用 <code>MONGODB-AWS</code> 连接到集群，您可以在以下位置指定您的 AWS 访问密钥 ID：这个字段，<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>connection string</code></a>，或<code>AWS_ACCESS_KEY_ID</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/mongodump-examples/#std-label-mongodump-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。</p>
</li>
<li>
<p><code>--password=&lt;password&gt;, -p=&lt;password&gt;</code></p>
<p>指定密码，用于对使用身份验证的 MongoDB 数据库进行身份验证。与 <code>--username &lt;mongodump --username&gt;</code> 和 <code>--authenticationDatabase &lt;mongodump --authenticationDatabase&gt;</code> 选项结合使用。要提示用户输入密码，可使用不带 <code>--password &lt;mongodump --password&gt;</code> 的 <code>--username &lt;mongodump --username&gt;</code> 选项，或指定空字符串作为 <code>--password &lt;mongodump --password&gt;</code> 值，如 <code>--password &quot;&quot;</code>。或者，您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定密码。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a> 并指定冲突信息将导致错误。如果使用 <code>MONGODB-AWS</code> 连接到集群，您可以在以下位置指定您的 AWS 秘密访问密钥：这个字段，<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>connection string</code></a>，或<code>AWS_SECRET_ACCESS_KEY</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/mongodump-examples/#std-label-mongodump-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。警告在某些系统上，直接使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a> 选项提供的密码，可能会被其他用户调用的系统状态程序（如 <code>ps</code>）探测到。请考虑：省略 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--password"><code>--password</code></a> 选项，从而接收交互式密码提示，或使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--config"><code>--config</code></a> 选项指定包含密码的配置文件。</p>
</li>
<li>
<p><code>--awsSessionToken=&lt;AWS Session Token&gt;</code></p>
<p>如果使用 连接到 <code>MONGODB-AWS</code> 集群，并且除了 AWS 访问密钥 ID 和私密访问密钥之外还使用会话令牌，则可以在以下情况中指定 AWS 会话令牌：这个字段，<code>AWS_SESSION_TOKEN</code> 的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/#mongodb-urioption-urioption.authMechanismProperties"><code>connection string</code></a> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>authMechanismProperties</code></a> 参数，或<code>AWS_SESSION_TOKEN</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/mongodump-examples/#std-label-mongodump-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。仅在使用 <code>MONGODB-AWS</code><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--authenticationMechanism"><code>authentication mechanism</code></a></p>
</li>
<li>
<p><code>--authenticationDatabase=&lt;dbname&gt;</code></p>
<p>指定已创建指定 <code>--username &lt;mongodump --username&gt;</code> 的身份验证数据库。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-users/#std-label-user-authentication-database">身份验证数据库</a>如果未指定身份验证数据库，<code>mongodump</code> 将假定指定要导出的数据库保存用户凭证。如果未指定身份验证数据库或要导出的数据库，则 <code>mongodump</code> 将假定 <code>admin</code> 数据库保存用户的凭证。如果使用的是 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-kerberos">GSSAPI</a> (Kerberos)、<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-ldap">PLAIN</a> (LDAP SASL) 或 <code>MONGODB-AWS</code> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--authenticationMechanism"><code>authentication mechanisms</code></a>，则须将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--authenticationDatabase"><code>--authenticationDatabase</code></a> 设为 <code>$external</code>。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定身份验证数据库。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--authenticationDatabase"><code>--authenticationDatabase</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--authenticationMechanism=&lt;name&gt;</code></p>
<p><em>默认值</em>：SCRAM-SHA-1指定 <code>mongodump</code> 实例用来向 <code>mongod</code> 或 <code>mongos</code> 进行身份验证的身份验证机制。<em>在版本 100.1.0 中进行了更改</em>：从版本 <code>100.1.0</code> 开始，<code>mongodump</code> 在连接到 <code>MONGODB-AWS</code> 集群时增加了对 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/atlas/?tck=docs_server">MongoDB Atlas</a> 身份验证机制的支持。值说明<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-scram/#std-label-authentication-scram-sha-1">SCRAM-SHA-1</a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5802">RFC 5802</a> 使用 SHA-1 哈希函数的标准 Salted Challenge Response Authentication Mechanism<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-scram/#std-label-authentication-scram-sha-256">SCRAM-SHA-256</a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7677">RFC 7677</a> 使用 SHA-256 哈希函数的标准 Salted Challenge Response Authentication Mechanism需将 featureCompatibilityVersion 设为 <code>4.0</code>。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-x.509/#std-label-security-auth-x509">MONGODB-X509</a>MongoDB TLS/SSL 证书身份验证。<code>MONGODB-AWS</code>使用 AWS IAM 凭据进行外部身份验证，用于连接到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/cloud/atlas?tck=docs_server">MongoDB Atlas</a> 集群。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/mongodump-examples/#std-label-mongodump-example-connect-using-aws-iam">使用 AWS IAM 凭证连接到 MongoDB Atlas 集群</a>。<em>100.1.0 版本新增</em>。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-kerberos">GSSAPI</a> (Kerberos)使用 Kerberos 的外部身份验证。此机制仅在<a target="_blank" rel="noopener" href="http://www.mongodb.com/products/mongodb-enterprise-advanced?tck=docs_databasetools">MongoDB Enterprise 中可用。</a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-ldap">普通版</a> (LDAP SASL)使用 LDAP 进行外部身份验证。也可使用 <code>PLAIN</code> 对数据库内用户进行身份验证。<code>PLAIN</code> 以纯文本形式传输密码。此机制仅在 <a target="_blank" rel="noopener" href="http://www.mongodb.com/products/mongodb-enterprise-advanced?tck=docs_databasetools">MongoDB Enterprise</a>或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定身份验证机制。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--authenticationMechanism"><code>--authenticationMechanism</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--gssapiServiceName</code></p>
<p>使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/kerberos/">GSSAPI/Kerberos</a> 指定服务名称。仅当服务未使用默认名称 <code>mongodb</code> 时才需要。此选项仅在 MongoDB Enterprise 中可用。您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定服务名称。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--gssapiServiceName"><code>--gssapiServiceName</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--gssapiHostName</code></p>
<p>使用 <code>GSSAPI/Kerberos &lt;/core/kerberos&gt;</code> 指定服务的主机名。<em>仅</em>当机器的主机名与 DNS 解析的主机名不匹配时才需要。此选项仅在 MongoDB Enterprise 中可用。</p>
</li>
<li>
<p><code>--db=&lt;database&gt;, -d=&lt;database&gt;</code></p>
<p>指定要备份的数据库。如果不指定数据库，<code>mongodump</code> 会将此实例中的所有数据库复制到转储文件。或者也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--uri"><code>URI connection string</code></a> 中指定数据库。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--db"><code>--db</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--collection=&lt;collection&gt;, -c=&lt;collection&gt;</code></p>
<p>指定要备份的集合。如果不指定集合， 此选项则会将指定数据库或实例中的所有集合复制到转储文件。</p>
</li>
<li>
<p><code>--query=&lt;json&gt;, -q=&lt;json&gt;</code></p>
<p>提供 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-JSON-document">JSON 文档</a>作为查询，该查询可选择性地限制 <code>mongodump</code> 输出中包含的文档。要使用 <code>--query</code> 选项，还必须指定 <code>--collection &lt;mongodump --collection&gt;</code> 选项。必须用单引号 (<code>'&#123; ... &#125;'</code>) 括起查询文档，确保它不会与 shell 环境交互。此查询<strong>必须</strong>采用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/mongodb-extended-json/">扩展 JSON v2 格式（宽松模式或规范/严格模式）</a>，其中包括用引号将字段名称和操作符括起来。例如：<code>mongodump -d=test -c=records -q='&#123; &quot;a&quot;: &#123; &quot;$gte&quot;: 3 &#125;, &quot;date&quot;: &#123; &quot;$lt&quot;: &#123; &quot;$date&quot;: &quot;2016-01-01T00:00:00.000Z&quot; &#125; &#125; &#125;'</code>如要使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/regex/#mongodb-query-op.-regex"><code>$regex</code></a> 和 <code>mongodump</code>，请使用以下语法：<code>mongodump -d=sample_mflix -c=movies -q='&#123; &quot;year&quot;: &#123; &quot;$regex&quot;: &quot;20&quot; &#125; &#125;'</code>注意在<code>--query</code>上使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/timeseries-collections/#std-label-manual-timeseries-collection">时间序列集合</a> 选项时，只能查询指定为 <code>metaField</code> 的字段。</p>
</li>
<li>
<p><code>--queryFile=&lt;path&gt;</code></p>
<p>将包含 JSON 文档的文件的路径指定为查询过滤器，以限制在 <code>mongodump</code> 输出中包含的文档。<code>--queryFile</code> 使您能够创建过大而无法放入终端缓冲区的查询过滤器。注意在时间序列集合上使用 <code>--queryFile</code> 选项时，只能查询指定为 <code>metaField</code> 的字段。</p>
</li>
<li>
<p><code>--readPreference=&lt;string|document&gt;</code></p>
<p><em>默认</em>: <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/read-preference/#mongodb-readmode-primary"><code>primary</code></a>指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/read-preference/#std-label-replica-set-read-preference">读取偏好</a> 的<code>mongodump</code>。<code>--readPreference</code> 选项可以使用：如果仅指定读取偏好模式，则为一个字符串：<code>--readPreference=secondary</code>用引号括起的文档，用于指定模式、可选的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-replica-set-tag-sets/#std-label-configure-read-pref-tags">读取偏好标签集</a>以及可选的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/read-preference-staleness/#std-label-replica-set-read-preference-max-staleness">maxStalenessSeconds：</a><code>--readPreference='&#123;mode: &quot;secondary&quot;, tagSets: [ &#123; &quot;region&quot;: &quot;east&quot; &#125; ], maxStalenessSeconds: 120&#125;'</code>如果指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/read-preference-staleness/#std-label-replica-set-read-preference-max-staleness">maxStalenessSeconds</a>，该值则须大于或等于 90。<code>mongodump</code> 默认为 <code>primary</code> 读取偏好。如果此读取偏好也包含在 <code>--uri connection string &lt;--uri&gt;</code> 中，则命令行 <code>--readPreference</code> 会覆盖 URI 字符串中指定的读取偏好。</p>
</li>
<li>
<p><code>--gzip</code></p>
<p>压缩输出。如果 <code>mongodump</code> 输出到转储目录，则新功能将压缩单个文件。文件后缀为 <code>.gz</code>。如果 <code>mongodump</code> 输出到存档文件或标准输出数据流，则新功能会压缩存档文件或输出到数据流的数据。</p>
</li>
<li>
<p><code>--out=&lt;path&gt;, -o=&lt;path&gt;</code></p>
<p>指定 <code>mongodump</code> 将在其中为转储数据库写入 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-BSON">BSON</a> 文件的目录。默认情况下，<code>mongodump</code> 会将输出文件保存在当前工作目录中名为 <code>dump</code> 的目录中。要将数据库转储发送到标准输出，请指定 “<code>-</code>” 而不是路径。如果想在保存之前处理输出，请写入到标准输出，例如使用 <code>gzip</code> 来压缩转储.写入标准输出时，<code>mongodump</code> 不会写入当直接写入到文件时在 <code>&lt;dbname&gt;.metadata.json</code> 文件中写入的元数据。不能将 <code>--archive</code>选项与 <code>--out</code> 选项一起使用。</p>
</li>
<li>
<p><code>--archive=&lt;file&gt;</code></p>
<p>将输出写入到指定的存档文件中；如果未指定存档文件，则写入到标准输出 (<code>stdout</code>)。存档文件是多个 BSON 文件的单一文件替代方案。要将转储输出到存档文件，请运行带有 <code>--archive &lt;mongodump --archive&gt;</code> 选项和存档文件名的 <code>mongodump</code>。<code>mongodump --archive=&lt;file&gt;</code>要将转储输出到标准输出流，以便通过管道传输到其他进程，请使用 <code>--archive &lt;mongodump --archive&gt;</code> 选项运行 <code>mongodump</code>，但<em>省略</em>文件名。<code>mongodump --archive</code>不能将 <code>--archive &lt;mongodump --archive&gt;</code>选项与 <code>--out &lt;mongodump --out&gt;</code> 选项一起使用。注意如果 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#mongodb-binary-bin.mongodump"><code>mongodump</code></a> 写入到存档文件中，<code>mongodump</code> 性能可能会提高。有关 <code>mongodump</code> 性能影响的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/backup-and-restore-tools/#std-label-considerations-output-format">输出格式注意事项</a></p>
</li>
<li>
<p><code>--oplog</code></p>
<p>创建一个名为<code>oplog.bson</code>的文件，作为<code>mongodump</code>输出的一部分。位于输出目录顶层的<code>oplog.bson</code>文件包含<code>mongodump</code>操作期间出现的 oplog 条目。<code>mongodump --oplog</code>您可以将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>oplog.bson</code></a> 与 <code>mongorestore --oplogReplay</code> 一起使用，以确保数据是最新的，并且包含转储期间发生的所有写入。如果没有 <code>--oplog</code>，则当转储操作期间有写入操作时，转储将不会反映任何单一时间点。在更新过程中对数据库所做的更改可能会影响备份的输出。要在接受写入的同时备份各个副本集，请使用 <code>--oplog</code>。要使用 <code>mongodump</code> 备份分片集群，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/backup-sharded-cluster-with-database-dumps/#std-label-backup-sharded-dumps">使用数据库转储备份分片集群</a>重要如果客户端在转储过程中发出所列的任何操作，则带 <code>--oplog</code> 的 <code>mongodump</code> 运行会失败。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/command/renameCollection/#mongodb-dbcommand-dbcmd.renameCollection"><code>renameCollection</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.renameCollection/#mongodb-method-db.collection.renameCollection"><code>db.collection.renameCollection()</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.aggregate/#mongodb-method-db.collection.aggregate"><code>db.collection.aggregate()</code></a>，带有 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/operator/aggregation/out/#mongodb-pipeline-pipe.-out"><code>$out</code></a><code>mongos</code>在 <code>mongodump</code> 实例上运行 <code>--oplog</code> 以转储分片集群的全部内容时，<code>--oplog</code> 仅适用于维护 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-oplog">oplog</a> 的节点。这包括副本集的所有节点。<code>--oplog</code>不会转储 oplog 集合。注意要将 <code>mongodump</code> 与 <code>--oplog</code> 一起使用，必须创建<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-replica-set">副本集</a>节点的完整转储。如果使用以下任一选项限制要转储的数据，则带 <code>--oplog</code> 的 <code>mongodump</code> 将失败：<code>--db``--collection``--dumpDbUsersAndRoles``--query</code>提示另请参阅：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>mongorestore --oplogReplay</code></a></p>
</li>
<li>
<p><code>--dumpDbUsersAndRoles</code></p>
<p>在特定数据库上执行 <code>mongodump</code> 时，应在数据库的转储目录中包含用户和角色定义。仅当在 <code>--db</code> 选项中指定数据库时，此选项才会应用。将 <code>mongodump</code> 应用于整个实例而非特定数据库时，MongoDB 始终包含用户与角色定义。</p>
</li>
<li>
<p><code>--excludeCollection=&lt;string&gt;</code></p>
<p>排除 <code>mongodump</code> 输出中指定的集合。如需排除多个集合，请多次指定 <code>--excludeCollection</code>。</p>
</li>
<li>
<p><code>--excludeCollectionsWithPrefix=&lt;string&gt;</code></p>
<p>排除 <code>mongodump</code> 输出中所有带有指定前缀的集合。如需指定多个前缀，请多次指定 <code>--excludeCollectionsWithPrefix</code>。</p>
</li>
<li>
<p><code>--numParallelCollections=&lt;int&gt;, -j=&lt;int&gt;</code></p>
<p><em>默认</em>: 4<code>mongodump</code> 应并行导出的集合数量。</p>
</li>
<li>
<p><code>--viewsAsCollections</code></p>
<p>指定后，<code>mongodump</code> 会将<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/views/#std-label-views-landing-page">视图</a>导出为集合。注意仅导出视图。默认情况下，<code>mongodump</code> 仅导出视图的元数据。要导出视图中的文档，请使用 <code>--viewsAsCollections</code> 选项。对于每个视图，<code>mongodump</code> 都会创建一个 BSON 文件，其中包含该视图中的文档。如果您将 <code>mongorestore</code> 与由 <code>mongodump</code> 创建的 BSON 文件一起使用，则视图将恢复为集合。如果<em>不</em>包含 <code>--viewsAsCollections</code>，<code>mongodump</code> 会捕捉每个视图的元数据。如果您在 <code>mongorestore</code> 操作中包含视图的元数据文件，则该视图会重建。</p>
</li>
</ul>
<h3 id="数据恢复">数据恢复</h3>
<p>mongodb使用 mongorestore 命令来恢复备份的数据。</p>
<p>mongorestore程序将数据从mongodump创建的二进制数据库转储或标准输入加载到mongod或mongos实例中。</p>
<p>您可以将从 mongodump 生成的 BSON 文件恢复到与源部署运行相同或更新版本的 MongoDB 部署中。</p>
<p>从系统命令行运行 mongorestore，而非 mongo shell。</p>
<blockquote>
<p>MongoDB 不支持为同一集合同时运行多个 <code>mongorestore</code> 程序。</p>
</blockquote>
<h4 id="语法-2">语法</h4>
<p><code>mongorestore</code>语法：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">mongorestore &lt;options&gt; &lt;connection-<span class="hljs-keyword">string</span>&gt; &lt;<span class="hljs-built_in">directory</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">file</span> <span class="hljs-built_in">to</span> restore&gt;<br></code></pre></td></tr></table></figure>
<h4 id="常用选项-2">常用选项</h4>
<p>根据备份时的权限情况，恢复数据时也需要相应的鉴权，即需要用户密码才能恢复数据。</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--help</code></td>
<td>返回有关 <code>mongodump</code> 的选项和使用的信息。</td>
<td></td>
</tr>
<tr>
<td><code>--version</code></td>
<td>返回 <code>mongorestore</code> 版本号。</td>
<td></td>
</tr>
<tr>
<td><code>--host=&lt;hostname&gt;&lt;:port&gt;, -h=&lt;hostname&gt;&lt;:port&gt;</code></td>
<td>指定 MongoDB 部署的可解析主机名。默认情况下，<code>mongorestore</code> 尝试连接到在本地主机端口号 <code>27017</code> 上运行的 MongoDB 实例。</td>
<td><em>默认</em>：localhost:27017</td>
</tr>
<tr>
<td><code>--port=&lt;port&gt;</code></td>
<td>指定 MongoDB 实例侦听客户端连接的 TCP 端口。</td>
<td><em>默认</em>: 27017</td>
</tr>
<tr>
<td><code>--username=&lt;username&gt;, -u=&lt;username&gt;</code></td>
<td>指定用户名，用于对使用身份验证的 MongoDB 数据库进行身份验证。</td>
<td></td>
</tr>
<tr>
<td><code>--password=&lt;password&gt;, -p=&lt;password&gt;</code></td>
<td>指定密码，用于对使用身份验证的 MongoDB 数据库进行身份验证。</td>
<td></td>
</tr>
<tr>
<td><code>--db=&lt;database&gt;, -d=&lt;database&gt;</code></td>
<td>指定从BSON 文件恢复时，<code>mongorestore</code> 将数据恢复到<em>其中</em> 的目标数据库。如果该数据库不存在，<code>mongorestore</code> 将创建该数据库。</td>
<td></td>
</tr>
<tr>
<td><code>--collection=&lt;collection&gt;, -c=&lt;collection&gt;</code></td>
<td>指定从 BSON 文件恢复数据时<code>mongorestore</code>将数据恢复<em>到</em>其中的目标集合的名称。</td>
<td></td>
</tr>
<tr>
<td><code>--dir=string</code></td>
<td>指定转储目录。</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="详细选项-2">详细选项</h4>
<ul>
<li>
<p><code>--help</code></p>
<p>返回有关 <code>mongorestore</code> 的选项和使用的信息。</p>
</li>
<li>
<p><code>--verbose, -v</code></p>
<p>增加标准输出或日志文件中返回的内部报告数量。通过包括多个 <code>-v</code> 选项来提高详细程度，（例如 <code>-vvvvv</code>。）</p>
</li>
<li>
<p><code>--quiet</code></p>
<p>在尝试限制输出量的安静模式下运行 <code>mongorestore</code>。该选项会抑制：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-database-command">数据库命令</a>复制活动连接接受事件连接关闭事件</p>
</li>
<li>
<p><code>--version</code></p>
<p>返回 <code>mongorestore</code> 版本号。</p>
</li>
<li>
<p><code>--config=&lt;filename&gt;</code></p>
<p><em>版本 100.3.0 中的新增内容</em>。指定包含以下 <code>mongorestore</code> 选项的敏感值的 YAML 配置文件的完整路径：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a>除通过密码提示来指定密码之外，这是为 <code>mongorestore</code> 指定密码的另一推荐方法。配置文件采用以下形式：<code>password: &lt;password&gt;uri: mongodb://mongodb0.example.com:27017sslPEMKeyPassword: &lt;password&gt;</code>向 <code>password:</code> 字段指定密码并在 <code>uri:</code> 字段中提供包含冲突密码的连接字符串将导致错误。请务必使用相应的文件系统权限保护此文件。注意如果使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--config"><code>--config</code></a> 来指定配置文件，并使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a>、<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 选项来 <code>mongorestore</code>，那么每个命令行选项均会覆盖其在配置文件中的相应选项。</p>
</li>
<li>
<p><code>--uri=&lt;connectionString&gt;</code></p>
<p>指定 MongoDB 部署的可解析<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/">URI 连接字符串</a>，用引号引起来：<code>--uri=&quot;mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]&quot;</code>从 <code>mongorestore</code> 的 <code>100.0</code> 版本开始，也可以将连接字符串作为位置参数提供，而无需使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri</code></a> 选项：<code>mongorestore mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]</code>作为位置参数，可以在命令行上的任何位置指定连接字符串，前提是它以 <code>mongodb://</code> 或 <code>mongodb+srv://</code> 开头。例如：<code>mongorestore --username joe --password secret1 mongodb://mongodb0.example.com:27017 --ssl</code>只能提供一个连接字符串。无论是使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri</code></a> 选项还是作为位置参数，尝试纳入多个连接字符串都会导致错误。有关连接字符串组件的信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/">连接字符串 URI 格式</a>文档。注意<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>connection string</code></a> 中的某些组件也可以使用各自的显式命令行选项来指定，例如 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--username"><code>--username</code></a> 和 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a>。在提供连接字符串的同时，使用显式选项并指定冲突信息会导致错误。注意如果是在 Ubuntu 18.04 上使用 <code>mongorestore</code>，则在使用带 <code>mongodb+srv://</code> 选项的 （采用 <code>cannot unmarshal DNS</code> 格式）时，可能会出现错误消息。如果是这样，请改用以下选项之一：带有<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri">``</a>（格式为 ）的 <code>mongodb://</code> 选项<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--host"><code>--host</code></a> 选项指定直接连接的主机警告在某些系统上，使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri</code></a> 选项在连接字符串中提供的密码，可能会被其他用户调用的系统状态程序（如 <code>ps</code> ）探测到。请考虑：在连接字符串中省略密码，接收交互式密码提示，或者使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--config"><code>--config</code></a> 选项指定包含密码的配置文件。</p>
</li>
<li>
<p><code>--host=&lt;hostname&gt;&lt;:port&gt;, -h=&lt;hostname&gt;&lt;:port&gt;</code></p>
<p><em>默认</em>：localhost:27017指定 MongoDB 部署的可解析主机名。默认情况下，<code>mongorestore</code> 尝试连接到在本地主机端口号 <code>27017</code> 上运行的 MongoDB 实例。要连接到副本集，请指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-replication.replSetName"><code>replSetName</code></a> 和副本集成员的种子列表，如下所示：<code>--host=&lt;replSetName&gt;/&lt;hostname1&gt;&lt;:port&gt;,&lt;hostname2&gt;&lt;:port&gt;,&lt;...&gt;</code>指定副本集列表格式时，<code>mongorestore</code> 始终连接到<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-primary">主节点</a>还可以通过仅指定该成员的主机和端口来连接至副本集的任何单个成员：<code>--host=&lt;hostname1&gt;&lt;:port&gt;</code>如果您使用 IPv6 并采用 <code>&lt;address&gt;:&lt;port&gt;</code> 格式，则须将地址与端口的组合部分用方括号括起（即 <code>[&lt;address&gt;]</code>）。或者，您也可直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定主机名。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--host"><code>--host</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--port=&lt;port&gt;</code></p>
<p><em>默认</em>: 27017指定 MongoDB 实例侦听客户端连接的 TCP 端口。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定端口。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--port"><code>--port</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--ssl</code></p>
<p>支持链接到启用 TLS/SSL 支持的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongos/#mongodb-binary-bin.mongos"><code>mongos</code></a>。或者，也可以直接在<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中配置 TLS/SSL 支持。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--ssl"><code>--ssl</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--sslCAFile=&lt;filename&gt;</code></p>
<p>指定包含来自证书颁发机构的根证书链的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。或者，也可以直接在 <code>.pem</code> 中指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 文件。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslCAFile"><code>--sslCAFile</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--sslPEMKeyFile=&lt;filename&gt;</code></p>
<p>指定同时包含 TLS/SSL 证书和密钥的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--ssl"><code>--ssl</code></a>选项连接到已启用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongos/#mongodb-binary-bin.mongos"><code>](https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod)启用[</code></a>的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.CAFile"><code>CAFile</code></a>或<em>且未</em>时，需要使用此选项。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.allowConnectionsWithoutCertificates"><code>allowConnectionsWithoutCertificates</code></a>或者，也可以直接在 <code>.pem</code> 中指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 文件。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyFile"><code>--sslPEMKeyFile</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--sslPEMKeyPassword=&lt;value&gt;</code></p>
<p>指定解密证书密钥文件的密码（即 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyFile"><code>--sslPEMKeyFile</code></a>）。仅当证书密钥文件已加密时才能使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 选项。在所有情况下，<code>mongorestore</code> 都会对所有日志记录和报告输出中的密码进行脱敏。如果 PEM 文件中的私钥已加密，并且您未指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 选项，<code>mongorestore</code> 将提示输入密码。请参阅 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/#std-label-ssl-certificate-password">TLS/SSL 证书密码</a>或者，您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定密码。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a>警告在某些系统上，直接使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslPEMKeyPassword"><code>--sslPEMKeyPassword</code></a> 选项提供的密码，可能会被其他用户调用的系统状态程序（如 <code>ps</code>）探测到。可以考虑使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--config"><code>--config</code></a> 选项，指定一个包含密码的配置文件。</p>
</li>
<li>
<p><code>--sslCRLFile=&lt;filename&gt;</code></p>
<p>指定包含证书吊销列表的 <code>.pem</code> 文件。使用相对或绝对路径指定 <code>.pem</code> 文件的文件名。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--sslAllowInvalidCertificates</code></p>
<p>绕过对服务器证书的验证检查并允许使用无效证书。 使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-net.tls.allowInvalidCertificates"><code>allowInvalidCertificates</code></a>设置时，MongoDB 将使用无效证书记录为警告。警告尽管可用，但请尽可能避免使用 <code>--sslAllowInvalidCertificates</code> 选项。如果需要使用 <code>--sslAllowInvalidCertificates</code>，请仅在不可能入侵的系统上使用该选项。在未验证服务器证书的情况下，连接到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongos/#mongodb-binary-bin.mongos"><code>mongos</code></a> 实例存在潜在的安全风险。如果只需禁用 TLS/SSL 证书中的主机名验证，请参阅 <code>--sslAllowInvalidHostnames</code>。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中禁用证书验证。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslAllowInvalidCertificates"><code>--sslAllowInvalidCertificates</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--sslAllowInvalidHostnames</code></p>
<p>禁用 TLS/SSL 证书中的主机名验证。即使证书中的主机名与指定的主机名不匹配，也支持 <code>mongorestore</code> 连接到 MongoDB 实例。或者，您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中禁用主机名验证。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--sslAllowInvalidHostnames"><code>--sslAllowInvalidHostnames</code></a> 并指定冲突信息将导致错误。有关 TLS/SSL 和 MongoDB 的更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl/">为 TLS/SSL 配置 mongod 和 mongos</a>以及<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/configure-ssl-clients/">客户端的 TLS/SSL 配置。</a></p>
</li>
<li>
<p><code>--username=&lt;username&gt;, -u=&lt;username&gt;</code></p>
<p>指定用户名，用于对使用身份验证的 MongoDB 数据库进行身份验证。与 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a> 和 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationDatabase"><code>--authenticationDatabase</code></a> 选项配合使用。或者，也可直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定用户名。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--username"><code>--username</code></a> 并指定冲突信息将导致错误。如果使用 <code>MONGODB-AWS</code> 连接到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationMechanism">``</a>集群，您可以在以下位置指定您的 AWS 访问密钥 ID：这个字段，<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>connection string</code></a>，或<code>AWS_ACCESS_KEY_ID</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-mongorestore-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。</p>
</li>
<li>
<p><code>--password=&lt;password&gt;, -p=&lt;password&gt;</code></p>
<p>指定密码，用于对使用身份验证的 MongoDB 数据库进行身份验证。与 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--username"><code>--username</code></a> 和 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationDatabase"><code>--authenticationDatabase</code></a> 选项结合使用。如要提示用户输入密码，可使用不带 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--username"><code>--password</code></a> 的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--username</code></a> 选项，或指定空字符串作为 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a> 值，如 <code>--password=&quot;&quot;</code>。或者，您也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定密码。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a> 并指定冲突信息将导致错误。如果使用 <code>MONGODB-AWS</code> 连接到集群，您可以在以下位置指定您的 AWS 秘密访问密钥：这个字段，<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>connection string</code></a>，或<code>AWS_SECRET_ACCESS_KEY</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-mongorestore-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。警告在某些系统上，直接使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a> 选项提供的密码，可能会被其他用户调用的系统状态程序（如 <code>ps</code>）探测到。请考虑：省略 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--password"><code>--password</code></a> 选项，从而接收交互式密码提示，或使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--config"><code>--config</code></a> 选项指定包含密码的配置文件。</p>
</li>
<li>
<p><code>--awsSessionToken=&lt;AWS Session Token&gt;</code></p>
<p>如果使用 连接到 <code>MONGODB-AWS</code> 集群，并且除了 AWS 访问密钥 ID 和私密访问密钥之外还使用会话令牌，则可以在以下情况中指定 AWS 会话令牌：这个字段，<code>AWS_SESSION_TOKEN</code> 的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/connection-string/#mongodb-urioption-urioption.authMechanismProperties"><code>connection string</code></a> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>authMechanismProperties</code></a> 参数，或<code>AWS_SESSION_TOKEN</code> 环境变量。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-mongorestore-example-connect-using-aws-iam">使用 AWS IAM 凭据连接到 MongoDB Atlas 集群</a>，了解每个凭据的示例。仅在使用 <code>MONGODB-AWS</code><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationMechanism"><code>authentication mechanism</code></a></p>
</li>
<li>
<p><code>--authenticationDatabase=&lt;dbname&gt;</code></p>
<p>指定已创建指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--username"><code>--username</code></a> 的身份验证数据库。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-users/#std-label-user-authentication-database">身份验证数据库</a>如果使用的是 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-kerberos">GSSAPI</a> (Kerberos)、<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-ldap">PLAIN</a> (LDAP SASL) 或 <code>MONGODB-AWS</code> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationMechanism"><code>authentication mechanisms</code></a>，则须将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationDatabase"><code>--authenticationDatabase</code></a> 设为 <code>$external</code>。或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定身份验证数据库。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationDatabase"><code>--authenticationDatabase</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--authenticationMechanism=&lt;name&gt;</code></p>
<p><em>默认值</em>：SCRAM-SHA-1指定 <code>mongorestore</code> 实例用来向 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a> 或 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongos/#mongodb-binary-bin.mongos"><code>mongos</code></a><em>在版本 100.1.0 中进行了更改</em>：从版本 <code>100.1.0</code> 开始，<code>mongorestore</code> 在连接到 <code>MONGODB-AWS</code> 集群时增加了对 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/atlas/?tck=docs_server">MongoDB Atlas</a> 身份验证机制的支持。值说明<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-scram/#std-label-authentication-scram-sha-1">SCRAM-SHA-1</a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5802">RFC 5802</a> 使用 SHA-1 哈希函数的标准 Salted Challenge Response Authentication Mechanism<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-scram/#std-label-authentication-scram-sha-256">SCRAM-SHA-256</a><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7677">RFC 7677</a> 使用 SHA-256 哈希函数的标准 Salted Challenge Response Authentication Mechanism需将 featureCompatibilityVersion 设为 <code>4.0</code>。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/security-x.509/#std-label-security-auth-x509">MONGODB-X509</a>MongoDB TLS/SSL 证书身份验证。<code>MONGODB-AWS</code>使用 AWS IAM 凭据进行外部身份验证，用于连接到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/cloud/atlas?tck=docs_server">MongoDB Atlas</a> 集群。请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-mongorestore-example-connect-using-aws-iam">使用 AWS IAM 凭证连接到 MongoDB Atlas 集群</a>。<em>100.1.0 版本新增</em>。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-kerberos">GSSAPI</a> (Kerberos)使用 Kerberos 的外部身份验证。此机制仅在<a target="_blank" rel="noopener" href="http://www.mongodb.com/products/mongodb-enterprise-advanced?tck=docs_databasetools">MongoDB Enterprise 中可用。</a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/authentication/#std-label-security-auth-ldap">普通版</a> (LDAP SASL)使用 LDAP 进行外部身份验证。也可使用 <code>PLAIN</code> 对数据库内用户进行身份验证。<code>PLAIN</code> 以纯文本形式传输密码。此机制仅在 <a target="_blank" rel="noopener" href="http://www.mongodb.com/products/mongodb-enterprise-advanced?tck=docs_databasetools">MongoDB Enterprise</a>或者，也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定身份验证机制。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--authenticationMechanism"><code>--authenticationMechanism</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--gssapiServiceName=&lt;serviceName&gt;</code></p>
<p>使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/kerberos/">GSSAPI/Kerberos</a> 指定服务名称。仅当服务未使用默认名称 <code>mongodb</code> 时才需要。此选项仅在 MongoDB Enterprise 中可用。</p>
</li>
<li>
<p><code>--gssapiHostName=&lt;hostname&gt;</code></p>
<p>使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/kerberos/">GSSAPI/Kerberos</a>指定服务的主机名。<em>仅</em>当计算机的主机名与 DNS 解析的主机名不匹配时才需要。此选项仅在 MongoDB Enterprise 中可用。</p>
</li>
<li>
<p><code>--db=&lt;database&gt;, -d=&lt;database&gt;</code></p>
<p>指定从BSON 文件恢复时，<code>mongorestore</code> 将数据恢复到<em>其中</em> 的目标数据库。如果该数据库不存在，<code>mongorestore</code> 将创建该数据库。例如，以下示例将 <code>salaries</code> 集合恢复到 <code>reporting</code> 数据库中。<code>mongorestore --db=reporting dump/test/salaries.bson</code>如果不指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a> ， <code>mongorestore</code>将从数据文件中读取数据库名称。从目录或存档文件恢复时，不建议使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--collection"><code>--collection</code></a>选项。 相反，要从存档或目录中恢复，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsInclude"><code>--nsInclude</code></a> 。或者也可以直接在 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>URI connection string</code></a> 中指定数据库。在提供连接字符串的同时使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a> 并指定冲突信息将导致错误。</p>
</li>
<li>
<p><code>--collection=&lt;collection&gt;, -c=&lt;collection&gt;</code></p>
<p>指定从 BSON 文件恢复数据时<code>mongorestore</code>将数据恢复<em>到</em>其中的目标集合的名称。 如果您不指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--collection"><code>--collection</code></a> ，则<code>mongorestore</code>将从输入文件名中获取集合名称。 如果输入文件包含扩展名，MongoDB 将从集合名称中省略文件的扩展名。<code>mongorestore --db=reporting --collection=employeesalaries dump/test/salaries.bson</code>从目录或存档文件恢复时，不建议使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--collection"><code>--collection</code></a>选项。 相反，要从存档或目录中恢复，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsInclude"><code>--nsInclude</code></a> 。</p>
</li>
<li>
<p><code>--nsExclude=&lt;namespace pattern&gt;</code></p>
<p>指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-namespace">命名空间</a>模式（例如 <code>&quot;test.myCollection&quot;</code> 、 <code>&quot;reporting.*&quot;</code> 、 <code>&quot;dept*.bar&quot;</code> ）从恢复中<em>排除</em>匹配的命名空间。 在该模式中，您可以使用星号<code>*</code>作为<em>通配符</em>。 有关通配符模式的示例，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-example-basic-wildcard-usage">使用通配符恢复集合。</a>您可以多次指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsExclude"><code>--nsExclude</code></a>以排除多个命名空间模式。</p>
</li>
<li>
<p><code>--nsInclude=&lt;namespace pattern&gt;</code></p>
<p>指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-namespace">命名空间</a>模式（例如 <code>&quot;test.myCollection&quot;</code> 、 <code>&quot;reporting.*&quot;</code> 、 <code>&quot;dept*.bar&quot;</code> ）仅恢复与模式匹配的命名空间。 在该模式中，您可以使用星号<code>*</code>作为<em>通配符</em>。 有关通配符模式的示例，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-example-basic-wildcard-usage">使用通配符恢复集合。</a>您可以多次指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsInclude"><code>--nsInclude</code></a>以包含多个命名空间模式。如果源目录或文件（即恢复数据的目录/文件） 不包含与命名空间模式匹配的数据文件， 则不会恢复任何数据。对于包含非 ASCII 字符的集合名称，<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#mongodb-binary-bin.mongodump"><code>mongodump</code></a> 会用百分比编码名称输出相应的文件名称。但是要恢复这些集合，请勿使用编码名称。相反，应使用包含非 ASCII 字符的命名空间。例如，如果转储目录包含<code>dump/test/caf%C3%A9s.bson</code>，请指定<code>--nsInclude &quot;test.cafés&quot;</code>。</p>
</li>
<li>
<p><code>--nsFrom=&lt;namespace pattern&gt;</code></p>
<p>与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>一起使用可在恢复操作期间重命名命名<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-namespace">空间</a>。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>指定转储文件中的集合，而<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>指定应在还原的数据库中使用的名称。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>接受<em>命名空间模式</em>作为其参数。 命名空间模式允许<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>引用与指定模式匹配的任何命名空间。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#mongodb-binary-bin.mongorestore"><code>mongorestore</code></a>匹配命名空间模式的最小有效出现次数。对于简单的替换，使用星号 (<code>*</code>) 作为通配符。用反斜杠转义所有字面星号和反斜杠。替换与匹配线性对应：<code>--nsFrom</code> 中的每个星号必须对应于 <code>--nsTo</code> 中的一个星号，并且 <code>--nsFrom</code> 中的第一个星号与 <code>nsTo</code> 中的第一个星号匹配。对于更复杂的替换，请使用美元符号来界定要在替换中使用的“通配符”变量。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-example-complex-wildcard-usage">在恢复期间更改集合命名空间</a>提供了使用以美元符号分隔的通配符进行复杂替换的示例。与星号的替换不同，美元符号分隔的通配符的替换<strong>不</strong>需要是线性的。</p>
</li>
<li>
<p><code>--nsTo=&lt;namespace pattern&gt;</code></p>
<p>与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>一起使用可在恢复操作期间重命名命名<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-namespace">空间</a>。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>指定要在恢复的数据库中使用的新集合名称，而<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>指定转储文件中的名称。<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>接受<em>命名空间模式</em>作为其参数。 命名空间模式允许<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>引用与指定模式匹配的任何命名空间。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#mongodb-binary-bin.mongorestore"><code>mongorestore</code></a>匹配命名空间模式的最小有效出现次数。对于简单的替换，使用星号 (<code>*</code>) 作为通配符。用反斜杠转义所有字面星号和反斜杠。替换与匹配线性对应：<code>--nsFrom</code> 中的每个星号必须对应于 <code>--nsTo</code> 中的一个星号，并且 <code>--nsFrom</code> 中的第一个星号与 <code>nsTo</code> 中的第一个星号匹配。对于更复杂的替换，请使用美元符号来界定要在替换中使用的“通配符”变量。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-examples/#std-label-example-complex-wildcard-usage">在恢复期间更改集合命名空间</a>提供了使用以美元符号分隔的通配符进行复杂替换的示例。与星号的替换不同，美元符号分隔的通配符的替换<strong>不</strong>需要是线性的。</p>
</li>
<li>
<p><code>--objcheck</code></p>
<p>强制<code>mongorestore</code>在收到客户端的所有请求后进行验证，以确保客户端永远不会将无效文档插入到数据库中。 对于子文档嵌套程度较高的对象， <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--objcheck"><code>--objcheck</code></a>对性能的影响很小。</p>
</li>
<li>
<p><code>--drop</code></p>
<p>从转储的备份中恢复集合之前，请从目标数据库中删除集合。 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--drop"><code>--drop</code></a>不会删除不在备份中的集合。当恢复包括<code>admin</code>数据库时， <code>mongorestore</code>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--drop"><code>--drop</code></a>会删除所有用户档案，并将其替换为转储文件中定义的用户。 因此，在启用了<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/configuration-options/#mongodb-setting-security.authorization"><code>authorization</code></a>的系统中， <code>mongorestore</code>必须能够对现有用户<em>和</em>转储文件中定义的用户进行身份验证。 如果<code>mongorestore</code>无法对转储文件中定义的用户进行身份验证，恢复进程就会失败，从而产生空数据库。如果在恢复过程中删除并重新创建集合，则新创建的集合具有不同的 UUID，除非<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--drop"><code>--drop</code></a>与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--preserveUUID"><code>--preserveUUID</code>一起使用。</a></p>
</li>
<li>
<p><code>--preserveUUID</code></p>
<p>已恢复的集合使用恢复数据中的 UUID， 而不会为在恢复过程中删除并重新创建的集合创建新的 UUID。要使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--preserveUUID"><code>--preserveUUID</code></a> ，还必须包含<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--drop"><code>--drop</code></a>选项。</p>
</li>
<li>
<p><code>--dryRun</code></p>
<p>运行 <code>mongorestore</code>，而不实际导入任何数据，将返回 <code>mongorestore</code> 摘要信息。与 <code>--verbose</code> 一起使用可生成更详细的摘要信息。</p>
</li>
<li>
<p><code>--oplogReplay</code></p>
<p>恢复数据库转储后，从 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-oplog">oplog</a> 文件重放 <code>oplog.bson</code> 条目。要在恢复中应用 <code>oplog.bson</code> 文件中的 oplog 条目，请使用<code>mongorestore --oplogReplay</code>。您可以将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--oplog"><code>mongodump --oplog</code></a> 与 <code>mongorestore --oplogReplay</code> 一起使用，以确保数据是最新的，并且包含转储操作期间发生的所有写入。<code>mongorestore</code>在以下位置搜索 bson 文件的任何有效来源：转储目录的顶层，比如使用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--oplog"><code>mongodump --oplog</code> 创建的转储。</a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogFile"><code>--oplogFile</code>指定的路径。</a><code>&lt;dump-directory&gt;/local/oplog.rs.bson</code>，例如将 <code>local</code> 数据库中的 <code>oplog.rs</code> 集合转储到副本集节点 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a> 上。如果转储目录的顶层存在<code>oplog.bson</code>文件，<strong>且</strong>路径由<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogFile"><code>--oplogFile</code></a>指定，则<code>mongorestore</code>将返回错误。如果转储目录的顶层有 <code>oplog.bson</code> 文件，则 <code>mongorestore</code> 会将该文件恢复为 oplog。如果 <code>dump/local</code> 目录中还有 bson 文件，<code>mongorestore</code> 会将该文件恢复为普通集合。如果您使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogFile"><code>--oplogFile</code></a>指定 oplog 文件， <code>mongorestore</code>会将该文件恢复为 oplog。 如果 <code>dump/local</code> 目录中还有BSON文件，<code>mongorestore</code> 会将其恢复为普通集合。oplog 重放输出中的以下消息显示 oplog 重放之前插入的数量。 它不包括重放期间 执行的插入。<code>0 document(s) restored successfully. 0 document(s) failed torestore.</code>有关 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>--oplogReplay</code></a> 的示例，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/tutorial/backup-and-restore-tools/#std-label-backup-restore-oplogreplay">使用 Oplog 文件备份和还原数据</a>注意将<code>mongorestore</code> 与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>--oplogReplay</code></a> 一起使用来恢复副本集时，必须恢复使用 创建的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-replica-set"> 副本集</a> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--oplog"><code>mongodump --oplog</code></a>成员的完整转储。如果使用以下任一选项来限制要恢复的数据，则<code>mongorestore</code>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>--oplogReplay</code></a>都会失败：<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--collection"><code>--collection</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsInclude"><code>--nsInclude</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsExclude"><code>--nsExclude</code></a>提示<strong>另请参阅：</strong><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/mongorestore-behavior-access-usage/#std-label-mongorestore-required-access">mongorestore 所需访问权限</a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--oplog"><code>mongodump --oplog</code></a></p>
</li>
<li>
<p><code>--oplogLimit=&lt;timestamp&gt;</code></p>
<p>防止<code>mongorestore</code>应用时间戳晚于或等于<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-oplog">oplog</a>的<code>&lt;timestamp&gt;</code>条目。 以<code>&lt;time_t&gt;:&lt;ordinal&gt;</code>的形式指定<code>&lt;timestamp&gt;</code>值，其中<code>&lt;time_t&gt;</code>是自 UNIX 纪元以来的秒数， <code>&lt;ordinal&gt;</code>表示在指定秒内发生的 oplog 中的操作计数器。警告请谨慎使用 <code>oplogLimit</code>：手动指定要应用的 oplog 条目可能会导致还原数据损坏和不一致。必须将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogLimit"><code>--oplogLimit</code></a> 与 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>--oplogReplay</code></a> 选项结合使用。</p>
</li>
<li>
<p><code>--oplogFile=&lt;path&gt;</code></p>
<p>指定包含用于恢复的 oplog 数据的 oplog 文件的路径。 与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogReplay"><code>--oplogReplay</code>一起使用。</a>如果指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--oplogFile"><code>--oplogFile</code></a>且转储目录的顶层存在<code>oplog.bson</code>文件，则<code>mongorestore</code>会返回错误。警告请谨慎使用 <code>oplogFile</code>：手动指定要应用的 oplog 条目可能会导致还原数据损坏和不一致。</p>
</li>
<li>
<p><code>--convertLegacyIndexes</code></p>
<p><em>100.0.0 版本新增</em>。删除相应的 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#mongodb-binary-bin.mongodump"><code>mongodump</code></a> 输出中指定的任何无效索引选项，并重写所有旧版索引键值以使用有效值。<em>无效索引选项</em> 是为索引指定的任何选项，但未列为 命令的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.createIndexes/#std-label-createIndexes-method-options"> 有效字段</a> <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/command/createIndexes/#mongodb-dbcommand-dbcmd.createIndexes"><code>createIndexes</code></a>。例如， <code>name</code>和<code>collation</code>有效，但任意<code>custom_field</code>无效。 指定<code>--convertLegacyIndexes</code>后，将删除所有找到的无效索引选项。<em>传统索引键值</em>是不再支持的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/indexes/index-types/#std-label-index-types">索引类型</a>的任何值。 例如，<code>1</code> 和 <code>-1</code> 是有效的索引键值，但 <code>0</code> 或空string是旧值。 指定<code>--convertLegacyIndexes</code>后，找到的任何旧索引键值都将被重写为<code>1</code> 。 非空string值不会被替换。如果不指定 <code>--convertLegacyIndexes</code> 选项，则无效索引选项或传统索引键值的存在可能会导致索引构建失败。如果将<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--noIndexRestore"><code>--noIndexRestore</code></a>选项指定为<code>mongorestore</code> ，则忽略<code>--convertLegacyIndexes</code>选项。</p>
</li>
<li>
<p><code>--keepIndexVersion</code></p>
<p>防止 <code>mongorestore</code> 在恢复过程中将索引升级到最新版本。</p>
</li>
<li>
<p><code>--noIndexRestore</code></p>
<p>防止 <code>mongorestore</code> 按照相应 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#mongodb-binary-bin.mongodump"><code>mongodump</code></a> 输出中的指定方式来恢复和构建索引。</p>
</li>
<li>
<p><code>--fixDottedHashIndex</code></p>
<p>在目标数据库上将虚线字段上的所有<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/indexes/index-types/index-hashed/">哈希索引</a>创建为单字段升序索引。</p>
</li>
<li>
<p><code>--noOptionsRestore</code></p>
<p>防止<code>mongorestore</code>在恢复的集合上设置集合选项，例如<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/command/collMod/#mongodb-dbcommand-dbcmd.collMod"><code>collMod</code></a><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-database-command">数据库命令</a>指定的选项。</p>
</li>
<li>
<p><code>--restoreDbUsersAndRoles</code></p>
<p>恢复给定数据库的用户和角色定义。有关更多信息，请参阅<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/system-roles-collection/">system.roles 集合</a>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/system-users-collection/">system.users 集合</a>。注意<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--restoreDbUsersAndRoles"><code>--restoreDbUsersAndRoles</code></a>如果为<code>admin</code> 选项指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db</code></a> 数据库，则无法使用 } 选项，尝试这样做会导致错误。通过将<code>mongorestore</code>指定为<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--db"><code>--db admin</code></a>来恢复<code>admin</code>数据库已恢复所有用户和角色。</p>
</li>
<li>
<p><code>--writeConcern=&lt;document&gt;</code></p>
<p><em>默认</em>：多数为<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/glossary/#std-term-write-concern">写关注</a>执行的每个写入操作指定<code>mongorestore</code>。使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/reference/write-concern/#std-label-wc-w">w 选项将写关注指定为文档：</a><code>--writeConcern=&quot;&#123;w:'majority'&#125;&quot;</code>如果写关注也包含在<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--uri"><code>--uri connection string</code></a>中，则命令行<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--writeConcern"><code>--writeConcern</code></a>将覆盖 URI string中指定的写关注。</p>
</li>
<li>
<p><code>--maintainInsertionOrder</code></p>
<p><em>默认</em>：false如果已指定，<code>mongorestore</code> 则会按照这些文档在输入源中出现的顺序将其插入。也就是说，批量写入批处理顺序和批处理中的文档顺序都将保持不变。指定 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--maintainInsertionOrder"><code>--maintainInsertionOrder</code></a> 还会启用 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--stopOnError"><code>--stopOnError</code></a> 并将 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--numInsertionWorkersPerCollection"><code>numInsertionWorkersPerCollection</code></a> 设置为 1。如果未指定，<code>mongorestore</code> 则可能会按任意顺序执行插入。</p>
</li>
<li>
<p><code>--numParallelCollections=&lt;int&gt;, -j=&lt;int&gt;</code></p>
<p><em>默认</em>: 4<code>mongorestore</code> 应并行恢复的集合数量。如果在恢复<code>-j</code>集合时指定<em>单个</em> ，则<code>-j</code>会映射到<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--numInsertionWorkersPerCollection"><code>--numInsertionWorkersPerCollection</code></a>选项，而不是<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--numParallelCollections"><code>--numParallelCollections</code> 。</a></p>
</li>
<li>
<p><code>--numInsertionWorkersPerCollection=&lt;int&gt;</code></p>
<p><em>默认</em>: 1指定每个集合要同时运行的插入工作线程数。对于大型导入，增加插入工作线程的数量可以提高导入的速度。</p>
</li>
<li>
<p><code>--stopOnError</code></p>
<p>出误时强制 <code>mongorestore</code> 停止恢复。默认情况下， <code>mongorestore</code>会在遇到重复键和文档验证错误时继续。 为确保程序在出现这些错误时停止运行，请指定<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--stopOnError"><code>--stopOnError</code> 。</a></p>
</li>
<li>
<p><code>--bypassDocumentValidation</code></p>
<p>启用<code>mongorestore</code>可在操作期间绕过<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/manual/core/schema-validation/">文档验证</a>。这样，您就可以插入不符合验证要求的文档。如果要恢复启用了可查询加密的集合，则需要此选项。</p>
</li>
<li>
<p><code>--gzip</code></p>
<p>从 <a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongodump/#std-option-mongodump.--gzip"><code>mongodump --gzip</code></a>要从包含压缩文件的转储目录恢复，请运行带有 <code>--gzip</code> 选项的 <code>mongorestore</code>。要从压缩的存档文件中恢复，请运行带有<code>mongorestore</code> <code>--gzip</code>和 选项的<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--archive"><code>--archive</code></a> 。注意您可以使用<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsFrom"><code>--nsFrom</code></a>和<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--nsTo"><code>--nsTo</code></a>选项以及<code>--gzip</code>选项来更改要恢复的集合的命名空间。</p>
</li>
<li>
<p><code>--archive=&lt;file&gt;</code></p>
<p>从指定的存档文件进行恢复；或者，如果未指定此文件，则从标准输入 (<code>stdin</code>) 恢复：要从存档文件恢复，请运行带 <code>--archive</code> 选项和存档文件名的 <code>mongorestore</code>要从标准输入恢复，请运行带 <code>--archive</code> 选项的 <code>mongorestore</code>，但<em>忽略</em> 文件名。注意不能将<code>--archive</code>选项与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--dir"><code>--dir</code></a>选项一起使用。如果将<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.--archive"><code>--archive</code></a>选项与<a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/mongorestore/#std-option-mongorestore.-path-">``</a>参数一起使用， <code>mongorestore</code>将忽略<code>&lt;path&gt;</code>参数。<code>mongorestore</code> 仍然支持位置 <code>-</code> 参数，以从标准输入恢复<em>单个</em>集合。</p>
</li>
<li>
<p><code>&lt;path&gt;</code></p>
<p>要从中恢复数据的目录路径或 BSON 文件名称。不能同时将 <code>&lt;path&gt;</code> 参数和 <code>--dir</code> 选项（也指定转储目录）指定为 <code>mongorestore</code>。</p>
</li>
<li>
<p><code>--dir=string</code></p>
<p>指定转储目录。您不能同时将 <code>--dir</code> 选项和 <code>&lt;path&gt;</code> 参数（也指定转储目录）指定为 <code>mongorestore</code>。不能将 <code>--archive</code>选项与 <code>--dir</code> 选项一起使用。</p>
</li>
</ul>
<h3 id="参考资料">参考资料</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-mongodump-mongorestore.html">https://www.runoob.com/mongodb/mongodb-mongodump-mongorestore.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.mongodb.com/zh-cn/docs/database-tools/bsondump/">https://www.mongodb.com/zh-cn/docs/database-tools/bsondump/</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
                


				<br /><br />
				<blockquote>
					<p>文章链接：<br /> 
					<a style="font-size: 0.85rem" target="_blank" rel="noopener" href="https://www.zywvvd.com/notes/coding/dataset/mongodb-dump-restore/mongodb-dump-restore/">https://www.zywvvd.com/notes/coding/dataset/mongodb-dump-restore/mongodb-dump-restore/</a>
					</p>
				</blockquote>


              </div>
            
            <hr/>
			
			<!-- 添加打赏模块 -->
			<div class="reward-container">
				
					<button id="rewardBtn" class="reward-btn">
						 
							❤ 打赏
							
					</button>
					<p class="tea">“觉得不错的话，给点打赏吧 ୧(๑•̀⌄•́๑)૭”</p>
					<div id="rewardImgContainer" class="reward-img-container">
						<div class="singleImgContainer">
							<img id="wechatImg" class="reward-img" src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_pc_upload/wechatpay.png" srcset="/img/loading.gif" lazyload alt="微信二维码">
							<p class="wechatPay">微信支付</p>
						</div>
						<div class="singleImgContainer">
							<img id="alipayImg" class="reward-img" src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_pc_upload/alipay.png" srcset="/img/loading.gif" lazyload alt="支付宝二维码">
							<p class="aliPay">支付宝支付</p>
						</div>
					</div>
				
			</div>
			
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Coding/" class="category-chain-item">Coding</a>
  
  
    <span>></span>
    
  <a href="/categories/Coding/Database/" class="category-chain-item">Database</a>
  
  
    <span>></span>
    
  <a href="/categories/Coding/Database/MongoDB/" class="category-chain-item">MongoDB</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Coding/" class="print-no-link">#Coding</a>
      
        <a href="/tags/Database/" class="print-no-link">#Database</a>
      
        <a href="/tags/MongoDB/" class="print-no-link">#MongoDB</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MongoDB 备份与恢复</div>
      <div>https://www.zywvvd.com/notes/coding/dataset/mongodb-dump-restore/mongodb-dump-restore/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Yiwei Zhang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年8月21日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/notes/coding/python/python-round/pytho-round/" title="Python 四舍五入">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Python 四舍五入</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/notes/coding/dataset/mysql/python-mysql/python-mysql/" title="Python 操作 MySQL">
                        <span class="hidden-mobile">Python 操作 MySQL</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.14.8/waline.min.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.14.8/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://uipv4.zywvvd.com:33033/","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":["nick"],"lang":"zh-CN","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10,"reaction":true,"locale":{"placeholder":"山高路远，常来玩吖 ~","reactionTitle":null}},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-xiangshangjiantou" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <div class="vvd_footer" style="font-size: 0.85rem;"> <a href="https://hexo.io" target="_blank" rel="nofollow noopener" color="#d7d8d9" data-umami-event="Footer-Hexo"><span class="umami--click--Footer-Hexo">Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener" data-umami-event="Footer-Fluid"><span class="umami--click--Footer-Fluid">Fluid</span></a> <i class="iconfont icon-love"></i> <a href="https://uipv4.zywvvd.com:33039/share/0zx3o21oIpZTZqwC/%E5%8F%88%E8%A7%81%E8%8B%8D%E5%B2%9A" target="_blank" rel="nofollow noopener" data-umami-event="Footer-Umami"><span class="umami--click--Footer-Umami">Umami</span></a> <div style="font-size: 0.85rem;"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/vvd_js/duration.js"></script> </div> <div style="font-size: 0.85rem;"> <span> 总访问量 <span style="color: #d7d8d9;" id="PVstatic">0</span> 次&nbsp</span> <span> 总访客数 <span style="color: #d7d8d9;" id="UVstatic">0</span> 人&nbsp</span> <span> 当前在线 <span style="color: #d7d8d9;" id="ACTstatic">0</span> 人&nbsp</span> <script src="https://uipv4.zywvvd.com:33037/statistics" defer></script> </div> <div> <span> Copyright © 2020-2025. All Rights Reserved.</span> </div> <div style="font-size: 0.88rem;"> <a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #d7d8d9;"  id="hitokoto"></span></a> <script src="https://uipv4.zywvvd.com:33044/?encode=js&select=%23hitokoto" defer></script> </div> <a href="https://icp.gov.moe/?keyword=20230615" target="_blank">萌ICP备20230615号</a>


</div> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script>
<script src="/js/reward.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  <script type="text/javascript">
    /*窗口监视*/
    var originalTitle = document.title;
    window.onblur = function(){document.title = "明眸如初"};
    window.onfocus = function(){document.title = originalTitle};
  </script>


  <div id="tooltip-rightmenu" class="tooltip-rightmenu">如需原始右键菜单请按下 <strong>Ctrl+右键</strong></div>

<div id="rightmenu-wrapper" style="">
  <ul class="list-v rightmenu" id="rightmenu-content">
	  <li class="navigation menuNavigation-Content">
		<a class="nav icon-only fix-cursor-default" onclick="history.back()"><i class="iconfont icon-zuojiantou1"></i></a>
		<a class="nav icon-only fix-cursor-default" onclick="history.forward()"><i class="iconfont icon-youjiantou1"></i></a>
		<a class="nav icon-only fix-cursor-default" onclick="window.location.reload()"><i class="iconfont icon-shuaxin"></i></a>
		<a  aria-label="TOP" href="#" role="button"><i class="iconfont icon-xiangshang"></i></a>
	  </li>

		<hr class="menuLoad-Content" style="display: block;">
	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
		  <span>
			  <i class="iconfont icon-sousuo1 rightmenu-icon"></i>
			  站内搜索
		  </span>
		</a>
	  </li>

	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default"  href="https://www.zywvvd.com/messagebd/" data-group="link">
		  <span>
			  <i class="iconfont icon-yangshi_icon_tongyong_chat rightmenu-icon">  </i>
			   留言吐槽 
		   </span>
		</a>
	  </li>


	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" id="help" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html" data-group="link">
		<span>
			  <i class="iconfont icon-a-BlackHole rightmenu-icon"></i>
			  虫洞穿梭
		  </span>
		</a>
	  </li>

	<a id="scroll-top-button" aria-label="TOP" href="#" role="button" style="bottom: 20px; right: 52.6364px;">
        <i class="iconfont icon-xiangshangjiantou" aria-hidden="true"></i>
      </a>

	<hr class="menuLoad-Content" style="display: block;">
	
	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" id="destroy-airplane" target="_blank" rel="noopener"  data-group="link">
		<span>
			  <i class="iconfont icon-feiji rightmenu-icon"></i>
			  破坏小飞机
		  </span>
		</a>
	  </li>
  </ul>
</div>

<script>
	var ua = navigator.userAgent;
	var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
		isIphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
		isAndroid = ua.match(/(Android)\s+([\d.]+)/),
		isMobile = isIphone || isAndroid;

	if(!isMobile) {
		// 为按钮添加事件处理器
		document.getElementById('destroy-airplane').onclick = function() {
		  console.log('飞机起飞！');
		  // 定义要执行的JavaScript代码
		var KICKASSVERSION='2.0';
		var s = document.createElement('script');
		s.type='text/javascript';
		document.body.appendChild(s);
		s.src='https://uipv4.zywvvd.com:33030/HexoFiles/js/games/airplane/airplane.js';
		void(0);
		};
	}
</script>





<link href="/css/custom.css"type="text/css"rel="stylesheet"/>
<script src="/vvd_js/right_menu.js" type="text/javascript"></script>
<link href="/css/right_menu.css"type="text/css"rel="stylesheet"/>
<script src="/vvd_js/go.js"></script>


  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"left","width":200,"height":400},"mobile":{"show":false},"react":{"opacity":0.9}});</script></body>
</html>
