

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="codeva-rLWafCJGYc" />
  <link rel="apple-touch-icon" sizes="76x76" href="/image/avatar.png">
  <link rel="icon" href="/image/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Yiwei Zhang">
  <meta name="keywords" content="人工智能, 深度学习, 个人博客, 机器学习">
  
    <meta name="description" content="Shapely 是 Python 中一个优秀的平面图形处理库，本文跟读翻译官方文档2.0.4版本的用户手册，解释了如何使用 Shapely Python 软件包进行几何计算。">
<meta property="og:type" content="article">
<meta property="og:title" content="Python Shapely 用户手册 2.0.4">
<meta property="og:url" content="https://www.zywvvd.com/notes/coding/python/shapely/shapely-user-manual-204/index.html">
<meta property="og:site_name" content="又见苍岚">
<meta property="og:description" content="Shapely 是 Python 中一个优秀的平面图形处理库，本文跟读翻译官方文档2.0.4版本的用户手册，解释了如何使用 Shapely Python 软件包进行几何计算。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011419607.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011538450.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011545861.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011551299.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011552634.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011600135.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407020847763.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407020851420.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031508605.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031512053.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031513860.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031551642.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031555928.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031558890.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031601390.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031607461.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031609096.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031619231.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031708503.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031710583.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031713175.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031726448.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031730161.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031731498.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031743986.png">
<meta property="og:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031743668.png">
<meta property="article:published_time" content="2024-07-01T06:04:06.000Z">
<meta property="article:modified_time" content="2025-04-30T06:50:13.446Z">
<meta property="article:author" content="Yiwei Zhang">
<meta property="article:tag" content="Coding">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011419607.png">
  
  
  
  <title>Python Shapely 用户手册 2.0.4 - 又见苍岚</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">
<link rel="stylesheet" href="/css/reward.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.zywvvd.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":90,"cursorChar":"_","loop":false,"scope":["home"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Cv0XNeBSBdAPAIuVj3PsyM3R-MdYXbMMI","app_key":"4PU1rNlGrqXWzhfW3dgq98oX","server_url":null,"path":"window.location.pathname","ignore_local":false},"gtag":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="又见苍岚" type="application/atom+xml">
</head>

<script>
// 页面加载完成后隐藏加载动画
document.addEventListener("readystatechange", function() {
    const loader = document.getElementById('Loadanimation');
    if (loader) {
        // 停留1秒后开始淡出
        setTimeout(function() {
            loader.style.transition = 'opacity 1.2s';
            loader.style.opacity = '0';
            // 淡出完成后隐藏
            setTimeout(() => {
                loader.style.display = 'none';
            }, 1000); // 等待淡出动画完成
        }, 700); // 停留0.8秒
    }
});
</script>



<body>
  
<div id="Loadanimation" style="z-index:999999;">
<div id="Loadanimation-center">
   <div id="Loadanimation-center-absolute">
       <div class="xccx_object" id="xccx_four"></div>
       <div class="xccx_object" id="xccx_three"></div>
       <div class="xccx_object" id="xccx_two"></div>
       <div class="xccx_object" id="xccx_one"></div>
   </div>
</div>
</div>

<link href="/css/loading.css"type="text/css"rel="stylesheet"/>






<div>
	<div class='real_mask' style="
		background-color: rgba(0,0,0,0.4);
		width: 100%;
		height: 100%;
		position: fixed;
		z-index: -777;
	"></div>
	<div id="banner_video_insert">
	</div>	
	<div id='vvd_banner_img'>
	</div>
</div>
<div id="banner"></div>







  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>CangLan</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
		<div >
		      <a class="nav-link" href="/" target="_self" data-umami-event="Navigation-Homepage">

		        <i class="iconfont icon-home-fill"></i>
		        <span>首页</span>
		      </a>
		</div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-shuji1"></i>
                <span>文章</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/archives/" target="_self" data-umami-event="Navigation-Archive">

                    <i class="iconfont icon-archive-fill"></i>
                    <span>归档</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/categories/" target="_self" data-umami-event="Navigation-Category">

                    <i class="iconfont icon-category-fill"></i>
                    <span>分类</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/tags/" target="_self" data-umami-event="Navigation-Tag">

                    <i class="iconfont icon-tags-fill"></i>
                    <span>标签</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/shuoshuo/" target="_self" data-umami-event="Navigation-Shuoshuo">

                    <i class="iconfont icon-24gf-bubblesDots4"></i>
                    <span>说说</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-momo"></i>
                <span>社交</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/links/" target="_self" data-umami-event="Navigation-Friends">

                    <i class="iconfont icon-link-fill"></i>
                    <span>友链</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/messagebd/" target="_self" data-umami-event="Navigation-MessageBoard">

                    <i class="iconfont icon-comment"></i>
                    <span>留言板</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/atom.xml" target="_self" data-umami-event="Navigation-RSS">

                    <i class="iconfont icon-dingyue"></i>
                    <span>RSS订阅</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/reccomments/" target="_self" data-umami-event="Navigation-Recent-Comments">

                    <i class="iconfont icon-icon-pinglunguanli-pinglunliebiao"></i>
                    <span>近期评论</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-user-fill"></i>
                <span>个人</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/about/" target="_self" data-umami-event="Navigation-AboutMe">

                    <i class="iconfont icon-guanyuwomen"></i>
                    <span>关于</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/playlist/" target="_self" data-umami-event="Navigation-Music">

                    <i class="iconfont icon-music"></i>
                    <span>歌单</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33035" target="_self" data-umami-event="Navigation-Nextcloud">

                    <i class="iconfont icon-xuniyingpan"></i>
                    <span>网盘</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33036" target="_self" data-umami-event="Navigation-OneDev">

                    <i class="iconfont icon-git"></i>
                    <span>仓库</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33041" target="_self" data-umami-event="Navigation-Wiki">

                    <i class="iconfont icon-wiki"></i>
                    <span>百科</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-ic_fly"></i>
                <span>导航</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/site-map/" target="_self" data-umami-event="Navigation-SiteMap">

                    <i class="iconfont icon-lianjie"></i>
                    <span>链接</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/nodeppt/hexo/snavigation/" target="_self" data-umami-event="Navigation-Search">

                    <i class="iconfont icon-sousuo"></i>
                    <span>搜索</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-wangzhan"></i>
                <span>站点</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33039/share/0zx3o21oIpZTZqwC/%E5%8F%88%E8%A7%81%E8%8B%8D%E5%B2%9A" target="_self" data-umami-event="Navigation-Umami">

                    <i class="iconfont icon-tongji2"></i>
                    <span>站点分析</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/earth_sta/" target="_self" data-umami-event="Navigation-Globe">

                    <i class="iconfont icon-tongjifenxi-xiangmubiaogetongji"></i>
                    <span>访问统计</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://uipv4.zywvvd.com:33034/status/show" target="_self" data-umami-event="Navigation-Monitor">

                    <i class="iconfont icon-jiankong"></i>
                    <span>站点监控</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-chuansong"></i>
                <span>传送</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://www.foreverblog.cn/go.html" target="_self" data-umami-event="Navigation-ForeverBolg">

                    <i class="iconfont icon-a-BlackHole"></i>
                    <span>十年之约</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://www.travellings.cn/go.html" target="_self" data-umami-event="Navigation-DriveTo">

                    <i class="iconfont icon-train1"></i>
                    <span>开往</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="https://bf.zzxworld.com/" target="_self" data-umami-event="Navigation-BlogFinder">

                    <i class="iconfont icon-icon-"></i>
                    <span>BlogFinder</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-gongju"></i>
                <span>工具</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/calculator" target="_self" data-umami-event="Navigation-Calculator">

                    <i class="iconfont icon-jisuan"></i>
                    <span>计算器</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/webgraphviz" target="_self" data-umami-event="Navigation-WebGtaphviz">

                    <i class="iconfont icon-tongyong-huatugongju2"></i>
                    <span>Graphviz</span>
                  </a>
		</div>
                
                  
                  
                  
		<div >

                  <a class="dropdown-item" href="/navigates/formular_reco" target="_self" data-umami-event="Navigation-Formular-Reco">

                    <i class="iconfont icon-a-checkformula"></i>
                    <span>公式识别</span>
                  </a>
		</div>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://uipv4.zywvvd.com:33030/HexoFiles/new/bg-trans.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">Python Shapely 用户手册 2.0.4</span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Yiwei Zhang
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-07-01 14:04" pubdate>
          2024年7月1日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          15k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          124 分钟
        
      </span>
    

    
    
      
        <span id="vvdpost_container_page_pvuv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="vvdpost_value_page_pv">0</span> 次&nbsp&nbsp
		  <i class="iconfont icon-users" aria-hidden="true"></i>
		  <span id="vvdpost_value_page_uv">0</span> 人&nbsp&nbsp
		  <i class="iconfont icon-comment" aria-hidden="true"></i>
		  <span id="vvdpost_value_page_cn">0</span> 条
        </span>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
	      console.log("PVUV_" + window.location.pathname);

	      // 使用 fetch API 发送 POST 请求
	      fetch('https://uipv4.zywvvd.com:33037/poststats', { 
		  method: 'POST',
		  headers: {
		      'Content-Type': 'application/json'
		  },
		  body: JSON.stringify(window.location.pathname) // 将路径名作为对象发送，以便在服务器端更容易处理
	      })
	      .then(response => {
		  // 检查响应状态
		  if (!response.ok) {
		      throw new Error('Network response was not ok ' + response.statusText);
		  }
		  return response.json(); // 解析 JSON 响应
	      })
	      .then(data => {
		  // 处理解析后的数据
		  console.log(data.pv);
		  var pvCtn = document.querySelector('#vvdpost_container_page_pvuv');
		  if (pvCtn) {
		      var pvEle = document.querySelector('#vvdpost_value_page_pv');
		      var uvEle = document.querySelector('#vvdpost_value_page_uv');
		      var cnEle = document.querySelector('#vvdpost_value_page_cn');
		      if (pvEle && uvEle) {
		          pvEle.innerText = data.pv;
		          uvEle.innerText = data.uv;
		          cnEle.innerText = data.cn;
		          pvCtn.style.display = 'inline';
		      }
		  }
	      })
	      .catch(error => {
		  // 处理请求错误
		  console.error('There has been a problem with your fetch operation:', error);
	      });
      });
  </script>
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>


	<script type="text/javascript" src="/vvd_js/jquery.js"></script>
	<script async src="https://uipv4.zywvvd.com:33039/script.js" data-website-id="dd4a05c6-dde2-4743-9c3a-a79d6bee0778"></script>
	<div class="banner" id='banner' >

		<div class="full-bg-img" >

			
				<script>
					var ua = navigator.userAgent;
					var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
						isIphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
						isAndroid = ua.match(/(Android)\s+([\d.]+)/),
						isMobile = isIphone || isAndroid;

					function set_video_attr(id){
						var height = document.body.clientHeight
						var width = document.body.clientWidth
						var video_item = document.getElementById(id);

						if (height / width < 0.56){
							video_item.setAttribute('width', '100%');
							video_item.setAttribute('height', 'auto');
						} else {
							video_item.setAttribute('height', '100%');
							video_item.setAttribute('width', 'auto');
						}
					}

					fetch('https://uipv4.zywvvd.com:33037/wallpaper-pair')
					  .then(response => response.json()) // 解析JSON数据
					  .then(data => {
						console.log('获取链接成功');
						video_url = data[0][0]
						pre_show_image_url = data[0][1]

						banner_obj = document.getElementById("banner")
						banner_obj.style.cssText = "background: url('" + pre_show_image_url + "') no-repeat;"

						vvd_banner_obj = document.getElementById("vvd_banner_img")
						vvd_banner_content = "<img id='banner_img_item' src='" + pre_show_image_url + "'style='position: fixed; z-index: -999'>"
						vvd_banner_obj.innerHTML = vvd_banner_content 

						if (!isMobile) {
							video_html_res = "<video id='video_item' style='position: fixed; z-index: -888;'  muted='muted' src=" + video_url + " autoplay='autoplay' loop='loop'></video>"
							document.getElementById("banner_video_insert").innerHTML = video_html_res;
							set_video_attr('video_item')
							set_video_attr('banner_img_item')
						}
					    
					  })
					  .catch((error) => {
					    console.error('请求失败,尝试本地获取背景图像：', error);
	    					$.getJSON('/vvd_js/video_url.json', function(data){

							var video_list_length = data.length
							var seed = Math.random()
							index = Math.floor(seed * video_list_length)

							video_url = data[index][0]
							pre_show_image_url = data[index][1]

							banner_obj = document.getElementById("banner")
							banner_obj.style.cssText = "background: url('" + pre_show_image_url + "') no-repeat;"

							vvd_banner_obj = document.getElementById("vvd_banner_img")
							vvd_banner_content = "<img id='banner_img_item' src='" + pre_show_image_url + "'style='position: fixed; z-index: -999'>"
							vvd_banner_obj.innerHTML = vvd_banner_content 

							if (!isMobile) {
								video_html_res = "<video id='video_item' style='position: fixed; z-index: -888;'  muted='muted' src=" + video_url + " autoplay='autoplay' loop='loop'></video>"
								document.getElementById("banner_video_insert").innerHTML = video_html_res;
								set_video_attr('video_item')
								set_video_attr('banner_img_item')
							}
						});
					  });






					if (!isMobile){
						window.onresize = function(){
							set_video_attr('video_item')
							set_video_attr('banner_img_item')
							}
						}
				</script>

			


			
			</div>
		</div>
    </div>

  </header>

  <main>
    
      



<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">

            <!-- <h1 id="seo-header">Python Shapely 用户手册 2.0.4</h1> -->

            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    <!-- compatible with older versions-->
                    本文最后更新于：2025年4月30日 下午
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <blockquote>
<p>Shapely 是 Python 中一个优秀的平面图形处理库，本文跟读翻译官方文档2.0.4版本的用户手册，解释了如何使用 Shapely Python 软件包进行几何计算。</p>
</blockquote>
<span id="more"></span>
<h2 id="简介（Introduction）">简介（Introduction）</h2>
<p>官方文档：<a target="_blank" rel="noopener" href="https://shapely.readthedocs.io/en/stable/manual.html#introduction">https://shapely.readthedocs.io/en/stable/manual.html#introduction</a></p>
<blockquote>
<p>文中所有介绍以及代码示例均基于 shapely v2.0.4</p>
</blockquote>
<p>确定性空间分析是计算方法在农业，生态学，流行病学，社会学和许多其他领域的问题的重要组成部分。这些动物栖息地的调查周长/面积比率是多少？这个小镇的哪些房产与这个新的洪水模型中的50年洪水轮廓线相交？有“ A”和“ B”标记的古代陶器发现点的范围是什么，范围在哪里重叠？从家到办公室，哪条路最能避免垃圾邮件的定位？这些只是几个可以通过非统计空间分析解决的问题，更具体地说，是计算几何。</p>
<p>Shapely 是一个用于集合论分析和平面特性操作的 Python 包，使用的函数来自著名的和广泛部署的 GEOS 库。GEOS 是 Java 拓扑套件(JTS)的一个端口，是 PostGIS 空间扩展的几何引擎，用于 PostgreSQL RDBMS。JTS 和 GEOS 的设计在很大程度上遵循了开放地理空间协会的简单特性访问规范[1] ，而 Shapely 主要遵循同一套标准类和操作。Shapely 因此深深植根于地理信息系统(GIS)世界的惯例，但是渴望对处理非常规问题的程序员同样有用。</p>
<p>Shapely 的第一个前提是 Python 程序员应该能够在 RDBMS 之外执行 PostGIS 类型的几何操作。并非所有地理数据都源自或驻留在 RDBMS 中，或者最好使用 SQL 进行处理。我们可以将数据加载到一个空间 RDBMS 中来完成工作，但是如果没有任务来管理数据库中的数据(“ RDBMS”中的“ M”) ，那么我们就使用了错误的工具来完成这项工作。第二个前提是特征的持久性、序列化和映射投影是重要的，但是是正交的问题。你可能不需要100个 GIS 格式的读者和作者，也不需要大量的国家平面投影，Shapely 也不会给你带来负担。第三个前提是 Python 习惯用法胜过 GIS (在本例中是 Java，因为 GEOS 库源自 Java 项目 JTS)习惯用法。</p>
<h3 id="空间数据模型">空间数据模型</h3>
<p>Shapely 实现的几何对象的基本类型是点、曲线和曲面。每一个都与平面上的三组(可能是无限的)点相关联。一个特征的内部(<em>interior</em>)、边界(<em>boundary</em>)和外部(<em>exterior</em>)集合是相互排斥的，它们的结合与整个平面一致。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>内部</th>
<th>边界</th>
<th>外部</th>
<th>拓扑维数</th>
</tr>
</thead>
<tbody>
<tr>
<td>Point</td>
<td>一个点</td>
<td>无</td>
<td>其他所有点</td>
<td>0</td>
</tr>
<tr>
<td>Curve</td>
<td>线上所有的点（不包含起点、终点）</td>
<td>起点、终点</td>
<td>其他所有点</td>
<td>1</td>
</tr>
<tr>
<td>Surface</td>
<td>边缘内部的所有点</td>
<td>边缘曲线上的所有点</td>
<td>其他所有点</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>点类型由 Point 类实现; 曲线由 LineString 和 LinearRing 类实现; 曲面由 Polygon 类实现。Shapely 不实现平滑曲线(即具有连续的切线)。所有曲线都必须用线性样条逼近。所有的圆形斑块都必须用线性样条曲线所包围的区域来近似。</p>
<p>点的集合由 MultiPoint 类实现，曲线的集合由 MultiLineString 类实现，曲面的集合由 MultiPolygon 类实现。这些集合在计算上并不重要，但是对于建模某些类型的特性非常有用。</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011419607.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h2 id="几何对象-Geometric-Objects">几何对象(Geometric Objects)</h2>
<p>官方文档：<a target="_blank" rel="noopener" href="https://shapely.readthedocs.io/en/stable/manual.html#geometric-objects">https://shapely.readthedocs.io/en/stable/manual.html#geometric-objects</a></p>
<p>Point、 LineString 和 LinearRing 的实例最重要的属性是一个有限的坐标序列，它决定了它们的内部、边界和外部点集。线条字符串可以由最少2个点确定，但包含无限多个点。坐标序列是不可变的。在构建实例时可以使用第三个 z 坐标值，但对几何分析没有影响。所有操作都在 x-y 平面中执行。</p>
<p>在所有构造函数中，数值都被转换为 float 类型。换句话说，Point (0.0)和 Point (0.0.0.0)产生几何等效的实例。当构造实例时，Shapely 不检查拓扑的简单性或有效性，因为在大多数情况下，成本是没有保证的。验证工厂很容易通过需要它们的用户使用: <code>attr: is_valid</code>谓词来实现。</p>
<p><strong>Shapely 是一个平面几何库，z (平面上方或下方的高度)在几何分析中被忽略</strong>。对于用户来说，这里有一个潜在的陷阱: 只有 z 值不同的坐标元组彼此之间没有区别，而且它们的应用程序可能导致令人惊讶的无效几何对象。</p>
<h3 id="一般属性">一般属性</h3>
<table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>object.area</td>
<td>返回对象的面积(浮点数)。</td>
<td></td>
</tr>
<tr>
<td>object.bounds</td>
<td>返回一个(minx，miny，maxx，maxy)元组(float 值) ，该元组围绕对象。</td>
<td></td>
</tr>
<tr>
<td>object.length</td>
<td>返回对象的长度(浮点数)。</td>
<td></td>
</tr>
<tr>
<td>object.minimum_clearance</td>
<td>返回移动节点以生成无效几何图形的最小距离。</td>
<td>这可以被认为是一个测量的健壮性的几何形状，其中较大的最小间隙值表示一个更健壮的几何形状。如果一个几何图形没有最小间隙，比如一个点，那么这个函数将返回数学无穷大。</td>
</tr>
<tr>
<td>object.geom_type</td>
<td>返回指定对象的几何类型的字符串</td>
<td></td>
</tr>
</tbody>
</table>
<p><code>minimum_clearance</code> 示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> Polygon<br>Polygon([[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]]).minimum_clearance<br><br>--&gt;<br><span class="hljs-number">1.0</span><br></code></pre></td></tr></table></figure>
<p><code>geom_type</code> 示例s</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> Point, LineString<br>Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).geom_type<br><br>--&gt;<br><span class="hljs-string">&#x27;Point&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="一般方法">一般方法</h3>
<table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>object.distance(other)</td>
<td>返回到其他几何对象的最小距离(浮点数)。</td>
<td></td>
</tr>
<tr>
<td>object.hausdorff_distance(other)</td>
<td>返回另一个几何对象的豪斯多夫距离(float)。两个几何图形之间的豪斯多夫距离是任何一个几何图形上的一个点与另一个几何图形上的一个点之间的最远距离。</td>
<td></td>
</tr>
<tr>
<td>object.representative_point()</td>
<td>返回一个保证位于几何对象内的点。</td>
<td></td>
</tr>
</tbody>
</table>
<p><code>hausdorff_distance</code> 示例</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">point</span> = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><span class="hljs-attribute">line</span> = LineString([(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">4</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)])<br><span class="hljs-attribute">point</span>.hausdorff_distance(line)<br><span class="hljs-attribute">3</span>.<span class="hljs-number">605551275463989</span><br><span class="hljs-attribute">point</span>.distance(Point(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>))<br><span class="hljs-attribute">3</span>.<span class="hljs-number">605551275463989</span><br></code></pre></td></tr></table></figure>
<h3 id="Points">Points</h3>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">Point</span>(<span class="hljs-symbol">coordinates</span>)<br></code></pre></td></tr></table></figure>
<p>创建实例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> Point<br>point = Point(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)<br>q = Point((<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>))<br></code></pre></td></tr></table></figure>
<h4 id="属性展示">属性展示</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><br><span class="hljs-comment"># 面积为 0</span><br>point.area<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 长度为 0</span><br>point.length<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 边界为该点</span><br>point.bounds<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)<br><br><span class="hljs-comment"># 坐标</span><br><span class="hljs-built_in">list</span>(point.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)]<br>point.x<br><span class="hljs-number">0.0</span><br>point.y<br><span class="hljs-number">0.0</span><br></code></pre></td></tr></table></figure>
<h3 id="LineStrings">LineStrings</h3>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">LineString</span>(<span class="hljs-symbol">coordinates</span>)<br></code></pre></td></tr></table></figure>
<p>LineString 构造函数接受2个或更多(x，y [ ，z ])点元组的有序序列。</p>
<p>构造的 LineString 对象表示点之间的一个或多个连接的线性样条。在有序的顺序中允许重复的点，但是可能会导致性能损失，应该避免。一个 LineString 可以跨越它自己(也就是说是复杂的而不是简单的)。</p>
<h4 id="示例代码">示例代码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLACK, BLUE, GRAY, YELLOW, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1: simple line</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(line, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(line.boundary, ax=ax, color=BLACK)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) simple&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment"># 2: complex line</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br>line2 = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br>plot_line(line2, ax=ax, add_points=<span class="hljs-literal">False</span>, color=YELLOW, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(line2, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(line2.boundary, ax=ax, color=BLACK)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) complex&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>其中 <code>figures.py</code> 需要<a target="_blank" rel="noopener" href="https://github.com/shapely/shapely/issues/536">手动创建</a>：</p>
<blockquote>
<p>后文中的 类似 figures 用法相同，不再赘述</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> affinity<br><br>GM = (sqrt(<span class="hljs-number">5</span>)-<span class="hljs-number">1.0</span>)/<span class="hljs-number">2.0</span><br>W = <span class="hljs-number">8.0</span><br>H = W*GM<br>SIZE = (W, H)<br><br>BLUE = <span class="hljs-string">&#x27;#6699cc&#x27;</span><br>GRAY = <span class="hljs-string">&#x27;#999999&#x27;</span><br>DARKGRAY = <span class="hljs-string">&#x27;#333333&#x27;</span><br>YELLOW = <span class="hljs-string">&#x27;#ffcc33&#x27;</span><br>GREEN = <span class="hljs-string">&#x27;#339933&#x27;</span><br>RED = <span class="hljs-string">&#x27;#ff3333&#x27;</span><br>BLACK = <span class="hljs-string">&#x27;#000000&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_origin</span>(<span class="hljs-params">ax, geom, origin</span>):<br>    x, y = xy = affinity.interpret_origin(geom, origin, <span class="hljs-number">2</span>)<br>    ax.plot(x, y, <span class="hljs-string">&#x27;o&#x27;</span>, color=GRAY, zorder=<span class="hljs-number">1</span>)<br>    ax.annotate(<span class="hljs-built_in">str</span>(xy), xy=xy, ha=<span class="hljs-string">&#x27;center&#x27;</span>,<br>                textcoords=<span class="hljs-string">&#x27;offset points&#x27;</span>, xytext=(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_limits</span>(<span class="hljs-params">ax, x0, xN, y0, yN</span>):<br>    ax.set_xlim(x0, xN)<br>    ax.set_xticks(<span class="hljs-built_in">range</span>(x0, xN+<span class="hljs-number">1</span>))<br>    ax.set_ylim(y0, yN)<br>    ax.set_yticks(<span class="hljs-built_in">range</span>(y0, yN+<span class="hljs-number">1</span>))<br>    ax.set_aspect(<span class="hljs-string">&quot;equal&quot;</span>)<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011538450.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="属性展示-2">属性展示</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> LineString<br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br><span class="hljs-comment"># 面积为0</span><br>line.area<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 长度非0</span><br>line.length<br><span class="hljs-number">1.4142135623730951</span><br><br><span class="hljs-comment"># 边界</span><br>line.bounds<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br><br><span class="hljs-comment"># 点数</span><br><span class="hljs-built_in">len</span>(line.coords)<br><span class="hljs-number">2</span><br><br><span class="hljs-comment"># 各点坐标</span><br><span class="hljs-built_in">list</span>(line.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)]<br>line.coords[:]<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)]<br>line.coords[<span class="hljs-number">1</span>:]<br>[(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)]<br><br><span class="hljs-comment"># 构造函数</span><br>LineString(line)<br>&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;<br><br>LineString([Point(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>), (<span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>), Point(<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>)])<br>&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-number">3</span>, <span class="hljs-number">4</span> <span class="hljs-number">5</span>)&gt;<br></code></pre></td></tr></table></figure>
<h3 id="LinearRings">LinearRings</h3>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">LinearRing</span>(<span class="hljs-symbol">coordinates</span>)<br></code></pre></td></tr></table></figure>
<p>LinearRing 构造函数接受(x，y [ ，z ])点元组的有序序列。</p>
<p>序列可以通过在第一个和最后一个索引中传递相同的值来显式关闭。否则，通过将第一个元组复制到最后一个索引，序列将隐式关闭。与使用 LineString 一样，允许顺序序列中的重复点，但是可能会导致性能损失，因此应该避免。一个线性环不可以跨越自己，也不可以触及自己在一个单一的点。</p>
<blockquote>
<p>与 LineStrings 不同的就是 Rings 闭环</p>
</blockquote>
<h4 id="示例代码-2">示例代码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LinearRing<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, RED, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1: valid ring</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br>ring = LinearRing([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0.8</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)])<br><br>plot_line(ring, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(ring, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) valid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br>ring2 = LinearRing([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)])<br><br>plot_line(ring2, ax=ax, add_points=<span class="hljs-literal">False</span>, color=RED, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(ring2, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) invalid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>运行效果</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011545861.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>Shapely 不会阻止出问题的环的产生，但是当它们被操作时会产生错误。</p>
</blockquote>
<h4 id="属性展示-3">属性展示</h4>
<p>和 LineStrings 很像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> LinearRing<br>ring = LinearRing([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br><span class="hljs-comment"># 面积为 0</span><br>ring.area<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 长度不为零</span><br>ring.length<br><span class="hljs-number">3.414213562373095</span><br><br><span class="hljs-comment"># 边界</span><br>ring.bounds<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br><br><span class="hljs-comment"># 坐标</span><br><span class="hljs-built_in">len</span>(ring.coords)<br><span class="hljs-number">4</span><br><span class="hljs-built_in">list</span>(ring.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)]<br><br><span class="hljs-comment"># 构造函数</span><br>LinearRing(ring)<br>&lt;LINEARRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>)&gt;<br></code></pre></td></tr></table></figure>
<h3 id="Polygons">Polygons</h3>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">Polygon</span>(<span class="hljs-symbol">shell</span>[, <span class="hljs-symbol">holes</span>=<span class="hljs-symbol">None</span>])<br></code></pre></td></tr></table></figure>
<p>多边形构造函数有两个位置参数。第一个是(x，y [ ，z ])点元组的有序序列，它被完全按照 LinearRing 的情况处理。第二个是一个可选的环状序列的无序序列，指定特征的内部边界或“孔”。</p>
<p>一个有效的多边形的环不能相互交叉，但只能在一个点接触。同样，Shapely 不会阻止无效特性的创建，但在操作它们时会引发异常。</p>
<h4 id="示例代码-1">示例代码 1</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, RED, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1: valid polygon</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>ext = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br><span class="hljs-built_in">int</span> = [(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)][::-<span class="hljs-number">1</span>]<br>polygon = Polygon(ext, [<span class="hljs-built_in">int</span>])<br><br>plot_polygon(polygon, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>plot_points(polygon, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) valid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br>ext = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br><span class="hljs-built_in">int</span> = [(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)][::-<span class="hljs-number">1</span>]<br>polygon = Polygon(ext, [<span class="hljs-built_in">int</span>])<br><br>plot_polygon(polygon, ax=ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br>plot_points(polygon, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) invalid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>运行效果</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011551299.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="示例代码-2">示例代码 2</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> GRAY, RED, SIZE, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 3: invalid polygon, ring touch along a line</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>ext = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br><span class="hljs-built_in">int</span> = [(<span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>)]<br>polygon = Polygon(ext, [<span class="hljs-built_in">int</span>])<br><br>plot_polygon(polygon, ax=ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br>plot_points(polygon, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;c) invalid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#4: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br>ext = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br>int_1 = [(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.25</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0.25</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">1.25</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">1.25</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.25</span>)]<br>int_2 = [(<span class="hljs-number">0.5</span>, <span class="hljs-number">1.25</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1.25</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1.75</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">1.75</span>)]<br>polygon = Polygon(ext, [int_1, int_2])<br><br>plot_polygon(polygon, ax=ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br>plot_points(polygon, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;d) invalid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>运行效果</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011552634.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>上述代码运行结果中，仅蓝色块为合法多边形，其余由于多点重合、边重合为非法多边形。</p>
</blockquote>
<h4 id="属性展示-4">属性展示</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> Polygon<br>polygon = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br><span class="hljs-comment"># 面积</span><br>polygon.area<br><span class="hljs-number">0.5</span><br><br><span class="hljs-comment"># 长度</span><br>polygon.length<br><span class="hljs-number">3.414213562373095</span><br><br><span class="hljs-comment"># 边界</span><br>polygon.bounds<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br><br><span class="hljs-comment"># 外部</span><br><span class="hljs-built_in">list</span>(polygon.exterior.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)]<br><br><span class="hljs-comment"># 内部</span><br><span class="hljs-built_in">list</span>(polygon.interiors)<br>[]<br><br><span class="hljs-comment"># 构造方式</span><br><span class="hljs-comment"># Polygon 构造函数还接受 LineString 和 LinearRing 的实例。</span><br>coords = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)]<br>r = LinearRing(coords)<br>s = Polygon(r)<br>s.area<br><span class="hljs-number">0.5</span><br>t = Polygon(s.buffer(<span class="hljs-number">1.0</span>).exterior, [r])<br>t.area<br><span class="hljs-number">6.5507620529190325</span><br></code></pre></td></tr></table></figure>
<h4 id="box"><strong>box</strong></h4>
<p>矩形多边形经常出现，可以方便地使用 shapely.geomey.box ()函数构造。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.geometry.box(minx, miny, maxx, maxy, <span class="hljs-attribute">ccw</span>=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>示例代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> box<br>b = box(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br>b<br>&lt;POLYGON ((<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>))&gt;<br><span class="hljs-built_in">list</span>(b.exterior.coords)<br>[(<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>)]<br></code></pre></td></tr></table></figure>
<h4 id="orient"><strong>orient</strong></h4>
<p>要获得具有已知方向的多边形，请使用 <code>shapely.geomey.polygon.orient</code> () :</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">shapely.<span class="hljs-built_in">geometry</span>.<span class="hljs-built_in">polygon</span>.orient(<span class="hljs-built_in">polygon</span>, sign=<span class="hljs-number">1.0</span>)<br></code></pre></td></tr></table></figure>
<p>返回给定多边形的一个正确定向的副本。结果的签名区域将具有给定的符号。1.0的符号意味着产品外环的坐标将逆时针方向和内环(孔)将顺时针方向。</p>
<h3 id="Collections">Collections</h3>
<p>几何对象的异构集合可能来自某些 Shapely 操作。例如，两个 LineString 可能在一条线上和一个点上相交。为了表示这类结果，Shapely 提供了类似于冻结集的、不可变的几何对象集合。集合可以是同构的(MultiPoint 等)或异构的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">a = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)])<br>b = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">1</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)])<br>x = a.intersection(b)<br>x<br>&lt;GEOMETRYCOLLECTION (LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), POINT (<span class="hljs-number">2</span> <span class="hljs-number">2</span>))&gt;<br><br><span class="hljs-comment"># 通过 geoms 属性访问 GeomeyCollection 的成员。</span><br><span class="hljs-built_in">list</span>(x.geoms)<br>[&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;, &lt;POINT (<span class="hljs-number">2</span> <span class="hljs-number">2</span>)&gt;]<br></code></pre></td></tr></table></figure>
<h4 id="示例代码-3">示例代码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> BLUE, GRAY, YELLOW, GREEN, SIZE, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>a = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)])<br>b = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">1</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)])<br><br><span class="hljs-comment"># 1: disconnected multilinestring</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_line(a, ax, add_points=<span class="hljs-literal">False</span>, color=YELLOW, alpha=<span class="hljs-number">0.5</span>)<br>plot_line(b, ax, add_points=<span class="hljs-literal">False</span>, color=GREEN, alpha=<span class="hljs-number">0.5</span>)<br>plot_points(a, ax=ax, color=GRAY)<br>plot_points(b, ax=ax, color=GRAY)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) lines&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>x = a.intersection(b)<br><br>plot_line(a, ax=ax, color=GRAY, add_points=<span class="hljs-literal">False</span>)<br>plot_line(b, ax=ax, color=GRAY, add_points=<span class="hljs-literal">False</span>)<br><br>plot_line(x.geoms[<span class="hljs-number">0</span>], ax=ax, color=BLUE)<br>plot_points(x.geoms[<span class="hljs-number">1</span>], ax=ax, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) collection&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>运行效果</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407011600135.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>一条绿色和一条黄色的线，它们沿着一条直线在一个点相交; b)交点(蓝色)是一个包含一个 LineString 和一个 Point 的集合。</p>
</blockquote>
<h4 id="Collections-of-Points">Collections of Points</h4>
<p>MultiPoint 构造函数接受(x，y [ ，z ])点元组序列。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">MultiPoint</span>(<span class="hljs-symbol">points</span>)<br></code></pre></td></tr></table></figure>
<h5 id="属性展示-5">属性展示</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> MultiPoint<br>points = MultiPoint([(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)])<br><br><span class="hljs-comment"># 面积为 0</span><br>points.area<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 长度为 0</span><br>points.length<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 边界</span><br>points.bounds<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br><br><span class="hljs-comment"># 坐标</span><br><span class="hljs-built_in">list</span>(points.geoms)<br>[&lt;POINT (<span class="hljs-number">0</span> <span class="hljs-number">0</span>)&gt;, &lt;POINT (<span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;]<br>MultiPoint([Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>&lt;MULTIPOINT (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure>
<h4 id="Collections-of-Lines">Collections of Lines</h4>
<p>MultiLineString 构造函数接受一系列类似行的序列或对象。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">MultiLineString</span>(<span class="hljs-symbol">lines</span>)<br></code></pre></td></tr></table></figure>
<h5 id="示例代码-4">示例代码</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiLineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLACK, BLUE, GRAY, YELLOW, set_limits<br><br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1: disconnected multilinestring</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>mline1 = MultiLineString([((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)), ((<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),  (<span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>))])<br><br>plot_line(mline1, ax=ax, color=BLUE)<br>plot_points(mline1, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(mline1.boundary, ax=ax, color=BLACK)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) simple&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>mline2 = MultiLineString([((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>)), ((<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>))])<br><br>plot_line(mline2, ax=ax, color=YELLOW)<br>plot_points(mline2, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br>plot_points(mline2.boundary, ax=ax, color=BLACK)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) complex&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407020847763.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h5 id="属性展示-6">属性展示</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> MultiLineString<br>coords = [((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)), ((-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>))]<br>lines = MultiLineString(coords)<br><br><span class="hljs-comment"># 面积为 0</span><br>lines.area<br><span class="hljs-number">0.0</span><br><br><span class="hljs-comment"># 长度</span><br>lines.length<br><span class="hljs-number">3.414213562373095</span><br><br><span class="hljs-comment"># 边界</span><br>lines.bounds<br>(-<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>)<br><br><span class="hljs-comment"># 线个数</span><br><span class="hljs-built_in">len</span>(lines.geoms)<br><span class="hljs-number">2</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(lines.geoms))<br>[&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;, &lt;LINESTRING (-<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>)&gt;]<br><br><span class="hljs-comment"># 构造函数</span><br>MultiLineString(lines)<br>&lt;MULTILINESTRING ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), (-<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>))&gt;<br>MultiLineString(lines.geoms)<br>&lt;MULTILINESTRING ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), (-<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>))&gt;<br></code></pre></td></tr></table></figure>
<h4 id="Collections-of-Polygons">Collections of Polygons</h4>
<p>MultiPolygon 构造函数接受一个外环和空穴列表元组序列: [((a1，… ，aM) ，[(b1，… ，bN) ，… ]) ，… ]。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span> <span class="hljs-symbol">MultiPolygon</span>(<span class="hljs-symbol">polygons</span>)<br></code></pre></td></tr></table></figure>
<h5 id="示例代码-5">示例代码</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPolygon<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, RED, set_limits<br>    <br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1: valid multi-polygon</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>a = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br>b = [(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]<br><br>multi1 = MultiPolygon([[a, []], [b, []]])<br><br>plot_polygon(multi1, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>plot_points(multi1, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) valid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2: invalid self-touching ring</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>c = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br>d = [(<span class="hljs-number">1</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0.5</span>)]<br><br>multi2 = MultiPolygon([[c, []], [d, []]])<br><br>plot_polygon(multi2, ax=ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br>plot_points(multi2, ax=ax, color=GRAY, alpha=<span class="hljs-number">0.7</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) invalid&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p>运行效果</p>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407020851420.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>左边是一个有2个成员的有效多边形，右边是一个无效的多边形，因为它的成员在无限多个点(沿着一条线)接触。</p>
</blockquote>
<h4 id="Empty">Empty</h4>
<p>一个 <code>Empty</code> 特性是一个与空集重合的点集; 不是 <code>None</code>，而是与 <code>set ([])</code> 类似。可以通过调用不带参数的各种构造函数来创建空特性。空特性几乎不支持任何操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">line = LineString()<br>line.is_empty<br><span class="hljs-literal">True</span><br>line.length<br><span class="hljs-number">0.0</span><br>line.bounds<br>(nan, nan, nan, nan)<br><span class="hljs-built_in">list</span>(line.coords)<br>[]<br></code></pre></td></tr></table></figure>
<h4 id="Coordinate-sequences">Coordinate sequences</h4>
<p>描述几何图形的坐标列表表示为坐标序列对象。这些序列不应该被直接初始化，而是可以从现有的几何图形中访问，作为几何图形的属性。</p>
<p>可以对坐标序列进行索引、切片和迭代，就好像它们是一个坐标元组列表一样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">line.coords[<span class="hljs-number">0</span>]<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)<br>line.coords[<span class="hljs-number">1</span>:]<br>[(<span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>), (<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>)]<br><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> line.coords:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x=&#123;&#125;, y=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(x, y))<br><br>x=<span class="hljs-number">0.0</span>, y=<span class="hljs-number">1.0</span><br>x=<span class="hljs-number">2.0</span>, y=<span class="hljs-number">3.0</span><br>x=<span class="hljs-number">4.0</span>, y=<span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure>
<p><code>Polygons</code> 的外部和每个内部环都有一个坐标序列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">poly = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)])<br>poly.exterior.coords<br>&lt;shapely.coords.CoordinateSequence <span class="hljs-built_in">object</span> at ...&gt;<br></code></pre></td></tr></table></figure>
<h4 id="Linear-Referencing-Methods">Linear Referencing Methods</h4>
<p>使用一维参考系统沿线性特征(如 LineStrings 和 MultiLineStrings)指定位置是有用的。Shapely 支持基于长度或距离的线性引用，评估沿着一个几何物体到一个给定点的投影的距离，或者沿着该物体的一个给定距离的点的距离。</p>
<h5 id="interpolate">interpolate</h5>
<p>沿线性几何物体返回指定距离处的点。</p>
<p>如果归一化参数为 True，则距离将被解释为几何对象长度的一小部分。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.interpolate</span>(distance<span class="hljs-selector-attr">[, normalized=False]</span>)<br></code></pre></td></tr></table></figure>
<blockquote>
<p>就是返回从几何体边缘从起点出发走过一段距离（可以是绝对距离或者是总长度的百分比）之后停在哪里的坐标。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 从 (0,0) 出发，走1.5长度的距离</span><br>ip = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).interpolate(<span class="hljs-number">1.5</span>)<br>ip<br>&lt;POINT (<span class="hljs-number">0.5</span> <span class="hljs-number">1</span>)&gt;<br><br><span class="hljs-comment"># 从 (0,0) 出发，走75%总长度（也就是1.5）的距离</span><br>LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).interpolate(<span class="hljs-number">0.75</span>, normalized=<span class="hljs-literal">True</span>)<br>&lt;POINT (<span class="hljs-number">0.5</span> <span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure>
<h5 id="project">project</h5>
<p>返回沿着这个几何对象到离另一个对象最近的点的距离。</p>
<p>如果规范化参数为 <code>True</code>，则返回规范化为对象长度的距离。<code>project ()</code>方法是 <code>interpolate()</code> 的逆方法。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.project</span>(other<span class="hljs-selector-attr">[, normalized=False]</span>)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).project(ip)<br><span class="hljs-number">1.5</span><br>LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).project(ip, normalized=<span class="hljs-literal">True</span>)<br><span class="hljs-number">0.75</span><br></code></pre></td></tr></table></figure>
<h2 id="谓词和关系-Predicates-and-Relationships">谓词和关系(Predicates and Relationships)</h2>
<p>几何对象中解释的类型的对象提供标准的谓词作为属性(对于一元谓词)和方法(对于二元谓词)。无论是一进制还是二进制，都返回 True 或 False。</p>
<h3 id="一元谓词-Unary-Predicates">一元谓词(Unary Predicates)</h3>
<p>标准一元谓词实现为只读属性属性，都是形状对象的属性。</p>
<h4 id="has-z"><strong>has_z</strong></h4>
<p>如果特性不仅有 x 和 y，而且还有3D (或所谓的2.5 D)几何图形的 z 坐标，则返回 True。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).has_z<br><span class="hljs-literal">False</span><br>Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>).has_z<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<h4 id="is-ccw"><strong>is_ccw</strong></h4>
<p>如果坐标为逆时针顺序，则返回 True (用正符号区域包围区域)。<strong>此方法仅适用于 <code>LinearRing</code> 对象</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">LinearRing([(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>), (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)]).is_ccw<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<h4 id="is-empty"><strong>is_empty</strong></h4>
<p>如果特性的内部和边界(在点集术语中)与空集重合，则返回 True。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">Point</span><span class="hljs-params">()</span></span><span class="hljs-selector-class">.is_empty</span><br>True<br><span class="hljs-function"><span class="hljs-title">Point</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span></span><span class="hljs-selector-class">.is_empty</span><br>False<br></code></pre></td></tr></table></figure>
<h4 id="is-ring"><strong>is_ring</strong></h4>
<p>如果该特性是一个闭合且简单的 LineString，则返回 True。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)]).is_ring<br><span class="hljs-literal">False</span><br>LinearRing([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)]).is_ring<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>此属性适用于 LineString 和 LinearRing 实例，但对其他实例没有意义。</p>
</blockquote>
<h4 id="is-simple"><strong>is_simple</strong></h4>
<p>如果特性没有交叉，则返回 True。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)]).is_simple<br><span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>只对 LineStrings 和 LinearRings 有意义。</p>
</blockquote>
<h4 id="is-valid"><strong>is_valid</strong></h4>
<p>如果一个特性是“有效的”，返回 True.</p>
<p>有效性测试仅对多边形和多边形有意义。对于其他类型的几何图形，总是返回 True。</p>
<p>一个有效的多边形不能有任何重叠的外部或内部环。一个有效的<code>MultiPolygon</code>不能收集任何重叠的多边形。对无效特性的操作可能会失败。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">MultiPolygon([Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).buffer(<span class="hljs-number">2.0</span>), Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">2.0</span>)]).is_valid<br><span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p><code>is_valid</code> 谓词可用于编写验证修饰符，以确保只有有效的对象从构造函数返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params">func</span>):<br><span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        ob = func(*args, **kwargs)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ob.is_valid:<br>            <span class="hljs-keyword">raise</span> TopologicalError(<br>                <span class="hljs-string">&quot;Given arguments do not determine a valid geometric object&quot;</span>)<br>        <span class="hljs-keyword">return</span> ob<br>    <span class="hljs-keyword">return</span> wrapper<br></code></pre></td></tr></table></figure>
<h3 id="二元谓词-Binary-Predicates">二元谓词(Binary Predicates)</h3>
<p>标准二元谓词作为方法实现。这些谓词评估拓扑、集合论关系。在某些情况下，结果可能不是人们从不同假设开始所期望的那样。所有这些都以另一个几何对象作为参数并返回 True 或 False。</p>
<h4 id="eq"><code>__eq__</code></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span>.<span class="hljs-built_in">__eq__</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果两个对象具有相同的几何类型，并且两个对象的坐标精确匹配，则返回 True。</p>
<h4 id="equals"><strong>equals</strong></h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-built_in">object</span>.<span class="hljs-keyword">equals</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的集合论边界、内部和外部与另一个对象的边界、内部和外部重合，则返回 True。</p>
<blockquote>
<p>传递给对象构造函数的坐标是这些集合的坐标，并确定它们，但不是集合的整体。对于新用户来说，这是一个潜在的“陷阱”。例如，可以以不同的方式构建等效线。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">a = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>b = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>c = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>a.equals(b)<br><span class="hljs-literal">True</span><br>a == b<br><span class="hljs-literal">False</span><br>b.equals(c)<br><span class="hljs-literal">True</span><br>b == c<br><span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>也就是说 <code>__eq__</code> 表示<strong>完全相同</strong>，<code>equals</code> 表示<strong>等效</strong></p>
</blockquote>
<h4 id="contains"><strong>contains</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.contains</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果 other 的点均不位于对象的外部且 other 的内部至少有一个点位于对象的内部，则返回 True。</p>
<blockquote>
<p>该谓词适用于所有类型，并且与 inside() 相反。表达式 a.contains(b) == b.within(a) 的计算结果始终为 True。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">coords = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]<br>LineString(coords).contains(Point(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>))<br><span class="hljs-literal">True</span><br>Point(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>).within(LineString(coords))<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<p>线的端点是其边界的一部分，因此不包含在内。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">LineString(coords).contains(Point(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>))<br><span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>二元谓词可以直接用作 <code>filter()</code> 或 <code>itertools.ifilter()</code> 的谓词。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">line = LineString(coords)<br>contained = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">filter</span>(line.contains, [Point(), Point(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>)]))<br><span class="hljs-built_in">len</span>(contained)<br><span class="hljs-number">1</span><br>contained<br>[&lt;POINT (<span class="hljs-number">0.5</span> <span class="hljs-number">0.5</span>)&gt;]<br></code></pre></td></tr></table></figure>
<h4 id="covers"><strong>covers</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.covers</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果 other 的每个点都是对象内部或边界上的点，则返回 True。这与 object.contains(other) 类似，只不过它不要求 other 的任何内部点位于 object 的内部。</p>
<blockquote>
<p>也就是带着边界。</p>
</blockquote>
<h4 id="covered-by"><strong>covered_by</strong></h4>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon"><span class="hljs-keyword">object</span>.covered<span class="hljs-number">_</span><span class="hljs-meta">by</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的每个点都是其他点的内部或边界上的点，则返回 True。这相当于 other.covers(object)。</p>
<blockquote>
<p>covers 的反函数</p>
</blockquote>
<h4 id="crosses"><strong>crosses</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.crosses</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的内部与另一个对象的内部相交但不包含它，并且相交的尺寸小于其中一个或另一个的尺寸，则返回 True。</p>
<h4 id="disjoint"><strong>disjoint</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.disjoint</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的边界和内部与另一个对象根本不相交，则返回 True。</p>
<h4 id="intersects"><strong>intersects</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.intersects</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的边界或内部以任何方式与另一个对象的边界或内部相交，则返回 True。</p>
<blockquote>
<p>换句话说，如果几何对象有任何共同的边界或内点，则它们相交。</p>
</blockquote>
<h4 id="overlaps"><strong>overlaps</strong></h4>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">object</span>.<span class="hljs-keyword">overlaps</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果几何图形具有多个但不是所有的公共点、具有相同的维度，并且几何图形内部的交集具有与几何图形本身相同的维度，则返回 True。</p>
<h4 id="touches"><strong>touches</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.touches</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象至少有一个共同点并且其内部不与另一个对象的任何部分相交，则返回 True。</p>
<blockquote>
<p>边界相切/相交</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">a = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>b = LineString([(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)])<br>a.touches(b)<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<h4 id="within"><strong>within</strong></h4>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">object</span>.<span class="hljs-keyword">within</span>(other)<br></code></pre></td></tr></table></figure>
<p>如果对象的边界和内部仅与另一个对象的内部（而不是其边界或外部）相交，则返回 True。</p>
<h3 id="DE-9IM-Relationships">DE-9IM Relationships</h3>
<h4 id="relate">relate</h4>
<p><code>relate()</code> 方法测试对象之间的所有 <a href="/notes/study/set-theory/de-9im/de-9im/">DE-9IM</a> 关系，上述命名关系谓词是其中的一个子集。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.relate</span>(other)<br></code></pre></td></tr></table></figure>
<p>返回一个对象的内部、边界、外部与另一个几何对象的内部、边界、外部之间关系的 DE-9IM 矩阵的字符串表示形式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).relate(Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><span class="hljs-string">&#x27;FF0FFF0F2&#x27;</span><br>Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).relate(LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]))<br><span class="hljs-string">&#x27;F0FFFF102&#x27;</span><br></code></pre></td></tr></table></figure>
<h4 id="relate-pattern"><strong>relate_pattern</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.relate_pattern</span>(other, pattern)<br></code></pre></td></tr></table></figure>
<p>如果几何图形之间关系的 DE-9IM 字符串代码满足模式要求，则返回 True，否则返回 False。</p>
<p><code>relate_pattern()</code> 将两个几何图形的 DE-9IM 代码字符串与指定的模式进行比较。如果字符串与模式匹配，则返回 True，否则返回 False。</p>
<p>指定的模式可以是精确匹配（0、1 或 2）、布尔匹配（T 或 F）或通配符 (<code>*</code>)。例如，&quot;在…内 &quot;谓词的模式是 <code>T*****FF*</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">point = Point(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>)<br>square = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>square.relate_pattern(point, <span class="hljs-string">&#x27;T*****FF*&#x27;</span>)<br><span class="hljs-literal">True</span><br>point.within(square)<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<p>请注意，几何图形的顺序很重要，如下面代码所示。在这个例子中，正方形包含点，但点不包含正方形。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">point.relate(square)<br><span class="hljs-string">&#x27;0FFFFF212&#x27;</span><br>square.relate(point)<br><span class="hljs-string">&#x27;0F2FF1FF2&#x27;</span><br></code></pre></td></tr></table></figure>
<h2 id="空间分析方法-Spatial-Analysis-Methods">空间分析方法 (Spatial Analysis Methods)</h2>
<p>除了布尔属性和方法之外，Shapely 还提供返回新几何对象的分析方法。</p>
<h3 id="集合论方法-Set-theoretic-Methods">集合论方法 (Set-theoretic Methods)</h3>
<p>几乎每一个二元谓词方法都有一个对应的方法来返回一个新的几何对象。此外，对象的集合论边界可作为只读属性使用。</p>
<blockquote>
<p>这些方法将始终返回一个几何对象。例如，不相交几何体的交集将返回一个空的几何体集合，而不是 None 或 False。要测试结果是否为空，请使用几何体的 is_empty 属性。</p>
</blockquote>
<h4 id="boundary">boundary</h4>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon"><span class="hljs-keyword">object</span>.boundary<br></code></pre></td></tr></table></figure>
<p>返回代表对象集合论边界的低维对象。</p>
<blockquote>
<p>多边形的边界是一条线，线的边界是点的集合。点的边界是一个空集合。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">coords = [((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)), ((-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>))]<br>lines = MultiLineString(coords)<br>lines.boundary<br>&lt;MULTIPOINT (-<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;<br><span class="hljs-built_in">list</span>(lines.boundary.geoms)<br>[&lt;POINT (-<span class="hljs-number">1</span> <span class="hljs-number">0</span>)&gt;, &lt;POINT (<span class="hljs-number">0</span> <span class="hljs-number">0</span>)&gt;, &lt;POINT (<span class="hljs-number">1</span> <span class="hljs-number">0</span>)&gt;, &lt;POINT (<span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;]<br>lines.boundary.boundary<br>&lt;GEOMETRYCOLLECTION EMPTY&gt;<br></code></pre></td></tr></table></figure>
<h4 id="centroid"><strong>centroid</strong></h4>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">object.<span class="hljs-built_in">centroid</span><br></code></pre></td></tr></table></figure>
<p>返回对象几何中心点（点）的表示。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">LineString</span>([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).centroid<br><span class="hljs-section">&lt;POINT (0.5 0.5)&gt;</span><br></code></pre></td></tr></table></figure>
<h4 id="difference"><strong>difference</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.difference</span>(other)<br></code></pre></td></tr></table></figure>
<p>返回构成此几何对象但不构成其他对象的点的表示。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>a = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br>b = Point(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br>plot_polygon(b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br><br>c = a.difference(b)<br>plot_polygon(c, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a.difference(b)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br>plot_polygon(b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br><br>c = b.difference(a)<br>plot_polygon(c, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b.difference(a)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031508605.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>两个近似圆形的多边形之间的差异。</p>
</blockquote>
<p>Shapely 无法将对象与低维对象之间的差异（例如多边形与线或点之间的差异）表示为单个对象，在这些情况下，difference 方法返回名为 self 的对象的副本。</p>
<h4 id="intersection"><strong>intersection</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.intersection</span>(other)<br></code></pre></td></tr></table></figure>
<p>返回此对象与其他几何对象的交集的表示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">a = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br>b = Point(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br>a.intersection(b)<br>&lt;POLYGON ((<span class="hljs-number">2.493</span> <span class="hljs-number">0.853</span>, <span class="hljs-number">2.471</span> <span class="hljs-number">0.707</span>, <span class="hljs-number">2.435</span> <span class="hljs-number">0.565</span>, <span class="hljs-number">2.386</span> <span class="hljs-number">0.426</span>, <span class="hljs-number">2.323</span> <span class="hljs-number">0.293</span>, ...&gt;<br></code></pre></td></tr></table></figure>
<h4 id="symmetric-difference"><strong>symmetric_difference</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">object</span><span class="hljs-selector-class">.symmetric_difference</span>(other)<br></code></pre></td></tr></table></figure>
<p>返回该对象中不属于其他几何对象中的点以及其他不属于该几何对象中的点的表示。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>a = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br>b = Point(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br>plot_polygon(b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br><br>c = a.intersection(b)<br>plot_polygon(c, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a.intersection(b)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br>plot_polygon(b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br><br>c = a.symmetric_difference(b)<br>plot_polygon(c, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a.symmetric_difference(b)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031512053.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="union"><strong>union</strong></h4>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">object</span>.<span class="hljs-keyword">union</span>(other)<br></code></pre></td></tr></table></figure>
<p>返回此对象和另一个几何对象的点并集的表示。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>a = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br>b = Point(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br>plot_polygon(b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.2</span>)<br><br>c = a.union(b)<br>plot_polygon(c, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a.union(b)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_line(a.exterior, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, linewidth=<span class="hljs-number">3</span>)<br>plot_line(b.exterior, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, linewidth=<span class="hljs-number">3</span>)<br><br>u = a.exterior.union(b.exterior)<br>plot_line(u, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, linewidth=<span class="hljs-number">3</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a.boundary.union(b.boundary)&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031513860.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p><code>union()</code> 是一种查找多个对象的累积并集的昂贵方法。请参阅 shapely.unary_union() 了解更有效的方法。</p>
</blockquote>
<h4 id="重载运算符">重载运算符</h4>
<p>其中一些集合论方法可以使用重载运算符来调用：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>逻辑运算</th>
<th>运算符</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>intersection</em></td>
<td>and</td>
<td>&amp;</td>
</tr>
<tr>
<td><em>union</em></td>
<td>or</td>
<td>|</td>
</tr>
<tr>
<td><em>difference</em></td>
<td>minus</td>
<td>-</td>
</tr>
<tr>
<td><em>symmetric_difference</em></td>
<td>xor</td>
<td>^</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> wkt<br>p1 = wkt.loads(<span class="hljs-string">&#x27;POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))&#x27;</span>)<br>p2 = wkt.loads(<span class="hljs-string">&#x27;POLYGON((0.5 0, 1.5 0, 1.5 1, 0.5 1, 0.5 0))&#x27;</span>)<br>p1 &amp; p2<br>&lt;POLYGON ((<span class="hljs-number">0.5</span> <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">0</span>))&gt;<br>p1 | p2<br>&lt;POLYGON ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span> <span class="hljs-number">1</span>, <span class="hljs-number">1.5</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>))&gt;<br>p1 - p2<br>&lt;POLYGON ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">1</span>, <span class="hljs-number">0.5</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>))&gt;<br>(p1 ^ p2).wkt<br><span class="hljs-string">&#x27;MULTIPOLYGON (((0 0, 0 1, 0.5 1, 0.5 0, 0 0)), ((1 1, 1.5 1, 1.5 0, 1 0, 1 1)))&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="构造方法-Constructive-Methods">构造方法 (Constructive Methods)</h3>
<p>有形状的几何对象有几种方法可以产生新的对象，而不是通过集合论分析得出的。</p>
<h4 id="buffer"><strong>buffer</strong></h4>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">object.buffer(distance, <span class="hljs-attribute">quad_segs</span>=16, <span class="hljs-attribute">cap_style</span>=1, <span class="hljs-attribute">join_style</span>=1, <span class="hljs-attribute">mitre_limit</span>=5.0, <span class="hljs-attribute">single_sided</span>=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>返回该几何对象给定距离内所有点的近似表示。</p>
<h5 id="cap-style"><em>cap_style</em></h5>
<p>caps 的样式由整数值指定：1（圆形）、2（扁平）、3（方形）。这些值也由对象 <code>shapely.BufferCapStyle</code> 枚举。</p>
<p><strong>shapely.BufferCapStyle</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>round</td>
<td>1</td>
</tr>
<tr>
<td>flat</td>
<td>2</td>
</tr>
<tr>
<td>square</td>
<td>3</td>
</tr>
</tbody>
</table>
<h5 id="JoinStyle">JoinStyle</h5>
<p><strong>shapely.BufferJoinStyle</strong></p>
<p>偏移线段之间的连接样式由整数值指定：1（圆形）、2（斜接）和 3（斜角）。这些值也由对象 <code>shapely.BufferJoinStyle</code> 枚举。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>round</td>
<td>1</td>
</tr>
<tr>
<td>mitre</td>
<td>2</td>
</tr>
<tr>
<td>bevel</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>正距离具有膨胀效果；负距离，侵蚀。可选的 <code>quad_segs</code> 参数确定用于围绕点近似四分之一圆的线段数。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ine</span> = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><span class="hljs-attribute">dilated</span> = line.buffer(<span class="hljs-number">0</span>.<span class="hljs-number">5</span>)<br><span class="hljs-attribute">eroded</span> = dilated.buffer(-<span class="hljs-number">0</span>.<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>
<p><strong>示例代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, linewidth=<span class="hljs-number">3</span>)<br><br>dilated = line.buffer(<span class="hljs-number">0.5</span>, cap_style=<span class="hljs-number">3</span>)<br>plot_polygon(dilated, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) dilation, cap_style=3&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(dilated, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br><br>eroded = dilated.buffer(-<span class="hljs-number">0.3</span>)<br>plot_polygon(eroded, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) erosion, join_style=1&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031551642.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>线的膨胀（左）和多边形的腐蚀（右）。新对象显示为蓝色。</p>
</blockquote>
<h5 id="quad-segs">quad_segs</h5>
<p>点的默认缓冲区（<code>quad_segs</code> 为 16）是一个多边形面，其面积占其近似圆盘面积的 99.8%。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">p = Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).buffer(<span class="hljs-number">10.0</span>)<br><span class="hljs-built_in">len</span>(p.exterior.coords)<br><span class="hljs-number">65</span><br>p.area<br><span class="hljs-number">313.6548490545941</span><br></code></pre></td></tr></table></figure>
<p>当<code>quad_segs</code>为1时，缓冲区是一个方形。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">q = Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).buffer(<span class="hljs-number">10.0</span>, <span class="hljs-number">1</span>)<br><span class="hljs-built_in">len</span>(q.exterior.coords)<br><span class="hljs-number">5</span><br>q.area<br><span class="hljs-number">200.0</span><br></code></pre></td></tr></table></figure>
<h5 id="single-side">single_side</h5>
<p>您可能只需要一侧有一个缓冲区。您可以使用 <code>single_side</code> 选项来实现此效果。</p>
<p>使用的边由缓冲区距离的符号确定：</p>
<ul>
<li>正距离表示左侧</li>
<li>负距离表示右侧</li>
</ul>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, linewidth=<span class="hljs-number">3</span>)<br><br>left_hand_side = line.buffer(<span class="hljs-number">0.5</span>, single_sided=<span class="hljs-literal">True</span>)<br>plot_polygon(left_hand_side, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) left hand buffer&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, linewidth=<span class="hljs-number">3</span>)<br><br>right_hand_side = line.buffer(-<span class="hljs-number">0.3</span>, single_sided=<span class="hljs-literal">True</span>)<br>plot_polygon(right_hand_side, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) right hand buffer&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031555928.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>点几何形状的单面缓冲区与常规缓冲区相同。单面缓冲区的端盖样式始终被忽略，并强制为 BufferCapStyle.flat 的等效项。</p>
<h5 id="distance-0">distance = 0</h5>
<p>如果距离为 0，<code>buffer()</code> 有时可用于 &quot;清理 &quot;自接触或自交叉的多边形，如经典的 “领结”。用户报告说，很小的距离值有时会产生比 0 更干净的结果。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs stylus">coords = <span class="hljs-selector-attr">[(0, 0), (0, 2), (1, 1), (2, 2), (2, 0), (1, 1), (0, 0)]</span><br>bowtie = <span class="hljs-built_in">Polygon</span>(coords)<br>bowtie<span class="hljs-selector-class">.is_valid</span><br>False<br>clean = bowtie<span class="hljs-selector-class">.buffer</span>(<span class="hljs-number">0</span>)<br>clean<span class="hljs-selector-class">.is_valid</span><br>True<br>clean<br>&lt;MULTIPOLYGON (((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">2</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>)), ((<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-number">2</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)))&gt;<br><span class="hljs-function"><span class="hljs-title">len</span><span class="hljs-params">(clean.geoms)</span></span><br><span class="hljs-number">2</span><br><span class="hljs-function"><span class="hljs-title">list</span><span class="hljs-params">(clean.geoms[<span class="hljs-number">0</span>].exterior.coords)</span></span><br><span class="hljs-selector-attr">[(0.0, 0.0), (0.0, 2.0), (1.0, 1.0), (0.0, 0.0)]</span><br><span class="hljs-function"><span class="hljs-title">list</span><span class="hljs-params">(clean.geoms[<span class="hljs-number">1</span>].exterior.coords)</span></span><br><span class="hljs-selector-attr">[(1.0, 1.0), (2.0, 2.0), (2.0, 0.0), (1.0, 1.0)]</span><br></code></pre></td></tr></table></figure>
<h4 id="convex-hull"><strong>convex_hull</strong></h4>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon"><span class="hljs-keyword">object</span>.convex<span class="hljs-number">_</span>hull<br></code></pre></td></tr></table></figure>
<p>返回包含对象中所有点的最小凸多边形的表示，除非对象中的点数少于三个。对于两个点，凸包折叠成一个 LineString；对于 1，一个点。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPoint<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> GRAY, BLUE, SIZE, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>points2 = MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)])<br>plot_points(points2, ax=ax, color=GRAY)<br><br>hull2 = points2.convex_hull<br>plot_line(hull2, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, zorder=<span class="hljs-number">3</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) N = 2&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>points1 = MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>plot_points(points1, ax=ax, color=GRAY)<br><br>hull1 = points1.convex_hull<br>plot_polygon(hull1, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, zorder=<span class="hljs-number">3</span>, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) N &gt; 2&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031558890.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="envelope"><strong>envelope</strong></h4>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon"><span class="hljs-keyword">object</span>.envelope<br></code></pre></td></tr></table></figure>
<p>返回包含对象的点或最小矩形多边形（边平行于坐标轴）的表示形式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).envelope<br>&lt;POINT (<span class="hljs-number">0</span> <span class="hljs-number">0</span>)&gt;<br>MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).envelope<br>&lt;POLYGON ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>))&gt;<br></code></pre></td></tr></table></figure>
<h4 id="minimum-rotated-rectangle"><strong>minimum_rotated_rectangle</strong></h4>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon"><span class="hljs-keyword">object</span>.minimum<span class="hljs-number">_</span>rotated<span class="hljs-number">_</span>rectangle<br></code></pre></td></tr></table></figure>
<p>返回包含该对象的一般最小外接矩形。与 <code>envelope</code> 不同，该矩形不限于平行于坐标轴。如果对象的凸包是退化维度的图形（线或点），则返回该对象。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPoint, LineString<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> DARKGRAY, GRAY, BLUE, SIZE, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>mp = MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">1.5</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>)])<br>rect = mp.minimum_rotated_rectangle<br><br>plot_points(mp, ax=ax, color=GRAY)<br>plot_polygon(rect, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>, zorder=-<span class="hljs-number">1</span>)<br>ax.set_title(<span class="hljs-string">&#x27;a) MultiPoint&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># 2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br>ls = LineString([(-<span class="hljs-number">0.5</span>, <span class="hljs-number">1.2</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1.5</span>, <span class="hljs-number">0.5</span>)])<br>rect = ls.minimum_rotated_rectangle<br><br>plot_line(ls, ax=ax, add_points=<span class="hljs-literal">False</span>, color=DARKGRAY, linewidth=<span class="hljs-number">3</span>, alpha=<span class="hljs-number">0.5</span>)<br>plot_polygon(rect, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>, zorder=-<span class="hljs-number">1</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) LineString&#x27;</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031601390.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>多点要素（左）和线串要素（右）的最小旋转矩形。</p>
</blockquote>
<h4 id="parallel-offset"><strong>parallel_offset</strong></h4>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">object.parallel_offset(distance, side, <span class="hljs-attribute">resolution</span>=16, <span class="hljs-attribute">join_style</span>=1, <span class="hljs-attribute">mitre_limit</span>=5.0)<br></code></pre></td></tr></table></figure>
<p>返回距其右侧或左侧对象一定距离的 LineString 或 MultiLineString 几何图形。</p>
<blockquote>
<p>offset_curve() 方法的较旧替代方法，但使用分辨率而不是quad_segs，并使用 side 关键字（“左”或“右”）而不是距离符号。目前保留此方法是为了向后兼容，但建议使用 offset_curve() 代替。</p>
</blockquote>
<h4 id="offset-curve"><strong>offset_curve</strong></h4>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">object.offset_curve(distance, <span class="hljs-attribute">quad_segs</span>=16, <span class="hljs-attribute">join_style</span>=1, <span class="hljs-attribute">mitre_limit</span>=5.0)<br></code></pre></td></tr></table></figure>
<p>返回距其右侧或左侧对象一定距离的 LineString 或 MultiLineString 几何图形。</p>
<p>distance 参数必须是浮点值。</p>
<p>边由距离参数的符号确定（负值表示右侧偏移，正值表示左侧偏移）。左和右是通过遵循 LineString 给定几何点的方向来确定的。</p>
<p>对象每个顶点周围偏移的分辨率按照 buffer() 方法（使用quad_segs）进行参数化。</p>
<p>严重斜接的角可以通过 mitre_limit 参数（以英式英语拼写，en-gb）控制。平行线的拐角将比斜接连接样式的大多数地方距原始线更远。该更远的距离与指定距离的比率就是斜接比。比例超过限制的角将会被倒角。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> LineString, get_point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>line_bounds = line.bounds<br>ax_range = [<span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">0</span>] - <span class="hljs-number">1.0</span>), <span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">2</span>] + <span class="hljs-number">1.0</span>)]<br>ay_range = [<span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">1</span>] - <span class="hljs-number">1.0</span>), <span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">3</span>] + <span class="hljs-number">1.0</span>)]<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=(SIZE[<span class="hljs-number">0</span>], <span class="hljs-number">1.5</span> * SIZE[<span class="hljs-number">1</span>]), dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">221</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;left&#x27;</span>, join_style=<span class="hljs-number">1</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) left, round&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">222</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;left&#x27;</span>, join_style=<span class="hljs-number">2</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) left, mitred&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#3</span><br>ax = fig.add_subplot(<span class="hljs-number">223</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;left&#x27;</span>, join_style=<span class="hljs-number">3</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;c) left, beveled&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#4</span><br>ax = fig.add_subplot(<span class="hljs-number">224</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;right&#x27;</span>, join_style=<span class="hljs-number">1</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;d) right, round&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031607461.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><code>mitre_limit</code> 参数的效果如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> LineString, get_point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>line = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>line_bounds = line.bounds<br>ax_range = [<span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">0</span>] - <span class="hljs-number">1.0</span>), <span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">2</span>] + <span class="hljs-number">1.0</span>)]<br>ay_range = [<span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">1</span>] - <span class="hljs-number">1.0</span>), <span class="hljs-built_in">int</span>(line_bounds[<span class="hljs-number">3</span>] + <span class="hljs-number">1.0</span>)]<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=(SIZE[<span class="hljs-number">0</span>], <span class="hljs-number">1.5</span> * SIZE[<span class="hljs-number">1</span>]), dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">221</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;left&#x27;</span>, join_style=<span class="hljs-number">2</span>, mitre_limit=<span class="hljs-number">0.1</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) left, limit=0.1&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">222</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;left&#x27;</span>, join_style=<span class="hljs-number">2</span>, mitre_limit=<span class="hljs-number">10.0</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) left, limit=10.0&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#3</span><br>ax = fig.add_subplot(<span class="hljs-number">223</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;right&#x27;</span>, join_style=<span class="hljs-number">2</span>, mitre_limit=<span class="hljs-number">0.1</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;c) right, limit=0.1&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#4</span><br>ax = fig.add_subplot(<span class="hljs-number">224</span>)<br><br>plot_line(line, ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_points(get_point(line, <span class="hljs-number">0</span>), ax=ax, color=GRAY)<br>offset = line.parallel_offset(<span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;right&#x27;</span>, join_style=<span class="hljs-number">2</span>, mitre_limit=<span class="hljs-number">10.0</span>)<br>plot_line(offset, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;d) right, limit=10.0&#x27;</span>)<br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031609096.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="simplify"><strong>simplify</strong></h4>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">object.simplify(tolerance, <span class="hljs-attribute">preserve_topology</span>=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>返回几何对象的简化表示。</p>
<blockquote>
<p>简化对象中的所有点都将在原始几何体的公差距离内。默认情况下，使用较慢的算法来保留拓扑。如果保留拓扑设置为 False，则使用更快的 Douglas-Peucker 算法 [6]。</p>
</blockquote>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPoint, Point<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>p = Point(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).buffer(<span class="hljs-number">1.5</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>q = p.simplify(<span class="hljs-number">0.2</span>)<br><br>plot_polygon(p, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>plot_polygon(q, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) tolerance 0.2&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>r = p.simplify(<span class="hljs-number">0.5</span>)<br><br>plot_polygon(p, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>plot_polygon(r, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) tolerance 0.5&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031619231.png" srcset="/img/loading.gif" lazyload alt=""></p>
<blockquote>
<p>使用 0.2（左）和 0.5（右）公差简化近似圆形的多边形。</p>
</blockquote>
<h2 id="仿射变换-Affine-Transformations">仿射变换 (Affine Transformations)</h2>
<p><code>shapely.affinity</code> 模块中包含仿射变换函数的集合，它通过直接向仿射变换矩阵提供系数或使用特定的命名变换（旋转、缩放等）来返回变换后的几何图形。这些函数可用于所有几何类型（GeometryCollection 除外），并且 3D 仿射变换会保留或支持 3D 类型。</p>
<h3 id="affine-transform"><strong>affine_transform</strong></h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.affinity</span><span class="hljs-selector-class">.affine_transform</span>(geom, matrix)<br></code></pre></td></tr></table></figure>
<p>使用仿射变换矩阵返回变换后的几何图形。</p>
<blockquote>
<p>系数矩阵以列表或元组的形式提供，分别包含 6 个或 12 个项目，用于 2D 或 3D 变换。</p>
</blockquote>
<h4 id="2D">2D</h4>
<p>对于 2D 仿射变换，6 个参数矩阵为：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[a, b, d, e, xoff, yoff]</span><br></code></pre></td></tr></table></figure>
<p>表示矩阵：</p>

$$
\begin{split}\begin{bmatrix}
  x' \\
  y' \\
  1
\end{bmatrix} =
\begin{bmatrix}
  a & b & x_\mathrm{off} \\
  d & e & y_\mathrm{off} \\
  0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
  x \\
  y \\
  1
\end{bmatrix}\end{split}
$$
变换后的坐标方程：
$$
\begin{split}x' &= a x + b y + x_\mathrm{off} \\
y' &= d x + e y + y_\mathrm{off}.\end{split}
$$


<h4 id="3D">3D</h4>
<p>对于 3D 仿射变换，12 个参数矩阵为：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[a, b, c, d, e, f, g, h, i, xoff, yoff, zoff]</span><br></code></pre></td></tr></table></figure>
<p>表示矩阵：</p>

$$
\begin{split}\begin{bmatrix}
  x' \\
  y' \\
  z' \\
  1
\end{bmatrix} =
\begin{bmatrix}
  a & b & c & x_\mathrm{off} \\
  d & e & f & y_\mathrm{off} \\
  g & h & i & z_\mathrm{off} \\
  0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
  x \\
  y \\
  z \\
  1
\end{bmatrix}\end{split}
$$
变换后的坐标方程：
$$
\begin{split}x' &= a x + b y + c z + x_\mathrm{off} \\
y' &= d x + e y + f z + y_\mathrm{off} \\
z' &= g x + h y + i z + z_\mathrm{off}.\end{split}
$$


<h3 id="rotate"><strong>rotate</strong></h3>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.affinity.rotate(geom, angle, <span class="hljs-attribute">origin</span>=<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-attribute">use_radians</span>=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>返回 2D 平面上的旋转几何体。</p>
<p>通过设置 <code>use_radians=True</code> 可以以<code>度</code>（默认）或<code>弧度</code>指定旋转角度。正角度是逆时针旋转，负角度是顺时针旋转。</p>
<p>原点可以是边界框中心的关键字 <code>center</code>（默认）、几何体质心的 <code>centroid</code>、<code>Point</code> 对象或坐标元组 <code>(x0, y0)</code>。</p>
<p>二维角度 $\theta$ 旋转的仿射变换矩阵是：</p>

$$
\begin{split}\begin{bmatrix}
  \cos{\theta} & -\sin{\theta} & x_\mathrm{off} \\
  \sin{\theta} &  \cos{\theta} & y_\mathrm{off} \\
        0      &        0      & 1
\end{bmatrix}\end{split}
$$
其中偏移量是从点 $(x_0,y_0)$ 计算的:
$$
\begin{split}x_\mathrm{off} &= x_0 - x_0 \cos{\theta} + y_0 \sin{\theta} \\
y_\mathrm{off} &= y_0 - x_0 \sin{\theta} - y_0 \cos{\theta}\end{split}
$$


<h4 id="示例代码-6"><strong>示例代码</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> LineString<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> affinity<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_line<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits, add_origin<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>line = LineString([(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">4</span>, <span class="hljs-number">1</span>)])<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_line(affinity.rotate(line, <span class="hljs-number">90</span>, <span class="hljs-string">&#x27;center&#x27;</span>), ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>add_origin(ax, line, <span class="hljs-string">&#x27;center&#x27;</span>)<br><br>ax.set_title(<span class="hljs-string">&quot;90\N&#123;DEGREE SIGN&#125;, default origin (center)&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br><span class="hljs-comment"># 2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_line(line, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br>plot_line(affinity.rotate(line, <span class="hljs-number">90</span>, <span class="hljs-string">&#x27;centroid&#x27;</span>), ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>add_origin(ax, line, <span class="hljs-string">&#x27;centroid&#x27;</span>)<br><br>ax.set_title(<span class="hljs-string">&quot;90\N&#123;DEGREE SIGN&#125;, origin=&#x27;centroid&#x27;&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031708503.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="scale"><strong>scale</strong></h3>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.affinity.scale(geom, <span class="hljs-attribute">xfact</span>=1.0, <span class="hljs-attribute">yfact</span>=1.0, <span class="hljs-attribute">zfact</span>=1.0, <span class="hljs-attribute">origin</span>=<span class="hljs-string">&#x27;center&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>返回缩放后的几何图形，按每个维度上的因子进行缩放。</p>
<p>原点可以是 2D 边界框中心的关键字 <code>center</code>（默认）、几何体 2D 质心的 <code>centroid</code>、<code>Point</code> 对象或坐标元组 <code>(x0, y0, z0)</code>。</p>
<p>负比例因子将镜像或反映坐标。</p>
<p>用于缩放的一般 3D 仿射变换矩阵为：</p>

$$
\begin{split}\begin{bmatrix}
  x_\mathrm{fact} & 0               & 0               & x_\mathrm{off} \\
  0               & y_\mathrm{fact} & 0               & y_\mathrm{off} \\
  0               & 0               & z_\mathrm{fact} & z_\mathrm{off} \\
  0               & 0               & 0               & 1
\end{bmatrix}\end{split}
$$

$$
\begin{split}x_\mathrm{off} &= x_0 - x_0 x_\mathrm{fact} \\
y_\mathrm{off} &= y_0 - y_0 y_\mathrm{fact} \\
z_\mathrm{off} &= z_0 - z_0 z_\mathrm{fact}\end{split}
$$


<h4 id="示例代码-7">示例代码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> affinity<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits, add_origin<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>triangle = Polygon([(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>)])<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(triangle, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>triangle_a = affinity.scale(triangle, xfact=<span class="hljs-number">1.5</span>, yfact=-<span class="hljs-number">1</span>)<br>plot_polygon(triangle_a, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>add_origin(ax, triangle, <span class="hljs-string">&#x27;center&#x27;</span>)<br><br>ax.set_title(<span class="hljs-string">&quot;a) xfact=1.5, yfact=-1&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br><span class="hljs-comment"># 2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(triangle, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>triangle_b = affinity.scale(triangle, xfact=<span class="hljs-number">2</span>, origin=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br>plot_polygon(triangle_b, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>add_origin(ax, triangle, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><br>ax.set_title(<span class="hljs-string">&quot;b) xfact=2, origin=(1, 1)&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031710583.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="skew"><strong>skew</strong></h3>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.affinity.skew(geom, <span class="hljs-attribute">xs</span>=0.0, <span class="hljs-attribute">ys</span>=0.0, <span class="hljs-attribute">origin</span>=<span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-attribute">use_radians</span>=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>返回一个倾斜的几何体，沿 x 和 y 维度被角度剪切。</p>
<p>通过设置 <code>use_radians=True</code> 可以以度数（默认）或弧度指定剪切角。</p>
<p>原点可以是边界框中心的关键字 <code>center</code>（默认）、几何体质心的 <code>centroid</code>、<code>Point</code> 对象或坐标元组 <code>(x0, y0)</code>。</p>
<p>倾斜的一般二维仿射变换矩阵为：</p>

$$
\begin{split}\begin{bmatrix}
  1 & \tan{x_s} & x_\mathrm{off} \\
  \tan{y_s} & 1 & y_\mathrm{off} \\
  0 & 0 & 1
\end{bmatrix}\end{split}
$$

$$
\begin{split}x_\mathrm{off} &= -y_0 \tan{x_s} \\
y_\mathrm{off} &= -x_0 \tan{y_s}\end{split}
$$


<h4 id="示例代码-8">示例代码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.wkt <span class="hljs-keyword">import</span> loads <span class="hljs-keyword">as</span> load_wkt<br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> affinity<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits, add_origin<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># Geometry from JTS TestBuilder with fixed precision model of 100.0</span><br><span class="hljs-comment"># Using CreateShape &gt; FontGlyphSanSerif and A = triangle.wkt from scale.py</span><br>R = load_wkt(<span class="hljs-string">&#x27;&#x27;&#x27;\</span><br><span class="hljs-string">POLYGON((2.218 2.204, 2.273 2.18, 2.328 2.144, 2.435 2.042, 2.541 1.895,</span><br><span class="hljs-string">  2.647 1.702, 3 1, 2.626 1, 2.298 1.659, 2.235 1.777, 2.173 1.873,</span><br><span class="hljs-string">  2.112 1.948, 2.051 2.001, 1.986 2.038, 1.91 2.064, 1.823 2.08, 1.726 2.085,</span><br><span class="hljs-string">  1.347 2.085, 1.347 1, 1 1, 1 3.567, 1.784 3.567, 1.99 3.556, 2.168 3.521,</span><br><span class="hljs-string">  2.319 3.464, 2.441 3.383, 2.492 3.334, 2.536 3.279, 2.604 3.152,</span><br><span class="hljs-string">  2.644 3.002, 2.658 2.828, 2.651 2.712, 2.63 2.606, 2.594 2.51, 2.545 2.425,</span><br><span class="hljs-string">  2.482 2.352, 2.407 2.29, 2.319 2.241, 2.218 2.204),</span><br><span class="hljs-string"> (1.347 3.282, 1.347 2.371, 1.784 2.371, 1.902 2.378, 2.004 2.4, 2.091 2.436,</span><br><span class="hljs-string">  2.163 2.487, 2.219 2.552, 2.259 2.63, 2.283 2.722, 2.291 2.828, 2.283 2.933,</span><br><span class="hljs-string">  2.259 3.025, 2.219 3.103, 2.163 3.167, 2.091 3.217, 2.004 3.253, 1.902 3.275,</span><br><span class="hljs-string">  1.784 3.282, 1.347 3.282))&#x27;&#x27;&#x27;</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(R, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>skewR = affinity.skew(R, xs=<span class="hljs-number">20</span>, origin=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br>plot_polygon(skewR, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>add_origin(ax, R, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><br>ax.set_title(<span class="hljs-string">&quot;a) xs=20, origin(1, 1)&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br><span class="hljs-comment"># 2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(R, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY, alpha=<span class="hljs-number">0.5</span>)<br>skewR = affinity.skew(R, ys=<span class="hljs-number">30</span>)<br>plot_polygon(skewR, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE, alpha=<span class="hljs-number">0.5</span>)<br><br>add_origin(ax, R, <span class="hljs-string">&#x27;center&#x27;</span>)<br><br>ax.set_title(<span class="hljs-string">&quot;b) ys=30&quot;</span>)<br><br>set_limits(ax, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031713175.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="translate"><strong>translate</strong></h3>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">shapely</span>.affinity.translate(geom, xoff=<span class="hljs-number">0</span>.<span class="hljs-number">0</span>, yoff=<span class="hljs-number">0</span>.<span class="hljs-number">0</span>, zoff=<span class="hljs-number">0</span>.<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<p>返回沿每个维度按偏移量移动的平移几何图形。</p>
<p>一般用于平移的 3D 仿射变换矩阵为：</p>

$$
\begin{split}\begin{bmatrix}
  1 & 0 & 0 & x_\mathrm{off} \\
  0 & 1 & 0 & y_\mathrm{off} \\
  0 & 0 & 1 & z_\mathrm{off} \\
  0 & 0 & 0 & 1
\end{bmatrix}\end{split}
$$


<h2 id="其他变换-Other-Transformations">其他变换(Other Transformations)</h2>
<p>Shapely 支持地图投影和几何对象的其他任意变换。</p>
<h3 id="transform"><strong>transform</strong></h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.transform</span>(func, geom)<br></code></pre></td></tr></table></figure>
<p>将 func 应用于 geom 的所有坐标，并从转换后的坐标返回相同类型的新几何图形。</p>
<p>func 将 x、y 和（可选的 z）映射到输出 xp、yp、zp。输入参数可以是可迭代类型，例如列表或数组或单个值。输出应具有相同类型：标量输入，标量输出；列出，列出。</p>
<p>首先，transform 尝试通过使用 n 个可迭代的坐标调用 func 来确定传入的函数类型，其中 n 是输入几何图形的维数。如果 func 在使用可迭代对象作为参数调用时引发 TypeError，那么它将改为在几何图形中的每个单独坐标上调用 func。</p>
<p>例如，这是一个适用于两种类型的输入（标量或数组）的恒等函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">id_func</span>(<span class="hljs-params">x, y, z=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, [x, y, z]))<br><br>g2 = transform(id_func, g1)<br></code></pre></td></tr></table></figure>
<p>如果使用 pyproj&gt;=2.1.0，投影几何图形的首选方法是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyproj<br><br><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> transform<br><br>wgs84_pt = Point(-<span class="hljs-number">72.2495</span>, <span class="hljs-number">43.886</span>)<br><br>wgs84 = pyproj.CRS(<span class="hljs-string">&#x27;EPSG:4326&#x27;</span>)<br>utm = pyproj.CRS(<span class="hljs-string">&#x27;EPSG:32618&#x27;</span>)<br><br>project = pyproj.Transformer.from_crs(wgs84, utm, always_xy=<span class="hljs-literal">True</span>).transform<br>utm_point = transform(project, wgs84_pt)<br></code></pre></td></tr></table></figure>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://shapely.readthedocs.io/en/stable/manual.html#other-transformations">官方文档</a></p>
</blockquote>
<h2 id="其他功能-Other-Operations">其他功能 (Other Operations)</h2>
<h3 id="合并线性特征-Merging-Linear-Features">合并线性特征(Merging Linear Features)</h3>
<p>可以使用 shapely.ops 模块中的函数将接触线序列合并到 MultiLineStrings 或 Polygons 中。</p>
<h4 id="polygonize"><strong>polygonize</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.polygonize</span>(lines)<br></code></pre></td></tr></table></figure>
<p>返回根据输入线构造的多边形的迭代器。</p>
<p>与 <code>MultiLineString</code> 构造函数一样，输入元素可以是任何类似行的对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> polygonize<br>lines = [<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)),<br>    ((<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>    ]<br><span class="hljs-built_in">list</span>(polygonize(lines))<br>[&lt;POLYGON ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>))&gt;, &lt;POLYGON ((<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>))&gt;]<br></code></pre></td></tr></table></figure>
<h4 id="polygonize-full"><strong>polygonize_full</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.polygonize_full</span>(lines)<br></code></pre></td></tr></table></figure>
<p>从线源创建多边形，返回多边形和剩余的几何图形。</p>
<p>源可以是 MultiLineString、LineString 对象序列或可适应 LineString 的对象序列。</p>
<p>返回对象元组：（多边形、切边、悬垂物、无效环线）。每一个都是一个几何集合。</p>
<p>悬空是指一端或两端不与另一边端点重合的边。切边在两端相连，但不形成多边形的一部分。无效的环线形成无效的环（领结等）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> polygonize_full<br>lines = [<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)),<br>    ((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)),<br>    ((<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)),<br>    ((<span class="hljs-number">5</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">6</span>, <span class="hljs-number">6</span>)),<br>    ((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>)),<br>    ]<br>result, cuts, dangles, invalids = polygonize_full(lines)<br><span class="hljs-built_in">len</span>(result.geoms)<br><span class="hljs-number">2</span><br><span class="hljs-built_in">list</span>(result.geoms)<br>[&lt;POLYGON ((<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>))&gt;, &lt;POLYGON ((<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>))&gt;]<br><span class="hljs-built_in">list</span>(dangles.geoms)<br>[&lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">100</span> <span class="hljs-number">100</span>)&gt;, &lt;LINESTRING (<span class="hljs-number">5</span> <span class="hljs-number">5</span>, <span class="hljs-number">6</span> <span class="hljs-number">6</span>)&gt;]<br></code></pre></td></tr></table></figure>
<h4 id="linemerge"><strong>linemerge</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.linemerge</span>(lines)<br></code></pre></td></tr></table></figure>
<p>返回表示行的所有连续元素的合并的 LineString 或 MultiLineString。</p>
<blockquote>
<p>与 shapely.ops.polygonize() 一样，输入元素可以是任何线状对象。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> linemerge<br>linemerge(lines)<br>&lt;MULTILINESTRING ((<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>), (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), (<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">100</span> <span class="hljs-number">10.</span>..&gt;<br><span class="hljs-built_in">list</span>(linemerge(lines).geoms)<br>[&lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span>)&gt;,<br> &lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;,<br> &lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span> <span class="hljs-number">1</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>)&gt;,<br> &lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">100</span> <span class="hljs-number">100</span>)&gt;,<br> &lt;LINESTRING (<span class="hljs-number">5</span> <span class="hljs-number">5</span>, <span class="hljs-number">6</span> <span class="hljs-number">6</span>)&gt;]<br></code></pre></td></tr></table></figure>
<h3 id="高效矩形裁剪-Efficient-Rectangle-Clipping">高效矩形裁剪 (Efficient Rectangle Clipping)</h3>
<p>shapely.ops 中的 <code>clip_by_rect()</code> 函数返回矩形内几何图形的部分。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.clip_by_rect</span>(geom, xmin, ymin, xmax, ymax)<br></code></pre></td></tr></table></figure>
<p>几何体以快速但可能出问题的方式被剪裁。不保证输出有效。拓扑错误不会引发任何异常。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> clip_by_rect<br>polygon = Polygon(<br>    shell=[(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">30</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">30</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)],<br>    holes=[[(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>), (<span class="hljs-number">20</span>, <span class="hljs-number">10</span>), (<span class="hljs-number">20</span>, <span class="hljs-number">20</span>), (<span class="hljs-number">10</span>, <span class="hljs-number">20</span>), (<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)]],<br>)<br>clipped_polygon = clip_by_rect(polygon, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>)<br>clipped_polygon<br>&lt;POLYGON ((<span class="hljs-number">5</span> <span class="hljs-number">5</span>, <span class="hljs-number">5</span> <span class="hljs-number">15</span>, <span class="hljs-number">10</span> <span class="hljs-number">15</span>, <span class="hljs-number">10</span> <span class="hljs-number">10</span>, <span class="hljs-number">15</span> <span class="hljs-number">10</span>, <span class="hljs-number">15</span> <span class="hljs-number">5</span>, <span class="hljs-number">5</span> <span class="hljs-number">5</span>))&gt;<br></code></pre></td></tr></table></figure>
<h3 id="高效并集运算-Efficient-Unions">高效并集运算 (Efficient Unions)</h3>
<p>shapely.ops 中的 <code>unary_union()</code> 函数比使用 <code>union()</code> 累加更高效。</p>
<h4 id="unary-union">unary_union</h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.unary_union</span>(geoms)<br></code></pre></td></tr></table></figure>
<p>返回给定几何对象的并集的表示。</p>
<p>重叠多边形的区域将被合并。 LineStrings 将完全溶解并节点化。重复的点将被合并。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> unary_union<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>polygons = [Point(i, <span class="hljs-number">0</span>).buffer(<span class="hljs-number">0.7</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br><span class="hljs-comment"># 1</span><br>ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br><span class="hljs-keyword">for</span> ob <span class="hljs-keyword">in</span> polygons:<br>    plot_polygon(ob, ax=ax, add_points=<span class="hljs-literal">False</span>, color=GRAY)<br><br>ax.set_title(<span class="hljs-string">&#x27;a) polygons&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">6</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br><br><span class="hljs-comment">#2</span><br>ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>u = unary_union(polygons)<br>plot_polygon(u, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>ax.set_title(<span class="hljs-string">&#x27;b) union&#x27;</span>)<br><br>set_limits(ax, -<span class="hljs-number">2</span>, <span class="hljs-number">6</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031726448.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>因为联合合并了重叠多边形的区域，所以它可以用于尝试修复无效的多多边形。与零距离 buffer() 技巧一样，使用此技巧时您的里程可能会有所不同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">m = MultiPolygon(polygons)<br>m.area<br><span class="hljs-number">7.684543801837549</span><br>m.is_valid<br><span class="hljs-literal">False</span><br>unary_union(m).area<br><span class="hljs-number">6.610301355116799</span><br>unary_union(m).is_valid<br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure>
<h4 id="cascaded-union"><strong>cascaded_union</strong></h4>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.cascaded_union</span>(geoms)<br></code></pre></td></tr></table></figure>
<p>返回给定几何对象的并集的表示。</p>
<h3 id="德劳内三角-Delaunay-triangulation">德劳内三角 (Delaunay triangulation)</h3>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.ops.triangulate(geom, <span class="hljs-attribute">tolerance</span>=0.0, <span class="hljs-attribute">edges</span>=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>shapely.ops 中的 <code>triangulate()</code> 函数根据点集合计算 Delaunay 三角剖分。</p>
<p>返回输入几何体顶点的 Delaunay 三角剖分。<br>
源可以是任何几何类型。几何体的所有顶点将用作三角剖分的点。<br>
Tolerance 关键字参数设置用于提高三角测量计算的鲁棒性的捕捉容差。容差 0.0 指定不会发生捕捉。<br>
如果 Edge 关键字参数为 False，则将返回多边形三角形列表。否则返回 LineString 边的列表。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPoint<br><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> triangulate<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>points = MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>triangles = triangulate(points)<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>ax = fig.add_subplot(<span class="hljs-number">111</span>)<br><br><span class="hljs-keyword">for</span> triangle <span class="hljs-keyword">in</span> triangles:<br>    plot_polygon(triangle, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>plot_points(points, ax=ax, color=GRAY)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031730161.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="沃罗诺图-Voronoi-Diagram">沃罗诺图 (Voronoi Diagram)</h3>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">shapely.ops.voronoi_diagram(geom, <span class="hljs-attribute">envelope</span>=None, <span class="hljs-attribute">tolerance</span>=0.0, <span class="hljs-attribute">edges</span>=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure>
<p>shapely.ops 中的 <code>voronoi_diagram()</code> 函数根据集合点或任何几何体的顶点构造 Voronoi 图。</p>
<p>从输入几何体的顶点构造 Voronoi 图。<br>
源可以是任何几何类型。几何体的所有顶点将用作图表的输入点。<br>
Envelope 关键字参数提供了一个用于剪辑结果图的信封。如果没有，则会自动计算。该图表将被剪切到所提供的信封或站点周围的信封中较大的一个。<br>
tolerance 关键字参数设置用于提高计算鲁棒性的捕捉容差。容差 0.0 指定不会发生捕捉。容差参数可能很挑剔，并且已知在某些情况下会导致算法失败。如果您使用容差并遇到失败，请尝试将其删除。 tests/test_voronoi_diagram.py 中的测试用例显示了更多详细信息。<br>
如果 Edge 关键字参数为 False，则将返回多边形列表。否则返回`LineString 边的列表。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> MultiPoint<br><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> voronoi_diagram<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_points<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, GRAY, set_limits<br><br>points = MultiPoint([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)])<br>regions = voronoi_diagram(points)<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>ax = fig.add_subplot(<span class="hljs-number">111</span>)<br><br><span class="hljs-keyword">for</span> region <span class="hljs-keyword">in</span> regions.geoms:<br>    plot_polygon(region, ax=ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>plot_points(points, ax=ax, color=GRAY)<br><br>set_limits(ax, -<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031731498.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="最近点-Nearest-points">最近点(Nearest points)</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.nearest_points</span>(geom1, geom2)<br></code></pre></td></tr></table></figure>
<p>返回输入几何中最近点的元组。点的返回顺序与输入几何图形的顺序相同。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> shapely.ops import nearest_points<br><span class="hljs-attribute">triangle</span> = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>.<span class="hljs-number">5</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)])<br><span class="hljs-attribute">square</span> = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)])<br><span class="hljs-attribute">list</span>(nearest_points(triangle, square))<span class="hljs-meta"></span><br><span class="hljs-meta">[&lt;POINT (0.5 1)&gt;, &lt;POINT (0.5 2)&gt;]</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>请注意，最近的点可能不是几何图形中的现有顶点。</p>
</blockquote>
<h3 id="捕捉-Snapping">捕捉 (Snapping)</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.snap</span>(geom1, geom2, tolerance)<br></code></pre></td></tr></table></figure>
<p>将 geom1 中的顶点捕捉到 geom2 中的顶点。返回捕捉的几何体的副本。输入几何形状未修改。</p>
<p>容差参数指定要捕捉的顶点之间的最小距离。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> snap<br>square = Polygon([(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)])<br>line = LineString([(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), (<span class="hljs-number">0.8</span>, <span class="hljs-number">0.8</span>), (<span class="hljs-number">1.8</span>, <span class="hljs-number">0.95</span>), (<span class="hljs-number">2.6</span>, <span class="hljs-number">0.5</span>)])<br>result = snap(line, square, <span class="hljs-number">0.5</span>)<br>result<br>&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-number">1</span>, <span class="hljs-number">2.6</span> <span class="hljs-number">0.5</span>)&gt;<br></code></pre></td></tr></table></figure>
<h3 id="共享路径-Shared-paths">共享路径 (Shared paths)</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.shared_paths</span>(geom1, geom2)<br></code></pre></td></tr></table></figure>
<p>查找 geom1 和 geom2 之间的共享路径，其中两个几何图形都是 LineString。<br>
返回带有两个元素的 GeometryCollection。第一个元素是一个 MultiLineString，其中包含两个输入具有相同方向的共享路径。第二个元素是一个 MultiLineString，其中包含两个输入方向相反的共享路径。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> shared_paths<br>g1 = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">10</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">10</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">20</span>, <span class="hljs-number">5</span>)])<br>g2 = LineString([(<span class="hljs-number">5</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">30</span>, <span class="hljs-number">5</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)])<br>forward, backward = shared_paths(g1, g2).geoms<br>forward<br>&lt;MULTILINESTRING ((<span class="hljs-number">5</span> <span class="hljs-number">0</span>, <span class="hljs-number">10</span> <span class="hljs-number">0</span>))&gt;<br>backward<br>&lt;MULTILINESTRING ((<span class="hljs-number">10</span> <span class="hljs-number">5</span>, <span class="hljs-number">20</span> <span class="hljs-number">5</span>))&gt;<br></code></pre></td></tr></table></figure>
<h3 id="分割-Splitting">分割 (Splitting)</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.split</span>(geom, splitter)<br></code></pre></td></tr></table></figure>
<p>将一个几何图形分割为另一个几何图形并返回几何图形的集合。该函数在理论上与分割几何部分的并集相反。如果分割器不分割几何图形，则返回具有等于输入几何图形的单个几何图形的集合。<br>
该功能支持：<br>
通过（多）点或（多）线串或（多）多边形边界分割（多）线串<br>
通过线串分割（多）多边形<br>
以对几何形状的低公差来卡扣分离器可能会很方便。例如，在用点分割线的情况下，该点必须恰好在线上，才能正确分割线。当用多边形分割线时，将使用多边形的边界进行操作。当将一行与另一行分割时，如果两条线在某些段重叠，则会引发 ValueError 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> split<br>pt = Point((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br>line = LineString([(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), (<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)])<br>result = split(line, pt)<br>result<br>&lt;GEOMETRYCOLLECTION (LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">1</span>), LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span> <span class="hljs-number">2</span>))&gt;<br></code></pre></td></tr></table></figure>
<h3 id="子串-Substring">子串 (Substring)</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.substring</span>(geom, start_dist, end_dist<span class="hljs-selector-attr">[, normalized=False]</span>)<br></code></pre></td></tr></table></figure>
<p>返回 <code>start_dist</code> 和 <code>end_dist</code> 之间的 LineString 或 Point（如果它们位于同一位置）<br>
负距离值是从几何体末端沿相反方向测量的。超出范围的索引值通过将其限制在有效值范围内来处理。<br>
如果起始距离等于结束距离，则返回一个点。<br>
如果起始距离实际上超过了结束距离，则返回反转的子字符串，使得起始距离位于第一个坐标处。<br>
如果归一化 arg 为 True，则距离将被解释为几何长度的一部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> substring<br>ls = LineString((i, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>))<br>ls<br>&lt;LINESTRING (<span class="hljs-number">0</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>, <span class="hljs-number">3</span> <span class="hljs-number">0</span>, <span class="hljs-number">4</span> <span class="hljs-number">0</span>, <span class="hljs-number">5</span> <span class="hljs-number">0</span>)&gt;<br>substring(ls, start_dist=<span class="hljs-number">1</span>, end_dist=<span class="hljs-number">3</span>)<br>&lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>, <span class="hljs-number">3</span> <span class="hljs-number">0</span>)&gt;<br>substring(ls, start_dist=<span class="hljs-number">3</span>, end_dist=<span class="hljs-number">1</span>)<br>&lt;LINESTRING (<span class="hljs-number">3</span> <span class="hljs-number">0</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>, <span class="hljs-number">1</span> <span class="hljs-number">0</span>)&gt;<br>substring(ls, start_dist=<span class="hljs-number">1</span>, end_dist=-<span class="hljs-number">3</span>)<br>&lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>)&gt;<br>substring(ls, start_dist=<span class="hljs-number">0.2</span>, end_dist=-<span class="hljs-number">0.6</span>, normalized=<span class="hljs-literal">True</span>)<br>&lt;LINESTRING (<span class="hljs-number">1</span> <span class="hljs-number">0</span>, <span class="hljs-number">2</span> <span class="hljs-number">0</span>)&gt;<br><br>substring(ls, start_dist=<span class="hljs-number">2.5</span>, end_dist=-<span class="hljs-number">2.5</span>)<br>&lt;POINT (<span class="hljs-number">2.5</span> <span class="hljs-number">0</span>)&gt;<br></code></pre></td></tr></table></figure>
<h3 id="准备的几何操作-Prepared-Geometry-Operations">准备的几何操作(Prepared Geometry Operations)</h3>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">prepared.prep<span class="hljs-comment">(ob)</span><br></code></pre></td></tr></table></figure>
<p>创建并返回准备好的几何对象。<br>
要针对大量点测试一个多边形包含，应首先使用 <code>prepared.prep()</code> 函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.prepared <span class="hljs-keyword">import</span> prep<br>points = [...] <span class="hljs-comment"># large list of points</span><br>polygon = Point(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>).buffer(<span class="hljs-number">1.0</span>)<br>prepared_polygon = prep(polygon)<br>prepared_polygon<br>&lt;shapely.prepared.PreparedGeometry <span class="hljs-built_in">object</span> at 0x...&gt;<br>hits = <span class="hljs-built_in">filter</span>(prepared_polygon.contains, points)<br></code></pre></td></tr></table></figure>
<p>Prepared geometries 实例具有以下方法：<code>contains</code>、<code>contains_properly</code>、<code>covers</code> 和 <code>intersects</code>。所有这些都与未准备的几何对象中的对应对象具有完全相同的参数和用法。</p>
<h3 id="诊断-Diagnostics">诊断 (Diagnostics)</h3>
<h4 id="explain-validity">explain_validity</h4>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">validation<span class="hljs-selector-class">.explain_validity</span>(ob)<br></code></pre></td></tr></table></figure>
<p>返回一个字符串，解释对象的有效性或无效性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">coords = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)]<br>p = Polygon(coords)<br><span class="hljs-keyword">from</span> shapely.validation <span class="hljs-keyword">import</span> explain_validity<br>explain_validity(p)<br><span class="hljs-string">&#x27;Ring Self-intersection[1 1]&#x27;</span><br></code></pre></td></tr></table></figure>
<h4 id="make-valid"><strong>make_valid</strong></h4>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">validation<span class="hljs-selector-class">.make_valid</span>(ob)<br></code></pre></td></tr></table></figure>
<p>如果几何图形无效，则返回有效的表示形式。如果有效，将返回输入的几何图形。</p>
<p>在许多情况下，为了创建有效的几何图形，必须将输入几何图形分割成多个部分或多个几何图形。如果必须将几何图形分割成相同几何类型的多个部分，则将返回多部分几何图形（例如 MultiPolygon）。如果必须将几何图形拆分为不同类型的多个部分，则将返回 GeometryCollection。</p>
<p><strong>示例代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<br><span class="hljs-keyword">from</span> shapely.validation <span class="hljs-keyword">import</span> make_valid<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, RED, set_limits<br><br>invalid_poly = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)])<br>valid_poly = make_valid(invalid_poly)<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>invalid_ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(invalid_poly, ax=invalid_ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>set_limits(invalid_ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><br>valid_ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(valid_poly.geoms[<span class="hljs-number">0</span>], ax=valid_ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>plot_polygon(valid_poly.geoms[<span class="hljs-number">1</span>], ax=valid_ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br><br>set_limits(valid_ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031743986.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<br><span class="hljs-keyword">from</span> shapely.validation <span class="hljs-keyword">import</span> make_valid<br><span class="hljs-keyword">from</span> shapely.plotting <span class="hljs-keyword">import</span> plot_polygon, plot_line<br><br><span class="hljs-keyword">from</span> figures <span class="hljs-keyword">import</span> SIZE, BLUE, RED, set_limits<br><br><br>invalid_poly = Polygon([(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)])<br>valid_poly = make_valid(invalid_poly)<br><br>fig = plt.figure(<span class="hljs-number">1</span>, figsize=SIZE, dpi=<span class="hljs-number">90</span>)<br><br>invalid_ax = fig.add_subplot(<span class="hljs-number">121</span>)<br><br>plot_polygon(invalid_poly, ax=invalid_ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br><br>set_limits(invalid_ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><br>valid_ax = fig.add_subplot(<span class="hljs-number">122</span>)<br><br>plot_polygon(valid_poly.geoms[<span class="hljs-number">0</span>], ax=valid_ax, add_points=<span class="hljs-literal">False</span>, color=BLUE)<br>plot_line(valid_poly.geoms[<span class="hljs-number">1</span>], ax=valid_ax, add_points=<span class="hljs-literal">False</span>, color=RED)<br><br>set_limits(valid_ax, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_image_files/202407031743668.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="Polylabel">Polylabel</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.ops</span><span class="hljs-selector-class">.polylabel</span>(polygon, tolerance)<br></code></pre></td></tr></table></figure>
<p>查找给定多边形的不可到达极点的大致位置。基于弗拉基米尔·阿加丰金 (Vladimir Agafonkin) 的 <a target="_blank" rel="noopener" href="https://github.com/mapbox/polylabel">Polylabel</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.ops <span class="hljs-keyword">import</span> polylabel<br>polygon = LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">50</span>, <span class="hljs-number">200</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>), (<span class="hljs-number">20</span>, <span class="hljs-number">50</span>),<br>(-<span class="hljs-number">100</span>, -<span class="hljs-number">20</span>), (-<span class="hljs-number">150</span>, -<span class="hljs-number">200</span>)]).buffer(<span class="hljs-number">100</span>)<br>label = polylabel(polygon, tolerance=<span class="hljs-number">10</span>)<br>label<br>&lt;POINT (<span class="hljs-number">59.356</span> <span class="hljs-number">121.839</span>)&gt;<br></code></pre></td></tr></table></figure>
<h2 id="交互-Interoperation">交互 (Interoperation)</h2>
<p>Shapely 提供了 4 种与其他软件互操作的途径。</p>
<h3 id="Well-Known-Formats">Well-Known Formats</h3>
<p>任何几何对象的众所周知的文本（WKT）或众所周知的二进制（WKB）表示都可以通过其 wkt 或 wkb 属性获得。这些表示允许与许多 GIS 程序互换。例如，PostGIS 以十六进制编码的 WKB 进行交互。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).wkt<br><span class="hljs-string">&#x27;POINT (0 0)&#x27;</span><br>Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).wkb<br><span class="hljs-string">b&#x27;\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span><br>Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).wkb_hex<br><span class="hljs-string">&#x27;010100000000000000000000000000000000000000&#x27;</span><br></code></pre></td></tr></table></figure>
<p>shapely.wkt和shapely.wkb模块提供了dumps()和loads()函数，它们的工作方式几乎与pickle和simplejson模块的对应函数完全相同。要将几何对象序列化为二进制或文本字符串，请使用 dumps()。要反序列化字符串并获取适当类型的新几何对象，请使用loads()。</p>
<p>wkt 属性和 shapely.wkt.dumps() 函数的默认设置不同。默认情况下，该属性的值会修剪掉多余的小数，而 dumps() 则不是这种情况，尽管可以通过设置 trim=True 来复制它。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.wkb</span><span class="hljs-selector-class">.dumps</span>(ob)<br></code></pre></td></tr></table></figure>
<p>返回 ob 的 WKB 表示形式。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.wkb</span><span class="hljs-selector-class">.loads</span>(wkb)<br></code></pre></td></tr></table></figure>
<p>从 WKB 表示形式 wkb 返回一个几何对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely <span class="hljs-keyword">import</span> wkb<br>pt = Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>wkb.dumps(pt)<br><span class="hljs-string">b&#x27;\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span><br>pt.wkb<br><span class="hljs-string">b&#x27;\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span><br>wkb.loads(pt.wkb).wkt<br><span class="hljs-string">&#x27;POINT (0 0)&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="Numpy-and-Python-Arrays">Numpy and Python Arrays</h3>
<p>所有具有坐标序列的几何对象（Point、LinearRing、LineString）都提供 Numpy 数组接口，从而可以转换或适应 Numpy 数组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>np.asarray(Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).coords)<br>array([[<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>]])<br>np.asarray(LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).coords)<br>array([[<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>],<br>       [<span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>]])<br></code></pre></td></tr></table></figure>
<p>相同类型的几何对象的坐标可以通过 xy 属性作为 x 和 y 值的标准 Python 数组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Point(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).xy<br>(array(<span class="hljs-string">&#x27;d&#x27;</span>, [<span class="hljs-number">0.0</span>]), array(<span class="hljs-string">&#x27;d&#x27;</span>, [<span class="hljs-number">0.0</span>]))<br>LineString([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]).xy<br>(array(<span class="hljs-string">&#x27;d&#x27;</span>, [<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>]), array(<span class="hljs-string">&#x27;d&#x27;</span>, [<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>]))<br></code></pre></td></tr></table></figure>
<h3 id="Python-Geo-Interface">Python Geo Interface</h3>
<p>任何提供类似 GeoJSON 的 Python 地理接口的对象都可以使用 <code>shapely.geometry.shape()</code> 函数转换为 Shapely 几何图形。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.geometry</span><span class="hljs-selector-class">.shape</span>(context)<br></code></pre></td></tr></table></figure>
<p>返回一个新的独立几何体，其坐标是从上下文复制的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> shape<br>data = &#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Point&quot;</span>, <span class="hljs-string">&quot;coordinates&quot;</span>: (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)&#125;<br>geom = shape(data)<br>geom.geom_type<br><span class="hljs-string">&#x27;Point&#x27;</span><br><span class="hljs-built_in">list</span>(geom.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)]<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GeoThing</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, d</span>):<br>        self.__geo_interface__ = d<br>thing = GeoThing(&#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Point&quot;</span>, <span class="hljs-string">&quot;coordinates&quot;</span>: (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)&#125;)<br>geom = shape(thing)<br>geom.geom_type<br><span class="hljs-string">&#x27;Point&#x27;</span><br><span class="hljs-built_in">list</span>(geom.coords)<br>[(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)]<br></code></pre></td></tr></table></figure>
<p>可以使用 <code>shapely.geometry.mapping()</code> 获得几何对象的类似 GeoJSON 的映射。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">shapely<span class="hljs-selector-class">.geometry</span><span class="hljs-selector-class">.mapping</span>(ob)<br></code></pre></td></tr></table></figure>
<p>从 Geometry 或任何实现 <strong>geo_interface</strong> 的对象返回类似 GeoJSON 的映射。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> mapping<br>thing = GeoThing(&#123;<span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Point&quot;</span>, <span class="hljs-string">&quot;coordinates&quot;</span>: (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)&#125;)<br>m = mapping(thing)<br>m[<span class="hljs-string">&#x27;type&#x27;</span>]<br><span class="hljs-string">&#x27;Point&#x27;</span><br>m[<span class="hljs-string">&#x27;coordinates&#x27;</span>]<br>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>)<br></code></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://shapely.readthedocs.io/en/stable/manual.html">https://shapely.readthedocs.io/en/stable/manual.html</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://web.archive.org/web/20160719195511/http://www.vividsolutions.com/jts/discussion.htm">https://web.archive.org/web/20160719195511/http://www.vividsolutions.com/jts/discussion.htm</a></p>
</li>
<li>
<p><a href="https://www.zywvvd.com/notes/study/set-theory/de-9im/de-9im/">https://www.zywvvd.com/notes/study/set-theory/de-9im/de-9im/</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://github.com/mapbox/polylabel">https://github.com/mapbox/polylabel</a></p>
</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
                


				<br /><br />
				<blockquote>
					<p>文章链接：<br /> 
					<a style="font-size: 0.85rem" target="_blank" rel="noopener" href="https://www.zywvvd.com/notes/coding/python/shapely/shapely-user-manual-204/">https://www.zywvvd.com/notes/coding/python/shapely/shapely-user-manual-204/</a>
					</p>
				</blockquote>


              </div>
            
            <hr/>
			
			<!-- 添加打赏模块 -->
			<div class="reward-container">
				
					<button id="rewardBtn" class="reward-btn">
						 
							❤ 打赏
							
					</button>
					<p class="tea">“觉得不错的话，给点打赏吧 ୧(๑•̀⌄•́๑)૭”</p>
					<div id="rewardImgContainer" class="reward-img-container">
						<div class="singleImgContainer">
							<img id="wechatImg" class="reward-img" src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_pc_upload/wechatpay.png" srcset="/img/loading.gif" lazyload alt="微信二维码">
							<p class="wechatPay">微信支付</p>
						</div>
						<div class="singleImgContainer">
							<img id="alipayImg" class="reward-img" src="https://uipv4.zywvvd.com:33030/HexoFiles/vvd_pc_upload/alipay.png" srcset="/img/loading.gif" lazyload alt="支付宝二维码">
							<p class="aliPay">支付宝支付</p>
						</div>
					</div>
				
			</div>
			
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Coding/" class="category-chain-item">Coding</a>
  
  
    <span>></span>
    
  <a href="/categories/Coding/Python/" class="category-chain-item">Python</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Coding/" class="print-no-link">#Coding</a>
      
        <a href="/tags/Python/" class="print-no-link">#Python</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Python Shapely 用户手册 2.0.4</div>
      <div>https://www.zywvvd.com/notes/coding/python/shapely/shapely-user-manual-204/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Yiwei Zhang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年7月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/notes/study/set-theory/de-9im/de-9im/" title="DE-9IM 空间关系模型">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">DE-9IM 空间关系模型</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/notes/coding/python/pyproj/pyproj/" title="Python pyproj 实现地理坐标转换">
                        <span class="hidden-mobile">Python pyproj 实现地理坐标转换</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.14.8/waline.min.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.14.8/waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://uipv4.zywvvd.com:33033/","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":["nick"],"lang":"zh-CN","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10,"reaction":true,"locale":{"placeholder":"山高路远，常来玩吖 ~","reactionTitle":null}},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-xiangshangjiantou" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <div class="vvd_footer" style="font-size: 0.85rem;"> <a href="https://hexo.io" target="_blank" rel="nofollow noopener" color="#d7d8d9" data-umami-event="Footer-Hexo"><span class="umami--click--Footer-Hexo">Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener" data-umami-event="Footer-Fluid"><span class="umami--click--Footer-Fluid">Fluid</span></a> <i class="iconfont icon-love"></i> <a href="https://uipv4.zywvvd.com:33039/share/0zx3o21oIpZTZqwC/%E5%8F%88%E8%A7%81%E8%8B%8D%E5%B2%9A" target="_blank" rel="nofollow noopener" data-umami-event="Footer-Umami"><span class="umami--click--Footer-Umami">Umami</span></a> <div style="font-size: 0.85rem;"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/vvd_js/duration.js"></script> </div> <div style="font-size: 0.85rem;"> <span> 总访问量 <span style="color: #d7d8d9;" id="PVstatic">0</span> 次&nbsp</span> <span> 总访客数 <span style="color: #d7d8d9;" id="UVstatic">0</span> 人&nbsp</span> <span> 当前在线 <span style="color: #d7d8d9;" id="ACTstatic">0</span> 人&nbsp</span> <script src="https://uipv4.zywvvd.com:33037/statistics" defer></script> </div> <div> <span> Copyright © 2020-2025. All Rights Reserved.</span> </div> <div style="font-size: 0.88rem;"> <a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #d7d8d9;"  id="hitokoto"></span></a> <script src="https://uipv4.zywvvd.com:33044/?encode=js&select=%23hitokoto" defer></script> </div> <a href="https://icp.gov.moe/?keyword=20230615" target="_blank">萌ICP备20230615号</a>


</div> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script>
<script src="/js/reward.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  <script type="text/javascript">
    /*窗口监视*/
    var originalTitle = document.title;
    window.onblur = function(){document.title = "明眸如初"};
    window.onfocus = function(){document.title = originalTitle};
  </script>


  <div id="tooltip-rightmenu" class="tooltip-rightmenu">如需原始右键菜单请按下 <strong>Ctrl+右键</strong></div>

<div id="rightmenu-wrapper" style="">
  <ul class="list-v rightmenu" id="rightmenu-content">
	  <li class="navigation menuNavigation-Content">
		<a class="nav icon-only fix-cursor-default" onclick="history.back()"><i class="iconfont icon-zuojiantou1"></i></a>
		<a class="nav icon-only fix-cursor-default" onclick="history.forward()"><i class="iconfont icon-youjiantou1"></i></a>
		<a class="nav icon-only fix-cursor-default" onclick="window.location.reload()"><i class="iconfont icon-shuaxin"></i></a>
		<a  aria-label="TOP" href="#" role="button"><i class="iconfont icon-xiangshang"></i></a>
	  </li>

		<hr class="menuLoad-Content" style="display: block;">
	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
		  <span>
			  <i class="iconfont icon-sousuo1 rightmenu-icon"></i>
			  站内搜索
		  </span>
		</a>
	  </li>

	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default"  href="https://www.zywvvd.com/messagebd/" data-group="link">
		  <span>
			  <i class="iconfont icon-yangshi_icon_tongyong_chat rightmenu-icon">  </i>
			   留言吐槽 
		   </span>
		</a>
	  </li>


	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" id="help" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html" data-group="link">
		<span>
			  <i class="iconfont icon-a-BlackHole rightmenu-icon"></i>
			  虫洞穿梭
		  </span>
		</a>
	  </li>

	<a id="scroll-top-button" aria-label="TOP" href="#" role="button" style="bottom: 20px; right: 52.6364px;">
        <i class="iconfont icon-xiangshangjiantou" aria-hidden="true"></i>
      </a>

	<hr class="menuLoad-Content" style="display: block;">
	
	  <li class="menuLoad-Content" style="display: block;">
		<a class="vlts-menu fix-cursor-default" id="destroy-airplane" target="_blank" rel="noopener"  data-group="link">
		<span>
			  <i class="iconfont icon-feiji rightmenu-icon"></i>
			  破坏小飞机
		  </span>
		</a>
	  </li>
  </ul>
</div>

<script>
	var ua = navigator.userAgent;
	var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
		isIphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
		isAndroid = ua.match(/(Android)\s+([\d.]+)/),
		isMobile = isIphone || isAndroid;

	if(!isMobile) {
		// 为按钮添加事件处理器
		document.getElementById('destroy-airplane').onclick = function() {
		  console.log('飞机起飞！');
		  // 定义要执行的JavaScript代码
		var KICKASSVERSION='2.0';
		var s = document.createElement('script');
		s.type='text/javascript';
		document.body.appendChild(s);
		s.src='https://uipv4.zywvvd.com:33030/HexoFiles/js/games/airplane/airplane.js';
		void(0);
		};
	}
</script>





<link href="/css/custom.css"type="text/css"rel="stylesheet"/>
<script src="/vvd_js/right_menu.js" type="text/javascript"></script>
<link href="/css/right_menu.css"type="text/css"rel="stylesheet"/>
<script src="/vvd_js/go.js"></script>


  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"left","width":200,"height":400},"mobile":{"show":false},"react":{"opacity":0.9}});</script></body>
</html>
